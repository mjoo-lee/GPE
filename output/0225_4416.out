set -e
set -x

eval "$(conda shell.bash hook)"
++ conda shell.bash hook
+ eval 'export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\''

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause
__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We'\''re not allowing PS1 to be unbound. It must at least be set.
    # However, we'\''re not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi

conda activate base'
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
++ export _CE_M=
++ _CE_M=
export _CE_CONDA=''
++ export _CE_CONDA=
++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause
__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We're not allowing PS1 to be unbound. It must at least be set.
    # However, we're not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi
++ '[' -z x ']'

conda activate base
++ conda activate base
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate base
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate base
+++ /home/s2/mjoolee/anaconda/bin/conda shell.posix activate base
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
PS1='(base) '
+++ PS1='(base) '
export PATH='/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'
+++ export PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+++ PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
export CONDA_PREFIX='/home/s2/mjoolee/anaconda'
+++ export CONDA_PREFIX=/home/s2/mjoolee/anaconda
+++ CONDA_PREFIX=/home/s2/mjoolee/anaconda
export CONDA_SHLVL='3'
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
export CONDA_DEFAULT_ENV='base'
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
export CONDA_PROMPT_MODIFIER='(base) '
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
export CONDA_PREFIX_2='/home/s2/mjoolee/anaconda/envs/dassl'
+++ export CONDA_PREFIX_2=/home/s2/mjoolee/anaconda/envs/dassl
+++ CONDA_PREFIX_2=/home/s2/mjoolee/anaconda/envs/dassl
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
+++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
+++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
+++ export _CE_M=
+++ _CE_M=
export _CE_CONDA=''
+++ export _CE_CONDA=
+++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
+++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
+++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
conda activate dassl
+ conda activate dassl
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate dassl
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate dassl
++ /home/s2/mjoolee/anaconda/bin/conda shell.posix activate dassl
+ ask_conda='PS1='\''(dassl) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''dassl'\''
export CONDA_PROMPT_MODIFIER='\''(dassl) '\''
export CONDA_PREFIX_3='\''/home/s2/mjoolee/anaconda'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
+ eval 'PS1='\''(dassl) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''dassl'\''
export CONDA_PROMPT_MODIFIER='\''(dassl) '\''
export CONDA_PREFIX_3='\''/home/s2/mjoolee/anaconda'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
PS1='(dassl) '
++ PS1='(dassl) '
export PATH='/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'
++ export PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
++ PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
export CONDA_PREFIX='/home/s2/mjoolee/anaconda/envs/dassl'
++ export CONDA_PREFIX=/home/s2/mjoolee/anaconda/envs/dassl
++ CONDA_PREFIX=/home/s2/mjoolee/anaconda/envs/dassl
export CONDA_SHLVL='4'
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
export CONDA_DEFAULT_ENV='dassl'
++ export CONDA_DEFAULT_ENV=dassl
++ CONDA_DEFAULT_ENV=dassl
export CONDA_PROMPT_MODIFIER='(dassl) '
++ export 'CONDA_PROMPT_MODIFIER=(dassl) '
++ CONDA_PROMPT_MODIFIER='(dassl) '
export CONDA_PREFIX_3='/home/s2/mjoolee/anaconda'
++ export CONDA_PREFIX_3=/home/s2/mjoolee/anaconda
++ CONDA_PREFIX_3=/home/s2/mjoolee/anaconda
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
++ export _CE_M=
++ _CE_M=
export _CE_CONDA=''
++ export _CE_CONDA=
++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r

GPU=0
+ GPU=0
SHOT=16
+ SHOT=16

for dataset in eurosat dtd fgvc_aircraft oxford_flowers
do
    for seed in 1 2 3
    do
    sh scripts/rpo_prime/base2new_train_sdl.sh ${dataset} ${seed} ${GPU} main_tmp ${SHOT}
    #sh scripts/rpo_prime/base2new_test.sh ${dataset} ${seed} ${GPU} main_9_9 ${SHOT} base
    sh scripts/rpo_prime/base2new_test_sdl.sh ${dataset} ${seed} ${GPU} main_tmp ${SHOT} new
    done
done
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh eurosat 1 0 main_tmp 16
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 16
    PREC: fp16
    sdl_loss: 0
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE BASE CLASSES!
80 2800 4200
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,800
# test     4,200
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [1/1] time 7.897 (7.897) data 1.178 (1.178) loss 2.4922 (2.4922) lr 9.9901e-02 eta 0:06:26
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:35,  2.55s/it] 13%|█▎        | 2/15 [00:02<00:16,  1.28s/it] 20%|██        | 3/15 [00:03<00:09,  1.22it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.64it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.05it/s] 40%|████      | 6/15 [00:04<00:03,  2.41it/s] 47%|████▋     | 7/15 [00:04<00:02,  2.71it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:05<00:01,  3.29it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.39it/s] 80%|████████  | 12/15 [00:05<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.52it/s] 93%|█████████▎| 14/15 [00:06<00:00,  3.56it/s]100%|██████████| 15/15 [00:06<00:00,  2.31it/s]=> result
* total: 2,800
* correct: 941
* accuracy: 33.6%
* error: 66.4%
* macro_f1: 30.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [2/50] batch [1/1] time 1.218 (1.218) data 0.740 (0.740) loss 1.9561 (1.9561) lr 9.9606e-02 eta 0:00:58
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.67s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.94it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:04<00:01,  3.27it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.38it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.45it/s] 80%|████████  | 12/15 [00:04<00:00,  3.51it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.55it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.58it/s]100%|██████████| 15/15 [00:05<00:00,  4.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.62it/s]=> result
* total: 2,800
* correct: 857
* accuracy: 30.6%
* error: 69.4%
* macro_f1: 26.4%

epoch [3/50] batch [1/1] time 1.438 (1.438) data 0.839 (0.839) loss 1.7334 (1.7334) lr 9.9114e-02 eta 0:01:07
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.50s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.16it/s] 20%|██        | 3/15 [00:02<00:07,  1.68it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.11it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.49it/s] 40%|████      | 6/15 [00:03<00:03,  2.79it/s] 47%|████▋     | 7/15 [00:03<00:02,  3.02it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.20it/s] 60%|██████    | 9/15 [00:03<00:01,  3.32it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.42it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.48it/s] 80%|████████  | 12/15 [00:04<00:00,  3.53it/s] 87%|████████▋ | 13/15 [00:04<00:00,  3.56it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.59it/s]100%|██████████| 15/15 [00:05<00:00,  2.75it/s]=> result
* total: 2,800
* correct: 906
* accuracy: 32.4%
* error: 67.6%
* macro_f1: 27.7%

epoch [4/50] batch [1/1] time 1.195 (1.195) data 0.726 (0.726) loss 1.7031 (1.7031) lr 9.8429e-02 eta 0:00:54
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.88s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:04<00:01,  3.27it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.37it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.45it/s] 80%|████████  | 12/15 [00:04<00:00,  3.50it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.53it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.56it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 931
* accuracy: 33.2%
* error: 66.8%
* macro_f1: 28.7%

epoch [5/50] batch [1/1] time 1.191 (1.191) data 0.719 (0.719) loss 1.6523 (1.6523) lr 9.7553e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.74s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.97it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.15it/s] 60%|██████    | 9/15 [00:04<00:01,  3.29it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.39it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.46it/s] 80%|████████  | 12/15 [00:04<00:00,  3.51it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.55it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.57it/s]100%|██████████| 15/15 [00:05<00:00,  2.67it/s]=> result
* total: 2,800
* correct: 974
* accuracy: 34.8%
* error: 65.2%
* macro_f1: 30.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [6/50] batch [1/1] time 1.226 (1.226) data 0.750 (0.750) loss 1.6523 (1.6523) lr 9.6489e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.69s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.61it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.07it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.45it/s] 40%|████      | 6/15 [00:03<00:03,  2.75it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.99it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.17it/s] 60%|██████    | 9/15 [00:03<00:01,  3.30it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.39it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.46it/s] 80%|████████  | 12/15 [00:04<00:00,  3.51it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.54it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.57it/s]100%|██████████| 15/15 [00:05<00:00,  2.69it/s]=> result
* total: 2,800
* correct: 1,025
* accuracy: 36.6%
* error: 63.4%
* macro_f1: 32.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [7/50] batch [1/1] time 1.245 (1.245) data 0.762 (0.762) loss 1.6221 (1.6221) lr 9.5241e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.59s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.64it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.09it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.47it/s] 40%|████      | 6/15 [00:03<00:03,  2.77it/s] 47%|████▋     | 7/15 [00:03<00:02,  3.00it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.18it/s] 60%|██████    | 9/15 [00:03<00:01,  3.30it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.38it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.45it/s] 80%|████████  | 12/15 [00:04<00:00,  3.50it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.54it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.57it/s]100%|██████████| 15/15 [00:05<00:00,  2.72it/s]=> result
* total: 2,800
* correct: 1,106
* accuracy: 39.5%
* error: 60.5%
* macro_f1: 35.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [8/50] batch [1/1] time 1.216 (1.216) data 0.739 (0.739) loss 1.6660 (1.6660) lr 9.3815e-02 eta 0:00:51
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.72s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.96it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.14it/s] 60%|██████    | 9/15 [00:04<00:01,  3.28it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.38it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.45it/s] 80%|████████  | 12/15 [00:04<00:00,  3.50it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.54it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.57it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 1,176
* accuracy: 42.0%
* error: 58.0%
* macro_f1: 38.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [9/50] batch [1/1] time 1.215 (1.215) data 0.739 (0.739) loss 1.6357 (1.6357) lr 9.2216e-02 eta 0:00:49
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.52s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.17it/s] 20%|██        | 3/15 [00:02<00:07,  1.69it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.14it/s] 33%|███▎      | 5/15 [00:02<00:03,  2.51it/s] 40%|████      | 6/15 [00:03<00:03,  2.80it/s] 47%|████▋     | 7/15 [00:03<00:02,  3.03it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.14it/s] 60%|██████    | 9/15 [00:03<00:01,  3.28it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.38it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.45it/s] 80%|████████  | 12/15 [00:04<00:00,  3.50it/s] 87%|████████▋ | 13/15 [00:04<00:00,  3.52it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.55it/s]100%|██████████| 15/15 [00:05<00:00,  2.73it/s]=> result
* total: 2,800
* correct: 1,207
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 39.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [10/50] batch [1/1] time 1.171 (1.171) data 0.687 (0.687) loss 1.6436 (1.6436) lr 9.0451e-02 eta 0:00:46
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.62it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.08it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.45it/s] 40%|████      | 6/15 [00:03<00:03,  2.74it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.98it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.15it/s] 60%|██████    | 9/15 [00:03<00:01,  3.28it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.38it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.45it/s] 80%|████████  | 12/15 [00:04<00:00,  3.49it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.53it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.55it/s]100%|██████████| 15/15 [00:05<00:00,  2.69it/s]=> result
* total: 2,800
* correct: 1,272
* accuracy: 45.4%
* error: 54.6%
* macro_f1: 41.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model.pth.tar-10

epoch [11/50] batch [1/1] time 1.230 (1.230) data 0.747 (0.747) loss 1.6396 (1.6396) lr 8.8526e-02 eta 0:00:47
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.86s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.35it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.42it/s] 80%|████████  | 12/15 [00:05<00:00,  3.48it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.52it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,312
* accuracy: 46.9%
* error: 53.1%
* macro_f1: 43.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [12/50] batch [1/1] time 1.194 (1.194) data 0.722 (0.722) loss 1.6221 (1.6221) lr 8.6448e-02 eta 0:00:45
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.76s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.43it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.95it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:04<00:01,  3.26it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.36it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.43it/s] 80%|████████  | 12/15 [00:04<00:00,  3.48it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.52it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.55it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 1,309
* accuracy: 46.8%
* error: 53.2%
* macro_f1: 44.4%

epoch [13/50] batch [1/1] time 1.199 (1.199) data 0.724 (0.724) loss 1.6416 (1.6416) lr 8.4227e-02 eta 0:00:44
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.09s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.03s/it] 20%|██        | 3/15 [00:02<00:08,  1.46it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.90it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.30it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.88it/s] 53%|█████▎    | 8/15 [00:04<00:02,  3.07it/s] 60%|██████    | 9/15 [00:04<00:01,  3.22it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:05<00:00,  3.47it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.51it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 1,343
* accuracy: 48.0%
* error: 52.0%
* macro_f1: 46.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [14/50] batch [1/1] time 1.205 (1.205) data 0.722 (0.722) loss 1.6318 (1.6318) lr 8.1871e-02 eta 0:00:43
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.93s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.93it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:04<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.35it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.43it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,307
* accuracy: 46.7%
* error: 53.3%
* macro_f1: 46.4%

epoch [15/50] batch [1/1] time 1.207 (1.207) data 0.734 (0.734) loss 1.6299 (1.6299) lr 7.9389e-02 eta 0:00:42
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:04<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.35it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.43it/s] 80%|████████  | 12/15 [00:04<00:00,  3.48it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.51it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.54it/s]100%|██████████| 15/15 [00:05<00:00,  2.63it/s]=> result
* total: 2,800
* correct: 1,274
* accuracy: 45.5%
* error: 54.5%
* macro_f1: 45.4%

epoch [16/50] batch [1/1] time 1.224 (1.224) data 0.743 (0.743) loss 1.6182 (1.6182) lr 7.6791e-02 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.88s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.09it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:05<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 1,237
* accuracy: 44.2%
* error: 55.8%
* macro_f1: 44.4%

epoch [17/50] batch [1/1] time 1.212 (1.212) data 0.731 (0.731) loss 1.6182 (1.6182) lr 7.4088e-02 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.88s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.93it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:04<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 1,182
* accuracy: 42.2%
* error: 57.8%
* macro_f1: 42.4%

epoch [18/50] batch [1/1] time 1.202 (1.202) data 0.728 (0.728) loss 1.6182 (1.6182) lr 7.1289e-02 eta 0:00:38
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:05<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 1,177
* accuracy: 42.0%
* error: 58.0%
* macro_f1: 42.4%

epoch [19/50] batch [1/1] time 1.202 (1.202) data 0.721 (0.721) loss 1.6338 (1.6338) lr 6.8406e-02 eta 0:00:37
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.94s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:05<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 1,149
* accuracy: 41.0%
* error: 59.0%
* macro_f1: 41.2%

epoch [20/50] batch [1/1] time 1.216 (1.216) data 0.733 (0.733) loss 1.6270 (1.6270) lr 6.5451e-02 eta 0:00:36
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.11it/s] 60%|██████    | 9/15 [00:04<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.35it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.42it/s] 80%|████████  | 12/15 [00:04<00:00,  3.47it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.64it/s]=> result
* total: 2,800
* correct: 1,169
* accuracy: 41.8%
* error: 58.2%
* macro_f1: 42.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model.pth.tar-20

epoch [21/50] batch [1/1] time 1.174 (1.174) data 0.693 (0.693) loss 1.6094 (1.6094) lr 6.2434e-02 eta 0:00:34
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.69s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.04it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.95it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:04<00:01,  3.26it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.36it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.42it/s] 80%|████████  | 12/15 [00:04<00:00,  3.47it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.51it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.53it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 1,148
* accuracy: 41.0%
* error: 59.0%
* macro_f1: 41.3%

epoch [22/50] batch [1/1] time 1.212 (1.212) data 0.728 (0.728) loss 1.6152 (1.6152) lr 5.9369e-02 eta 0:00:33
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.71s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.93it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.11it/s] 60%|██████    | 9/15 [00:04<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.65it/s]=> result
* total: 2,800
* correct: 1,160
* accuracy: 41.4%
* error: 58.6%
* macro_f1: 41.5%

epoch [23/50] batch [1/1] time 1.171 (1.171) data 0.698 (0.698) loss 1.6162 (1.6162) lr 5.6267e-02 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.62it/s]=> result
* total: 2,800
* correct: 1,185
* accuracy: 42.3%
* error: 57.7%
* macro_f1: 42.5%

epoch [24/50] batch [1/1] time 1.196 (1.196) data 0.719 (0.719) loss 1.6270 (1.6270) lr 5.3140e-02 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.50s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.17it/s] 20%|██        | 3/15 [00:02<00:07,  1.69it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.13it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.50it/s] 40%|████      | 6/15 [00:03<00:03,  2.78it/s] 47%|████▋     | 7/15 [00:03<00:02,  3.00it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.16it/s] 60%|██████    | 9/15 [00:03<00:01,  3.27it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.36it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.42it/s] 80%|████████  | 12/15 [00:04<00:00,  3.47it/s] 87%|████████▋ | 13/15 [00:04<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.74it/s]=> result
* total: 2,800
* correct: 1,208
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 43.6%

epoch [25/50] batch [1/1] time 1.200 (1.200) data 0.717 (0.717) loss 1.6172 (1.6172) lr 5.0000e-02 eta 0:00:30
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.55s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.67it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.64it/s]=> result
* total: 2,800
* correct: 1,212
* accuracy: 43.3%
* error: 56.7%
* macro_f1: 43.6%

epoch [26/50] batch [1/1] time 1.160 (1.160) data 0.682 (0.682) loss 1.6230 (1.6230) lr 4.6860e-02 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.90s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,247
* accuracy: 44.5%
* error: 55.5%
* macro_f1: 45.1%

epoch [27/50] batch [1/1] time 1.188 (1.188) data 0.694 (0.694) loss 1.6191 (1.6191) lr 4.3733e-02 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.61it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.95it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:03<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.35it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.67it/s]=> result
* total: 2,800
* correct: 1,225
* accuracy: 43.8%
* error: 56.2%
* macro_f1: 44.4%

epoch [28/50] batch [1/1] time 1.262 (1.262) data 0.773 (0.773) loss 1.6260 (1.6260) lr 4.0631e-02 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.88s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,268
* accuracy: 45.3%
* error: 54.7%
* macro_f1: 46.0%

epoch [29/50] batch [1/1] time 1.187 (1.187) data 0.716 (0.716) loss 1.6104 (1.6104) lr 3.7566e-02 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.86s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,257
* accuracy: 44.9%
* error: 55.1%
* macro_f1: 45.5%

epoch [30/50] batch [1/1] time 1.210 (1.210) data 0.731 (0.731) loss 1.6152 (1.6152) lr 3.4549e-02 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.22it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,273
* accuracy: 45.5%
* error: 54.5%
* macro_f1: 46.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model.pth.tar-30

epoch [31/50] batch [1/1] time 1.175 (1.175) data 0.692 (0.692) loss 1.6279 (1.6279) lr 3.1594e-02 eta 0:00:22
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.97s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.89it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:05<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 1,305
* accuracy: 46.6%
* error: 53.4%
* macro_f1: 47.3%

epoch [32/50] batch [1/1] time 1.203 (1.203) data 0.727 (0.727) loss 1.6270 (1.6270) lr 2.8711e-02 eta 0:00:21
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.49s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.93it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:03<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.68it/s]=> result
* total: 2,800
* correct: 1,316
* accuracy: 47.0%
* error: 53.0%
* macro_f1: 47.6%

epoch [33/50] batch [1/1] time 1.215 (1.215) data 0.740 (0.740) loss 1.6143 (1.6143) lr 2.5912e-02 eta 0:00:20
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.56s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.14it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.04it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.71it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:03<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.69it/s]=> result
* total: 2,800
* correct: 1,318
* accuracy: 47.1%
* error: 52.9%
* macro_f1: 47.6%

epoch [34/50] batch [1/1] time 1.160 (1.160) data 0.681 (0.681) loss 1.6104 (1.6104) lr 2.3209e-02 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.55s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.12it/s] 20%|██        | 3/15 [00:02<00:07,  1.61it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.43it/s] 40%|████      | 6/15 [00:03<00:03,  2.73it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.95it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:03<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.70it/s]=> result
* total: 2,800
* correct: 1,353
* accuracy: 48.3%
* error: 51.7%
* macro_f1: 48.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [35/50] batch [1/1] time 1.208 (1.208) data 0.734 (0.734) loss 1.6104 (1.6104) lr 2.0611e-02 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.62it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.07it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.44it/s] 40%|████      | 6/15 [00:03<00:03,  2.73it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.96it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:03<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.67it/s]=> result
* total: 2,800
* correct: 1,357
* accuracy: 48.5%
* error: 51.5%
* macro_f1: 48.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [36/50] batch [1/1] time 1.161 (1.161) data 0.682 (0.682) loss 1.6025 (1.6025) lr 1.8129e-02 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.81s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.22it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:05<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 1,353
* accuracy: 48.3%
* error: 51.7%
* macro_f1: 48.6%

epoch [37/50] batch [1/1] time 1.199 (1.199) data 0.715 (0.715) loss 1.6123 (1.6123) lr 1.5773e-02 eta 0:00:15
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.84s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.09it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,355
* accuracy: 48.4%
* error: 51.6%
* macro_f1: 48.6%

epoch [38/50] batch [1/1] time 1.209 (1.209) data 0.732 (0.732) loss 1.6191 (1.6191) lr 1.3552e-02 eta 0:00:14
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.47s/it] 13%|█▎        | 2/15 [00:01<00:10,  1.18it/s] 20%|██        | 3/15 [00:02<00:07,  1.63it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.08it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.45it/s] 40%|████      | 6/15 [00:03<00:03,  2.74it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.96it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:03<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.42it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.46it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.71it/s]=> result
* total: 2,800
* correct: 1,367
* accuracy: 48.8%
* error: 51.2%
* macro_f1: 49.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [39/50] batch [1/1] time 1.200 (1.200) data 0.720 (0.720) loss 1.6006 (1.6006) lr 1.1474e-02 eta 0:00:13
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.48s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.15it/s] 20%|██        | 3/15 [00:02<00:07,  1.61it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.12it/s] 60%|██████    | 9/15 [00:03<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.70it/s]=> result
* total: 2,800
* correct: 1,373
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 49.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [40/50] batch [1/1] time 1.218 (1.218) data 0.740 (0.740) loss 1.6113 (1.6113) lr 9.5492e-03 eta 0:00:12
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.09it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 1,368
* accuracy: 48.9%
* error: 51.1%
* macro_f1: 48.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model.pth.tar-40

epoch [41/50] batch [1/1] time 1.205 (1.205) data 0.720 (0.720) loss 1.6152 (1.6152) lr 7.7836e-03 eta 0:00:10
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.75s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.67it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.09it/s] 60%|██████    | 9/15 [00:04<00:01,  3.22it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 1,365
* accuracy: 48.8%
* error: 51.2%
* macro_f1: 48.8%

epoch [42/50] batch [1/1] time 1.169 (1.169) data 0.690 (0.690) loss 1.6025 (1.6025) lr 6.1847e-03 eta 0:00:09
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.81s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.62it/s]=> result
* total: 2,800
* correct: 1,372
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 49.0%

epoch [43/50] batch [1/1] time 1.163 (1.163) data 0.689 (0.689) loss 1.6084 (1.6084) lr 4.7586e-03 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.89it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.07it/s] 60%|██████    | 9/15 [00:04<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.31it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.38it/s] 80%|████████  | 12/15 [00:05<00:00,  3.43it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 1,373
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 49.0%

epoch [44/50] batch [1/1] time 1.195 (1.195) data 0.713 (0.713) loss 1.6143 (1.6143) lr 3.5112e-03 eta 0:00:07
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.95s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.89it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.07it/s] 60%|██████    | 9/15 [00:04<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.31it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.38it/s] 80%|████████  | 12/15 [00:05<00:00,  3.43it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 1,380
* accuracy: 49.3%
* error: 50.7%
* macro_f1: 49.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [45/50] batch [1/1] time 1.204 (1.204) data 0.723 (0.723) loss 1.6240 (1.6240) lr 2.4472e-03 eta 0:00:06
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.70s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.15it/s] 20%|██        | 3/15 [00:02<00:07,  1.66it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.10it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.47it/s] 40%|████      | 6/15 [00:03<00:03,  2.75it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.97it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:03<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.69it/s]=> result
* total: 2,800
* correct: 1,375
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 48.9%

epoch [46/50] batch [1/1] time 1.219 (1.219) data 0.741 (0.741) loss 1.6045 (1.6045) lr 1.5708e-03 eta 0:00:04
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.64s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.71it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.11it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 1,370
* accuracy: 48.9%
* error: 51.1%
* macro_f1: 48.9%

epoch [47/50] batch [1/1] time 1.200 (1.200) data 0.720 (0.720) loss 1.6045 (1.6045) lr 8.8564e-04 eta 0:00:03
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.52s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.16it/s] 20%|██        | 3/15 [00:02<00:07,  1.68it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.12it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.48it/s] 40%|████      | 6/15 [00:03<00:03,  2.76it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.98it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.14it/s] 60%|██████    | 9/15 [00:03<00:01,  3.26it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.71it/s]=> result
* total: 2,800
* correct: 1,373
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 48.9%

epoch [48/50] batch [1/1] time 1.211 (1.211) data 0.726 (0.726) loss 1.6123 (1.6123) lr 3.9426e-04 eta 0:00:02
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.31it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.38it/s] 80%|████████  | 12/15 [00:04<00:00,  3.43it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 1,385
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 49.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar

epoch [49/50] batch [1/1] time 1.225 (1.225) data 0.745 (0.745) loss 1.6074 (1.6074) lr 9.8664e-05 eta 0:00:01
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.86s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.51it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.88it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.07it/s] 60%|██████    | 9/15 [00:04<00:01,  3.20it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.30it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.37it/s] 80%|████████  | 12/15 [00:05<00:00,  3.43it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.46it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 1,378
* accuracy: 49.2%
* error: 50.8%
* macro_f1: 48.9%

epoch [50/50] batch [1/1] time 1.177 (1.177) data 0.693 (0.693) loss 1.6152 (1.6152) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.88it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.06it/s] 60%|██████    | 9/15 [00:04<00:01,  3.20it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.30it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.37it/s] 80%|████████  | 12/15 [00:05<00:00,  3.42it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.46it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.48it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]
=> result
* total: 2,800
* correct: 1,385
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 49.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar" (epoch = 48)
Evaluate on the *test* set
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:01<00:39,  1.89s/it]  9%|▉         | 2/22 [00:02<00:22,  1.13s/it] 14%|█▎        | 3/22 [00:02<00:15,  1.19it/s] 18%|█▊        | 4/22 [00:03<00:11,  1.61it/s] 23%|██▎       | 5/22 [00:03<00:08,  2.01it/s] 27%|██▋       | 6/22 [00:03<00:06,  2.36it/s] 32%|███▏      | 7/22 [00:04<00:05,  2.65it/s] 36%|███▋      | 8/22 [00:04<00:04,  2.88it/s] 41%|████      | 9/22 [00:04<00:04,  3.06it/s] 45%|████▌     | 10/22 [00:04<00:03,  3.20it/s] 50%|█████     | 11/22 [00:05<00:03,  3.30it/s] 55%|█████▍    | 12/22 [00:05<00:02,  3.37it/s] 59%|█████▉    | 13/22 [00:05<00:02,  3.42it/s] 64%|██████▎   | 14/22 [00:06<00:02,  3.46it/s] 68%|██████▊   | 15/22 [00:06<00:02,  3.49it/s] 73%|███████▎  | 16/22 [00:06<00:01,  3.50it/s] 77%|███████▋  | 17/22 [00:06<00:01,  3.52it/s] 82%|████████▏ | 18/22 [00:07<00:01,  3.51it/s] 86%|████████▋ | 19/22 [00:07<00:00,  3.52it/s] 91%|█████████ | 20/22 [00:07<00:00,  3.53it/s] 95%|█████████▌| 21/22 [00:08<00:00,  3.54it/s]100%|██████████| 22/22 [00:08<00:00,  4.20it/s]100%|██████████| 22/22 [00:08<00:00,  2.64it/s]
=> result
* total: 4,200
* correct: 2,043
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 48.4%
Elapsed: 0:06:07
+ sh scripts/rpo_prime/base2new_test_sdl.sh eurosat 1 0 main_tmp 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 16
    PREC: fp16
    sdl_loss: 0
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE NEW CLASSES!
80 2600 3900
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,600
# test     3,900
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed1/prompt_learner/model-best.pth.tar" (epoch = 48)
Evaluate on the *test* set
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:04<01:34,  4.96s/it] 10%|█         | 2/20 [00:05<00:39,  2.21s/it] 15%|█▌        | 3/20 [00:05<00:22,  1.33s/it] 20%|██        | 4/20 [00:05<00:14,  1.09it/s] 25%|██▌       | 5/20 [00:06<00:10,  1.46it/s] 30%|███       | 6/20 [00:06<00:07,  1.83it/s] 35%|███▌      | 7/20 [00:06<00:05,  2.17it/s] 40%|████      | 8/20 [00:06<00:04,  2.48it/s] 45%|████▌     | 9/20 [00:07<00:04,  2.75it/s] 50%|█████     | 10/20 [00:07<00:03,  2.96it/s] 55%|█████▌    | 11/20 [00:07<00:02,  3.12it/s] 60%|██████    | 12/20 [00:08<00:02,  3.25it/s] 65%|██████▌   | 13/20 [00:08<00:02,  3.34it/s] 70%|███████   | 14/20 [00:08<00:01,  3.41it/s] 75%|███████▌  | 15/20 [00:08<00:01,  3.45it/s] 80%|████████  | 16/20 [00:09<00:01,  3.49it/s] 85%|████████▌ | 17/20 [00:09<00:00,  3.52it/s] 90%|█████████ | 18/20 [00:09<00:00,  3.53it/s] 95%|█████████▌| 19/20 [00:09<00:00,  3.55it/s]100%|██████████| 20/20 [00:10<00:00,  3.66it/s]100%|██████████| 20/20 [00:10<00:00,  1.93it/s]
=> result
* total: 3,900
* correct: 2,191
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 54.6%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh eurosat 2 0 main_tmp 16
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 16
    PREC: fp16
    sdl_loss: 0
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE BASE CLASSES!
80 2800 4200
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,800
# test     4,200
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [1/1] time 3.010 (3.010) data 1.122 (1.122) loss 2.4688 (2.4688) lr 9.9901e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:30,  2.16s/it] 13%|█▎        | 2/15 [00:02<00:15,  1.20s/it] 20%|██        | 3/15 [00:02<00:09,  1.28it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.72it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.12it/s] 40%|████      | 6/15 [00:03<00:03,  2.46it/s] 47%|████▋     | 7/15 [00:04<00:02,  2.74it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.95it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.25it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.35it/s] 80%|████████  | 12/15 [00:05<00:00,  3.42it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:06<00:00,  3.50it/s]100%|██████████| 15/15 [00:06<00:00,  2.39it/s]=> result
* total: 2,800
* correct: 1,151
* accuracy: 41.1%
* error: 58.9%
* macro_f1: 37.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2/prompt_learner/model-best.pth.tar

epoch [2/50] batch [1/1] time 1.298 (1.298) data 0.812 (0.812) loss 2.0898 (2.0898) lr 9.9606e-02 eta 0:01:02
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.71s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.94it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.11it/s] 60%|██████    | 9/15 [00:04<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.35it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.63it/s]=> result
* total: 2,800
* correct: 772
* accuracy: 27.6%
* error: 72.4%
* macro_f1: 24.0%

epoch [3/50] batch [1/1] time 1.214 (1.214) data 0.736 (0.736) loss 1.8818 (1.8818) lr 9.9114e-02 eta 0:00:57
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.59s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.65it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.09it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.46it/s] 40%|████      | 6/15 [00:03<00:03,  2.76it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.98it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.15it/s] 60%|██████    | 9/15 [00:03<00:01,  3.28it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.36it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.46it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.69it/s]=> result
* total: 2,800
* correct: 1,167
* accuracy: 41.7%
* error: 58.3%
* macro_f1: 37.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2/prompt_learner/model-best.pth.tar

epoch [4/50] batch [1/1] time 1.174 (1.174) data 0.706 (0.706) loss 1.7598 (1.7598) lr 9.8429e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.75s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:04<00:01,  3.23it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 1,376
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 45.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2/prompt_learner/model-best.pth.tar

epoch [5/50] batch [1/1] time 1.221 (1.221) data 0.745 (0.745) loss 1.6963 (1.6963) lr 9.7553e-02 eta 0:00:54
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.55s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.15it/s] 20%|██        | 3/15 [00:02<00:07,  1.66it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.10it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.47it/s] 40%|████      | 6/15 [00:03<00:03,  2.76it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.98it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.15it/s] 60%|██████    | 9/15 [00:03<00:01,  3.27it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.36it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.42it/s] 80%|████████  | 12/15 [00:04<00:00,  3.47it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.50it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.52it/s]100%|██████████| 15/15 [00:05<00:00,  2.71it/s]=> result
* total: 2,800
* correct: 1,450
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 46.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp/seed2/prompt_learner/model-best.pth.tar

epoch [6/50] batch [1/1] time 1.211 (1.211) data 0.735 (0.735) loss 1.7070 (1.7070) lr 9.6489e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.67s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.09it/s] 60%|██████    | 9/15 [00:04<00:01,  3.22it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.32it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.39it/s] 80%|████████  | 12/15 [00:04<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,329
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 43.6%

epoch [7/50] batch [1/1] time 1.204 (1.204) data 0.724 (0.724) loss 1.6592 (1.6592) lr 9.5241e-02 eta 0:00:51
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.05s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.01s/it] 20%|██        | 3/15 [00:02<00:08,  1.48it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:04<00:02,  3.06it/s] 60%|██████    | 9/15 [00:04<00:01,  3.20it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.31it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.38it/s] 80%|████████  | 12/15 [00:05<00:00,  3.44it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.50it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 1,028
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 33.9%

epoch [8/50] batch [1/1] time 1.472 (1.472) data 0.879 (0.879) loss 1.6621 (1.6621) lr 9.3815e-02 eta 0:01:01
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.62s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.62it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.07it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.44it/s] 40%|████      | 6/15 [00:03<00:03,  2.73it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.96it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.13it/s] 60%|██████    | 9/15 [00:03<00:01,  3.25it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.34it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.41it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.49it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.51it/s]100%|██████████| 15/15 [00:05<00:00,  2.67it/s]=> result
* total: 2,800
* correct: 983
* accuracy: 35.1%
* error: 64.9%
* macro_f1: 31.4%

epoch [9/50] batch [1/1] time 1.205 (1.205) data 0.724 (0.724) loss 1.6523 (1.6523) lr 9.2216e-02 eta 0:00:49
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.83s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.03it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.71it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.93it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.11it/s] 60%|██████    | 9/15 [00:04<00:01,  3.24it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.33it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.40it/s] 80%|████████  | 12/15 [00:04<00:00,  3.45it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.48it/s]slurmstepd: error: *** JOB 391535 ON a02 CANCELLED AT 2024-02-26T14:33:08 ***
