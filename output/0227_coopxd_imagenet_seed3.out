set -e
set -x

eval "$(conda shell.bash hook)"
++ conda shell.bash hook
+ eval 'export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\''

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause
__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We'\''re not allowing PS1 to be unbound. It must at least be set.
    # However, we'\''re not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi

conda activate base'
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
++ export _CE_M=
++ _CE_M=
export _CE_CONDA=''
++ export _CE_CONDA=
++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause
__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We're not allowing PS1 to be unbound. It must at least be set.
    # However, we're not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi
++ '[' -z x ']'

conda activate base
++ conda activate base
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate base
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate base
+++ /home/s2/mjoolee/anaconda/bin/conda shell.posix activate base
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
PS1='(base) '
+++ PS1='(base) '
export PATH='/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'
+++ export PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+++ PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
export CONDA_PREFIX='/home/s2/mjoolee/anaconda'
+++ export CONDA_PREFIX=/home/s2/mjoolee/anaconda
+++ CONDA_PREFIX=/home/s2/mjoolee/anaconda
export CONDA_SHLVL='3'
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
export CONDA_DEFAULT_ENV='base'
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
export CONDA_PROMPT_MODIFIER='(base) '
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
export CONDA_PREFIX_2='/home/s2/mjoolee/anaconda/envs/dassl'
+++ export CONDA_PREFIX_2=/home/s2/mjoolee/anaconda/envs/dassl
+++ CONDA_PREFIX_2=/home/s2/mjoolee/anaconda/envs/dassl
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
+++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
+++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
+++ export _CE_M=
+++ _CE_M=
export _CE_CONDA=''
+++ export _CE_CONDA=
+++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
+++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
+++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
conda activate dassl
+ conda activate dassl
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate dassl
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate dassl
++ /home/s2/mjoolee/anaconda/bin/conda shell.posix activate dassl
+ ask_conda='PS1='\''(dassl) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''dassl'\''
export CONDA_PROMPT_MODIFIER='\''(dassl) '\''
export CONDA_PREFIX_3='\''/home/s2/mjoolee/anaconda'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
+ eval 'PS1='\''(dassl) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''dassl'\''
export CONDA_PROMPT_MODIFIER='\''(dassl) '\''
export CONDA_PREFIX_3='\''/home/s2/mjoolee/anaconda'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
PS1='(dassl) '
++ PS1='(dassl) '
export PATH='/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'
++ export PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
++ PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
export CONDA_PREFIX='/home/s2/mjoolee/anaconda/envs/dassl'
++ export CONDA_PREFIX=/home/s2/mjoolee/anaconda/envs/dassl
++ CONDA_PREFIX=/home/s2/mjoolee/anaconda/envs/dassl
export CONDA_SHLVL='4'
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
export CONDA_DEFAULT_ENV='dassl'
++ export CONDA_DEFAULT_ENV=dassl
++ CONDA_DEFAULT_ENV=dassl
export CONDA_PROMPT_MODIFIER='(dassl) '
++ export 'CONDA_PROMPT_MODIFIER=(dassl) '
++ CONDA_PROMPT_MODIFIER='(dassl) '
export CONDA_PREFIX_3='/home/s2/mjoolee/anaconda'
++ export CONDA_PREFIX_3=/home/s2/mjoolee/anaconda
++ CONDA_PREFIX_3=/home/s2/mjoolee/anaconda
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
++ export _CE_M=
++ _CE_M=
export _CE_CONDA=''
++ export _CE_CONDA=
++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r

GPU=0
+ GPU=0
SHOT=16
+ SHOT=16
EPOCH=50
+ EPOCH=50
cfg=vit_b16_ep50_ctxv1
+ cfg=vit_b16_ep50_ctxv1
# EPOCH=200
# cfg=vit_b16_ctxv1
TRAINER=CoOp
+ TRAINER=CoOp


for seed in 3
 do
     #training
     sh scripts/coop/crossdataset_train.sh imagenet ${seed} ${GPU} ${cfg} ${SHOT} ${TRAINER}
 done         
+ for seed in 3
+ sh scripts/coop/crossdataset_train.sh imagenet 3 0 vit_b16_ep50_ctxv1 16 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/imagenet.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: ImageNet
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:ImageNet
Loading dataset: ImageNet
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/ImageNet/split_fewshot_taesup/shot_16-seed_3.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  --------
Dataset    ImageNet
# classes  1,000
# train_x  16,000
# val      50,000
# test     50,000
---------  --------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Found checkpoint at output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3 (will resume training)
Loading checkpoint from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50"
Loaded model weights
Loaded optimizer
Loaded scheduler
Previous epoch: 50
Initialize tensorboard (log_dir=output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/tensorboard)
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:05<42:39,  5.13s/it]  0%|          | 2/500 [00:05<18:55,  2.28s/it]  1%|          | 3/500 [00:05<11:21,  1.37s/it]  1%|          | 4/500 [00:05<07:48,  1.06it/s]  1%|          | 5/500 [00:06<05:50,  1.41it/s]  1%|          | 6/500 [00:06<04:39,  1.76it/s]  1%|▏         | 7/500 [00:06<03:54,  2.10it/s]  2%|▏         | 8/500 [00:07<03:25,  2.40it/s]  2%|▏         | 9/500 [00:07<03:05,  2.65it/s]  2%|▏         | 10/500 [00:07<02:52,  2.85it/s]  2%|▏         | 11/500 [00:08<02:42,  3.00it/s]  2%|▏         | 12/500 [00:08<02:36,  3.12it/s]  3%|▎         | 13/500 [00:08<02:31,  3.21it/s]  3%|▎         | 14/500 [00:08<02:28,  3.28it/s]  3%|▎         | 15/500 [00:09<02:26,  3.32it/s]  3%|▎         | 16/500 [00:09<02:24,  3.36it/s]  3%|▎         | 17/500 [00:09<02:22,  3.38it/s]  4%|▎         | 18/500 [00:10<02:21,  3.40it/s]  4%|▍         | 19/500 [00:10<02:21,  3.41it/s]  4%|▍         | 20/500 [00:10<02:20,  3.42it/s]  4%|▍         | 21/500 [00:10<02:20,  3.42it/s]  4%|▍         | 22/500 [00:11<02:19,  3.43it/s]  5%|▍         | 23/500 [00:11<02:19,  3.43it/s]  5%|▍         | 24/500 [00:11<02:18,  3.43it/s]  5%|▌         | 25/500 [00:12<02:18,  3.42it/s]  5%|▌         | 26/500 [00:12<02:18,  3.43it/s]  5%|▌         | 27/500 [00:12<02:18,  3.43it/s]  6%|▌         | 28/500 [00:12<02:17,  3.43it/s]  6%|▌         | 29/500 [00:13<02:17,  3.43it/s]  6%|▌         | 30/500 [00:13<02:17,  3.43it/s]  6%|▌         | 31/500 [00:13<02:16,  3.43it/s]  6%|▋         | 32/500 [00:14<02:16,  3.43it/s]  7%|▋         | 33/500 [00:14<02:16,  3.43it/s]  7%|▋         | 34/500 [00:14<02:16,  3.43it/s]  7%|▋         | 35/500 [00:15<02:15,  3.42it/s]  7%|▋         | 36/500 [00:15<02:15,  3.43it/s]  7%|▋         | 37/500 [00:15<02:15,  3.43it/s]  8%|▊         | 38/500 [00:15<02:14,  3.43it/s]  8%|▊         | 39/500 [00:16<02:14,  3.42it/s]  8%|▊         | 40/500 [00:16<02:14,  3.42it/s]  8%|▊         | 41/500 [00:16<02:14,  3.42it/s]  8%|▊         | 42/500 [00:17<02:13,  3.42it/s]  9%|▊         | 43/500 [00:17<02:13,  3.42it/s]  9%|▉         | 44/500 [00:17<02:13,  3.42it/s]  9%|▉         | 45/500 [00:17<02:13,  3.42it/s]  9%|▉         | 46/500 [00:18<02:12,  3.42it/s]  9%|▉         | 47/500 [00:18<02:12,  3.42it/s] 10%|▉         | 48/500 [00:18<02:12,  3.42it/s] 10%|▉         | 49/500 [00:19<02:12,  3.42it/s] 10%|█         | 50/500 [00:19<02:11,  3.42it/s] 10%|█         | 51/500 [00:19<02:11,  3.42it/s] 10%|█         | 52/500 [00:19<02:11,  3.42it/s] 11%|█         | 53/500 [00:20<02:10,  3.42it/s] 11%|█         | 54/500 [00:20<02:10,  3.42it/s] 11%|█         | 55/500 [00:20<02:09,  3.42it/s] 11%|█         | 56/500 [00:21<02:09,  3.42it/s] 11%|█▏        | 57/500 [00:21<02:09,  3.43it/s] 12%|█▏        | 58/500 [00:21<02:09,  3.43it/s] 12%|█▏        | 59/500 [00:22<02:08,  3.42it/s] 12%|█▏        | 60/500 [00:22<02:08,  3.42it/s] 12%|█▏        | 61/500 [00:22<02:08,  3.42it/s] 12%|█▏        | 62/500 [00:22<02:08,  3.42it/s] 13%|█▎        | 63/500 [00:23<02:07,  3.42it/s] 13%|█▎        | 64/500 [00:23<02:07,  3.42it/s] 13%|█▎        | 65/500 [00:23<02:07,  3.42it/s] 13%|█▎        | 66/500 [00:24<02:07,  3.41it/s] 13%|█▎        | 67/500 [00:24<02:06,  3.41it/s] 14%|█▎        | 68/500 [00:24<02:06,  3.41it/s] 14%|█▍        | 69/500 [00:24<02:06,  3.41it/s] 14%|█▍        | 70/500 [00:25<02:06,  3.41it/s] 14%|█▍        | 71/500 [00:25<02:05,  3.41it/s] 14%|█▍        | 72/500 [00:25<02:05,  3.41it/s] 15%|█▍        | 73/500 [00:26<02:05,  3.41it/s] 15%|█▍        | 74/500 [00:26<02:05,  3.40it/s] 15%|█▌        | 75/500 [00:26<02:04,  3.40it/s] 15%|█▌        | 76/500 [00:27<02:04,  3.40it/s] 15%|█▌        | 77/500 [00:27<02:04,  3.40it/s] 16%|█▌        | 78/500 [00:27<02:04,  3.40it/s] 16%|█▌        | 79/500 [00:27<02:03,  3.40it/s] 16%|█▌        | 80/500 [00:28<02:03,  3.40it/s] 16%|█▌        | 81/500 [00:28<02:03,  3.40it/s] 16%|█▋        | 82/500 [00:28<02:02,  3.40it/s] 17%|█▋        | 83/500 [00:29<02:02,  3.40it/s] 17%|█▋        | 84/500 [00:29<02:02,  3.40it/s] 17%|█▋        | 85/500 [00:29<02:02,  3.40it/s] 17%|█▋        | 86/500 [00:29<02:01,  3.40it/s] 17%|█▋        | 87/500 [00:30<02:01,  3.40it/s] 18%|█▊        | 88/500 [00:30<02:01,  3.40it/s] 18%|█▊        | 89/500 [00:30<02:00,  3.40it/s] 18%|█▊        | 90/500 [00:31<02:00,  3.40it/s] 18%|█▊        | 91/500 [00:31<02:00,  3.40it/s] 18%|█▊        | 92/500 [00:31<02:00,  3.40it/s] 19%|█▊        | 93/500 [00:32<01:59,  3.40it/s] 19%|█▉        | 94/500 [00:32<01:59,  3.40it/s] 19%|█▉        | 95/500 [00:32<01:59,  3.40it/s] 19%|█▉        | 96/500 [00:32<01:58,  3.40it/s] 19%|█▉        | 97/500 [00:33<01:58,  3.40it/s] 20%|█▉        | 98/500 [00:33<01:58,  3.40it/s] 20%|█▉        | 99/500 [00:33<01:58,  3.40it/s] 20%|██        | 100/500 [00:34<01:57,  3.40it/s] 20%|██        | 101/500 [00:34<01:57,  3.40it/s] 20%|██        | 102/500 [00:34<01:57,  3.40it/s] 21%|██        | 103/500 [00:34<01:56,  3.40it/s] 21%|██        | 104/500 [00:35<01:56,  3.40it/s] 21%|██        | 105/500 [00:35<01:56,  3.40it/s] 21%|██        | 106/500 [00:35<01:56,  3.39it/s] 21%|██▏       | 107/500 [00:36<01:55,  3.39it/s] 22%|██▏       | 108/500 [00:36<01:55,  3.39it/s] 22%|██▏       | 109/500 [00:36<01:55,  3.39it/s] 22%|██▏       | 110/500 [00:37<01:55,  3.39it/s] 22%|██▏       | 111/500 [00:37<01:54,  3.39it/s] 22%|██▏       | 112/500 [00:37<01:54,  3.39it/s] 23%|██▎       | 113/500 [00:37<01:54,  3.39it/s] 23%|██▎       | 114/500 [00:38<01:53,  3.39it/s] 23%|██▎       | 115/500 [00:38<01:53,  3.39it/s] 23%|██▎       | 116/500 [00:38<01:53,  3.39it/s] 23%|██▎       | 117/500 [00:39<01:52,  3.39it/s] 24%|██▎       | 118/500 [00:39<01:52,  3.39it/s] 24%|██▍       | 119/500 [00:39<01:52,  3.39it/s] 24%|██▍       | 120/500 [00:39<01:52,  3.39it/s] 24%|██▍       | 121/500 [00:40<01:51,  3.39it/s] 24%|██▍       | 122/500 [00:40<01:52,  3.37it/s] 25%|██▍       | 123/500 [00:40<01:51,  3.37it/s] 25%|██▍       | 124/500 [00:41<01:51,  3.38it/s] 25%|██▌       | 125/500 [00:41<01:50,  3.38it/s] 25%|██▌       | 126/500 [00:41<01:50,  3.38it/s] 25%|██▌       | 127/500 [00:42<01:50,  3.39it/s] 26%|██▌       | 128/500 [00:42<01:49,  3.38it/s] 26%|██▌       | 129/500 [00:42<01:49,  3.38it/s] 26%|██▌       | 130/500 [00:42<01:49,  3.38it/s] 26%|██▌       | 131/500 [00:43<01:49,  3.38it/s] 26%|██▋       | 132/500 [00:43<01:48,  3.38it/s] 27%|██▋       | 133/500 [00:43<01:48,  3.38it/s] 27%|██▋       | 134/500 [00:44<01:48,  3.38it/s] 27%|██▋       | 135/500 [00:44<01:47,  3.38it/s] 27%|██▋       | 136/500 [00:44<01:47,  3.38it/s] 27%|██▋       | 137/500 [00:45<01:47,  3.38it/s] 28%|██▊       | 138/500 [00:45<01:47,  3.38it/s] 28%|██▊       | 139/500 [00:45<01:47,  3.37it/s] 28%|██▊       | 140/500 [00:45<01:46,  3.37it/s] 28%|██▊       | 141/500 [00:46<01:46,  3.38it/s] 28%|██▊       | 142/500 [00:46<01:46,  3.38it/s] 29%|██▊       | 143/500 [00:46<01:45,  3.38it/s] 29%|██▉       | 144/500 [00:47<01:45,  3.38it/s] 29%|██▉       | 145/500 [00:47<01:44,  3.38it/s] 29%|██▉       | 146/500 [00:47<01:44,  3.38it/s] 29%|██▉       | 147/500 [00:47<01:44,  3.38it/s] 30%|██▉       | 148/500 [00:48<01:44,  3.38it/s] 30%|██▉       | 149/500 [00:48<01:43,  3.38it/s] 30%|███       | 150/500 [00:48<01:43,  3.38it/s] 30%|███       | 151/500 [00:49<01:43,  3.38it/s] 30%|███       | 152/500 [00:49<01:43,  3.38it/s] 31%|███       | 153/500 [00:49<01:42,  3.38it/s] 31%|███       | 154/500 [00:50<01:42,  3.37it/s] 31%|███       | 155/500 [00:50<01:42,  3.37it/s] 31%|███       | 156/500 [00:50<01:41,  3.37it/s] 31%|███▏      | 157/500 [00:50<01:41,  3.37it/s] 32%|███▏      | 158/500 [00:51<01:41,  3.38it/s] 32%|███▏      | 159/500 [00:51<01:40,  3.38it/s] 32%|███▏      | 160/500 [00:51<01:40,  3.38it/s] 32%|███▏      | 161/500 [00:52<01:40,  3.38it/s] 32%|███▏      | 162/500 [00:52<01:40,  3.38it/s] 33%|███▎      | 163/500 [00:52<01:39,  3.38it/s] 33%|███▎      | 164/500 [00:53<01:39,  3.38it/s] 33%|███▎      | 165/500 [00:53<01:39,  3.38it/s] 33%|███▎      | 166/500 [00:53<01:38,  3.37it/s] 33%|███▎      | 167/500 [00:53<01:38,  3.38it/s] 34%|███▎      | 168/500 [00:54<01:38,  3.38it/s] 34%|███▍      | 169/500 [00:54<01:38,  3.37it/s] 34%|███▍      | 170/500 [00:54<01:37,  3.37it/s] 34%|███▍      | 171/500 [00:55<01:37,  3.38it/s] 34%|███▍      | 172/500 [00:55<01:37,  3.38it/s] 35%|███▍      | 173/500 [00:55<01:36,  3.38it/s] 35%|███▍      | 174/500 [00:55<01:36,  3.37it/s] 35%|███▌      | 175/500 [00:56<01:36,  3.37it/s] 35%|███▌      | 176/500 [00:56<01:36,  3.37it/s] 35%|███▌      | 177/500 [00:56<01:35,  3.36it/s] 36%|███▌      | 178/500 [00:57<01:35,  3.36it/s] 36%|███▌      | 179/500 [00:57<01:35,  3.36it/s] 36%|███▌      | 180/500 [00:57<01:35,  3.36it/s] 36%|███▌      | 181/500 [00:58<01:34,  3.36it/s] 36%|███▋      | 182/500 [00:58<01:34,  3.36it/s] 37%|███▋      | 183/500 [00:58<01:34,  3.36it/s] 37%|███▋      | 184/500 [00:58<01:34,  3.36it/s] 37%|███▋      | 185/500 [00:59<01:33,  3.35it/s] 37%|███▋      | 186/500 [00:59<01:33,  3.36it/s] 37%|███▋      | 187/500 [00:59<01:32,  3.37it/s] 38%|███▊      | 188/500 [01:00<01:32,  3.37it/s] 38%|███▊      | 189/500 [01:00<01:32,  3.37it/s] 38%|███▊      | 190/500 [01:00<01:31,  3.37it/s] 38%|███▊      | 191/500 [01:01<01:31,  3.37it/s] 38%|███▊      | 192/500 [01:01<01:31,  3.38it/s] 39%|███▊      | 193/500 [01:01<01:31,  3.37it/s] 39%|███▉      | 194/500 [01:01<01:30,  3.38it/s] 39%|███▉      | 195/500 [01:02<01:30,  3.37it/s] 39%|███▉      | 196/500 [01:02<01:30,  3.37it/s] 39%|███▉      | 197/500 [01:02<01:29,  3.37it/s] 40%|███▉      | 198/500 [01:03<01:29,  3.37it/s] 40%|███▉      | 199/500 [01:03<01:29,  3.37it/s] 40%|████      | 200/500 [01:03<01:29,  3.37it/s] 40%|████      | 201/500 [01:04<01:28,  3.37it/s] 40%|████      | 202/500 [01:04<01:28,  3.37it/s] 41%|████      | 203/500 [01:04<01:28,  3.37it/s] 41%|████      | 204/500 [01:04<01:27,  3.37it/s] 41%|████      | 205/500 [01:05<01:27,  3.37it/s] 41%|████      | 206/500 [01:05<01:27,  3.37it/s] 41%|████▏     | 207/500 [01:05<01:26,  3.37it/s] 42%|████▏     | 208/500 [01:06<01:26,  3.38it/s] 42%|████▏     | 209/500 [01:06<01:26,  3.37it/s] 42%|████▏     | 210/500 [01:06<01:25,  3.37it/s] 42%|████▏     | 211/500 [01:06<01:25,  3.38it/s] 42%|████▏     | 212/500 [01:07<01:25,  3.38it/s] 43%|████▎     | 213/500 [01:07<01:25,  3.37it/s] 43%|████▎     | 214/500 [01:07<01:24,  3.37it/s] 43%|████▎     | 215/500 [01:08<01:24,  3.38it/s] 43%|████▎     | 216/500 [01:08<01:24,  3.37it/s] 43%|████▎     | 217/500 [01:08<01:23,  3.37it/s] 44%|████▎     | 218/500 [01:09<01:23,  3.37it/s] 44%|████▍     | 219/500 [01:09<01:23,  3.37it/s] 44%|████▍     | 220/500 [01:09<01:23,  3.37it/s] 44%|████▍     | 221/500 [01:09<01:22,  3.37it/s] 44%|████▍     | 222/500 [01:10<01:22,  3.37it/s] 45%|████▍     | 223/500 [01:10<01:22,  3.37it/s] 45%|████▍     | 224/500 [01:10<01:21,  3.38it/s] 45%|████▌     | 225/500 [01:11<01:21,  3.38it/s] 45%|████▌     | 226/500 [01:11<01:21,  3.37it/s] 45%|████▌     | 227/500 [01:11<01:20,  3.37it/s] 46%|████▌     | 228/500 [01:12<01:20,  3.37it/s] 46%|████▌     | 229/500 [01:12<01:20,  3.37it/s] 46%|████▌     | 230/500 [01:12<01:20,  3.37it/s] 46%|████▌     | 231/500 [01:12<01:19,  3.37it/s] 46%|████▋     | 232/500 [01:13<01:19,  3.37it/s] 47%|████▋     | 233/500 [01:13<01:19,  3.37it/s] 47%|████▋     | 234/500 [01:13<01:18,  3.37it/s] 47%|████▋     | 235/500 [01:14<01:18,  3.38it/s] 47%|████▋     | 236/500 [01:14<01:18,  3.37it/s] 47%|████▋     | 237/500 [01:14<01:18,  3.37it/s] 48%|████▊     | 238/500 [01:14<01:17,  3.37it/s] 48%|████▊     | 239/500 [01:15<01:17,  3.37it/s] 48%|████▊     | 240/500 [01:15<01:17,  3.37it/s] 48%|████▊     | 241/500 [01:15<01:16,  3.37it/s] 48%|████▊     | 242/500 [01:16<01:16,  3.37it/s] 49%|████▊     | 243/500 [01:16<01:16,  3.36it/s] 49%|████▉     | 244/500 [01:16<01:16,  3.36it/s] 49%|████▉     | 245/500 [01:17<01:15,  3.36it/s] 49%|████▉     | 246/500 [01:17<01:15,  3.36it/s] 49%|████▉     | 247/500 [01:17<01:15,  3.36it/s] 50%|████▉     | 248/500 [01:17<01:14,  3.37it/s] 50%|████▉     | 249/500 [01:18<01:14,  3.37it/s] 50%|█████     | 250/500 [01:18<01:14,  3.36it/s] 50%|█████     | 251/500 [01:18<01:14,  3.36it/s] 50%|█████     | 252/500 [01:19<01:13,  3.37it/s] 51%|█████     | 253/500 [01:19<01:13,  3.37it/s] 51%|█████     | 254/500 [01:19<01:13,  3.37it/s] 51%|█████     | 255/500 [01:20<01:12,  3.37it/s] 51%|█████     | 256/500 [01:20<01:12,  3.37it/s] 51%|█████▏    | 257/500 [01:20<01:12,  3.37it/s] 52%|█████▏    | 258/500 [01:20<01:11,  3.37it/s] 52%|█████▏    | 259/500 [01:21<01:11,  3.37it/s] 52%|█████▏    | 260/500 [01:21<01:11,  3.36it/s] 52%|█████▏    | 261/500 [01:21<01:11,  3.36it/s] 52%|█████▏    | 262/500 [01:22<01:10,  3.36it/s] 53%|█████▎    | 263/500 [01:22<01:10,  3.36it/s] 53%|█████▎    | 264/500 [01:22<01:10,  3.36it/s] 53%|█████▎    | 265/500 [01:22<01:09,  3.36it/s] 53%|█████▎    | 266/500 [01:23<01:09,  3.37it/s] 53%|█████▎    | 267/500 [01:23<01:09,  3.36it/s] 54%|█████▎    | 268/500 [01:23<01:08,  3.36it/s] 54%|█████▍    | 269/500 [01:24<01:08,  3.36it/s] 54%|█████▍    | 270/500 [01:24<01:08,  3.36it/s] 54%|█████▍    | 271/500 [01:24<01:08,  3.37it/s] 54%|█████▍    | 272/500 [01:25<01:07,  3.37it/s] 55%|█████▍    | 273/500 [01:25<01:07,  3.37it/s] 55%|█████▍    | 274/500 [01:25<01:07,  3.37it/s] 55%|█████▌    | 275/500 [01:25<01:06,  3.37it/s] 55%|█████▌    | 276/500 [01:26<01:06,  3.36it/s] 55%|█████▌    | 277/500 [01:26<01:06,  3.36it/s] 56%|█████▌    | 278/500 [01:26<01:06,  3.36it/s] 56%|█████▌    | 279/500 [01:27<01:05,  3.36it/s] 56%|█████▌    | 280/500 [01:27<01:05,  3.36it/s] 56%|█████▌    | 281/500 [01:27<01:05,  3.36it/s] 56%|█████▋    | 282/500 [01:28<01:04,  3.36it/s] 57%|█████▋    | 283/500 [01:28<01:04,  3.36it/s] 57%|█████▋    | 284/500 [01:28<01:04,  3.36it/s] 57%|█████▋    | 285/500 [01:28<01:03,  3.36it/s] 57%|█████▋    | 286/500 [01:29<01:03,  3.36it/s] 57%|█████▋    | 287/500 [01:29<01:03,  3.35it/s] 58%|█████▊    | 288/500 [01:29<01:03,  3.35it/s] 58%|█████▊    | 289/500 [01:30<01:02,  3.36it/s] 58%|█████▊    | 290/500 [01:30<01:02,  3.36it/s] 58%|█████▊    | 291/500 [01:30<01:02,  3.37it/s] 58%|█████▊    | 292/500 [01:31<01:01,  3.37it/s] 59%|█████▊    | 293/500 [01:31<01:01,  3.36it/s] 59%|█████▉    | 294/500 [01:31<01:01,  3.36it/s] 59%|█████▉    | 295/500 [01:31<01:01,  3.36it/s] 59%|█████▉    | 296/500 [01:32<01:00,  3.36it/s] 59%|█████▉    | 297/500 [01:32<01:00,  3.36it/s] 60%|█████▉    | 298/500 [01:32<01:00,  3.36it/s] 60%|█████▉    | 299/500 [01:33<00:59,  3.37it/s] 60%|██████    | 300/500 [01:33<00:59,  3.37it/s] 60%|██████    | 301/500 [01:33<00:59,  3.37it/s] 60%|██████    | 302/500 [01:33<00:58,  3.37it/s] 61%|██████    | 303/500 [01:34<00:58,  3.36it/s] 61%|██████    | 304/500 [01:34<00:58,  3.36it/s] 61%|██████    | 305/500 [01:34<00:58,  3.36it/s] 61%|██████    | 306/500 [01:35<00:57,  3.36it/s] 61%|██████▏   | 307/500 [01:35<00:57,  3.36it/s] 62%|██████▏   | 308/500 [01:35<00:57,  3.36it/s] 62%|██████▏   | 309/500 [01:36<00:56,  3.36it/s] 62%|██████▏   | 310/500 [01:36<00:56,  3.36it/s] 62%|██████▏   | 311/500 [01:36<00:56,  3.36it/s] 62%|██████▏   | 312/500 [01:36<00:55,  3.36it/s] 63%|██████▎   | 313/500 [01:37<00:55,  3.36it/s] 63%|██████▎   | 314/500 [01:37<00:55,  3.36it/s] 63%|██████▎   | 315/500 [01:37<00:54,  3.36it/s] 63%|██████▎   | 316/500 [01:38<00:54,  3.37it/s] 63%|██████▎   | 317/500 [01:38<00:54,  3.36it/s] 64%|██████▎   | 318/500 [01:38<00:54,  3.36it/s] 64%|██████▍   | 319/500 [01:39<00:53,  3.36it/s] 64%|██████▍   | 320/500 [01:39<00:53,  3.36it/s] 64%|██████▍   | 321/500 [01:39<00:53,  3.36it/s] 64%|██████▍   | 322/500 [01:39<00:52,  3.36it/s] 65%|██████▍   | 323/500 [01:40<00:52,  3.36it/s] 65%|██████▍   | 324/500 [01:40<00:52,  3.36it/s] 65%|██████▌   | 325/500 [01:40<00:52,  3.36it/s] 65%|██████▌   | 326/500 [01:41<00:51,  3.36it/s] 65%|██████▌   | 327/500 [01:41<00:51,  3.36it/s] 66%|██████▌   | 328/500 [01:41<00:51,  3.36it/s] 66%|██████▌   | 329/500 [01:42<00:50,  3.36it/s] 66%|██████▌   | 330/500 [01:42<00:50,  3.37it/s] 66%|██████▌   | 331/500 [01:42<00:50,  3.37it/s] 66%|██████▋   | 332/500 [01:42<00:49,  3.37it/s] 67%|██████▋   | 333/500 [01:43<00:49,  3.37it/s] 67%|██████▋   | 334/500 [01:43<00:49,  3.37it/s] 67%|██████▋   | 335/500 [01:43<00:49,  3.37it/s] 67%|██████▋   | 336/500 [01:44<00:48,  3.37it/s] 67%|██████▋   | 337/500 [01:44<00:48,  3.37it/s] 68%|██████▊   | 338/500 [01:44<00:48,  3.37it/s] 68%|██████▊   | 339/500 [01:45<00:47,  3.36it/s] 68%|██████▊   | 340/500 [01:45<00:47,  3.36it/s] 68%|██████▊   | 341/500 [01:45<00:47,  3.36it/s] 68%|██████▊   | 342/500 [01:45<00:47,  3.36it/s] 69%|██████▊   | 343/500 [01:46<00:46,  3.36it/s] 69%|██████▉   | 344/500 [01:46<00:46,  3.37it/s] 69%|██████▉   | 345/500 [01:46<00:46,  3.37it/s] 69%|██████▉   | 346/500 [01:47<00:45,  3.37it/s] 69%|██████▉   | 347/500 [01:47<00:45,  3.37it/s] 70%|██████▉   | 348/500 [01:47<00:45,  3.36it/s] 70%|██████▉   | 349/500 [01:47<00:44,  3.36it/s] 70%|███████   | 350/500 [01:48<00:44,  3.36it/s] 70%|███████   | 351/500 [01:48<00:44,  3.35it/s] 70%|███████   | 352/500 [01:48<00:44,  3.36it/s] 71%|███████   | 353/500 [01:49<00:43,  3.36it/s] 71%|███████   | 354/500 [01:49<00:43,  3.36it/s] 71%|███████   | 355/500 [01:49<00:43,  3.36it/s] 71%|███████   | 356/500 [01:50<00:42,  3.36it/s] 71%|███████▏  | 357/500 [01:50<00:42,  3.36it/s] 72%|███████▏  | 358/500 [01:50<00:42,  3.36it/s] 72%|███████▏  | 359/500 [01:50<00:41,  3.36it/s] 72%|███████▏  | 360/500 [01:51<00:41,  3.36it/s] 72%|███████▏  | 361/500 [01:51<00:41,  3.36it/s] 72%|███████▏  | 362/500 [01:51<00:41,  3.36it/s] 73%|███████▎  | 363/500 [01:52<00:40,  3.37it/s] 73%|███████▎  | 364/500 [01:52<00:40,  3.36it/s] 73%|███████▎  | 365/500 [01:52<00:40,  3.37it/s] 73%|███████▎  | 366/500 [01:53<00:39,  3.37it/s] 73%|███████▎  | 367/500 [01:53<00:39,  3.36it/s] 74%|███████▎  | 368/500 [01:53<00:39,  3.36it/s] 74%|███████▍  | 369/500 [01:53<00:38,  3.37it/s] 74%|███████▍  | 370/500 [01:54<00:38,  3.37it/s] 74%|███████▍  | 371/500 [01:54<00:38,  3.36it/s] 74%|███████▍  | 372/500 [01:54<00:38,  3.36it/s] 75%|███████▍  | 373/500 [01:55<00:37,  3.36it/s] 75%|███████▍  | 374/500 [01:55<00:37,  3.36it/s] 75%|███████▌  | 375/500 [01:55<00:37,  3.36it/s] 75%|███████▌  | 376/500 [01:56<00:36,  3.36it/s] 75%|███████▌  | 377/500 [01:56<00:36,  3.36it/s] 76%|███████▌  | 378/500 [01:56<00:36,  3.36it/s] 76%|███████▌  | 379/500 [01:56<00:36,  3.36it/s] 76%|███████▌  | 380/500 [01:57<00:35,  3.36it/s] 76%|███████▌  | 381/500 [01:57<00:35,  3.36it/s] 76%|███████▋  | 382/500 [01:57<00:35,  3.36it/s] 77%|███████▋  | 383/500 [01:58<00:34,  3.36it/s] 77%|███████▋  | 384/500 [01:58<00:34,  3.36it/s] 77%|███████▋  | 385/500 [01:58<00:34,  3.36it/s] 77%|███████▋  | 386/500 [01:58<00:33,  3.36it/s] 77%|███████▋  | 387/500 [01:59<00:33,  3.36it/s] 78%|███████▊  | 388/500 [01:59<00:33,  3.36it/s] 78%|███████▊  | 389/500 [01:59<00:33,  3.36it/s] 78%|███████▊  | 390/500 [02:00<00:32,  3.36it/s] 78%|███████▊  | 391/500 [02:00<00:32,  3.36it/s] 78%|███████▊  | 392/500 [02:00<00:32,  3.36it/s] 79%|███████▊  | 393/500 [02:01<00:31,  3.36it/s] 79%|███████▉  | 394/500 [02:01<00:31,  3.36it/s] 79%|███████▉  | 395/500 [02:01<00:31,  3.36it/s] 79%|███████▉  | 396/500 [02:01<00:30,  3.36it/s] 79%|███████▉  | 397/500 [02:02<00:30,  3.37it/s] 80%|███████▉  | 398/500 [02:02<00:30,  3.37it/s] 80%|███████▉  | 399/500 [02:02<00:29,  3.37it/s] 80%|████████  | 400/500 [02:03<00:29,  3.37it/s] 80%|████████  | 401/500 [02:03<00:29,  3.37it/s] 80%|████████  | 402/500 [02:03<00:29,  3.37it/s] 81%|████████  | 403/500 [02:04<00:28,  3.37it/s] 81%|████████  | 404/500 [02:04<00:28,  3.37it/s] 81%|████████  | 405/500 [02:04<00:28,  3.37it/s] 81%|████████  | 406/500 [02:04<00:27,  3.37it/s] 81%|████████▏ | 407/500 [02:05<00:27,  3.37it/s] 82%|████████▏ | 408/500 [02:05<00:27,  3.37it/s] 82%|████████▏ | 409/500 [02:05<00:27,  3.37it/s] 82%|████████▏ | 410/500 [02:06<00:26,  3.36it/s] 82%|████████▏ | 411/500 [02:06<00:26,  3.37it/s] 82%|████████▏ | 412/500 [02:06<00:26,  3.36it/s] 83%|████████▎ | 413/500 [02:07<00:25,  3.37it/s] 83%|████████▎ | 414/500 [02:07<00:25,  3.37it/s] 83%|████████▎ | 415/500 [02:07<00:25,  3.37it/s] 83%|████████▎ | 416/500 [02:07<00:24,  3.36it/s] 83%|████████▎ | 417/500 [02:08<00:24,  3.36it/s] 84%|████████▎ | 418/500 [02:08<00:24,  3.37it/s] 84%|████████▍ | 419/500 [02:08<00:24,  3.37it/s] 84%|████████▍ | 420/500 [02:09<00:23,  3.37it/s] 84%|████████▍ | 421/500 [02:09<00:23,  3.37it/s] 84%|████████▍ | 422/500 [02:09<00:23,  3.37it/s] 85%|████████▍ | 423/500 [02:09<00:22,  3.37it/s] 85%|████████▍ | 424/500 [02:10<00:22,  3.37it/s] 85%|████████▌ | 425/500 [02:10<00:22,  3.37it/s] 85%|████████▌ | 426/500 [02:10<00:22,  3.36it/s] 85%|████████▌ | 427/500 [02:11<00:21,  3.36it/s] 86%|████████▌ | 428/500 [02:11<00:21,  3.36it/s] 86%|████████▌ | 429/500 [02:11<00:21,  3.37it/s] 86%|████████▌ | 430/500 [02:12<00:20,  3.37it/s] 86%|████████▌ | 431/500 [02:12<00:20,  3.37it/s] 86%|████████▋ | 432/500 [02:12<00:20,  3.37it/s] 87%|████████▋ | 433/500 [02:12<00:19,  3.37it/s] 87%|████████▋ | 434/500 [02:13<00:19,  3.37it/s] 87%|████████▋ | 435/500 [02:13<00:19,  3.37it/s] 87%|████████▋ | 436/500 [02:13<00:18,  3.37it/s] 87%|████████▋ | 437/500 [02:14<00:18,  3.37it/s] 88%|████████▊ | 438/500 [02:14<00:18,  3.36it/s] 88%|████████▊ | 439/500 [02:14<00:18,  3.36it/s] 88%|████████▊ | 440/500 [02:15<00:17,  3.36it/s] 88%|████████▊ | 441/500 [02:15<00:17,  3.37it/s] 88%|████████▊ | 442/500 [02:15<00:17,  3.36it/s] 89%|████████▊ | 443/500 [02:15<00:16,  3.36it/s] 89%|████████▉ | 444/500 [02:16<00:16,  3.36it/s] 89%|████████▉ | 445/500 [02:16<00:16,  3.37it/s] 89%|████████▉ | 446/500 [02:16<00:16,  3.37it/s] 89%|████████▉ | 447/500 [02:17<00:15,  3.36it/s] 90%|████████▉ | 448/500 [02:17<00:15,  3.36it/s] 90%|████████▉ | 449/500 [02:17<00:15,  3.36it/s] 90%|█████████ | 450/500 [02:18<00:14,  3.36it/s] 90%|█████████ | 451/500 [02:18<00:14,  3.36it/s] 90%|█████████ | 452/500 [02:18<00:14,  3.35it/s] 91%|█████████ | 453/500 [02:18<00:14,  3.35it/s] 91%|█████████ | 454/500 [02:19<00:13,  3.36it/s] 91%|█████████ | 455/500 [02:19<00:13,  3.36it/s] 91%|█████████ | 456/500 [02:19<00:13,  3.36it/s] 91%|█████████▏| 457/500 [02:20<00:12,  3.36it/s] 92%|█████████▏| 458/500 [02:20<00:12,  3.36it/s] 92%|█████████▏| 459/500 [02:20<00:12,  3.36it/s] 92%|█████████▏| 460/500 [02:20<00:11,  3.36it/s] 92%|█████████▏| 461/500 [02:21<00:11,  3.36it/s] 92%|█████████▏| 462/500 [02:21<00:11,  3.36it/s] 93%|█████████▎| 463/500 [02:21<00:11,  3.36it/s] 93%|█████████▎| 464/500 [02:22<00:10,  3.36it/s] 93%|█████████▎| 465/500 [02:22<00:10,  3.36it/s] 93%|█████████▎| 466/500 [02:22<00:10,  3.36it/s] 93%|█████████▎| 467/500 [02:23<00:09,  3.36it/s] 94%|█████████▎| 468/500 [02:23<00:09,  3.36it/s] 94%|█████████▍| 469/500 [02:23<00:09,  3.36it/s] 94%|█████████▍| 470/500 [02:23<00:08,  3.36it/s] 94%|█████████▍| 471/500 [02:24<00:08,  3.36it/s] 94%|█████████▍| 472/500 [02:24<00:08,  3.36it/s] 95%|█████████▍| 473/500 [02:24<00:08,  3.36it/s] 95%|█████████▍| 474/500 [02:25<00:07,  3.37it/s] 95%|█████████▌| 475/500 [02:25<00:07,  3.37it/s] 95%|█████████▌| 476/500 [02:25<00:07,  3.37it/s] 95%|█████████▌| 477/500 [02:26<00:06,  3.36it/s] 96%|█████████▌| 478/500 [02:26<00:06,  3.36it/s] 96%|█████████▌| 479/500 [02:26<00:06,  3.35it/s] 96%|█████████▌| 480/500 [02:26<00:05,  3.35it/s] 96%|█████████▌| 481/500 [02:27<00:05,  3.36it/s] 96%|█████████▋| 482/500 [02:27<00:05,  3.36it/s] 97%|█████████▋| 483/500 [02:27<00:05,  3.36it/s] 97%|█████████▋| 484/500 [02:28<00:04,  3.36it/s] 97%|█████████▋| 485/500 [02:28<00:04,  3.36it/s] 97%|█████████▋| 486/500 [02:28<00:04,  3.36it/s] 97%|█████████▋| 487/500 [02:29<00:03,  3.36it/s] 98%|█████████▊| 488/500 [02:29<00:03,  3.37it/s] 98%|█████████▊| 489/500 [02:29<00:03,  3.37it/s] 98%|█████████▊| 490/500 [02:29<00:02,  3.37it/s] 98%|█████████▊| 491/500 [02:30<00:02,  3.37it/s] 98%|█████████▊| 492/500 [02:30<00:02,  3.37it/s] 99%|█████████▊| 493/500 [02:30<00:02,  3.38it/s] 99%|█████████▉| 494/500 [02:31<00:01,  3.38it/s] 99%|█████████▉| 495/500 [02:31<00:01,  3.38it/s] 99%|█████████▉| 496/500 [02:31<00:01,  3.38it/s] 99%|█████████▉| 497/500 [02:31<00:00,  3.38it/s]100%|█████████▉| 498/500 [02:32<00:00,  3.38it/s]100%|█████████▉| 499/500 [02:32<00:00,  3.38it/s]100%|██████████| 500/500 [02:32<00:00,  3.38it/s]100%|██████████| 500/500 [02:32<00:00,  3.27it/s]
=> result
* total: 50,000
* correct: 35,874
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 71.1%
Elapsed: 0:02:33

for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet  
do
    for seed in 3
    do
        # evaluation
        sh scripts/coop/crossdataset_test.sh imagenet ${dataset} ${seed} ${GPU} ${cfg} ${SHOT} ${EPOCH} ${TRAINER}
    done
done
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet eurosat 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/eurosat/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/eurosat/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_3.pkl
160 5400 8100
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  10
# train_x  160
# val      5,400
# test     8,100
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/81 [00:00<?, ?it/s]  1%|          | 1/81 [00:03<04:22,  3.28s/it]  2%|▏         | 2/81 [00:03<01:51,  1.41s/it]  4%|▎         | 3/81 [00:03<01:03,  1.23it/s]  5%|▍         | 4/81 [00:03<00:41,  1.87it/s]  6%|▌         | 5/81 [00:03<00:28,  2.63it/s]  7%|▋         | 6/81 [00:03<00:21,  3.49it/s]  9%|▊         | 7/81 [00:03<00:16,  4.40it/s] 10%|▉         | 8/81 [00:04<00:13,  5.30it/s] 11%|█         | 9/81 [00:04<00:11,  6.15it/s] 12%|█▏        | 10/81 [00:04<00:10,  6.91it/s] 14%|█▎        | 11/81 [00:04<00:09,  7.54it/s] 15%|█▍        | 12/81 [00:04<00:08,  8.06it/s] 16%|█▌        | 13/81 [00:04<00:08,  8.46it/s] 17%|█▋        | 14/81 [00:04<00:07,  8.72it/s] 19%|█▊        | 15/81 [00:04<00:07,  8.92it/s] 20%|█▉        | 16/81 [00:04<00:07,  9.10it/s] 21%|██        | 17/81 [00:04<00:06,  9.22it/s] 22%|██▏       | 18/81 [00:05<00:06,  9.31it/s] 23%|██▎       | 19/81 [00:05<00:06,  9.37it/s] 25%|██▍       | 20/81 [00:05<00:06,  9.43it/s] 26%|██▌       | 21/81 [00:05<00:06,  9.44it/s] 27%|██▋       | 22/81 [00:05<00:06,  9.46it/s] 28%|██▊       | 23/81 [00:05<00:06,  9.48it/s] 30%|██▉       | 24/81 [00:05<00:05,  9.50it/s] 31%|███       | 25/81 [00:05<00:05,  9.47it/s] 32%|███▏      | 26/81 [00:05<00:05,  9.46it/s] 33%|███▎      | 27/81 [00:06<00:05,  9.48it/s] 35%|███▍      | 28/81 [00:06<00:05,  9.37it/s] 36%|███▌      | 29/81 [00:06<00:05,  9.37it/s] 37%|███▋      | 30/81 [00:06<00:05,  9.37it/s] 38%|███▊      | 31/81 [00:06<00:05,  9.39it/s] 40%|███▉      | 32/81 [00:06<00:05,  9.42it/s] 41%|████      | 33/81 [00:06<00:05,  9.43it/s] 42%|████▏     | 34/81 [00:06<00:04,  9.47it/s] 43%|████▎     | 35/81 [00:06<00:04,  9.43it/s] 44%|████▍     | 36/81 [00:06<00:04,  9.46it/s] 46%|████▌     | 37/81 [00:07<00:04,  9.49it/s] 47%|████▋     | 38/81 [00:07<00:04,  9.50it/s] 48%|████▊     | 39/81 [00:07<00:04,  9.47it/s] 49%|████▉     | 40/81 [00:07<00:04,  9.48it/s] 51%|█████     | 41/81 [00:07<00:04,  9.47it/s] 52%|█████▏    | 42/81 [00:07<00:04,  9.46it/s] 53%|█████▎    | 43/81 [00:07<00:04,  9.47it/s] 54%|█████▍    | 44/81 [00:07<00:03,  9.46it/s] 56%|█████▌    | 45/81 [00:07<00:03,  9.48it/s] 57%|█████▋    | 46/81 [00:08<00:03,  9.44it/s] 58%|█████▊    | 47/81 [00:08<00:03,  9.46it/s] 59%|█████▉    | 48/81 [00:08<00:03,  9.45it/s] 60%|██████    | 49/81 [00:08<00:03,  9.46it/s] 62%|██████▏   | 50/81 [00:08<00:03,  9.46it/s] 63%|██████▎   | 51/81 [00:08<00:03,  9.49it/s] 64%|██████▍   | 52/81 [00:08<00:03,  9.50it/s] 65%|██████▌   | 53/81 [00:08<00:02,  9.51it/s] 67%|██████▋   | 54/81 [00:08<00:02,  9.50it/s] 68%|██████▊   | 55/81 [00:08<00:02,  9.45it/s] 69%|██████▉   | 56/81 [00:09<00:02,  9.45it/s] 70%|███████   | 57/81 [00:09<00:02,  9.42it/s] 72%|███████▏  | 58/81 [00:09<00:02,  9.44it/s] 73%|███████▎  | 59/81 [00:09<00:02,  9.47it/s] 74%|███████▍  | 60/81 [00:09<00:02,  9.48it/s] 75%|███████▌  | 61/81 [00:09<00:02,  9.50it/s] 77%|███████▋  | 62/81 [00:09<00:01,  9.50it/s] 78%|███████▊  | 63/81 [00:09<00:01,  9.51it/s] 79%|███████▉  | 64/81 [00:09<00:01,  9.51it/s] 80%|████████  | 65/81 [00:10<00:01,  9.51it/s] 81%|████████▏ | 66/81 [00:10<00:01,  9.53it/s] 83%|████████▎ | 67/81 [00:10<00:01,  9.52it/s] 84%|████████▍ | 68/81 [00:10<00:01,  9.55it/s] 85%|████████▌ | 69/81 [00:10<00:01,  9.57it/s] 86%|████████▋ | 70/81 [00:10<00:01,  9.59it/s] 88%|████████▊ | 71/81 [00:10<00:01,  9.61it/s] 89%|████████▉ | 72/81 [00:10<00:00,  9.62it/s] 90%|█████████ | 73/81 [00:10<00:00,  9.63it/s] 91%|█████████▏| 74/81 [00:10<00:00,  9.64it/s] 93%|█████████▎| 75/81 [00:11<00:00,  9.63it/s] 94%|█████████▍| 76/81 [00:11<00:00,  9.50it/s] 95%|█████████▌| 77/81 [00:11<00:00,  9.54it/s] 96%|█████████▋| 78/81 [00:11<00:00,  9.57it/s] 98%|█████████▊| 79/81 [00:11<00:00,  9.59it/s] 99%|█████████▉| 80/81 [00:11<00:00,  9.61it/s]100%|██████████| 81/81 [00:11<00:00,  9.62it/s]100%|██████████| 81/81 [00:11<00:00,  6.88it/s]
=> result
* total: 8,100
* correct: 3,489
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 38.6%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet dtd 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/dtd/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/dtd/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_3.pkl
752 1128 1692
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      1,128
# test     1,692
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:03<00:59,  3.71s/it] 12%|█▏        | 2/17 [00:03<00:23,  1.59s/it] 18%|█▊        | 3/17 [00:03<00:12,  1.09it/s] 24%|██▎       | 4/17 [00:04<00:07,  1.68it/s] 29%|██▉       | 5/17 [00:04<00:05,  2.38it/s] 35%|███▌      | 6/17 [00:04<00:03,  3.18it/s] 41%|████      | 7/17 [00:04<00:02,  4.05it/s] 47%|████▋     | 8/17 [00:04<00:01,  4.93it/s] 53%|█████▎    | 9/17 [00:04<00:01,  5.77it/s] 59%|█████▉    | 10/17 [00:04<00:01,  6.52it/s] 65%|██████▍   | 11/17 [00:04<00:00,  7.14it/s] 71%|███████   | 12/17 [00:04<00:00,  7.66it/s] 76%|███████▋  | 13/17 [00:05<00:00,  8.07it/s] 82%|████████▏ | 14/17 [00:05<00:00,  8.38it/s] 88%|████████▊ | 15/17 [00:05<00:00,  8.61it/s] 94%|█████████▍| 16/17 [00:05<00:00,  8.78it/s]100%|██████████| 17/17 [00:05<00:00,  9.08it/s]100%|██████████| 17/17 [00:05<00:00,  3.08it/s]
=> result
* total: 1,692
* correct: 689
* accuracy: 40.7%
* error: 59.3%
* macro_f1: 35.5%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet fgvc_aircraft 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/fgvc_aircraft/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/fgvc_aircraft/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_3.pkl
1600 3333 3333
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  100
# train_x  1,600
# val      3,333
# test     3,333
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:05<02:52,  5.22s/it]  6%|▌         | 2/34 [00:05<01:11,  2.22s/it]  9%|▉         | 3/34 [00:05<00:39,  1.26s/it] 12%|█▏        | 4/34 [00:05<00:24,  1.23it/s] 15%|█▍        | 5/34 [00:05<00:16,  1.78it/s] 18%|█▊        | 6/34 [00:05<00:11,  2.43it/s] 21%|██        | 7/34 [00:05<00:08,  3.16it/s] 24%|██▎       | 8/34 [00:06<00:06,  3.94it/s] 26%|██▋       | 9/34 [00:06<00:09,  2.76it/s] 29%|██▉       | 10/34 [00:06<00:06,  3.48it/s] 32%|███▏      | 11/34 [00:06<00:05,  4.23it/s] 35%|███▌      | 12/34 [00:07<00:04,  4.97it/s] 38%|███▊      | 13/34 [00:07<00:03,  5.66it/s] 41%|████      | 14/34 [00:07<00:03,  6.27it/s] 44%|████▍     | 15/34 [00:07<00:02,  6.77it/s] 47%|████▋     | 16/34 [00:07<00:02,  7.18it/s] 50%|█████     | 17/34 [00:09<00:09,  1.71it/s] 53%|█████▎    | 18/34 [00:09<00:07,  2.24it/s] 56%|█████▌    | 19/34 [00:09<00:05,  2.85it/s] 59%|█████▉    | 20/34 [00:09<00:03,  3.55it/s] 62%|██████▏   | 21/34 [00:09<00:03,  4.29it/s] 65%|██████▍   | 22/34 [00:09<00:02,  5.02it/s] 68%|██████▊   | 23/34 [00:09<00:01,  5.69it/s] 71%|███████   | 24/34 [00:09<00:01,  6.29it/s] 74%|███████▎  | 25/34 [00:11<00:05,  1.51it/s] 76%|███████▋  | 26/34 [00:11<00:04,  2.00it/s] 79%|███████▉  | 27/34 [00:12<00:02,  2.59it/s] 82%|████████▏ | 28/34 [00:12<00:01,  3.27it/s] 85%|████████▌ | 29/34 [00:12<00:01,  4.00it/s] 88%|████████▊ | 30/34 [00:12<00:00,  4.75it/s] 91%|█████████ | 31/34 [00:12<00:00,  5.46it/s] 94%|█████████▍| 32/34 [00:12<00:00,  6.10it/s] 97%|█████████▋| 33/34 [00:14<00:00,  1.92it/s]100%|██████████| 34/34 [00:14<00:00,  2.40it/s]
=> result
* total: 3,333
* correct: 628
* accuracy: 18.8%
* error: 81.2%
* macro_f1: 14.9%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet oxford_flowers 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/oxford_flowers/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordFlowers
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/oxford_flowers/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:OxfordFlowers
Loading dataset: OxfordFlowers
Reading split from /shared/s2/lab01/dataset/clip/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_flowers/split_fewshot_taesup/shot_16-seed_3.pkl
1632 1633 2463
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      1,633
# test     2,463
---------  -------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:04<01:45,  4.38s/it]  8%|▊         | 2/25 [00:04<00:43,  1.87s/it] 12%|█▏        | 3/25 [00:04<00:23,  1.07s/it] 16%|█▌        | 4/25 [00:04<00:14,  1.44it/s] 20%|██        | 5/25 [00:04<00:09,  2.05it/s] 24%|██▍       | 6/25 [00:04<00:06,  2.76it/s] 28%|██▊       | 7/25 [00:05<00:05,  3.53it/s] 32%|███▏      | 8/25 [00:05<00:03,  4.32it/s] 36%|███▌      | 9/25 [00:05<00:03,  5.08it/s] 40%|████      | 10/25 [00:05<00:02,  5.78it/s] 44%|████▍     | 11/25 [00:05<00:02,  6.36it/s] 48%|████▊     | 12/25 [00:05<00:01,  6.85it/s] 52%|█████▏    | 13/25 [00:05<00:01,  7.24it/s] 56%|█████▌    | 14/25 [00:05<00:01,  7.53it/s] 60%|██████    | 15/25 [00:06<00:01,  7.77it/s] 64%|██████▍   | 16/25 [00:06<00:01,  7.93it/s] 68%|██████▊   | 17/25 [00:06<00:00,  8.05it/s] 72%|███████▏  | 18/25 [00:06<00:00,  8.14it/s] 76%|███████▌  | 19/25 [00:06<00:00,  8.22it/s] 80%|████████  | 20/25 [00:06<00:00,  8.26it/s] 84%|████████▍ | 21/25 [00:06<00:00,  8.30it/s] 88%|████████▊ | 22/25 [00:06<00:00,  8.33it/s] 92%|█████████▏| 23/25 [00:07<00:00,  8.35it/s] 96%|█████████▌| 24/25 [00:07<00:00,  8.35it/s]100%|██████████| 25/25 [00:07<00:00,  3.42it/s]
=> result
* total: 2,463
* correct: 1,661
* accuracy: 67.4%
* error: 32.6%
* macro_f1: 60.7%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet stanford_cars 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/stanford_cars.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/stanford_cars/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: StanfordCars
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/stanford_cars/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:StanfordCars
Loading dataset: StanfordCars
Reading split from /shared/s2/lab01/dataset/clip/stanford_cars/split_zhou_StanfordCars.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/stanford_cars/split_fewshot_taesup/shot_16-seed_3.pkl
3136 1635 8041
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    StanfordCars
# classes  196
# train_x  3,136
# val      1,635
# test     8,041
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/81 [00:00<?, ?it/s]  1%|          | 1/81 [00:04<05:43,  4.30s/it]  2%|▏         | 2/81 [00:04<02:26,  1.85s/it]  4%|▎         | 3/81 [00:04<01:23,  1.07s/it]  5%|▍         | 4/81 [00:04<00:53,  1.43it/s]  6%|▌         | 5/81 [00:04<00:37,  2.01it/s]  7%|▋         | 6/81 [00:04<00:28,  2.66it/s]  9%|▊         | 7/81 [00:05<00:22,  3.36it/s] 10%|▉         | 8/81 [00:05<00:18,  4.05it/s] 11%|█         | 9/81 [00:05<00:15,  4.70it/s] 12%|█▏        | 10/81 [00:05<00:13,  5.27it/s] 14%|█▎        | 11/81 [00:05<00:12,  5.74it/s] 15%|█▍        | 12/81 [00:05<00:11,  6.13it/s] 16%|█▌        | 13/81 [00:05<00:10,  6.43it/s] 17%|█▋        | 14/81 [00:06<00:10,  6.65it/s] 19%|█▊        | 15/81 [00:06<00:09,  6.77it/s] 20%|█▉        | 16/81 [00:06<00:09,  6.90it/s] 21%|██        | 17/81 [00:06<00:09,  7.00it/s] 22%|██▏       | 18/81 [00:06<00:08,  7.08it/s] 23%|██▎       | 19/81 [00:06<00:08,  7.12it/s] 25%|██▍       | 20/81 [00:06<00:08,  7.15it/s] 26%|██▌       | 21/81 [00:07<00:08,  7.18it/s] 27%|██▋       | 22/81 [00:07<00:08,  7.19it/s] 28%|██▊       | 23/81 [00:07<00:08,  7.20it/s] 30%|██▉       | 24/81 [00:07<00:07,  7.21it/s] 31%|███       | 25/81 [00:07<00:07,  7.21it/s] 32%|███▏      | 26/81 [00:07<00:07,  7.20it/s] 33%|███▎      | 27/81 [00:07<00:07,  7.20it/s] 35%|███▍      | 28/81 [00:08<00:07,  7.20it/s] 36%|███▌      | 29/81 [00:08<00:07,  7.21it/s] 37%|███▋      | 30/81 [00:08<00:07,  7.22it/s] 38%|███▊      | 31/81 [00:08<00:06,  7.22it/s] 40%|███▉      | 32/81 [00:08<00:06,  7.23it/s] 41%|████      | 33/81 [00:09<00:15,  3.11it/s] 42%|████▏     | 34/81 [00:09<00:12,  3.75it/s] 43%|████▎     | 35/81 [00:09<00:10,  4.38it/s] 44%|████▍     | 36/81 [00:09<00:09,  4.97it/s] 46%|████▌     | 37/81 [00:09<00:08,  5.49it/s] 47%|████▋     | 38/81 [00:10<00:07,  5.91it/s] 48%|████▊     | 39/81 [00:10<00:06,  6.25it/s] 49%|████▉     | 40/81 [00:10<00:06,  6.51it/s] 51%|█████     | 41/81 [00:11<00:18,  2.14it/s] 52%|█████▏    | 42/81 [00:11<00:14,  2.71it/s] 53%|█████▎    | 43/81 [00:11<00:11,  3.33it/s] 54%|█████▍    | 44/81 [00:11<00:09,  3.98it/s] 56%|█████▌    | 45/81 [00:12<00:07,  4.59it/s] 57%|█████▋    | 46/81 [00:12<00:06,  5.15it/s] 58%|█████▊    | 47/81 [00:12<00:06,  5.63it/s] 59%|█████▉    | 48/81 [00:12<00:06,  5.14it/s] 60%|██████    | 49/81 [00:13<00:10,  3.19it/s] 62%|██████▏   | 50/81 [00:13<00:08,  3.83it/s] 63%|██████▎   | 51/81 [00:13<00:06,  4.43it/s] 64%|██████▍   | 52/81 [00:13<00:05,  5.01it/s] 65%|██████▌   | 53/81 [00:13<00:05,  5.51it/s] 67%|██████▋   | 54/81 [00:13<00:04,  5.94it/s] 68%|██████▊   | 55/81 [00:13<00:04,  6.27it/s] 69%|██████▉   | 56/81 [00:14<00:03,  6.52it/s] 70%|███████   | 57/81 [00:14<00:06,  3.76it/s] 72%|███████▏  | 58/81 [00:14<00:05,  4.38it/s] 73%|███████▎  | 59/81 [00:14<00:04,  4.97it/s] 74%|███████▍  | 60/81 [00:15<00:03,  5.48it/s] 75%|███████▌  | 61/81 [00:15<00:03,  5.90it/s] 77%|███████▋  | 62/81 [00:15<00:03,  6.23it/s] 78%|███████▊  | 63/81 [00:15<00:02,  6.49it/s] 79%|███████▉  | 64/81 [00:15<00:02,  6.69it/s] 80%|████████  | 65/81 [00:16<00:04,  3.25it/s] 81%|████████▏ | 66/81 [00:16<00:03,  3.89it/s] 83%|████████▎ | 67/81 [00:16<00:03,  4.51it/s] 84%|████████▍ | 68/81 [00:16<00:02,  5.07it/s] 85%|████████▌ | 69/81 [00:16<00:02,  5.56it/s] 86%|████████▋ | 70/81 [00:17<00:01,  5.97it/s] 88%|████████▊ | 71/81 [00:17<00:01,  6.30it/s] 89%|████████▉ | 72/81 [00:17<00:01,  6.54it/s] 90%|█████████ | 73/81 [00:17<00:01,  6.73it/s] 91%|█████████▏| 74/81 [00:17<00:01,  6.88it/s] 93%|█████████▎| 75/81 [00:17<00:00,  6.98it/s] 94%|█████████▍| 76/81 [00:17<00:00,  7.05it/s] 95%|█████████▌| 77/81 [00:17<00:00,  7.11it/s] 96%|█████████▋| 78/81 [00:18<00:00,  7.15it/s] 98%|█████████▊| 79/81 [00:18<00:00,  7.19it/s] 99%|█████████▉| 80/81 [00:18<00:00,  7.16it/s]100%|██████████| 81/81 [00:18<00:00,  4.36it/s]
=> result
* total: 8,041
* correct: 5,136
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 61.8%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet oxford_pets 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/oxford_pets.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/oxford_pets/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordPets
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/oxford_pets/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:OxfordPets
Loading dataset: OxfordPets
Reading split from /shared/s2/lab01/dataset/clip/oxford_pets/split_zhou_OxfordPets.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_pets/split_fewshot_taesup/shot_16-seed_3.pkl
592 736 3669
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------
Dataset    OxfordPets
# classes  37
# train_x  592
# val      736
# test     3,669
---------  ----------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/37 [00:00<?, ?it/s]  3%|▎         | 1/37 [00:04<02:24,  4.01s/it]  5%|▌         | 2/37 [00:04<01:00,  1.72s/it]  8%|▊         | 3/37 [00:04<00:33,  1.02it/s] 11%|█         | 4/37 [00:04<00:20,  1.57it/s] 14%|█▎        | 5/37 [00:04<00:14,  2.24it/s] 16%|█▌        | 6/37 [00:04<00:10,  3.02it/s] 19%|█▉        | 7/37 [00:04<00:07,  3.87it/s] 22%|██▏       | 8/37 [00:04<00:06,  4.75it/s] 24%|██▍       | 9/37 [00:04<00:05,  5.59it/s] 27%|██▋       | 10/37 [00:04<00:04,  6.37it/s] 30%|██▉       | 11/37 [00:05<00:03,  7.02it/s] 32%|███▏      | 12/37 [00:05<00:03,  7.56it/s] 35%|███▌      | 13/37 [00:05<00:03,  7.98it/s] 38%|███▊      | 14/37 [00:05<00:02,  8.34it/s] 41%|████      | 15/37 [00:05<00:02,  8.60it/s] 43%|████▎     | 16/37 [00:05<00:02,  8.78it/s] 46%|████▌     | 17/37 [00:05<00:02,  8.91it/s] 49%|████▊     | 18/37 [00:05<00:02,  9.00it/s] 51%|█████▏    | 19/37 [00:05<00:01,  9.08it/s] 54%|█████▍    | 20/37 [00:06<00:01,  9.12it/s] 57%|█████▋    | 21/37 [00:06<00:01,  9.13it/s] 59%|█████▉    | 22/37 [00:06<00:01,  9.15it/s] 62%|██████▏   | 23/37 [00:06<00:01,  9.16it/s] 65%|██████▍   | 24/37 [00:06<00:01,  9.17it/s] 68%|██████▊   | 25/37 [00:06<00:01,  9.17it/s] 70%|███████   | 26/37 [00:06<00:01,  9.15it/s] 73%|███████▎  | 27/37 [00:06<00:01,  9.18it/s] 76%|███████▌  | 28/37 [00:06<00:00,  9.22it/s] 78%|███████▊  | 29/37 [00:07<00:00,  9.23it/s] 81%|████████  | 30/37 [00:07<00:00,  9.24it/s] 84%|████████▍ | 31/37 [00:07<00:00,  9.27it/s] 86%|████████▋ | 32/37 [00:07<00:00,  9.30it/s] 89%|████████▉ | 33/37 [00:07<00:00,  9.32it/s] 92%|█████████▏| 34/37 [00:07<00:00,  9.33it/s] 95%|█████████▍| 35/37 [00:07<00:00,  9.34it/s] 97%|█████████▋| 36/37 [00:07<00:00,  9.34it/s]100%|██████████| 37/37 [00:07<00:00,  4.65it/s]
=> result
* total: 3,669
* correct: 3,275
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 87.8%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet food101 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/food101.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/food101/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: Food101
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/food101/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:Food101
Loading dataset: Food101
Reading split from /shared/s2/lab01/dataset/clip/food-101/split_zhou_Food101.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/food-101/split_fewshot_taesup/shot_16-seed_3.pkl
1616 20200 30300
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    Food101
# classes  101
# train_x  1,616
# val      20,200
# test     30,300
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/303 [00:00<?, ?it/s]  0%|          | 1/303 [00:03<18:27,  3.67s/it]  1%|          | 2/303 [00:03<07:56,  1.58s/it]  1%|          | 3/303 [00:03<04:34,  1.09it/s]  1%|▏         | 4/303 [00:04<02:59,  1.67it/s]  2%|▏         | 5/303 [00:04<02:07,  2.34it/s]  2%|▏         | 6/303 [00:04<01:35,  3.11it/s]  2%|▏         | 7/303 [00:04<01:15,  3.91it/s]  3%|▎         | 8/303 [00:04<01:02,  4.71it/s]  3%|▎         | 9/303 [00:04<00:53,  5.46it/s]  3%|▎         | 10/303 [00:04<00:47,  6.11it/s]  4%|▎         | 11/303 [00:04<00:43,  6.66it/s]  4%|▍         | 12/303 [00:04<00:41,  7.09it/s]  4%|▍         | 13/303 [00:05<00:39,  7.37it/s]  5%|▍         | 14/303 [00:05<00:37,  7.65it/s]  5%|▍         | 15/303 [00:05<00:36,  7.86it/s]  5%|▌         | 16/303 [00:05<00:35,  7.99it/s]  6%|▌         | 17/303 [00:05<00:35,  8.09it/s]  6%|▌         | 18/303 [00:05<00:34,  8.17it/s]  6%|▋         | 19/303 [00:05<00:34,  8.23it/s]  7%|▋         | 20/303 [00:05<00:34,  8.27it/s]  7%|▋         | 21/303 [00:06<00:33,  8.30it/s]  7%|▋         | 22/303 [00:06<00:33,  8.31it/s]  8%|▊         | 23/303 [00:06<00:33,  8.31it/s]  8%|▊         | 24/303 [00:06<00:33,  8.33it/s]  8%|▊         | 25/303 [00:06<00:33,  8.33it/s]  9%|▊         | 26/303 [00:06<00:33,  8.34it/s]  9%|▉         | 27/303 [00:06<00:33,  8.33it/s]  9%|▉         | 28/303 [00:06<00:33,  8.33it/s] 10%|▉         | 29/303 [00:07<00:32,  8.31it/s] 10%|▉         | 30/303 [00:07<00:32,  8.31it/s] 10%|█         | 31/303 [00:07<00:32,  8.32it/s] 11%|█         | 32/303 [00:07<00:32,  8.31it/s] 11%|█         | 33/303 [00:07<00:32,  8.24it/s] 11%|█         | 34/303 [00:07<00:32,  8.26it/s] 12%|█▏        | 35/303 [00:07<00:32,  8.28it/s] 12%|█▏        | 36/303 [00:07<00:32,  8.28it/s] 12%|█▏        | 37/303 [00:07<00:32,  8.26it/s] 13%|█▎        | 38/303 [00:08<00:32,  8.26it/s] 13%|█▎        | 39/303 [00:08<00:31,  8.26it/s] 13%|█▎        | 40/303 [00:08<00:31,  8.28it/s] 14%|█▎        | 41/303 [00:08<00:31,  8.28it/s] 14%|█▍        | 42/303 [00:08<00:31,  8.29it/s] 14%|█▍        | 43/303 [00:08<00:31,  8.30it/s] 15%|█▍        | 44/303 [00:08<00:31,  8.31it/s] 15%|█▍        | 45/303 [00:08<00:30,  8.33it/s] 15%|█▌        | 46/303 [00:09<00:30,  8.33it/s] 16%|█▌        | 47/303 [00:09<00:30,  8.32it/s] 16%|█▌        | 48/303 [00:09<00:30,  8.32it/s] 16%|█▌        | 49/303 [00:09<00:30,  8.33it/s] 17%|█▋        | 50/303 [00:09<00:30,  8.33it/s] 17%|█▋        | 51/303 [00:09<00:30,  8.33it/s] 17%|█▋        | 52/303 [00:09<00:30,  8.34it/s] 17%|█▋        | 53/303 [00:09<00:29,  8.34it/s] 18%|█▊        | 54/303 [00:10<00:29,  8.32it/s] 18%|█▊        | 55/303 [00:10<00:29,  8.33it/s] 18%|█▊        | 56/303 [00:10<00:29,  8.33it/s] 19%|█▉        | 57/303 [00:10<00:29,  8.33it/s] 19%|█▉        | 58/303 [00:10<00:29,  8.33it/s] 19%|█▉        | 59/303 [00:10<00:29,  8.33it/s] 20%|█▉        | 60/303 [00:10<00:29,  8.33it/s] 20%|██        | 61/303 [00:10<00:29,  8.34it/s] 20%|██        | 62/303 [00:10<00:28,  8.34it/s] 21%|██        | 63/303 [00:11<00:28,  8.34it/s] 21%|██        | 64/303 [00:11<00:28,  8.34it/s] 21%|██▏       | 65/303 [00:11<00:28,  8.33it/s] 22%|██▏       | 66/303 [00:11<00:28,  8.32it/s] 22%|██▏       | 67/303 [00:11<00:28,  8.32it/s] 22%|██▏       | 68/303 [00:11<00:28,  8.32it/s] 23%|██▎       | 69/303 [00:11<00:28,  8.33it/s] 23%|██▎       | 70/303 [00:11<00:28,  8.32it/s] 23%|██▎       | 71/303 [00:12<00:27,  8.32it/s] 24%|██▍       | 72/303 [00:12<00:27,  8.32it/s] 24%|██▍       | 73/303 [00:12<00:27,  8.32it/s] 24%|██▍       | 74/303 [00:12<00:27,  8.32it/s] 25%|██▍       | 75/303 [00:12<00:27,  8.32it/s] 25%|██▌       | 76/303 [00:12<00:27,  8.32it/s] 25%|██▌       | 77/303 [00:12<00:27,  8.32it/s] 26%|██▌       | 78/303 [00:12<00:27,  8.27it/s] 26%|██▌       | 79/303 [00:13<00:27,  8.28it/s] 26%|██▋       | 80/303 [00:13<00:26,  8.29it/s] 27%|██▋       | 81/303 [00:13<00:26,  8.29it/s] 27%|██▋       | 82/303 [00:13<00:26,  8.29it/s] 27%|██▋       | 83/303 [00:13<00:26,  8.29it/s] 28%|██▊       | 84/303 [00:13<00:26,  8.30it/s] 28%|██▊       | 85/303 [00:13<00:26,  8.30it/s] 28%|██▊       | 86/303 [00:13<00:26,  8.31it/s] 29%|██▊       | 87/303 [00:14<00:25,  8.31it/s] 29%|██▉       | 88/303 [00:14<00:25,  8.30it/s] 29%|██▉       | 89/303 [00:14<00:25,  8.31it/s] 30%|██▉       | 90/303 [00:14<00:25,  8.29it/s] 30%|███       | 91/303 [00:14<00:25,  8.29it/s] 30%|███       | 92/303 [00:14<00:25,  8.29it/s] 31%|███       | 93/303 [00:14<00:25,  8.30it/s] 31%|███       | 94/303 [00:14<00:25,  8.30it/s] 31%|███▏      | 95/303 [00:15<00:31,  6.65it/s] 32%|███▏      | 96/303 [00:15<00:40,  5.09it/s] 32%|███▏      | 97/303 [00:15<00:35,  5.75it/s] 32%|███▏      | 98/303 [00:15<00:33,  6.05it/s] 33%|███▎      | 99/303 [00:15<00:31,  6.58it/s] 33%|███▎      | 100/303 [00:15<00:28,  7.01it/s] 33%|███▎      | 101/303 [00:16<00:27,  7.36it/s] 34%|███▎      | 102/303 [00:16<00:26,  7.62it/s] 34%|███▍      | 103/303 [00:16<00:34,  5.80it/s] 34%|███▍      | 104/303 [00:16<00:31,  6.37it/s] 35%|███▍      | 105/303 [00:16<00:28,  6.84it/s] 35%|███▍      | 106/303 [00:16<00:27,  7.22it/s] 35%|███▌      | 107/303 [00:16<00:26,  7.50it/s] 36%|███▌      | 108/303 [00:16<00:25,  7.73it/s] 36%|███▌      | 109/303 [00:17<00:24,  7.89it/s] 36%|███▋      | 110/303 [00:17<00:24,  8.00it/s] 37%|███▋      | 111/303 [00:17<00:29,  6.54it/s] 37%|███▋      | 112/303 [00:17<00:27,  6.99it/s] 37%|███▋      | 113/303 [00:17<00:25,  7.33it/s] 38%|███▊      | 114/303 [00:17<00:24,  7.59it/s] 38%|███▊      | 115/303 [00:17<00:24,  7.79it/s] 38%|███▊      | 116/303 [00:18<00:23,  7.93it/s] 39%|███▊      | 117/303 [00:18<00:23,  8.04it/s] 39%|███▉      | 118/303 [00:18<00:22,  8.12it/s] 39%|███▉      | 119/303 [00:18<00:27,  6.79it/s] 40%|███▉      | 120/303 [00:18<00:25,  7.17it/s] 40%|███▉      | 121/303 [00:18<00:24,  7.46it/s] 40%|████      | 122/303 [00:18<00:23,  7.69it/s] 41%|████      | 123/303 [00:18<00:22,  7.87it/s] 41%|████      | 124/303 [00:19<00:22,  7.99it/s] 41%|████▏     | 125/303 [00:19<00:22,  8.08it/s] 42%|████▏     | 126/303 [00:19<00:21,  8.14it/s] 42%|████▏     | 127/303 [00:19<00:25,  6.99it/s] 42%|████▏     | 128/303 [00:19<00:23,  7.33it/s] 43%|████▎     | 129/303 [00:19<00:22,  7.58it/s] 43%|████▎     | 130/303 [00:19<00:22,  7.78it/s] 43%|████▎     | 131/303 [00:20<00:21,  7.92it/s] 44%|████▎     | 132/303 [00:20<00:21,  8.03it/s] 44%|████▍     | 133/303 [00:20<00:20,  8.11it/s] 44%|████▍     | 134/303 [00:20<00:20,  8.15it/s] 45%|████▍     | 135/303 [00:20<00:20,  8.16it/s] 45%|████▍     | 136/303 [00:20<00:20,  8.19it/s] 45%|████▌     | 137/303 [00:20<00:20,  8.22it/s] 46%|████▌     | 138/303 [00:20<00:20,  8.24it/s] 46%|████▌     | 139/303 [00:20<00:19,  8.24it/s] 46%|████▌     | 140/303 [00:21<00:19,  8.24it/s] 47%|████▋     | 141/303 [00:21<00:19,  8.25it/s] 47%|████▋     | 142/303 [00:21<00:19,  8.24it/s] 47%|████▋     | 143/303 [00:21<00:19,  8.23it/s] 48%|████▊     | 144/303 [00:21<00:19,  8.22it/s] 48%|████▊     | 145/303 [00:21<00:19,  8.22it/s] 48%|████▊     | 146/303 [00:21<00:19,  8.25it/s] 49%|████▊     | 147/303 [00:21<00:18,  8.26it/s] 49%|████▉     | 148/303 [00:22<00:18,  8.27it/s] 49%|████▉     | 149/303 [00:22<00:18,  8.27it/s] 50%|████▉     | 150/303 [00:22<00:18,  8.28it/s] 50%|████▉     | 151/303 [00:22<00:18,  8.28it/s] 50%|█████     | 152/303 [00:22<00:18,  8.29it/s] 50%|█████     | 153/303 [00:22<00:18,  8.29it/s] 51%|█████     | 154/303 [00:22<00:17,  8.30it/s] 51%|█████     | 155/303 [00:22<00:17,  8.30it/s] 51%|█████▏    | 156/303 [00:23<00:27,  5.30it/s] 52%|█████▏    | 157/303 [00:23<00:24,  5.94it/s] 52%|█████▏    | 158/303 [00:23<00:22,  6.49it/s] 52%|█████▏    | 159/303 [00:23<00:20,  6.93it/s] 53%|█████▎    | 160/303 [00:23<00:19,  7.29it/s] 53%|█████▎    | 161/303 [00:23<00:18,  7.49it/s] 53%|█████▎    | 162/303 [00:24<00:18,  7.71it/s] 54%|█████▍    | 163/303 [00:24<00:17,  7.86it/s] 54%|█████▍    | 164/303 [00:24<00:17,  7.98it/s] 54%|█████▍    | 165/303 [00:24<00:17,  8.07it/s] 55%|█████▍    | 166/303 [00:24<00:16,  8.12it/s] 55%|█████▌    | 167/303 [00:24<00:16,  8.16it/s] 55%|█████▌    | 168/303 [00:24<00:16,  8.20it/s] 56%|█████▌    | 169/303 [00:24<00:16,  8.22it/s] 56%|█████▌    | 170/303 [00:24<00:16,  8.22it/s] 56%|█████▋    | 171/303 [00:25<00:16,  8.22it/s] 57%|█████▋    | 172/303 [00:25<00:16,  7.98it/s] 57%|█████▋    | 173/303 [00:25<00:16,  8.06it/s] 57%|█████▋    | 174/303 [00:25<00:15,  8.12it/s] 58%|█████▊    | 175/303 [00:25<00:15,  8.17it/s] 58%|█████▊    | 176/303 [00:25<00:15,  8.21it/s] 58%|█████▊    | 177/303 [00:25<00:15,  8.22it/s] 59%|█████▊    | 178/303 [00:25<00:15,  8.24it/s] 59%|█████▉    | 179/303 [00:26<00:15,  8.25it/s] 59%|█████▉    | 180/303 [00:26<00:14,  8.25it/s] 60%|█████▉    | 181/303 [00:26<00:14,  8.25it/s] 60%|██████    | 182/303 [00:26<00:14,  8.26it/s] 60%|██████    | 183/303 [00:26<00:14,  8.27it/s] 61%|██████    | 184/303 [00:26<00:14,  8.27it/s] 61%|██████    | 185/303 [00:26<00:14,  8.27it/s] 61%|██████▏   | 186/303 [00:26<00:14,  8.25it/s] 62%|██████▏   | 187/303 [00:27<00:14,  8.25it/s] 62%|██████▏   | 188/303 [00:27<00:13,  8.26it/s] 62%|██████▏   | 189/303 [00:27<00:13,  8.27it/s] 63%|██████▎   | 190/303 [00:27<00:13,  8.28it/s] 63%|██████▎   | 191/303 [00:27<00:13,  8.27it/s] 63%|██████▎   | 192/303 [00:27<00:13,  8.27it/s] 64%|██████▎   | 193/303 [00:27<00:13,  8.27it/s] 64%|██████▍   | 194/303 [00:27<00:13,  8.26it/s] 64%|██████▍   | 195/303 [00:28<00:13,  8.26it/s] 65%|██████▍   | 196/303 [00:28<00:12,  8.25it/s] 65%|██████▌   | 197/303 [00:28<00:12,  8.24it/s] 65%|██████▌   | 198/303 [00:28<00:12,  8.25it/s] 66%|██████▌   | 199/303 [00:28<00:12,  8.23it/s] 66%|██████▌   | 200/303 [00:28<00:12,  8.21it/s] 66%|██████▋   | 201/303 [00:28<00:12,  8.21it/s] 67%|██████▋   | 202/303 [00:28<00:12,  8.23it/s] 67%|██████▋   | 203/303 [00:28<00:12,  8.24it/s] 67%|██████▋   | 204/303 [00:29<00:12,  8.25it/s] 68%|██████▊   | 205/303 [00:29<00:11,  8.25it/s] 68%|██████▊   | 206/303 [00:29<00:11,  8.25it/s] 68%|██████▊   | 207/303 [00:29<00:11,  8.25it/s] 69%|██████▊   | 208/303 [00:29<00:11,  8.25it/s] 69%|██████▉   | 209/303 [00:29<00:11,  8.23it/s] 69%|██████▉   | 210/303 [00:29<00:11,  8.23it/s] 70%|██████▉   | 211/303 [00:29<00:11,  8.22it/s] 70%|██████▉   | 212/303 [00:30<00:11,  8.22it/s] 70%|███████   | 213/303 [00:30<00:10,  8.21it/s] 71%|███████   | 214/303 [00:30<00:10,  8.20it/s] 71%|███████   | 215/303 [00:30<00:10,  8.20it/s] 71%|███████▏  | 216/303 [00:30<00:10,  8.21it/s] 72%|███████▏  | 217/303 [00:30<00:10,  8.21it/s] 72%|███████▏  | 218/303 [00:30<00:10,  8.22it/s] 72%|███████▏  | 219/303 [00:30<00:10,  8.23it/s] 73%|███████▎  | 220/303 [00:31<00:10,  8.23it/s] 73%|███████▎  | 221/303 [00:31<00:09,  8.23it/s] 73%|███████▎  | 222/303 [00:31<00:09,  8.24it/s] 74%|███████▎  | 223/303 [00:31<00:09,  8.25it/s] 74%|███████▍  | 224/303 [00:31<00:09,  8.23it/s] 74%|███████▍  | 225/303 [00:31<00:09,  8.24it/s] 75%|███████▍  | 226/303 [00:31<00:09,  8.26it/s] 75%|███████▍  | 227/303 [00:31<00:09,  8.27it/s] 75%|███████▌  | 228/303 [00:32<00:09,  8.28it/s] 76%|███████▌  | 229/303 [00:32<00:08,  8.29it/s] 76%|███████▌  | 230/303 [00:32<00:08,  8.29it/s] 76%|███████▌  | 231/303 [00:32<00:08,  8.28it/s] 77%|███████▋  | 232/303 [00:32<00:08,  8.28it/s] 77%|███████▋  | 233/303 [00:32<00:08,  8.28it/s] 77%|███████▋  | 234/303 [00:32<00:08,  8.27it/s] 78%|███████▊  | 235/303 [00:32<00:08,  8.28it/s] 78%|███████▊  | 236/303 [00:32<00:08,  8.27it/s] 78%|███████▊  | 237/303 [00:33<00:07,  8.26it/s] 79%|███████▊  | 238/303 [00:33<00:08,  7.55it/s] 79%|███████▉  | 239/303 [00:33<00:08,  7.76it/s] 79%|███████▉  | 240/303 [00:33<00:07,  7.90it/s] 80%|███████▉  | 241/303 [00:33<00:07,  8.01it/s] 80%|███████▉  | 242/303 [00:33<00:07,  8.08it/s] 80%|████████  | 243/303 [00:33<00:07,  8.13it/s] 81%|████████  | 244/303 [00:33<00:07,  8.16it/s] 81%|████████  | 245/303 [00:34<00:07,  8.19it/s] 81%|████████  | 246/303 [00:34<00:06,  8.19it/s] 82%|████████▏ | 247/303 [00:34<00:06,  8.20it/s] 82%|████████▏ | 248/303 [00:34<00:06,  8.21it/s] 82%|████████▏ | 249/303 [00:34<00:06,  8.22it/s] 83%|████████▎ | 250/303 [00:34<00:06,  8.22it/s] 83%|████████▎ | 251/303 [00:34<00:06,  8.23it/s] 83%|████████▎ | 252/303 [00:34<00:06,  8.21it/s] 83%|████████▎ | 253/303 [00:35<00:06,  8.22it/s] 84%|████████▍ | 254/303 [00:35<00:05,  8.23it/s] 84%|████████▍ | 255/303 [00:35<00:05,  8.22it/s] 84%|████████▍ | 256/303 [00:35<00:05,  8.23it/s] 85%|████████▍ | 257/303 [00:35<00:05,  8.23it/s] 85%|████████▌ | 258/303 [00:35<00:05,  8.23it/s] 85%|████████▌ | 259/303 [00:35<00:05,  8.22it/s] 86%|████████▌ | 260/303 [00:35<00:05,  8.24it/s] 86%|████████▌ | 261/303 [00:36<00:05,  8.25it/s] 86%|████████▋ | 262/303 [00:36<00:04,  8.25it/s] 87%|████████▋ | 263/303 [00:36<00:04,  8.26it/s] 87%|████████▋ | 264/303 [00:36<00:04,  8.23it/s] 87%|████████▋ | 265/303 [00:36<00:04,  8.22it/s] 88%|████████▊ | 266/303 [00:36<00:04,  8.22it/s] 88%|████████▊ | 267/303 [00:36<00:04,  8.11it/s] 88%|████████▊ | 268/303 [00:36<00:04,  8.15it/s] 89%|████████▉ | 269/303 [00:37<00:04,  8.17it/s] 89%|████████▉ | 270/303 [00:37<00:04,  8.19it/s] 89%|████████▉ | 271/303 [00:37<00:03,  8.18it/s] 90%|████████▉ | 272/303 [00:37<00:03,  8.19it/s] 90%|█████████ | 273/303 [00:37<00:03,  8.21it/s] 90%|█████████ | 274/303 [00:37<00:03,  8.21it/s] 91%|█████████ | 275/303 [00:37<00:03,  8.21it/s] 91%|█████████ | 276/303 [00:37<00:03,  8.19it/s] 91%|█████████▏| 277/303 [00:38<00:03,  8.20it/s] 92%|█████████▏| 278/303 [00:38<00:03,  8.21it/s] 92%|█████████▏| 279/303 [00:38<00:02,  8.20it/s] 92%|█████████▏| 280/303 [00:38<00:02,  8.20it/s] 93%|█████████▎| 281/303 [00:38<00:02,  8.21it/s] 93%|█████████▎| 282/303 [00:38<00:02,  8.20it/s] 93%|█████████▎| 283/303 [00:38<00:02,  8.22it/s] 94%|█████████▎| 284/303 [00:38<00:02,  8.22it/s] 94%|█████████▍| 285/303 [00:38<00:02,  8.19it/s] 94%|█████████▍| 286/303 [00:39<00:02,  8.18it/s] 95%|█████████▍| 287/303 [00:39<00:01,  8.18it/s] 95%|█████████▌| 288/303 [00:39<00:01,  8.18it/s] 95%|█████████▌| 289/303 [00:39<00:01,  8.20it/s] 96%|█████████▌| 290/303 [00:39<00:01,  8.22it/s] 96%|█████████▌| 291/303 [00:39<00:01,  8.24it/s] 96%|█████████▋| 292/303 [00:39<00:01,  8.24it/s] 97%|█████████▋| 293/303 [00:39<00:01,  8.25it/s] 97%|█████████▋| 294/303 [00:40<00:01,  8.27it/s] 97%|█████████▋| 295/303 [00:40<00:00,  8.27it/s] 98%|█████████▊| 296/303 [00:40<00:00,  8.27it/s] 98%|█████████▊| 297/303 [00:40<00:00,  8.27it/s] 98%|█████████▊| 298/303 [00:40<00:00,  8.29it/s] 99%|█████████▊| 299/303 [00:40<00:00,  8.29it/s] 99%|█████████▉| 300/303 [00:40<00:00,  8.30it/s] 99%|█████████▉| 301/303 [00:40<00:00,  8.29it/s]100%|█████████▉| 302/303 [00:41<00:00,  8.29it/s]100%|██████████| 303/303 [00:41<00:00,  8.29it/s]100%|██████████| 303/303 [00:41<00:00,  7.35it/s]
=> result
* total: 30,300
* correct: 25,924
* accuracy: 85.6%
* error: 14.4%
* macro_f1: 85.5%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet ucf101 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/ucf101/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: UCF101
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/ucf101/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:UCF101
Loading dataset: UCF101
Reading split from /shared/s2/lab01/dataset/clip/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/ucf101/split_fewshot_taesup/shot_16-seed_3.pkl
1616 1898 3783
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      1,898
# test     3,783
---------  ------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/38 [00:00<?, ?it/s]  3%|▎         | 1/38 [00:03<02:15,  3.67s/it]  5%|▌         | 2/38 [00:03<00:56,  1.58s/it]  8%|▊         | 3/38 [00:03<00:32,  1.09it/s] 11%|█         | 4/38 [00:04<00:20,  1.66it/s] 13%|█▎        | 5/38 [00:04<00:14,  2.34it/s] 16%|█▌        | 6/38 [00:04<00:10,  3.10it/s] 18%|█▊        | 7/38 [00:04<00:07,  3.90it/s] 21%|██        | 8/38 [00:04<00:06,  4.69it/s] 24%|██▎       | 9/38 [00:04<00:05,  5.43it/s] 26%|██▋       | 10/38 [00:04<00:04,  6.07it/s] 29%|██▉       | 11/38 [00:04<00:04,  6.61it/s] 32%|███▏      | 12/38 [00:04<00:03,  7.05it/s] 34%|███▍      | 13/38 [00:05<00:03,  7.39it/s] 37%|███▋      | 14/38 [00:05<00:03,  7.65it/s] 39%|███▉      | 15/38 [00:05<00:02,  7.84it/s] 42%|████▏     | 16/38 [00:05<00:02,  7.96it/s] 45%|████▍     | 17/38 [00:05<00:02,  8.07it/s] 47%|████▋     | 18/38 [00:05<00:02,  8.15it/s] 50%|█████     | 19/38 [00:05<00:02,  8.19it/s] 53%|█████▎    | 20/38 [00:05<00:02,  8.22it/s] 55%|█████▌    | 21/38 [00:06<00:02,  8.24it/s] 58%|█████▊    | 22/38 [00:06<00:01,  8.26it/s] 61%|██████    | 23/38 [00:06<00:01,  8.27it/s] 63%|██████▎   | 24/38 [00:06<00:01,  8.28it/s] 66%|██████▌   | 25/38 [00:06<00:01,  8.28it/s] 68%|██████▊   | 26/38 [00:06<00:01,  8.30it/s] 71%|███████   | 27/38 [00:06<00:01,  8.31it/s] 74%|███████▎  | 28/38 [00:06<00:01,  8.33it/s] 76%|███████▋  | 29/38 [00:07<00:01,  8.34it/s] 79%|███████▉  | 30/38 [00:07<00:00,  8.34it/s] 82%|████████▏ | 31/38 [00:07<00:00,  8.35it/s] 84%|████████▍ | 32/38 [00:07<00:00,  8.35it/s] 87%|████████▋ | 33/38 [00:07<00:00,  8.35it/s] 89%|████████▉ | 34/38 [00:07<00:00,  8.35it/s] 92%|█████████▏| 35/38 [00:07<00:00,  8.34it/s] 95%|█████████▍| 36/38 [00:07<00:00,  8.34it/s] 97%|█████████▋| 37/38 [00:07<00:00,  8.34it/s]100%|██████████| 38/38 [00:08<00:00,  8.71it/s]100%|██████████| 38/38 [00:08<00:00,  4.64it/s]
=> result
* total: 3,783
* correct: 2,566
* accuracy: 67.8%
* error: 32.2%
* macro_f1: 64.8%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet caltech101 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/caltech101.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/caltech101/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: Caltech101
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/caltech101/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:Caltech101
Loading dataset: Caltech101
Reading split from /shared/s2/lab01/dataset/clip/caltech-101/split_zhou_Caltech101.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/caltech-101/split_fewshot_taesup/shot_16-seed_3.pkl
1600 1649 2465
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------
Dataset    Caltech101
# classes  100
# train_x  1,600
# val      1,649
# test     2,465
---------  ----------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:03<01:15,  3.14s/it]  8%|▊         | 2/25 [00:03<00:31,  1.36s/it] 12%|█▏        | 3/25 [00:03<00:17,  1.26it/s] 16%|█▌        | 4/25 [00:03<00:11,  1.89it/s] 20%|██        | 5/25 [00:03<00:07,  2.62it/s] 24%|██▍       | 6/25 [00:03<00:05,  3.42it/s] 28%|██▊       | 7/25 [00:03<00:04,  4.23it/s] 32%|███▏      | 8/25 [00:03<00:03,  5.02it/s] 36%|███▌      | 9/25 [00:04<00:02,  5.73it/s] 40%|████      | 10/25 [00:04<00:02,  6.35it/s] 44%|████▍     | 11/25 [00:04<00:02,  6.85it/s] 48%|████▊     | 12/25 [00:04<00:01,  7.25it/s] 52%|█████▏    | 13/25 [00:04<00:01,  7.56it/s] 56%|█████▌    | 14/25 [00:04<00:01,  7.80it/s] 60%|██████    | 15/25 [00:04<00:01,  7.97it/s] 64%|██████▍   | 16/25 [00:04<00:01,  8.09it/s] 68%|██████▊   | 17/25 [00:05<00:00,  8.18it/s] 72%|███████▏  | 18/25 [00:05<00:00,  8.24it/s] 76%|███████▌  | 19/25 [00:05<00:00,  8.28it/s] 80%|████████  | 20/25 [00:05<00:00,  8.31it/s] 84%|████████▍ | 21/25 [00:05<00:00,  8.33it/s] 88%|████████▊ | 22/25 [00:05<00:00,  8.34it/s] 92%|█████████▏| 23/25 [00:05<00:00,  8.35it/s] 96%|█████████▌| 24/25 [00:05<00:00,  8.35it/s]100%|██████████| 25/25 [00:06<00:00,  4.12it/s]
=> result
* total: 2,465
* correct: 2,281
* accuracy: 92.5%
* error: 7.5%
* macro_f1: 89.7%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet sun397 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/sun397.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/sun397/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: SUN397
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/sun397/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:SUN397
Loading dataset: SUN397
Reading split from /shared/s2/lab01/dataset/clip/sun397/split_zhou_SUN397.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/sun397/split_fewshot_taesup/shot_16-seed_3.pkl
6352 3970 19850
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------
Dataset    SUN397
# classes  397
# train_x  6,352
# val      3,970
# test     19,850
---------  ------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/199 [00:00<?, ?it/s]  1%|          | 1/199 [00:05<17:57,  5.44s/it]  1%|          | 2/199 [00:05<07:42,  2.35s/it]  2%|▏         | 3/199 [00:05<04:25,  1.36s/it]  2%|▏         | 4/199 [00:05<02:53,  1.12it/s]  3%|▎         | 5/199 [00:06<02:02,  1.58it/s]  3%|▎         | 6/199 [00:06<01:32,  2.09it/s]  4%|▎         | 7/199 [00:06<01:13,  2.63it/s]  4%|▍         | 8/199 [00:06<01:00,  3.16it/s]  5%|▍         | 9/199 [00:07<01:39,  1.91it/s]  5%|▌         | 10/199 [00:08<02:18,  1.36it/s]  6%|▌         | 11/199 [00:09<02:30,  1.25it/s]  6%|▌         | 12/199 [00:10<01:54,  1.63it/s]  7%|▋         | 13/199 [00:10<01:29,  2.08it/s]  7%|▋         | 14/199 [00:10<01:12,  2.57it/s]  8%|▊         | 15/199 [00:10<00:59,  3.07it/s]  8%|▊         | 16/199 [00:10<00:51,  3.55it/s]  9%|▊         | 17/199 [00:10<00:45,  3.99it/s]  9%|▉         | 18/199 [00:11<00:42,  4.23it/s] 10%|▉         | 19/199 [00:12<01:19,  2.26it/s] 10%|█         | 20/199 [00:12<01:05,  2.75it/s] 11%|█         | 21/199 [00:12<01:01,  2.87it/s] 11%|█         | 22/199 [00:12<00:52,  3.36it/s] 12%|█▏        | 23/199 [00:12<00:46,  3.82it/s] 12%|█▏        | 24/199 [00:13<00:41,  4.23it/s] 13%|█▎        | 25/199 [00:13<00:38,  4.56it/s] 13%|█▎        | 26/199 [00:14<01:20,  2.14it/s] 14%|█▎        | 27/199 [00:15<01:59,  1.44it/s] 14%|█▍        | 28/199 [00:15<01:32,  1.85it/s] 15%|█▍        | 29/199 [00:15<01:13,  2.32it/s] 15%|█▌        | 30/199 [00:16<01:00,  2.81it/s] 16%|█▌        | 31/199 [00:16<00:50,  3.31it/s] 16%|█▌        | 32/199 [00:16<00:44,  3.77it/s] 17%|█▋        | 33/199 [00:16<00:39,  4.17it/s] 17%|█▋        | 34/199 [00:16<00:36,  4.51it/s] 18%|█▊        | 35/199 [00:18<01:33,  1.76it/s] 18%|█▊        | 36/199 [00:18<01:13,  2.21it/s] 19%|█▊        | 37/199 [00:19<01:48,  1.50it/s] 19%|█▉        | 38/199 [00:19<01:23,  1.92it/s] 20%|█▉        | 39/199 [00:19<01:06,  2.39it/s] 20%|██        | 40/199 [00:20<00:55,  2.89it/s] 21%|██        | 41/199 [00:20<00:46,  3.38it/s] 21%|██        | 42/199 [00:20<00:40,  3.84it/s] 22%|██▏       | 43/199 [00:20<00:56,  2.76it/s] 22%|██▏       | 44/199 [00:21<00:53,  2.88it/s] 23%|██▎       | 45/199 [00:21<00:50,  3.05it/s] 23%|██▎       | 46/199 [00:21<00:43,  3.54it/s] 24%|██▎       | 47/199 [00:21<00:38,  3.98it/s] 24%|██▍       | 48/199 [00:22<00:34,  4.36it/s] 25%|██▍       | 49/199 [00:22<00:32,  4.67it/s] 25%|██▌       | 50/199 [00:22<00:30,  4.92it/s] 26%|██▌       | 51/199 [00:25<02:45,  1.12s/it] 26%|██▌       | 52/199 [00:25<02:03,  1.20it/s] 27%|██▋       | 53/199 [00:26<01:33,  1.56it/s] 27%|██▋       | 54/199 [00:26<01:12,  2.00it/s] 28%|██▊       | 55/199 [00:26<00:58,  2.47it/s] 28%|██▊       | 56/199 [00:26<00:48,  2.97it/s] 29%|██▊       | 57/199 [00:26<00:41,  3.46it/s] 29%|██▉       | 58/199 [00:26<00:36,  3.91it/s] 30%|██▉       | 59/199 [00:27<01:03,  2.20it/s] 30%|███       | 60/199 [00:28<00:55,  2.52it/s] 31%|███       | 61/199 [00:28<00:45,  3.02it/s] 31%|███       | 62/199 [00:28<00:39,  3.49it/s] 32%|███▏      | 63/199 [00:28<00:34,  3.94it/s] 32%|███▏      | 64/199 [00:28<00:31,  4.32it/s] 33%|███▎      | 65/199 [00:29<00:28,  4.63it/s] 33%|███▎      | 66/199 [00:30<01:14,  1.78it/s] 34%|███▎      | 67/199 [00:30<00:58,  2.24it/s] 34%|███▍      | 68/199 [00:31<01:32,  1.42it/s] 35%|███▍      | 69/199 [00:32<01:12,  1.80it/s] 35%|███▌      | 70/199 [00:32<00:57,  2.26it/s] 36%|███▌      | 71/199 [00:32<00:46,  2.76it/s] 36%|███▌      | 72/199 [00:32<00:39,  3.25it/s] 37%|███▋      | 73/199 [00:32<00:33,  3.72it/s] 37%|███▋      | 74/199 [00:33<01:01,  2.04it/s] 38%|███▊      | 75/199 [00:34<01:08,  1.81it/s] 38%|███▊      | 76/199 [00:34<00:54,  2.27it/s] 39%|███▊      | 77/199 [00:34<00:44,  2.76it/s] 39%|███▉      | 78/199 [00:35<00:37,  3.25it/s] 40%|███▉      | 79/199 [00:35<00:32,  3.72it/s] 40%|████      | 80/199 [00:35<00:28,  4.14it/s] 41%|████      | 81/199 [00:35<00:26,  4.49it/s] 41%|████      | 82/199 [00:36<01:05,  1.78it/s] 42%|████▏     | 83/199 [00:38<01:32,  1.25it/s] 42%|████▏     | 84/199 [00:38<01:10,  1.63it/s] 43%|████▎     | 85/199 [00:38<00:55,  2.07it/s] 43%|████▎     | 86/199 [00:38<00:44,  2.55it/s] 44%|████▎     | 87/199 [00:39<00:36,  3.05it/s] 44%|████▍     | 88/199 [00:39<00:31,  3.54it/s] 45%|████▍     | 89/199 [00:39<00:27,  3.98it/s] 45%|████▌     | 90/199 [00:42<01:51,  1.02s/it] 46%|████▌     | 91/199 [00:42<01:23,  1.30it/s] 46%|████▌     | 92/199 [00:42<01:03,  1.69it/s] 47%|████▋     | 93/199 [00:42<00:49,  2.14it/s] 47%|████▋     | 94/199 [00:42<00:39,  2.63it/s] 48%|████▊     | 95/199 [00:43<00:33,  3.13it/s] 48%|████▊     | 96/199 [00:43<00:28,  3.60it/s] 49%|████▊     | 97/199 [00:43<00:25,  4.04it/s] 49%|████▉     | 98/199 [00:44<00:59,  1.71it/s] 50%|████▉     | 99/199 [00:44<00:46,  2.16it/s] 50%|█████     | 100/199 [00:45<00:57,  1.72it/s] 51%|█████     | 101/199 [00:46<00:45,  2.17it/s] 51%|█████▏    | 102/199 [00:46<00:36,  2.65it/s] 52%|█████▏    | 103/199 [00:46<00:30,  3.15it/s] 52%|█████▏    | 104/199 [00:46<00:26,  3.62it/s] 53%|█████▎    | 105/199 [00:46<00:23,  4.03it/s] 53%|█████▎    | 106/199 [00:48<01:09,  1.34it/s] 54%|█████▍    | 107/199 [00:48<00:52,  1.74it/s] 54%|█████▍    | 108/199 [00:50<01:11,  1.28it/s] 55%|█████▍    | 109/199 [00:50<00:54,  1.67it/s] 55%|█████▌    | 110/199 [00:50<00:42,  2.11it/s] 56%|█████▌    | 111/199 [00:50<00:33,  2.60it/s] 56%|█████▋    | 112/199 [00:50<00:28,  3.09it/s] 57%|█████▋    | 113/199 [00:50<00:24,  3.57it/s] 57%|█████▋    | 114/199 [00:52<00:46,  1.84it/s] 58%|█████▊    | 115/199 [00:52<00:36,  2.30it/s] 58%|█████▊    | 116/199 [00:53<01:04,  1.28it/s] 59%|█████▉    | 117/199 [00:54<00:49,  1.67it/s] 59%|█████▉    | 118/199 [00:54<00:38,  2.12it/s] 60%|█████▉    | 119/199 [00:54<00:30,  2.60it/s] 60%|██████    | 120/199 [00:54<00:25,  3.10it/s] 61%|██████    | 121/199 [00:54<00:21,  3.58it/s] 61%|██████▏   | 122/199 [00:57<01:12,  1.07it/s] 62%|██████▏   | 123/199 [00:57<00:53,  1.41it/s] 62%|██████▏   | 124/199 [00:57<00:41,  1.82it/s] 63%|██████▎   | 125/199 [00:57<00:32,  2.29it/s] 63%|██████▎   | 126/199 [00:57<00:26,  2.78it/s] 64%|██████▍   | 127/199 [00:58<00:21,  3.28it/s] 64%|██████▍   | 128/199 [00:58<00:18,  3.75it/s] 65%|██████▍   | 129/199 [00:58<00:16,  4.16it/s] 65%|██████▌   | 130/199 [00:59<00:34,  1.99it/s] 66%|██████▌   | 131/199 [00:59<00:27,  2.46it/s] 66%|██████▋   | 132/199 [00:59<00:22,  2.96it/s] 67%|██████▋   | 133/199 [01:00<00:19,  3.45it/s] 67%|██████▋   | 134/199 [01:00<00:16,  3.90it/s] 68%|██████▊   | 135/199 [01:00<00:14,  4.28it/s] 68%|██████▊   | 136/199 [01:00<00:13,  4.61it/s] 69%|██████▉   | 137/199 [01:00<00:12,  4.86it/s] 69%|██████▉   | 138/199 [01:05<01:25,  1.40s/it] 70%|██████▉   | 139/199 [01:05<01:01,  1.03s/it] 70%|███████   | 140/199 [01:05<00:45,  1.29it/s] 71%|███████   | 141/199 [01:05<00:34,  1.67it/s] 71%|███████▏  | 142/199 [01:05<00:26,  2.12it/s] 72%|███████▏  | 143/199 [01:05<00:21,  2.61it/s] 72%|███████▏  | 144/199 [01:06<00:17,  3.11it/s] 73%|███████▎  | 145/199 [01:06<00:15,  3.58it/s] 73%|███████▎  | 146/199 [01:08<00:44,  1.20it/s] 74%|███████▍  | 147/199 [01:08<00:33,  1.57it/s] 74%|███████▍  | 148/199 [01:08<00:25,  2.00it/s] 75%|███████▍  | 149/199 [01:08<00:20,  2.47it/s] 75%|███████▌  | 150/199 [01:09<00:16,  2.97it/s] 76%|███████▌  | 151/199 [01:09<00:13,  3.46it/s] 76%|███████▋  | 152/199 [01:09<00:12,  3.90it/s] 77%|███████▋  | 153/199 [01:09<00:10,  4.28it/s] 77%|███████▋  | 154/199 [01:12<00:42,  1.05it/s] 78%|███████▊  | 155/199 [01:12<00:31,  1.39it/s] 78%|███████▊  | 156/199 [01:12<00:23,  1.80it/s] 79%|███████▉  | 157/199 [01:12<00:18,  2.26it/s] 79%|███████▉  | 158/199 [01:13<00:14,  2.75it/s] 80%|███████▉  | 159/199 [01:13<00:12,  3.24it/s] 80%|████████  | 160/199 [01:13<00:10,  3.71it/s] 81%|████████  | 161/199 [01:13<00:09,  4.12it/s] 81%|████████▏ | 162/199 [01:14<00:15,  2.44it/s] 82%|████████▏ | 163/199 [01:14<00:12,  2.94it/s] 82%|████████▏ | 164/199 [01:14<00:10,  3.43it/s] 83%|████████▎ | 165/199 [01:14<00:08,  3.88it/s] 83%|████████▎ | 166/199 [01:15<00:07,  4.27it/s] 84%|████████▍ | 167/199 [01:15<00:06,  4.59it/s] 84%|████████▍ | 168/199 [01:15<00:06,  4.86it/s] 85%|████████▍ | 169/199 [01:15<00:05,  5.05it/s] 85%|████████▌ | 170/199 [01:16<00:09,  3.03it/s] 86%|████████▌ | 171/199 [01:16<00:07,  3.51it/s] 86%|████████▋ | 172/199 [01:16<00:06,  3.94it/s] 87%|████████▋ | 173/199 [01:16<00:06,  4.32it/s] 87%|████████▋ | 174/199 [01:16<00:05,  4.63it/s] 88%|████████▊ | 175/199 [01:17<00:04,  4.88it/s] 88%|████████▊ | 176/199 [01:17<00:04,  5.07it/s] 89%|████████▉ | 177/199 [01:17<00:04,  5.21it/s] 89%|████████▉ | 178/199 [01:19<00:12,  1.63it/s] 90%|████████▉ | 179/199 [01:19<00:09,  2.07it/s] 90%|█████████ | 180/199 [01:19<00:07,  2.55it/s] 91%|█████████ | 181/199 [01:19<00:05,  3.04it/s] 91%|█████████▏| 182/199 [01:19<00:04,  3.51it/s] 92%|█████████▏| 183/199 [01:20<00:05,  3.17it/s] 92%|█████████▏| 184/199 [01:20<00:04,  3.64it/s] 93%|█████████▎| 185/199 [01:20<00:03,  4.07it/s] 93%|█████████▎| 186/199 [01:22<00:08,  1.49it/s] 94%|█████████▍| 187/199 [01:22<00:06,  1.91it/s] 94%|█████████▍| 188/199 [01:22<00:04,  2.38it/s] 95%|█████████▍| 189/199 [01:22<00:03,  2.88it/s] 95%|█████████▌| 190/199 [01:23<00:03,  2.50it/s] 96%|█████████▌| 191/199 [01:23<00:02,  3.00it/s] 96%|█████████▋| 192/199 [01:23<00:02,  3.48it/s] 97%|█████████▋| 193/199 [01:23<00:01,  3.93it/s] 97%|█████████▋| 194/199 [01:24<00:02,  1.94it/s] 98%|█████████▊| 195/199 [01:25<00:01,  2.42it/s] 98%|█████████▊| 196/199 [01:25<00:01,  2.92it/s] 99%|█████████▉| 197/199 [01:25<00:00,  3.41it/s] 99%|█████████▉| 198/199 [01:27<00:00,  1.42it/s]100%|██████████| 199/199 [01:27<00:00,  1.88it/s]100%|██████████| 199/199 [01:27<00:00,  2.28it/s]
=> result
* total: 19,850
* correct: 12,907
* accuracy: 65.0%
* error: 35.0%
* macro_f1: 63.4%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers stanford_cars oxford_pets food101 ucf101 caltech101 sun397 imagenet
+ for seed in 3
+ sh scripts/coop/crossdataset_test.sh imagenet imagenet 3 0 vit_b16_ep50_ctxv1 16 50 CoOp
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/CoOp/vit_b16_ep50_ctxv1.yaml
dataset_config_file: configs/datasets/imagenet.yaml
eval_only: True
head: 
load_epoch: 50
model_dir: output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'all']
output_dir: output/coop/crossdataset/test_target/source_imagenet/imagenet/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: CoOp
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: ImageNet
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/coop/crossdataset/test_target/source_imagenet/imagenet/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: a photo of a
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: CoOp
  RPO:
    CTX_INIT: 
    K1: 1
    K2: 1
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:CoOp
Loading trainer: CoOp
requested:ImageNet
Loading dataset: ImageNet
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/ImageNet/split_fewshot_taesup/shot_16-seed_3.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  --------
Dataset    ImageNet
# classes  1,000
# train_x  16,000
# val      50,000
# test     50,000
---------  --------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/coop/crossdataset/train_source/imagenet/shots_16/CoOp/vit_b16_ep50_ctxv1/seed3/prompt_learner/model.pth.tar-50" (epoch = 50)
Evaluate on the *test* set
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:04<33:53,  4.08s/it]  0%|          | 2/500 [00:04<15:20,  1.85s/it]  1%|          | 3/500 [00:04<09:24,  1.14s/it]  1%|          | 4/500 [00:04<06:38,  1.25it/s]  1%|          | 5/500 [00:05<05:06,  1.62it/s]  1%|          | 6/500 [00:05<04:10,  1.97it/s]  1%|▏         | 7/500 [00:05<03:35,  2.29it/s]  2%|▏         | 8/500 [00:06<03:12,  2.56it/s]  2%|▏         | 9/500 [00:06<02:56,  2.78it/s]  2%|▏         | 10/500 [00:06<02:46,  2.95it/s]  2%|▏         | 11/500 [00:06<02:38,  3.08it/s]  2%|▏         | 12/500 [00:07<02:33,  3.18it/s]  3%|▎         | 13/500 [00:07<02:29,  3.25it/s]  3%|▎         | 14/500 [00:07<02:27,  3.30it/s]  3%|▎         | 15/500 [00:08<02:25,  3.33it/s]  3%|▎         | 16/500 [00:08<02:24,  3.36it/s]  3%|▎         | 17/500 [00:08<02:23,  3.36it/s]  4%|▎         | 18/500 [00:09<02:22,  3.38it/s]  4%|▍         | 19/500 [00:09<02:21,  3.40it/s]  4%|▍         | 20/500 [00:09<02:20,  3.41it/s]  4%|▍         | 21/500 [00:09<02:20,  3.41it/s]  4%|▍         | 22/500 [00:10<02:20,  3.41it/s]  5%|▍         | 23/500 [00:10<02:19,  3.42it/s]  5%|▍         | 24/500 [00:10<02:19,  3.42it/s]  5%|▌         | 25/500 [00:11<02:19,  3.41it/s]  5%|▌         | 26/500 [00:11<02:18,  3.42it/s]  5%|▌         | 27/500 [00:11<02:18,  3.42it/s]  6%|▌         | 28/500 [00:11<02:17,  3.42it/s]  6%|▌         | 29/500 [00:12<02:17,  3.42it/s]  6%|▌         | 30/500 [00:12<02:17,  3.42it/s]  6%|▌         | 31/500 [00:12<02:17,  3.41it/s]  6%|▋         | 32/500 [00:13<02:17,  3.41it/s]  7%|▋         | 33/500 [00:13<02:17,  3.41it/s]  7%|▋         | 34/500 [00:13<02:16,  3.41it/s]  7%|▋         | 35/500 [00:14<02:16,  3.41it/s]  7%|▋         | 36/500 [00:14<02:15,  3.42it/s]  7%|▋         | 37/500 [00:14<02:15,  3.41it/s]  8%|▊         | 38/500 [00:14<02:15,  3.41it/s]  8%|▊         | 39/500 [00:15<02:15,  3.41it/s]  8%|▊         | 40/500 [00:15<02:14,  3.41it/s]  8%|▊         | 41/500 [00:15<02:14,  3.41it/s]  8%|▊         | 42/500 [00:16<02:14,  3.41it/s]  9%|▊         | 43/500 [00:16<02:13,  3.41it/s]  9%|▉         | 44/500 [00:16<02:13,  3.41it/s]  9%|▉         | 45/500 [00:16<02:13,  3.41it/s]  9%|▉         | 46/500 [00:17<02:13,  3.41it/s]  9%|▉         | 47/500 [00:17<02:12,  3.41it/s] 10%|▉         | 48/500 [00:17<02:12,  3.41it/s] 10%|▉         | 49/500 [00:18<02:12,  3.41it/s] 10%|█         | 50/500 [00:18<02:11,  3.41it/s] 10%|█         | 51/500 [00:18<02:11,  3.41it/s] 10%|█         | 52/500 [00:18<02:11,  3.41it/s] 11%|█         | 53/500 [00:19<02:11,  3.40it/s] 11%|█         | 54/500 [00:19<02:11,  3.40it/s] 11%|█         | 55/500 [00:19<02:10,  3.40it/s] 11%|█         | 56/500 [00:20<02:10,  3.40it/s] 11%|█▏        | 57/500 [00:20<02:10,  3.40it/s] 12%|█▏        | 58/500 [00:20<02:09,  3.40it/s] 12%|█▏        | 59/500 [00:21<02:09,  3.40it/s] 12%|█▏        | 60/500 [00:21<02:09,  3.39it/s] 12%|█▏        | 61/500 [00:21<02:09,  3.40it/s] 12%|█▏        | 62/500 [00:21<02:09,  3.39it/s] 13%|█▎        | 63/500 [00:22<02:08,  3.39it/s] 13%|█▎        | 64/500 [00:22<02:08,  3.39it/s] 13%|█▎        | 65/500 [00:22<02:08,  3.39it/s] 13%|█▎        | 66/500 [00:23<02:07,  3.40it/s] 13%|█▎        | 67/500 [00:23<02:07,  3.40it/s] 14%|█▎        | 68/500 [00:23<02:06,  3.40it/s] 14%|█▍        | 69/500 [00:24<02:06,  3.40it/s] 14%|█▍        | 70/500 [00:24<02:06,  3.40it/s] 14%|█▍        | 71/500 [00:24<02:06,  3.40it/s] 14%|█▍        | 72/500 [00:24<02:05,  3.40it/s] 15%|█▍        | 73/500 [00:25<02:05,  3.40it/s] 15%|█▍        | 74/500 [00:25<02:05,  3.40it/s] 15%|█▌        | 75/500 [00:25<02:05,  3.40it/s] 15%|█▌        | 76/500 [00:26<02:05,  3.38it/s] 15%|█▌        | 77/500 [00:26<02:04,  3.39it/s] 16%|█▌        | 78/500 [00:26<02:04,  3.39it/s] 16%|█▌        | 79/500 [00:26<02:04,  3.39it/s] 16%|█▌        | 80/500 [00:27<02:04,  3.38it/s] 16%|█▌        | 81/500 [00:27<02:03,  3.38it/s] 16%|█▋        | 82/500 [00:27<02:03,  3.39it/s] 17%|█▋        | 83/500 [00:28<02:03,  3.39it/s] 17%|█▋        | 84/500 [00:28<02:02,  3.39it/s] 17%|█▋        | 85/500 [00:28<02:02,  3.39it/s] 17%|█▋        | 86/500 [00:29<02:02,  3.39it/s] 17%|█▋        | 87/500 [00:29<02:01,  3.39it/s] 18%|█▊        | 88/500 [00:29<02:01,  3.39it/s] 18%|█▊        | 89/500 [00:29<02:01,  3.39it/s] 18%|█▊        | 90/500 [00:30<02:01,  3.38it/s] 18%|█▊        | 91/500 [00:30<02:00,  3.38it/s] 18%|█▊        | 92/500 [00:30<02:01,  3.37it/s] 19%|█▊        | 93/500 [00:31<02:00,  3.38it/s] 19%|█▉        | 94/500 [00:31<02:00,  3.38it/s] 19%|█▉        | 95/500 [00:31<01:59,  3.38it/s] 19%|█▉        | 96/500 [00:31<01:59,  3.39it/s] 19%|█▉        | 97/500 [00:32<01:58,  3.39it/s] 20%|█▉        | 98/500 [00:32<01:58,  3.39it/s] 20%|█▉        | 99/500 [00:32<01:58,  3.39it/s] 20%|██        | 100/500 [00:33<01:58,  3.39it/s] 20%|██        | 101/500 [00:33<01:57,  3.39it/s] 20%|██        | 102/500 [00:33<01:57,  3.39it/s] 21%|██        | 103/500 [00:34<01:56,  3.39it/s] 21%|██        | 104/500 [00:34<01:56,  3.39it/s] 21%|██        | 105/500 [00:34<01:56,  3.39it/s] 21%|██        | 106/500 [00:34<01:56,  3.39it/s] 21%|██▏       | 107/500 [00:35<01:55,  3.39it/s] 22%|██▏       | 108/500 [00:35<01:55,  3.38it/s] 22%|██▏       | 109/500 [00:35<01:55,  3.38it/s] 22%|██▏       | 110/500 [00:36<01:55,  3.39it/s] 22%|██▏       | 111/500 [00:36<01:54,  3.39it/s] 22%|██▏       | 112/500 [00:36<01:54,  3.39it/s] 23%|██▎       | 113/500 [00:36<01:54,  3.39it/s] 23%|██▎       | 114/500 [00:37<01:53,  3.39it/s] 23%|██▎       | 115/500 [00:37<01:53,  3.39it/s] 23%|██▎       | 116/500 [00:37<01:53,  3.39it/s] 23%|██▎       | 117/500 [00:38<01:53,  3.39it/s] 24%|██▎       | 118/500 [00:38<01:52,  3.38it/s] 24%|██▍       | 119/500 [00:38<01:52,  3.39it/s] 24%|██▍       | 120/500 [00:39<01:52,  3.39it/s] 24%|██▍       | 121/500 [00:39<01:51,  3.38it/s] 24%|██▍       | 122/500 [00:39<01:51,  3.39it/s] 25%|██▍       | 123/500 [00:39<01:51,  3.38it/s] 25%|██▍       | 124/500 [00:40<01:51,  3.39it/s] 25%|██▌       | 125/500 [00:40<01:50,  3.38it/s] 25%|██▌       | 126/500 [00:40<01:50,  3.38it/s] 25%|██▌       | 127/500 [00:41<01:50,  3.39it/s] 26%|██▌       | 128/500 [00:41<01:49,  3.39it/s] 26%|██▌       | 129/500 [00:41<01:49,  3.39it/s] 26%|██▌       | 130/500 [00:42<01:49,  3.38it/s] 26%|██▌       | 131/500 [00:42<01:48,  3.39it/s] 26%|██▋       | 132/500 [00:42<01:48,  3.39it/s] 27%|██▋       | 133/500 [00:42<01:48,  3.38it/s] 27%|██▋       | 134/500 [00:43<01:48,  3.38it/s] 27%|██▋       | 135/500 [00:43<01:48,  3.38it/s] 27%|██▋       | 136/500 [00:43<01:47,  3.38it/s] 27%|██▋       | 137/500 [00:44<01:47,  3.37it/s] 28%|██▊       | 138/500 [00:44<01:47,  3.37it/s] 28%|██▊       | 139/500 [00:44<01:46,  3.38it/s] 28%|██▊       | 140/500 [00:44<01:46,  3.38it/s] 28%|██▊       | 141/500 [00:45<01:46,  3.38it/s] 28%|██▊       | 142/500 [00:45<01:45,  3.38it/s] 29%|██▊       | 143/500 [00:45<01:45,  3.37it/s] 29%|██▉       | 144/500 [00:46<01:45,  3.37it/s] 29%|██▉       | 145/500 [00:46<01:45,  3.37it/s] 29%|██▉       | 146/500 [00:46<01:44,  3.37it/s] 29%|██▉       | 147/500 [00:47<01:44,  3.38it/s] 30%|██▉       | 148/500 [00:47<01:44,  3.38it/s] 30%|██▉       | 149/500 [00:47<01:43,  3.38it/s] 30%|███       | 150/500 [00:47<01:43,  3.37it/s] 30%|███       | 151/500 [00:48<01:43,  3.37it/s] 30%|███       | 152/500 [00:48<01:43,  3.37it/s] 31%|███       | 153/500 [00:48<01:42,  3.37it/s] 31%|███       | 154/500 [00:49<01:42,  3.37it/s] 31%|███       | 155/500 [00:49<01:42,  3.38it/s] 31%|███       | 156/500 [00:49<01:41,  3.38it/s] 31%|███▏      | 157/500 [00:50<01:41,  3.38it/s] 32%|███▏      | 158/500 [00:50<01:41,  3.38it/s] 32%|███▏      | 159/500 [00:50<01:40,  3.38it/s] 32%|███▏      | 160/500 [00:50<01:40,  3.38it/s] 32%|███▏      | 161/500 [00:51<01:40,  3.38it/s] 32%|███▏      | 162/500 [00:51<01:40,  3.38it/s] 33%|███▎      | 163/500 [00:51<01:39,  3.38it/s] 33%|███▎      | 164/500 [00:52<01:39,  3.38it/s] 33%|███▎      | 165/500 [00:52<01:39,  3.37it/s] 33%|███▎      | 166/500 [00:52<01:38,  3.37it/s] 33%|███▎      | 167/500 [00:52<01:38,  3.37it/s] 34%|███▎      | 168/500 [00:53<01:38,  3.37it/s] 34%|███▍      | 169/500 [00:53<01:38,  3.37it/s] 34%|███▍      | 170/500 [00:53<01:37,  3.37it/s] 34%|███▍      | 171/500 [00:54<01:37,  3.37it/s] 34%|███▍      | 172/500 [00:54<01:37,  3.37it/s] 35%|███▍      | 173/500 [00:54<01:36,  3.37it/s] 35%|███▍      | 174/500 [00:55<01:36,  3.37it/s] 35%|███▌      | 175/500 [00:55<01:36,  3.37it/s] 35%|███▌      | 176/500 [00:55<01:36,  3.37it/s] 35%|███▌      | 177/500 [00:55<01:35,  3.37it/s] 36%|███▌      | 178/500 [00:56<01:35,  3.37it/s] 36%|███▌      | 179/500 [00:56<01:35,  3.37it/s] 36%|███▌      | 180/500 [00:56<01:34,  3.37it/s] 36%|███▌      | 181/500 [00:57<01:34,  3.37it/s] 36%|███▋      | 182/500 [00:57<01:34,  3.37it/s] 37%|███▋      | 183/500 [00:57<01:33,  3.37it/s] 37%|███▋      | 184/500 [00:58<01:33,  3.37it/s] 37%|███▋      | 185/500 [00:58<01:33,  3.38it/s] 37%|███▋      | 186/500 [00:58<01:32,  3.38it/s] 37%|███▋      | 187/500 [00:58<01:32,  3.37it/s] 38%|███▊      | 188/500 [00:59<01:32,  3.38it/s] 38%|███▊      | 189/500 [00:59<01:32,  3.37it/s] 38%|███▊      | 190/500 [00:59<01:31,  3.37it/s] 38%|███▊      | 191/500 [01:00<01:31,  3.37it/s] 38%|███▊      | 192/500 [01:00<01:31,  3.37it/s] 39%|███▊      | 193/500 [01:00<01:31,  3.37it/s] 39%|███▉      | 194/500 [01:00<01:30,  3.37it/s] 39%|███▉      | 195/500 [01:01<01:30,  3.37it/s] 39%|███▉      | 196/500 [01:01<01:30,  3.37it/s] 39%|███▉      | 197/500 [01:01<01:29,  3.37it/s] 40%|███▉      | 198/500 [01:02<01:29,  3.37it/s] 40%|███▉      | 199/500 [01:02<01:29,  3.37it/s] 40%|████      | 200/500 [01:02<01:29,  3.36it/s] 40%|████      | 201/500 [01:03<01:28,  3.36it/s] 40%|████      | 202/500 [01:03<01:28,  3.36it/s] 41%|████      | 203/500 [01:03<01:28,  3.36it/s] 41%|████      | 204/500 [01:03<01:28,  3.36it/s] 41%|████      | 205/500 [01:04<01:27,  3.36it/s] 41%|████      | 206/500 [01:04<01:27,  3.37it/s] 41%|████▏     | 207/500 [01:04<01:26,  3.37it/s] 42%|████▏     | 208/500 [01:05<01:26,  3.36it/s] 42%|████▏     | 209/500 [01:05<01:26,  3.36it/s] 42%|████▏     | 210/500 [01:05<01:26,  3.37it/s] 42%|████▏     | 211/500 [01:06<01:25,  3.37it/s] 42%|████▏     | 212/500 [01:06<01:25,  3.36it/s] 43%|████▎     | 213/500 [01:06<01:25,  3.37it/s] 43%|████▎     | 214/500 [01:06<01:24,  3.37it/s] 43%|████▎     | 215/500 [01:07<01:24,  3.37it/s] 43%|████▎     | 216/500 [01:07<01:24,  3.37it/s] 43%|████▎     | 217/500 [01:07<01:24,  3.36it/s] 44%|████▎     | 218/500 [01:08<01:23,  3.37it/s] 44%|████▍     | 219/500 [01:08<01:23,  3.37it/s] 44%|████▍     | 220/500 [01:08<01:23,  3.37it/s] 44%|████▍     | 221/500 [01:08<01:22,  3.37it/s] 44%|████▍     | 222/500 [01:09<01:22,  3.37it/s] 45%|████▍     | 223/500 [01:09<01:22,  3.37it/s] 45%|████▍     | 224/500 [01:09<01:22,  3.36it/s] 45%|████▌     | 225/500 [01:10<01:21,  3.37it/s] 45%|████▌     | 226/500 [01:10<01:21,  3.36it/s] 45%|████▌     | 227/500 [01:10<01:21,  3.36it/s] 46%|████▌     | 228/500 [01:11<01:20,  3.37it/s] 46%|████▌     | 229/500 [01:11<01:20,  3.37it/s] 46%|████▌     | 230/500 [01:11<01:20,  3.37it/s] 46%|████▌     | 231/500 [01:11<01:19,  3.36it/s] 46%|████▋     | 232/500 [01:12<01:19,  3.36it/s] 47%|████▋     | 233/500 [01:12<01:19,  3.37it/s] 47%|████▋     | 234/500 [01:12<01:19,  3.36it/s] 47%|████▋     | 235/500 [01:13<01:18,  3.36it/s] 47%|████▋     | 236/500 [01:13<01:18,  3.36it/s] 47%|████▋     | 237/500 [01:13<01:18,  3.36it/s] 48%|████▊     | 238/500 [01:14<01:17,  3.37it/s] 48%|████▊     | 239/500 [01:14<01:17,  3.37it/s] 48%|████▊     | 240/500 [01:14<01:17,  3.37it/s] 48%|████▊     | 241/500 [01:14<01:16,  3.37it/s] 48%|████▊     | 242/500 [01:15<01:16,  3.37it/s] 49%|████▊     | 243/500 [01:15<01:16,  3.37it/s] 49%|████▉     | 244/500 [01:15<01:15,  3.37it/s] 49%|████▉     | 245/500 [01:16<01:16,  3.35it/s] 49%|████▉     | 246/500 [01:16<01:15,  3.35it/s] 49%|████▉     | 247/500 [01:16<01:15,  3.36it/s] 50%|████▉     | 248/500 [01:17<01:15,  3.36it/s] 50%|████▉     | 249/500 [01:17<01:14,  3.36it/s] 50%|█████     | 250/500 [01:17<01:14,  3.36it/s] 50%|█████     | 251/500 [01:17<01:14,  3.36it/s] 50%|█████     | 252/500 [01:18<01:13,  3.37it/s] 51%|█████     | 253/500 [01:18<01:13,  3.36it/s] 51%|█████     | 254/500 [01:18<01:13,  3.37it/s] 51%|█████     | 255/500 [01:19<01:12,  3.37it/s] 51%|█████     | 256/500 [01:19<01:12,  3.37it/s] 51%|█████▏    | 257/500 [01:19<01:12,  3.37it/s] 52%|█████▏    | 258/500 [01:19<01:11,  3.37it/s] 52%|█████▏    | 259/500 [01:20<01:11,  3.38it/s] 52%|█████▏    | 260/500 [01:20<01:11,  3.37it/s] 52%|█████▏    | 261/500 [01:20<01:10,  3.37it/s] 52%|█████▏    | 262/500 [01:21<01:10,  3.37it/s] 53%|█████▎    | 263/500 [01:21<01:10,  3.37it/s] 53%|█████▎    | 264/500 [01:21<01:10,  3.37it/s] 53%|█████▎    | 265/500 [01:22<01:09,  3.37it/s] 53%|█████▎    | 266/500 [01:22<01:09,  3.37it/s] 53%|█████▎    | 267/500 [01:22<01:09,  3.38it/s] 54%|█████▎    | 268/500 [01:22<01:08,  3.37it/s] 54%|█████▍    | 269/500 [01:23<01:08,  3.37it/s] 54%|█████▍    | 270/500 [01:23<01:08,  3.37it/s] 54%|█████▍    | 271/500 [01:23<01:08,  3.37it/s] 54%|█████▍    | 272/500 [01:24<01:07,  3.37it/s] 55%|█████▍    | 273/500 [01:24<01:07,  3.37it/s] 55%|█████▍    | 274/500 [01:24<01:07,  3.37it/s] 55%|█████▌    | 275/500 [01:25<01:06,  3.37it/s] 55%|█████▌    | 276/500 [01:25<01:06,  3.37it/s] 55%|█████▌    | 277/500 [01:25<01:06,  3.37it/s] 56%|█████▌    | 278/500 [01:25<01:05,  3.37it/s] 56%|█████▌    | 279/500 [01:26<01:05,  3.37it/s] 56%|█████▌    | 280/500 [01:26<01:05,  3.37it/s] 56%|█████▌    | 281/500 [01:26<01:04,  3.38it/s] 56%|█████▋    | 282/500 [01:27<01:04,  3.37it/s] 57%|█████▋    | 283/500 [01:27<01:04,  3.37it/s] 57%|█████▋    | 284/500 [01:27<01:04,  3.37it/s] 57%|█████▋    | 285/500 [01:28<01:03,  3.36it/s] 57%|█████▋    | 286/500 [01:28<01:03,  3.37it/s] 57%|█████▋    | 287/500 [01:28<01:03,  3.37it/s] 58%|█████▊    | 288/500 [01:28<01:02,  3.37it/s] 58%|█████▊    | 289/500 [01:29<01:02,  3.37it/s] 58%|█████▊    | 290/500 [01:29<01:02,  3.37it/s] 58%|█████▊    | 291/500 [01:29<01:02,  3.37it/s] 58%|█████▊    | 292/500 [01:30<01:01,  3.37it/s] 59%|█████▊    | 293/500 [01:30<01:01,  3.37it/s] 59%|█████▉    | 294/500 [01:30<01:01,  3.37it/s] 59%|█████▉    | 295/500 [01:30<01:00,  3.37it/s] 59%|█████▉    | 296/500 [01:31<01:00,  3.36it/s] 59%|█████▉    | 297/500 [01:31<01:00,  3.36it/s] 60%|█████▉    | 298/500 [01:31<01:00,  3.37it/s] 60%|█████▉    | 299/500 [01:32<00:59,  3.37it/s] 60%|██████    | 300/500 [01:32<00:59,  3.37it/s] 60%|██████    | 301/500 [01:32<00:59,  3.37it/s] 60%|██████    | 302/500 [01:33<00:58,  3.37it/s] 61%|██████    | 303/500 [01:33<00:58,  3.37it/s] 61%|██████    | 304/500 [01:33<00:58,  3.37it/s] 61%|██████    | 305/500 [01:33<00:57,  3.37it/s] 61%|██████    | 306/500 [01:34<00:57,  3.37it/s] 61%|██████▏   | 307/500 [01:34<00:57,  3.37it/s] 62%|██████▏   | 308/500 [01:34<00:57,  3.37it/s] 62%|██████▏   | 309/500 [01:35<00:56,  3.37it/s] 62%|██████▏   | 310/500 [01:35<00:56,  3.37it/s] 62%|██████▏   | 311/500 [01:35<00:56,  3.37it/s] 62%|██████▏   | 312/500 [01:36<00:55,  3.36it/s] 63%|██████▎   | 313/500 [01:36<00:55,  3.37it/s] 63%|██████▎   | 314/500 [01:36<00:55,  3.36it/s] 63%|██████▎   | 315/500 [01:36<00:55,  3.36it/s] 63%|██████▎   | 316/500 [01:37<00:54,  3.36it/s] 63%|██████▎   | 317/500 [01:37<00:54,  3.36it/s] 64%|██████▎   | 318/500 [01:37<00:54,  3.37it/s] 64%|██████▍   | 319/500 [01:38<00:53,  3.35it/s] 64%|██████▍   | 320/500 [01:38<00:53,  3.35it/s] 64%|██████▍   | 321/500 [01:38<00:53,  3.36it/s] 64%|██████▍   | 322/500 [01:39<00:52,  3.36it/s] 65%|██████▍   | 323/500 [01:39<00:52,  3.37it/s] 65%|██████▍   | 324/500 [01:39<00:52,  3.36it/s] 65%|██████▌   | 325/500 [01:39<00:52,  3.36it/s] 65%|██████▌   | 326/500 [01:40<00:51,  3.36it/s] 65%|██████▌   | 327/500 [01:40<00:51,  3.36it/s] 66%|██████▌   | 328/500 [01:40<00:51,  3.36it/s] 66%|██████▌   | 329/500 [01:41<00:50,  3.37it/s] 66%|██████▌   | 330/500 [01:41<00:50,  3.37it/s] 66%|██████▌   | 331/500 [01:41<00:50,  3.37it/s] 66%|██████▋   | 332/500 [01:41<00:49,  3.37it/s] 67%|██████▋   | 333/500 [01:42<00:49,  3.37it/s] 67%|██████▋   | 334/500 [01:42<00:49,  3.37it/s] 67%|██████▋   | 335/500 [01:42<00:49,  3.37it/s] 67%|██████▋   | 336/500 [01:43<00:48,  3.36it/s] 67%|██████▋   | 337/500 [01:43<00:48,  3.36it/s] 68%|██████▊   | 338/500 [01:43<00:48,  3.36it/s] 68%|██████▊   | 339/500 [01:44<00:47,  3.36it/s] 68%|██████▊   | 340/500 [01:44<00:47,  3.36it/s] 68%|██████▊   | 341/500 [01:44<00:47,  3.36it/s] 68%|██████▊   | 342/500 [01:44<00:46,  3.37it/s] 69%|██████▊   | 343/500 [01:45<00:46,  3.36it/s] 69%|██████▉   | 344/500 [01:45<00:46,  3.36it/s] 69%|██████▉   | 345/500 [01:45<00:46,  3.36it/s] 69%|██████▉   | 346/500 [01:46<00:45,  3.36it/s] 69%|██████▉   | 347/500 [01:46<00:45,  3.37it/s] 70%|██████▉   | 348/500 [01:46<00:45,  3.37it/s] 70%|██████▉   | 349/500 [01:47<00:44,  3.37it/s] 70%|███████   | 350/500 [01:47<00:44,  3.37it/s] 70%|███████   | 351/500 [01:47<00:44,  3.36it/s] 70%|███████   | 352/500 [01:47<00:43,  3.37it/s] 71%|███████   | 353/500 [01:48<00:43,  3.37it/s] 71%|███████   | 354/500 [01:48<00:43,  3.36it/s] 71%|███████   | 355/500 [01:48<00:43,  3.37it/s] 71%|███████   | 356/500 [01:49<00:42,  3.37it/s] 71%|███████▏  | 357/500 [01:49<00:42,  3.37it/s] 72%|███████▏  | 358/500 [01:49<00:42,  3.37it/s] 72%|███████▏  | 359/500 [01:49<00:41,  3.37it/s] 72%|███████▏  | 360/500 [01:50<00:41,  3.37it/s] 72%|███████▏  | 361/500 [01:50<00:41,  3.35it/s] 72%|███████▏  | 362/500 [01:50<00:41,  3.36it/s] 73%|███████▎  | 363/500 [01:51<00:40,  3.36it/s] 73%|███████▎  | 364/500 [01:51<00:40,  3.36it/s] 73%|███████▎  | 365/500 [01:51<00:40,  3.36it/s] 73%|███████▎  | 366/500 [01:52<00:39,  3.36it/s] 73%|███████▎  | 367/500 [01:52<00:39,  3.37it/s] 74%|███████▎  | 368/500 [01:52<00:39,  3.36it/s] 74%|███████▍  | 369/500 [01:52<00:38,  3.37it/s] 74%|███████▍  | 370/500 [01:53<00:38,  3.36it/s] 74%|███████▍  | 371/500 [01:53<00:38,  3.36it/s] 74%|███████▍  | 372/500 [01:53<00:38,  3.36it/s] 75%|███████▍  | 373/500 [01:54<00:37,  3.36it/s] 75%|███████▍  | 374/500 [01:54<00:37,  3.36it/s] 75%|███████▌  | 375/500 [01:54<00:37,  3.36it/s] 75%|███████▌  | 376/500 [01:55<00:36,  3.37it/s] 75%|███████▌  | 377/500 [01:55<00:36,  3.36it/s] 76%|███████▌  | 378/500 [01:55<00:36,  3.36it/s] 76%|███████▌  | 379/500 [01:55<00:36,  3.36it/s] 76%|███████▌  | 380/500 [01:56<00:35,  3.36it/s] 76%|███████▌  | 381/500 [01:56<00:35,  3.36it/s] 76%|███████▋  | 382/500 [01:56<00:35,  3.36it/s] 77%|███████▋  | 383/500 [01:57<00:34,  3.36it/s] 77%|███████▋  | 384/500 [01:57<00:34,  3.37it/s] 77%|███████▋  | 385/500 [01:57<00:34,  3.37it/s] 77%|███████▋  | 386/500 [01:58<00:33,  3.36it/s] 77%|███████▋  | 387/500 [01:58<00:33,  3.36it/s] 78%|███████▊  | 388/500 [01:58<00:33,  3.35it/s] 78%|███████▊  | 389/500 [01:58<00:33,  3.35it/s] 78%|███████▊  | 390/500 [01:59<00:32,  3.36it/s] 78%|███████▊  | 391/500 [01:59<00:32,  3.36it/s] 78%|███████▊  | 392/500 [01:59<00:32,  3.36it/s] 79%|███████▊  | 393/500 [02:00<00:31,  3.36it/s] 79%|███████▉  | 394/500 [02:00<00:31,  3.36it/s] 79%|███████▉  | 395/500 [02:00<00:31,  3.36it/s] 79%|███████▉  | 396/500 [02:01<00:30,  3.36it/s] 79%|███████▉  | 397/500 [02:01<00:30,  3.36it/s] 80%|███████▉  | 398/500 [02:01<00:30,  3.37it/s] 80%|███████▉  | 399/500 [02:01<00:30,  3.36it/s] 80%|████████  | 400/500 [02:02<00:29,  3.36it/s] 80%|████████  | 401/500 [02:02<00:29,  3.36it/s] 80%|████████  | 402/500 [02:02<00:29,  3.36it/s] 81%|████████  | 403/500 [02:03<00:28,  3.37it/s] 81%|████████  | 404/500 [02:03<00:28,  3.36it/s] 81%|████████  | 405/500 [02:03<00:28,  3.36it/s] 81%|████████  | 406/500 [02:03<00:27,  3.36it/s] 81%|████████▏ | 407/500 [02:04<00:27,  3.36it/s] 82%|████████▏ | 408/500 [02:04<00:27,  3.35it/s] 82%|████████▏ | 409/500 [02:04<00:27,  3.36it/s] 82%|████████▏ | 410/500 [02:05<00:26,  3.36it/s] 82%|████████▏ | 411/500 [02:05<00:26,  3.36it/s] 82%|████████▏ | 412/500 [02:05<00:26,  3.36it/s] 83%|████████▎ | 413/500 [02:06<00:25,  3.37it/s] 83%|████████▎ | 414/500 [02:06<00:25,  3.37it/s] 83%|████████▎ | 415/500 [02:06<00:25,  3.37it/s] 83%|████████▎ | 416/500 [02:06<00:24,  3.37it/s] 83%|████████▎ | 417/500 [02:07<00:24,  3.37it/s] 84%|████████▎ | 418/500 [02:07<00:24,  3.36it/s] 84%|████████▍ | 419/500 [02:07<00:24,  3.36it/s] 84%|████████▍ | 420/500 [02:08<00:23,  3.36it/s] 84%|████████▍ | 421/500 [02:08<00:23,  3.37it/s] 84%|████████▍ | 422/500 [02:08<00:23,  3.37it/s] 85%|████████▍ | 423/500 [02:09<00:22,  3.37it/s] 85%|████████▍ | 424/500 [02:09<00:22,  3.37it/s] 85%|████████▌ | 425/500 [02:09<00:22,  3.37it/s] 85%|████████▌ | 426/500 [02:09<00:22,  3.36it/s] 85%|████████▌ | 427/500 [02:10<00:21,  3.37it/s] 86%|████████▌ | 428/500 [02:10<00:21,  3.37it/s] 86%|████████▌ | 429/500 [02:10<00:21,  3.37it/s] 86%|████████▌ | 430/500 [02:11<00:20,  3.37it/s] 86%|████████▌ | 431/500 [02:11<00:20,  3.37it/s] 86%|████████▋ | 432/500 [02:11<00:20,  3.37it/s] 87%|████████▋ | 433/500 [02:12<00:19,  3.36it/s] 87%|████████▋ | 434/500 [02:12<00:19,  3.36it/s] 87%|████████▋ | 435/500 [02:12<00:19,  3.36it/s] 87%|████████▋ | 436/500 [02:12<00:19,  3.35it/s] 87%|████████▋ | 437/500 [02:13<00:18,  3.35it/s] 88%|████████▊ | 438/500 [02:13<00:18,  3.36it/s] 88%|████████▊ | 439/500 [02:13<00:18,  3.36it/s] 88%|████████▊ | 440/500 [02:14<00:17,  3.36it/s] 88%|████████▊ | 441/500 [02:14<00:17,  3.36it/s] 88%|████████▊ | 442/500 [02:14<00:17,  3.36it/s] 89%|████████▊ | 443/500 [02:14<00:16,  3.36it/s] 89%|████████▉ | 444/500 [02:15<00:16,  3.36it/s] 89%|████████▉ | 445/500 [02:15<00:16,  3.36it/s] 89%|████████▉ | 446/500 [02:15<00:16,  3.36it/s] 89%|████████▉ | 447/500 [02:16<00:15,  3.36it/s] 90%|████████▉ | 448/500 [02:16<00:15,  3.37it/s] 90%|████████▉ | 449/500 [02:16<00:15,  3.37it/s] 90%|█████████ | 450/500 [02:17<00:14,  3.36it/s] 90%|█████████ | 451/500 [02:17<00:14,  3.36it/s] 90%|█████████ | 452/500 [02:17<00:14,  3.36it/s] 91%|█████████ | 453/500 [02:17<00:13,  3.36it/s] 91%|█████████ | 454/500 [02:18<00:13,  3.36it/s] 91%|█████████ | 455/500 [02:18<00:13,  3.36it/s] 91%|█████████ | 456/500 [02:18<00:13,  3.36it/s] 91%|█████████▏| 457/500 [02:19<00:12,  3.36it/s] 92%|█████████▏| 458/500 [02:19<00:12,  3.36it/s] 92%|█████████▏| 459/500 [02:19<00:12,  3.34it/s] 92%|█████████▏| 460/500 [02:20<00:11,  3.34it/s] 92%|█████████▏| 461/500 [02:20<00:11,  3.34it/s] 92%|█████████▏| 462/500 [02:20<00:11,  3.35it/s] 93%|█████████▎| 463/500 [02:20<00:11,  3.36it/s] 93%|█████████▎| 464/500 [02:21<00:10,  3.36it/s] 93%|█████████▎| 465/500 [02:21<00:10,  3.36it/s] 93%|█████████▎| 466/500 [02:21<00:10,  3.36it/s] 93%|█████████▎| 467/500 [02:22<00:09,  3.36it/s] 94%|█████████▎| 468/500 [02:22<00:09,  3.36it/s] 94%|█████████▍| 469/500 [02:22<00:09,  3.36it/s] 94%|█████████▍| 470/500 [02:23<00:08,  3.36it/s] 94%|█████████▍| 471/500 [02:23<00:08,  3.35it/s] 94%|█████████▍| 472/500 [02:23<00:08,  3.35it/s] 95%|█████████▍| 473/500 [02:23<00:08,  3.35it/s] 95%|█████████▍| 474/500 [02:24<00:07,  3.36it/s] 95%|█████████▌| 475/500 [02:24<00:07,  3.35it/s] 95%|█████████▌| 476/500 [02:24<00:07,  3.36it/s] 95%|█████████▌| 477/500 [02:25<00:06,  3.36it/s] 96%|█████████▌| 478/500 [02:25<00:06,  3.36it/s] 96%|█████████▌| 479/500 [02:25<00:06,  3.36it/s] 96%|█████████▌| 480/500 [02:25<00:05,  3.36it/s] 96%|█████████▌| 481/500 [02:26<00:05,  3.35it/s] 96%|█████████▋| 482/500 [02:26<00:05,  3.36it/s] 97%|█████████▋| 483/500 [02:26<00:05,  3.37it/s] 97%|█████████▋| 484/500 [02:27<00:04,  3.37it/s] 97%|█████████▋| 485/500 [02:27<00:04,  3.36it/s] 97%|█████████▋| 486/500 [02:27<00:04,  3.37it/s] 97%|█████████▋| 487/500 [02:28<00:03,  3.37it/s] 98%|█████████▊| 488/500 [02:28<00:03,  3.38it/s] 98%|█████████▊| 489/500 [02:28<00:03,  3.38it/s] 98%|█████████▊| 490/500 [02:28<00:02,  3.38it/s] 98%|█████████▊| 491/500 [02:29<00:02,  3.38it/s] 98%|█████████▊| 492/500 [02:29<00:02,  3.38it/s] 99%|█████████▊| 493/500 [02:29<00:02,  3.38it/s] 99%|█████████▉| 494/500 [02:30<00:01,  3.38it/s] 99%|█████████▉| 495/500 [02:30<00:01,  3.38it/s] 99%|█████████▉| 496/500 [02:30<00:01,  3.38it/s] 99%|█████████▉| 497/500 [02:31<00:00,  3.38it/s]100%|█████████▉| 498/500 [02:31<00:00,  3.38it/s]100%|█████████▉| 499/500 [02:31<00:00,  3.38it/s]100%|██████████| 500/500 [02:31<00:00,  3.38it/s]100%|██████████| 500/500 [02:32<00:00,  3.29it/s]
=> result
* total: 50,000
* correct: 35,874
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 71.1%
