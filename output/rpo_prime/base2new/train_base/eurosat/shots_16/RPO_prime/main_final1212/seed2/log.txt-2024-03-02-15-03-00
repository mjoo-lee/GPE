***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_final1212.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime/main_final1212/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 4
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.01
  LR_SCHEDULER: cosine
  MAX_EPOCH: 30
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime/main_final1212/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime
  RPO:
    CTX_INIT: a photo of a
    K1: 24
    K2: 0
    PREC: fp16
    cov_loss: 500
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime
Loading trainer: RPO_prime
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE BASE CLASSES!
80 2800 4200
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,800
# test     4,200
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime/main_final1212/seed2/tensorboard)
> /shared/s2/lab01/myungjoo/RPO_v2/trainers/rpo_prime.py(269)forward()
-> return ce_loss +  self.cfg.TRAINER.RPO.cov_loss * cov_loss
(Pdb) torch.Size([])
(Pdb) tensor(nan, device='cuda:0', dtype=torch.float16, grad_fn=<AddBackward0>)
(Pdb) tensor(nan, device='cuda:0', dtype=torch.float16, grad_fn=<MeanBackward0>)
(Pdb) tensor(nan, device='cuda:0', dtype=torch.float16, grad_fn=<AddBackward0>)
(Pdb) tensor([], device='cuda:0', size=(0, 4, 5), dtype=torch.float16,
       grad_fn=<ReshapeAliasBackward0>)
(Pdb) tensor([], device='cuda:0', size=(0, 4, 5), dtype=torch.float16,
       grad_fn=<ReshapeAliasBackward0>)
(Pdb) tensor([[[24.1094, 21.9375, 23.6719, 25.5156, 23.5156],
         [24.2500, 21.8906, 23.2969, 25.8594, 23.7969],
         [23.1250, 20.6250, 22.5781, 26.3438, 23.3125],
         [19.4062, 17.0469, 19.0000, 23.3125, 20.4688]],

        [[21.2812, 19.7031, 18.7656, 22.5156, 21.1406],
         [22.5156, 20.7812, 20.6250, 23.6875, 20.9062],
         [20.0781, 18.7656, 18.2812, 22.5312, 20.2812],
         [18.8125, 17.6406, 18.2344, 22.7812, 18.9531]],

        [[23.2500, 21.6406, 22.4688, 24.0781, 23.2188],
         [23.2031, 21.7969, 21.0156, 23.8906, 22.5469],
         [22.1250, 20.5000, 21.1562, 23.6250, 22.4844],
         [20.1406, 19.0469, 17.2812, 22.6406, 21.0156]],

        [[20.9531, 20.8281, 22.4219, 24.2656, 21.9062],
         [22.0781, 22.3281, 22.6719, 24.9844, 20.7500],
         [20.4531, 20.0469, 21.9375, 24.7500, 21.0469],
         [17.5781, 17.5938, 18.7969, 22.5156, 18.0469]],

        [[21.2812, 21.1250, 23.9531, 24.7656, 23.9844],
         [21.4531, 21.5469, 23.5156, 24.3438, 22.1875],
         [20.1250, 20.0938, 22.8906, 24.9688, 23.1875],
         [16.3750, 16.6094, 18.5156, 21.0156, 18.8281]],

        [[21.0781, 19.6719, 19.6094, 22.2344, 20.2344],
         [21.6406, 19.9062, 19.1562, 21.2344, 19.5625],
         [18.7188, 17.4844, 17.0000, 20.2969, 17.9531],
         [19.4531, 17.5312, 16.8750, 19.2969, 17.5312]],

        [[23.9844, 22.2188, 23.1250, 25.2656, 24.1094],
         [24.9219, 22.4844, 23.2656, 25.3594, 23.3438],
         [23.8438, 22.3438, 23.2969, 25.9688, 24.3594],
         [20.1094, 18.1094, 19.1406, 21.7500, 19.9531]],

        [[21.4062, 21.3281, 21.4844, 23.7500, 22.6562],
         [22.3750, 21.9844, 22.1719, 23.7500, 22.0156],
         [20.5469, 19.9531, 20.4688, 23.4531, 21.5938],
         [18.3438, 17.6094, 18.6562, 20.4531, 19.6094]],

        [[23.2500, 21.5312, 21.5156, 24.4375, 21.5000],
         [24.4531, 22.3594, 21.7031, 25.1719, 21.0938],
         [23.2812, 21.2344, 21.3125, 24.6562, 21.3906],
         [20.5312, 18.5000, 17.8906, 22.2344, 18.7188]],

        [[23.6250, 21.0781, 21.6250, 23.1562, 22.2344],
         [24.4688, 21.4062, 22.9844, 23.2500, 24.0469],
         [22.3438, 19.6719, 20.2812, 22.2344, 22.2188],
         [20.8125, 18.3438, 21.2812, 21.5938, 22.5000]],

        [[16.6562, 15.7734, 18.1250, 17.9688, 16.4844],
         [18.9844, 17.5000, 20.2812, 18.9844, 16.7812],
         [16.2812, 15.3281, 18.3281, 18.0938, 17.0156],
         [19.0625, 17.2812, 20.0781, 19.9219, 18.2188]],

        [[22.3594, 21.8438, 22.0781, 22.5781, 23.0000],
         [24.0625, 23.8906, 22.7969, 23.8438, 23.7656],
         [21.8906, 21.7500, 22.1406, 23.5156, 22.9062],
         [20.6719, 21.4844, 19.9375, 22.7344, 20.7500]],

        [[23.8125, 24.2500, 23.9531, 25.6406, 25.5156],
         [24.2969, 24.5312, 24.0469, 25.7500, 24.1875],
         [23.1875, 23.5156, 23.2500, 25.5938, 24.7656],
         [19.4531, 19.8906, 20.2812, 23.0312, 20.5781]],

        [[19.3125, 17.9688, 18.1094, 21.4062, 19.0312],
         [19.5625, 18.2188, 17.1875, 20.9531, 18.0469],
         [16.0469, 15.1641, 15.1016, 19.4531, 16.5469],
         [15.7969, 14.6719, 13.9141, 18.8438, 15.4297]],

        [[22.1406, 22.3750, 23.6250, 25.5312, 23.1406],
         [22.7031, 22.6562, 24.1250, 25.4844, 21.5312],
         [20.7031, 20.9844, 22.4531, 25.6094, 22.1875],
         [17.5156, 17.4062, 20.3906, 21.7969, 18.0312]],

        [[21.3281, 21.1094, 21.3594, 23.1406, 22.3750],
         [20.7031, 20.8438, 20.6250, 22.4844, 20.0781],
         [20.2500, 19.8906, 20.6562, 22.9062, 21.3906],
         [15.1484, 15.5156, 15.6406, 18.4531, 16.5156]],

        [[17.1406, 16.5938, 16.6562, 18.3281, 16.3438],
         [18.8594, 17.5156, 17.2812, 18.4062, 15.9219],
         [16.5469, 15.9453, 16.2656, 18.2812, 16.8438],
         [16.4375, 15.0156, 16.0938, 16.7656, 14.6016]],

        [[22.5938, 20.8594, 22.9062, 23.9219, 22.4688],
         [22.9062, 21.0312, 23.8750, 24.3125, 21.5000],
         [21.2812, 19.5000, 21.8438, 23.5469, 21.1250],
         [17.3594, 15.9531, 20.3125, 20.9531, 17.8594]],

        [[21.8594, 22.1094, 21.9219, 24.2656, 21.3906],
         [23.4062, 23.9375, 23.2344, 25.5938, 21.7969],
         [20.3438, 20.2500, 20.3281, 23.0938, 20.1719],
         [19.2344, 20.4219, 19.3281, 22.3438, 20.0000]],

        [[24.0312, 20.5938, 19.5781, 23.5312, 21.7969],
         [27.4844, 24.5000, 22.8281, 27.0781, 24.6250],
         [22.8906, 20.4688, 19.4531, 23.7031, 22.1250],
         [24.1562, 22.7344, 21.7188, 26.0938, 22.9844]],

        [[18.8281, 18.9375, 18.9844, 19.9531, 18.1094],
         [21.2656, 20.8906, 19.9219, 20.2500, 19.1875],
         [16.9688, 17.3281, 17.4062, 18.1875, 16.4844],
         [16.0469, 16.0000, 15.0547, 16.9219, 15.5312]],

        [[20.6719, 19.8750, 19.3281, 20.5625, 19.9844],
         [19.7188, 18.3438, 17.8281, 19.0000, 17.1562],
         [18.6094, 18.1250, 17.8125, 19.7031, 18.2656],
         [17.3438, 15.4531, 15.1875, 17.6094, 14.6016]],

        [[21.8750, 20.5938, 21.5781, 22.5156, 22.0000],
         [22.0781, 20.6875, 21.6250, 22.4531, 21.5156],
         [20.9062, 19.5000, 20.9531, 22.2031, 21.5312],
         [17.8906, 16.6719, 16.5781, 19.3438, 18.3594]],

        [[20.1719, 18.6875, 18.5625, 18.7969, 19.5312],
         [23.4375, 21.0469, 20.4531, 20.6562, 20.2500],
         [21.1094, 19.5156, 19.1250, 20.3438, 20.6562],
         [22.9062, 20.6094, 19.9062, 21.6250, 20.4688]],

        [[22.8438, 20.8906, 23.2031, 25.3906, 22.6250],
         [22.5156, 20.9844, 22.4219, 25.7344, 20.7188],
         [22.1250, 19.7812, 22.3281, 25.8125, 21.9219],
         [16.8750, 15.6250, 17.6250, 22.8906, 16.8594]]], device='cuda:0',
       dtype=torch.float16, grad_fn=<ReshapeAliasBackward0>)
(Pdb) tensor([], device='cuda:0', size=(4, 0, 512), dtype=torch.float16,
       grad_fn=<DivBackward0>)
(Pdb) tensor([[[-0.0256, -0.0378,  0.0017,  ..., -0.0134, -0.0094,  0.0082],
         [-0.0179, -0.0333, -0.0170,  ..., -0.0094, -0.0110, -0.0285],
         [-0.0065, -0.0213,  0.0218,  ...,  0.0165,  0.0216,  0.0176],
         ...,
         [-0.0221, -0.0388,  0.0346,  ..., -0.0026, -0.0039,  0.0098],
         [ 0.0140, -0.0192,  0.0606,  ...,  0.0169, -0.0411, -0.0113],
         [ 0.0458, -0.0797, -0.0120,  ..., -0.0428, -0.0042, -0.0240]],

        [[-0.0193, -0.0359,  0.0147,  ...,  0.0078, -0.0302,  0.0341],
         [ 0.0093, -0.0005, -0.0079,  ...,  0.0268, -0.0316,  0.0041],
         [ 0.0026, -0.0040,  0.0218,  ...,  0.0203,  0.0013,  0.0610],
         ...,
         [-0.0186, -0.0010,  0.0139,  ..., -0.0009, -0.0163,  0.0307],
         [ 0.0051, -0.0054,  0.0388,  ...,  0.0229, -0.0575,  0.0103],
         [ 0.0434, -0.0263, -0.0298,  ..., -0.0201, -0.0169,  0.0109]],

        [[-0.0576, -0.0387, -0.0244,  ...,  0.0194, -0.0056,  0.0470],
         [-0.0266, -0.0431, -0.0454,  ...,  0.0399, -0.0221,  0.0285],
         [-0.0366, -0.0138, -0.0081,  ...,  0.0204,  0.0149,  0.0507],
         ...,
         [-0.0469, -0.0437,  0.0064,  ...,  0.0152, -0.0014,  0.0124],
         [-0.0214, -0.0189,  0.0145,  ...,  0.0525, -0.0110,  0.0152],
         [ 0.0097, -0.0475,  0.0142,  ..., -0.0055,  0.0110,  0.0183]],

        [[-0.0572, -0.0271,  0.0369,  ...,  0.0075, -0.0242,  0.0161],
         [-0.0482, -0.0169, -0.0124,  ...,  0.0145, -0.0081, -0.0149],
         [-0.0266, -0.0096,  0.0309,  ...,  0.0207,  0.0035,  0.0331],
         ...,
         [-0.0555, -0.0267,  0.0127,  ..., -0.0110,  0.0034,  0.0068],
         [-0.0255, -0.0072,  0.0615,  ...,  0.0247, -0.0319, -0.0052],
         [-0.0124, -0.0032,  0.0021,  ..., -0.0262,  0.0085, -0.0184]],

        [[ 0.0056, -0.0505,  0.0219,  ..., -0.0068, -0.0321,  0.0374],
         [-0.0363, -0.0199, -0.0267,  ...,  0.0065,  0.0084, -0.0387],
         [-0.0054, -0.0017,  0.0300,  ...,  0.0178,  0.0232,  0.0163],
         ...,
         [-0.0227,  0.0178, -0.0048,  ..., -0.0188, -0.0101, -0.0405],
         [-0.0029,  0.0043,  0.0524,  ...,  0.0319, -0.0341, -0.0327],
         [ 0.0414, -0.0016, -0.0043,  ..., -0.0400,  0.0207, -0.0486]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<DivBackward0>)
(Pdb) torch.Size([5, 24, 512])
(Pdb) tensor([], device='cuda:0', size=(4, 0, 512), dtype=torch.float16,
       grad_fn=<DivBackward0>)
(Pdb) (Pdb) tensor([], device='cuda:0', size=(4, 0, 512), dtype=torch.float16,
       grad_fn=<SliceBackward0>)
(Pdb) tensor([[[ 4.6948e-01, -3.4937e-01, -1.4758e-01,  ...,  3.1689e-01,
          -2.5830e-01,  9.0942e-02],
         [ 8.9050e-02, -1.4893e-02, -1.7822e-01,  ...,  1.0651e-01,
          -1.0345e-02, -2.9932e-01],
         [-3.4161e-03,  5.9723e-02, -1.1676e-01,  ...,  1.2482e-01,
           6.9885e-02, -1.4685e-01],
         ...,
         [ 4.2676e-01,  2.2095e-01, -1.6565e-01,  ...,  2.7783e-01,
          -9.1614e-02, -1.2323e-01],
         [-7.7515e-02, -7.8308e-02, -2.3315e-01,  ...,  1.6089e-01,
          -1.0284e-01, -3.5126e-02],
         [ 3.0688e-01,  2.1667e-01, -1.0992e-01,  ...,  1.3354e-01,
          -3.0225e-01, -1.2268e-01]],

        [[ 5.4346e-01, -4.8413e-01, -1.9775e-01,  ...,  4.3750e-01,
          -2.7686e-01,  8.6975e-02],
         [ 2.6660e-01, -1.8286e-01,  3.4180e-02,  ...,  8.5205e-02,
          -2.2937e-01, -2.4988e-01],
         [ 1.2238e-01, -6.3477e-02,  1.7493e-01,  ...,  8.8989e-02,
          -2.5665e-02, -4.8730e-01],
         ...,
         [ 3.6768e-01,  1.3684e-01, -8.9661e-02,  ...,  3.2666e-01,
          -4.5410e-02, -2.6709e-01],
         [-3.8177e-02, -3.8599e-01, -2.7368e-01,  ...,  1.0138e-01,
          -1.1969e-01, -1.2433e-01],
         [ 4.7144e-01, -2.8305e-02,  9.9304e-02,  ...,  2.3718e-01,
          -1.7346e-01, -2.2803e-01]],

        [[ 5.5029e-01, -3.2568e-01, -1.2915e-01,  ...,  3.3008e-01,
          -3.6133e-01,  4.0039e-02],
         [ 5.5176e-01,  1.9800e-01, -3.8574e-01,  ...,  1.1615e-01,
           1.2085e-01, -2.8662e-01],
         [-2.0630e-02, -1.5869e-01, -1.7578e-01,  ...,  1.1407e-01,
          -2.2510e-01, -2.9150e-01],
         ...,
         [ 4.1479e-01,  2.9858e-01, -7.5134e-02,  ...,  2.7490e-01,
          -1.5442e-01, -2.7515e-01],
         [ 7.6416e-02, -3.1763e-01, -2.3657e-01,  ...,  7.3303e-02,
          -1.9116e-01, -1.8237e-01],
         [ 4.0234e-01, -3.3813e-02, -9.4238e-02,  ...,  2.9278e-04,
          -3.8184e-01, -2.8687e-01]],

        [[ 5.0537e-01, -2.9297e-01, -2.4646e-01,  ...,  3.1909e-01,
          -3.4790e-01,  2.2107e-01],
         [ 5.4639e-01,  6.7444e-02,  1.0760e-01,  ...,  6.1768e-01,
           2.9004e-01, -1.4392e-01],
         [ 4.7455e-02,  2.3022e-01, -3.6073e-04,  ...,  3.6279e-01,
          -3.0908e-01,  2.1820e-02],
         ...,
         [ 5.4688e-01,  5.4138e-02, -8.5571e-02,  ...,  1.3647e-01,
          -6.6162e-02, -1.9861e-01],
         [ 1.2671e-01, -2.8760e-01, -2.8345e-01,  ..., -4.1016e-02,
          -1.5234e-01,  3.6774e-02],
         [ 4.5483e-01,  1.0468e-01, -2.1553e-03,  ...,  1.1816e-01,
          -2.9541e-01, -1.5564e-01]]], device='cuda:0', dtype=torch.float16,
       grad_fn=<UnsafeViewBackward0>)
(Pdb) tensor([], device='cuda:0', size=(4, 0, 512), dtype=torch.float16,
       grad_fn=<SliceBackward0>)
(Pdb) -24
(Pdb) 0
(Pdb) tensor([], device='cuda:0', size=(4, 0, 512), dtype=torch.float16,
       grad_fn=<SliceBackward0>)
(Pdb) *** SyntaxError: invalid syntax
(Pdb) tensor([[[ 6.3086e-01, -7.6172e-02, -9.4543e-02,  ...,  3.3203e-01,
           8.8623e-02, -1.8030e-01],
         [ 3.2153e-01,  6.5193e-03,  5.5817e-02,  ...,  3.2135e-02,
           1.0979e-02, -3.3112e-02],
         [ 2.3462e-01,  2.9834e-01, -7.3914e-02,  ...,  1.9397e-01,
          -1.5881e-01, -1.1420e-01],
         ...,
         [ 4.2676e-01,  2.2095e-01, -1.6565e-01,  ...,  2.7783e-01,
          -9.1614e-02, -1.2323e-01],
         [-7.7515e-02, -7.8308e-02, -2.3315e-01,  ...,  1.6089e-01,
          -1.0284e-01, -3.5126e-02],
         [ 3.0688e-01,  2.1667e-01, -1.0992e-01,  ...,  1.3354e-01,
          -3.0225e-01, -1.2268e-01]],

        [[ 6.4160e-01,  8.2520e-02, -6.1920e-02,  ...,  3.9893e-01,
           4.9164e-02, -2.9102e-01],
         [ 2.8979e-01,  1.3782e-01, -4.7708e-04,  ...,  2.5768e-03,
           2.8595e-02, -9.8633e-02],
         [ 2.0068e-01,  2.8369e-01, -1.5488e-02,  ...,  2.5073e-01,
          -1.6113e-01, -2.1863e-01],
         ...,
         [ 3.6768e-01,  1.3684e-01, -8.9661e-02,  ...,  3.2666e-01,
          -4.5410e-02, -2.6709e-01],
         [-3.8177e-02, -3.8599e-01, -2.7368e-01,  ...,  1.0138e-01,
          -1.1969e-01, -1.2433e-01],
         [ 4.7144e-01, -2.8305e-02,  9.9304e-02,  ...,  2.3718e-01,
          -1.7346e-01, -2.2803e-01]],

        [[ 6.4893e-01, -1.4305e-02,  1.4458e-03,  ...,  2.1802e-01,
          -3.8300e-02, -3.4766e-01],
         [ 2.2888e-01,  7.4341e-02, -1.4236e-02,  ..., -2.9358e-02,
          -1.1078e-02, -1.2817e-01],
         [ 3.6182e-01,  1.9788e-01, -7.3547e-02,  ...,  1.6016e-01,
          -2.0032e-01, -2.3218e-01],
         ...,
         [ 4.1479e-01,  2.9858e-01, -7.5134e-02,  ...,  2.7490e-01,
          -1.5442e-01, -2.7515e-01],
         [ 7.6416e-02, -3.1763e-01, -2.3657e-01,  ...,  7.3303e-02,
          -1.9116e-01, -1.8237e-01],
         [ 4.0234e-01, -3.3813e-02, -9.4238e-02,  ...,  2.9278e-04,
          -3.8184e-01, -2.8687e-01]],

        [[ 6.6211e-01,  6.3660e-02,  2.7142e-03,  ...,  3.3105e-01,
           1.0461e-01, -3.3740e-01],
         [ 3.6743e-01,  1.0208e-02, -1.1177e-03,  ..., -8.8989e-02,
          -3.1067e-02, -1.7908e-01],
         [ 3.0640e-01,  3.7329e-01, -1.1426e-01,  ...,  9.1125e-02,
          -2.3840e-01, -8.7097e-02],
         ...,
         [ 5.4688e-01,  5.4138e-02, -8.5571e-02,  ...,  1.3647e-01,
          -6.6162e-02, -1.9861e-01],
         [ 1.2671e-01, -2.8760e-01, -2.8345e-01,  ..., -4.1016e-02,
          -1.5234e-01,  3.6774e-02],
         [ 4.5483e-01,  1.0468e-01, -2.1553e-03,  ...,  1.1816e-01,
          -2.9541e-01, -1.5564e-01]]], device='cuda:0', dtype=torch.float16,
       grad_fn=<SliceBackward0>)
(Pdb) torch.Size([4, 24, 512])
(Pdb) tensor([[[-0.0256, -0.0378,  0.0017,  ..., -0.0134, -0.0094,  0.0082],
         [-0.0179, -0.0333, -0.0170,  ..., -0.0094, -0.0110, -0.0285],
         [-0.0065, -0.0213,  0.0218,  ...,  0.0165,  0.0216,  0.0176],
         ...,
         [-0.0221, -0.0388,  0.0346,  ..., -0.0026, -0.0039,  0.0098],
         [ 0.0140, -0.0192,  0.0606,  ...,  0.0169, -0.0411, -0.0113],
         [ 0.0458, -0.0797, -0.0120,  ..., -0.0428, -0.0042, -0.0240]],

        [[-0.0193, -0.0359,  0.0147,  ...,  0.0078, -0.0302,  0.0341],
         [ 0.0093, -0.0005, -0.0079,  ...,  0.0268, -0.0316,  0.0041],
         [ 0.0026, -0.0040,  0.0218,  ...,  0.0203,  0.0013,  0.0610],
         ...,
         [-0.0186, -0.0010,  0.0139,  ..., -0.0009, -0.0163,  0.0307],
         [ 0.0051, -0.0054,  0.0388,  ...,  0.0229, -0.0575,  0.0103],
         [ 0.0434, -0.0263, -0.0298,  ..., -0.0201, -0.0169,  0.0109]],

        [[-0.0576, -0.0387, -0.0244,  ...,  0.0194, -0.0056,  0.0470],
         [-0.0266, -0.0431, -0.0454,  ...,  0.0399, -0.0221,  0.0285],
         [-0.0366, -0.0138, -0.0081,  ...,  0.0204,  0.0149,  0.0507],
         ...,
         [-0.0469, -0.0437,  0.0064,  ...,  0.0152, -0.0014,  0.0124],
         [-0.0214, -0.0189,  0.0145,  ...,  0.0525, -0.0110,  0.0152],
         [ 0.0097, -0.0475,  0.0142,  ..., -0.0055,  0.0110,  0.0183]],

        [[-0.0572, -0.0271,  0.0369,  ...,  0.0075, -0.0242,  0.0161],
         [-0.0482, -0.0169, -0.0124,  ...,  0.0145, -0.0081, -0.0149],
         [-0.0266, -0.0096,  0.0309,  ...,  0.0207,  0.0035,  0.0331],
         ...,
         [-0.0555, -0.0267,  0.0127,  ..., -0.0110,  0.0034,  0.0068],
         [-0.0255, -0.0072,  0.0615,  ...,  0.0247, -0.0319, -0.0052],
         [-0.0124, -0.0032,  0.0021,  ..., -0.0262,  0.0085, -0.0184]],

        [[ 0.0056, -0.0505,  0.0219,  ..., -0.0068, -0.0321,  0.0374],
         [-0.0363, -0.0199, -0.0267,  ...,  0.0065,  0.0084, -0.0387],
         [-0.0054, -0.0017,  0.0300,  ...,  0.0178,  0.0232,  0.0163],
         ...,
         [-0.0227,  0.0178, -0.0048,  ..., -0.0188, -0.0101, -0.0405],
         [-0.0029,  0.0043,  0.0524,  ...,  0.0319, -0.0341, -0.0327],
         [ 0.0414, -0.0016, -0.0043,  ..., -0.0400,  0.0207, -0.0486]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<DivBackward0>)
(Pdb) torch.Size([5, 24, 512])
(Pdb) --KeyboardInterrupt--
(Pdb) 
