set -e
set -x

eval "$(conda shell.bash hook)"
++ conda shell.bash hook
+ eval 'export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\''

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause
__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We'\''re not allowing PS1 to be unbound. It must at least be set.
    # However, we'\''re not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi

conda activate base'
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
++ export _CE_M=
++ _CE_M=
export _CE_CONDA=''
++ export _CE_CONDA=
++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python

# Copyright (C) 2012 Anaconda, Inc
# SPDX-License-Identifier: BSD-3-Clause
__conda_exe() (
    "$CONDA_EXE" $_CE_M $_CE_CONDA "$@"
)

__conda_hashr() {
    if [ -n "${ZSH_VERSION:+x}" ]; then
        \rehash
    elif [ -n "${POSH_VERSION:+x}" ]; then
        :  # pass
    else
        \hash -r
    fi
}

__conda_activate() {
    if [ -n "${CONDA_PS1_BACKUP:+x}" ]; then
        # Handle transition from shell activated with conda <= 4.3 to a subsequent activation
        # after conda updated to >= 4.4. See issue #6173.
        PS1="$CONDA_PS1_BACKUP"
        \unset CONDA_PS1_BACKUP
    fi
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix "$@")" || \return
    \eval "$ask_conda"
    __conda_hashr
}

__conda_reactivate() {
    \local ask_conda
    ask_conda="$(PS1="${PS1:-}" __conda_exe shell.posix reactivate)" || \return
    \eval "$ask_conda"
    __conda_hashr
}

conda() {
    \local cmd="${1-__missing__}"
    case "$cmd" in
        activate|deactivate)
            __conda_activate "$@"
            ;;
        install|update|upgrade|remove|uninstall)
            __conda_exe "$@" || \return
            __conda_reactivate
            ;;
        *)
            __conda_exe "$@"
            ;;
    esac
}

if [ -z "${CONDA_SHLVL+x}" ]; then
    \export CONDA_SHLVL=0
    # In dev-mode CONDA_EXE is python.exe and on Windows
    # it is in a different relative location to condabin.
    if [ -n "${_CE_CONDA:+x}" ] && [ -n "${WINDIR+x}" ]; then
        PATH="$(\dirname "$CONDA_EXE")/condabin${PATH:+":${PATH}"}"
    else
        PATH="$(\dirname "$(\dirname "$CONDA_EXE")")/condabin${PATH:+":${PATH}"}"
    fi
    \export PATH

    # We're not allowing PS1 to be unbound. It must at least be set.
    # However, we're not exporting it, which can cause problems when starting a second shell
    # via a first shell (i.e. starting zsh from bash).
    if [ -z "${PS1+x}" ]; then
        PS1=
    fi
fi
++ '[' -z x ']'

conda activate base
++ conda activate base
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate base
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate base
+++ /home/s2/mjoolee/anaconda/bin/conda shell.posix activate base
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
PS1='(base) '
+++ PS1='(base) '
export PATH='/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'
+++ export PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+++ PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
export CONDA_PREFIX='/home/s2/mjoolee/anaconda'
+++ export CONDA_PREFIX=/home/s2/mjoolee/anaconda
+++ CONDA_PREFIX=/home/s2/mjoolee/anaconda
export CONDA_SHLVL='3'
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
export CONDA_DEFAULT_ENV='base'
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
export CONDA_PROMPT_MODIFIER='(base) '
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
export CONDA_PREFIX_2='/home/s2/mjoolee/anaconda/envs/dassl'
+++ export CONDA_PREFIX_2=/home/s2/mjoolee/anaconda/envs/dassl
+++ CONDA_PREFIX_2=/home/s2/mjoolee/anaconda/envs/dassl
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
+++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
+++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
+++ export _CE_M=
+++ _CE_M=
export _CE_CONDA=''
+++ export _CE_CONDA=
+++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
+++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
+++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
conda activate dassl
+ conda activate dassl
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate dassl
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate dassl
++ /home/s2/mjoolee/anaconda/bin/conda shell.posix activate dassl
+ ask_conda='PS1='\''(dassl) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''dassl'\''
export CONDA_PROMPT_MODIFIER='\''(dassl) '\''
export CONDA_PREFIX_3='\''/home/s2/mjoolee/anaconda'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
+ eval 'PS1='\''(dassl) '\''
export PATH='\''/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'\''
export CONDA_PREFIX='\''/home/s2/mjoolee/anaconda/envs/dassl'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''dassl'\''
export CONDA_PROMPT_MODIFIER='\''(dassl) '\''
export CONDA_PREFIX_3='\''/home/s2/mjoolee/anaconda'\''
export CONDA_EXE='\''/home/s2/mjoolee/anaconda/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/s2/mjoolee/anaconda/bin/python'\'''
PS1='(dassl) '
++ PS1='(dassl) '
export PATH='/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin'
++ export PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
++ PATH=/home/s2/mjoolee/.vscode-server/cli/servers/Stable-903b1e9d8990623e3d7da1df3d33db3e42d80eda/server/bin/remote-cli:/home/s2/mjoolee/anaconda/envs/dassl/bin:/home/s2/mjoolee/anaconda/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
export CONDA_PREFIX='/home/s2/mjoolee/anaconda/envs/dassl'
++ export CONDA_PREFIX=/home/s2/mjoolee/anaconda/envs/dassl
++ CONDA_PREFIX=/home/s2/mjoolee/anaconda/envs/dassl
export CONDA_SHLVL='4'
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
export CONDA_DEFAULT_ENV='dassl'
++ export CONDA_DEFAULT_ENV=dassl
++ CONDA_DEFAULT_ENV=dassl
export CONDA_PROMPT_MODIFIER='(dassl) '
++ export 'CONDA_PROMPT_MODIFIER=(dassl) '
++ CONDA_PROMPT_MODIFIER='(dassl) '
export CONDA_PREFIX_3='/home/s2/mjoolee/anaconda'
++ export CONDA_PREFIX_3=/home/s2/mjoolee/anaconda
++ CONDA_PREFIX_3=/home/s2/mjoolee/anaconda
export CONDA_EXE='/home/s2/mjoolee/anaconda/bin/conda'
++ export CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
++ CONDA_EXE=/home/s2/mjoolee/anaconda/bin/conda
export _CE_M=''
++ export _CE_M=
++ _CE_M=
export _CE_CONDA=''
++ export _CE_CONDA=
++ _CE_CONDA=
export CONDA_PYTHON_EXE='/home/s2/mjoolee/anaconda/bin/python'
++ export CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
++ CONDA_PYTHON_EXE=/home/s2/mjoolee/anaconda/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r

GPU=0
+ GPU=0
SHOT=16
+ SHOT=16

for dataset in eurosat dtd fgvc_aircraft oxford_flowers
do
    for seed in 1 2 3
    do
    sh scripts/rpo_prime/base2new_train_sdl.sh ${dataset} ${seed} ${GPU} main_tmp1_0.1sdl ${SHOT}
    #sh scripts/rpo_prime/base2new_test.sh ${dataset} ${seed} ${GPU} main_9_9 ${SHOT} base
    sh scripts/rpo_prime/base2new_test_sdl.sh ${dataset} ${seed} ${GPU} main_tmp1_0.1sdl ${SHOT} new
    done
done
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh eurosat 1 0 main_tmp1_0.1sdl 16
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE BASE CLASSES!
80 2800 4200
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,800
# test     4,200
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [1/1] time 3.325 (3.325) data 1.171 (1.171) loss 1.0986 (1.0986) lr 9.9901e-02 eta 0:02:42
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:40,  2.88s/it] 13%|█▎        | 2/15 [00:03<00:17,  1.35s/it] 20%|██        | 3/15 [00:03<00:10,  1.16it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.58it/s] 33%|███▎      | 5/15 [00:04<00:05,  1.97it/s] 40%|████      | 6/15 [00:04<00:03,  2.32it/s] 47%|████▋     | 7/15 [00:04<00:03,  2.62it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.85it/s] 60%|██████    | 9/15 [00:05<00:01,  3.04it/s] 67%|██████▋   | 10/15 [00:05<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:06<00:00,  3.41it/s] 93%|█████████▎| 14/15 [00:06<00:00,  3.45it/s]100%|██████████| 15/15 [00:06<00:00,  2.21it/s]=> result
* total: 2,800
* correct: 1,724
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 60.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [2/50] batch [1/1] time 1.159 (1.159) data 0.669 (0.669) loss 1.0205 (1.0205) lr 9.9606e-02 eta 0:00:55
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.79s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.31it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.38it/s] 80%|████████  | 12/15 [00:04<00:00,  3.43it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.47it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.49it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 1,725
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 57.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [3/50] batch [1/1] time 1.166 (1.166) data 0.662 (0.662) loss 0.8213 (0.8213) lr 9.9114e-02 eta 0:00:54
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.68s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.58it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.68it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:04<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.30it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.36it/s] 80%|████████  | 12/15 [00:04<00:00,  3.41it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.45it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.47it/s]100%|██████████| 15/15 [00:05<00:00,  4.32it/s]100%|██████████| 15/15 [00:05<00:00,  2.63it/s]=> result
* total: 2,800
* correct: 1,753
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 58.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [4/50] batch [1/1] time 1.243 (1.243) data 0.722 (0.722) loss 0.8091 (0.8091) lr 9.8429e-02 eta 0:00:57
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.98s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.94it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.05it/s] 60%|██████    | 9/15 [00:04<00:01,  3.18it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.28it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.35it/s] 80%|████████  | 12/15 [00:05<00:00,  3.41it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.45it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.48it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 1,752
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 58.5%

epoch [5/50] batch [1/1] time 1.169 (1.169) data 0.670 (0.670) loss 0.7476 (0.7476) lr 9.7553e-02 eta 0:00:52
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.60s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.12it/s] 20%|██        | 3/15 [00:02<00:07,  1.62it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.43it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.93it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:03<00:01,  3.22it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.31it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.38it/s] 80%|████████  | 12/15 [00:04<00:00,  3.37it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.41it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.45it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 1,775
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 60.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [6/50] batch [1/1] time 1.207 (1.207) data 0.698 (0.698) loss 0.7642 (0.7642) lr 9.6489e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.90s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it] 20%|██        | 3/15 [00:02<00:08,  1.46it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.90it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:04<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.16it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.27it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.33it/s] 80%|████████  | 12/15 [00:05<00:00,  3.39it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.42it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.44it/s]100%|██████████| 15/15 [00:05<00:00,  4.29it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 1,821
* accuracy: 65.0%
* error: 35.0%
* macro_f1: 63.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [7/50] batch [1/1] time 1.309 (1.309) data 0.747 (0.747) loss 0.6924 (0.6924) lr 9.5241e-02 eta 0:00:56
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.88s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.01s/it] 20%|██        | 3/15 [00:02<00:08,  1.47it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.91it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.27it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.34it/s] 80%|████████  | 12/15 [00:05<00:00,  3.39it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.43it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.46it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 1,879
* accuracy: 67.1%
* error: 32.9%
* macro_f1: 67.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [8/50] batch [1/1] time 1.405 (1.405) data 0.778 (0.778) loss 0.7041 (0.7041) lr 9.3815e-02 eta 0:00:58
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.13s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.44it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.87it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.57it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:04<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.26it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.34it/s] 80%|████████  | 12/15 [00:05<00:00,  3.39it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.43it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.45it/s]100%|██████████| 15/15 [00:05<00:00,  4.30it/s]100%|██████████| 15/15 [00:06<00:00,  2.48it/s]=> result
* total: 2,800
* correct: 1,869
* accuracy: 66.8%
* error: 33.2%
* macro_f1: 64.7%

epoch [9/50] batch [1/1] time 1.190 (1.190) data 0.683 (0.683) loss 0.5723 (0.5723) lr 9.2216e-02 eta 0:00:48
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.12s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.44it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.88it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:04<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.17it/s]100%|██████████| 15/15 [00:06<00:00,  2.46it/s]=> result
* total: 2,800
* correct: 1,894
* accuracy: 67.6%
* error: 32.4%
* macro_f1: 66.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [10/50] batch [1/1] time 1.167 (1.167) data 0.669 (0.669) loss 0.6641 (0.6641) lr 9.0451e-02 eta 0:00:46
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.81s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.88it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.06it/s] 60%|██████    | 9/15 [00:04<00:01,  3.18it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.28it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.35it/s] 80%|████████  | 12/15 [00:05<00:00,  3.40it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.43it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.46it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 1,939
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 68.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-10

epoch [11/50] batch [1/1] time 1.199 (1.199) data 0.698 (0.698) loss 0.5757 (0.5757) lr 8.8526e-02 eta 0:00:46
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.85s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.05it/s] 60%|██████    | 9/15 [00:04<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.27it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.33it/s] 80%|████████  | 12/15 [00:05<00:00,  3.38it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.41it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.43it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 1,940
* accuracy: 69.3%
* error: 30.7%
* macro_f1: 68.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [12/50] batch [1/1] time 1.216 (1.216) data 0.712 (0.712) loss 0.5493 (0.5493) lr 8.6448e-02 eta 0:00:46
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.11s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.44it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.88it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.25it/s] 80%|████████  | 12/15 [00:05<00:00,  3.29it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.18it/s]100%|██████████| 15/15 [00:06<00:00,  2.46it/s]=> result
* total: 2,800
* correct: 1,943
* accuracy: 69.4%
* error: 30.6%
* macro_f1: 67.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [13/50] batch [1/1] time 1.120 (1.120) data 0.627 (0.627) loss 0.5928 (0.5928) lr 8.4227e-02 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.53s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.15it/s] 20%|██        | 3/15 [00:02<00:07,  1.66it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.10it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.46it/s] 40%|████      | 6/15 [00:03<00:03,  2.73it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.95it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.10it/s] 60%|██████    | 9/15 [00:03<00:01,  3.21it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.30it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.35it/s] 80%|████████  | 12/15 [00:04<00:00,  3.40it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.42it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.45it/s]100%|██████████| 15/15 [00:05<00:00,  2.70it/s]=> result
* total: 2,800
* correct: 1,974
* accuracy: 70.5%
* error: 29.5%
* macro_f1: 69.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [14/50] batch [1/1] time 1.196 (1.196) data 0.696 (0.696) loss 0.5146 (0.5146) lr 8.1871e-02 eta 0:00:43
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.79s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.89it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.06it/s] 60%|██████    | 9/15 [00:04<00:01,  3.18it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.27it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.34it/s] 80%|████████  | 12/15 [00:04<00:00,  3.37it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.42it/s]100%|██████████| 15/15 [00:05<00:00,  4.26it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,052
* accuracy: 73.3%
* error: 26.7%
* macro_f1: 72.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [15/50] batch [1/1] time 1.182 (1.182) data 0.676 (0.676) loss 0.4858 (0.4858) lr 7.9389e-02 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.51it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,096
* accuracy: 74.9%
* error: 25.1%
* macro_f1: 74.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [16/50] batch [1/1] time 1.186 (1.186) data 0.689 (0.689) loss 0.5142 (0.5142) lr 7.6791e-02 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.56s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.14it/s] 20%|██        | 3/15 [00:02<00:07,  1.63it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.71it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.08it/s] 60%|██████    | 9/15 [00:03<00:01,  3.20it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.29it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.35it/s] 80%|████████  | 12/15 [00:04<00:00,  3.39it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.42it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.44it/s]100%|██████████| 15/15 [00:05<00:00,  2.67it/s]=> result
* total: 2,800
* correct: 2,146
* accuracy: 76.6%
* error: 23.4%
* macro_f1: 76.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [17/50] batch [1/1] time 1.231 (1.231) data 0.720 (0.720) loss 0.4487 (0.4487) lr 7.4088e-02 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.68s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:05<00:00,  3.36it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  4.25it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,188
* accuracy: 78.1%
* error: 21.9%
* macro_f1: 77.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [18/50] batch [1/1] time 1.248 (1.248) data 0.739 (0.739) loss 0.4712 (0.4712) lr 7.1289e-02 eta 0:00:39
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.42it/s]100%|██████████| 15/15 [00:05<00:00,  4.26it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 2,209
* accuracy: 78.9%
* error: 21.1%
* macro_f1: 78.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [19/50] batch [1/1] time 1.195 (1.195) data 0.694 (0.694) loss 0.3394 (0.3394) lr 6.8406e-02 eta 0:00:37
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.04it/s] 60%|██████    | 9/15 [00:04<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.26it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.33it/s] 80%|████████  | 12/15 [00:05<00:00,  3.37it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.41it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.43it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,249
* accuracy: 80.3%
* error: 19.7%
* macro_f1: 80.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [20/50] batch [1/1] time 1.182 (1.182) data 0.682 (0.682) loss 0.4658 (0.4658) lr 6.5451e-02 eta 0:00:35
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.54s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.25it/s] 80%|████████  | 12/15 [00:04<00:00,  3.29it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.32it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.16it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 2,216
* accuracy: 79.1%
* error: 20.9%
* macro_f1: 78.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-20

epoch [21/50] batch [1/1] time 1.209 (1.209) data 0.712 (0.712) loss 0.4897 (0.4897) lr 6.2434e-02 eta 0:00:35
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.61s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:04<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.16it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 2,275
* accuracy: 81.2%
* error: 18.8%
* macro_f1: 81.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [22/50] batch [1/1] time 1.201 (1.201) data 0.708 (0.708) loss 0.3286 (0.3286) lr 5.9369e-02 eta 0:00:33
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.60s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.12it/s] 20%|██        | 3/15 [00:02<00:07,  1.62it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.40it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.07it/s] 60%|██████    | 9/15 [00:04<00:01,  3.18it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.27it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.33it/s] 80%|████████  | 12/15 [00:04<00:00,  3.37it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.40it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.42it/s]100%|██████████| 15/15 [00:05<00:00,  4.27it/s]100%|██████████| 15/15 [00:05<00:00,  2.64it/s]=> result
* total: 2,800
* correct: 2,164
* accuracy: 77.3%
* error: 22.7%
* macro_f1: 77.1%

epoch [23/50] batch [1/1] time 1.163 (1.163) data 0.665 (0.665) loss 0.3457 (0.3457) lr 5.6267e-02 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.90s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.30it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.17it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.24it/s] 80%|████████  | 12/15 [00:05<00:00,  3.28it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.31it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.34it/s]100%|██████████| 15/15 [00:05<00:00,  4.16it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 2,301
* accuracy: 82.2%
* error: 17.8%
* macro_f1: 82.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [24/50] batch [1/1] time 1.207 (1.207) data 0.701 (0.701) loss 0.2651 (0.2651) lr 5.3140e-02 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.65s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  4.25it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,356
* accuracy: 84.1%
* error: 15.9%
* macro_f1: 84.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [25/50] batch [1/1] time 1.144 (1.144) data 0.644 (0.644) loss 0.3267 (0.3267) lr 5.0000e-02 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.55s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.36it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.42it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 2,363
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 84.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [26/50] batch [1/1] time 1.171 (1.171) data 0.672 (0.672) loss 0.3647 (0.3647) lr 4.6860e-02 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.66s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.58it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 2,330
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 83.3%

epoch [27/50] batch [1/1] time 1.178 (1.178) data 0.680 (0.680) loss 0.3125 (0.3125) lr 4.3733e-02 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.68s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.36it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,377
* accuracy: 84.9%
* error: 15.1%
* macro_f1: 84.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [28/50] batch [1/1] time 1.156 (1.156) data 0.652 (0.652) loss 0.3169 (0.3169) lr 4.0631e-02 eta 0:00:25
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.58s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.62it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.07it/s] 60%|██████    | 9/15 [00:04<00:01,  3.18it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.26it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.32it/s] 80%|████████  | 12/15 [00:04<00:00,  3.36it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  4.25it/s]100%|██████████| 15/15 [00:05<00:00,  2.65it/s]=> result
* total: 2,800
* correct: 2,368
* accuracy: 84.6%
* error: 15.4%
* macro_f1: 84.5%

epoch [29/50] batch [1/1] time 1.166 (1.166) data 0.667 (0.667) loss 0.2983 (0.2983) lr 3.7566e-02 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.89s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.94it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,368
* accuracy: 84.6%
* error: 15.4%
* macro_f1: 84.4%

epoch [30/50] batch [1/1] time 1.188 (1.188) data 0.686 (0.686) loss 0.3291 (0.3291) lr 3.4549e-02 eta 0:00:23
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.96s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.00s/it] 20%|██        | 3/15 [00:02<00:08,  1.47it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.90it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s] 40%|████      | 6/15 [00:03<00:03,  2.57it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.50it/s]=> result
* total: 2,800
* correct: 2,349
* accuracy: 83.9%
* error: 16.1%
* macro_f1: 83.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-30

epoch [31/50] batch [1/1] time 1.166 (1.166) data 0.667 (0.667) loss 0.2793 (0.2793) lr 3.1594e-02 eta 0:00:22
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.96s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 2,395
* accuracy: 85.5%
* error: 14.5%
* macro_f1: 85.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [32/50] batch [1/1] time 1.175 (1.175) data 0.677 (0.677) loss 0.2568 (0.2568) lr 2.8711e-02 eta 0:00:21
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.90s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 2,343
* accuracy: 83.7%
* error: 16.3%
* macro_f1: 83.5%

epoch [33/50] batch [1/1] time 1.184 (1.184) data 0.681 (0.681) loss 0.2456 (0.2456) lr 2.5912e-02 eta 0:00:20
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.06s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.03s/it] 20%|██        | 3/15 [00:02<00:08,  1.45it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.88it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:06<00:00,  2.47it/s]=> result
* total: 2,800
* correct: 2,378
* accuracy: 84.9%
* error: 15.1%
* macro_f1: 84.7%

epoch [34/50] batch [1/1] time 1.181 (1.181) data 0.687 (0.687) loss 0.1904 (0.1904) lr 2.3209e-02 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  2.00s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:04<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 2,400
* accuracy: 85.7%
* error: 14.3%
* macro_f1: 85.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [35/50] batch [1/1] time 1.184 (1.184) data 0.679 (0.679) loss 0.2485 (0.2485) lr 2.0611e-02 eta 0:00:17
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.67s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:04<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,362
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 84.3%

epoch [36/50] batch [1/1] time 1.190 (1.190) data 0.688 (0.688) loss 0.2734 (0.2734) lr 1.8129e-02 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.04s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it] 20%|██        | 3/15 [00:02<00:08,  1.46it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.89it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:06<00:00,  2.48it/s]=> result
* total: 2,800
* correct: 2,331
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 83.2%

epoch [37/50] batch [1/1] time 1.180 (1.180) data 0.681 (0.681) loss 0.2695 (0.2695) lr 1.5773e-02 eta 0:00:15
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.74s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,398
* accuracy: 85.6%
* error: 14.4%
* macro_f1: 85.4%

epoch [38/50] batch [1/1] time 1.208 (1.208) data 0.707 (0.707) loss 0.2915 (0.2915) lr 1.3552e-02 eta 0:00:14
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.84s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.00it/s] 20%|██        | 3/15 [00:02<00:08,  1.48it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.91it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s] 40%|████      | 6/15 [00:03<00:03,  2.57it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 2,396
* accuracy: 85.6%
* error: 14.4%
* macro_f1: 85.3%

epoch [39/50] batch [1/1] time 1.249 (1.249) data 0.730 (0.730) loss 0.1899 (0.1899) lr 1.1474e-02 eta 0:00:13
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.96s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.03s/it] 20%|██        | 3/15 [00:02<00:08,  1.45it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.88it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:06<00:00,  2.48it/s]=> result
* total: 2,800
* correct: 2,398
* accuracy: 85.6%
* error: 14.4%
* macro_f1: 85.4%

epoch [40/50] batch [1/1] time 1.146 (1.146) data 0.650 (0.650) loss 0.1899 (0.1899) lr 9.5492e-03 eta 0:00:11
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.00it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:06<00:00,  2.50it/s]=> result
* total: 2,800
* correct: 2,395
* accuracy: 85.5%
* error: 14.5%
* macro_f1: 85.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-40

epoch [41/50] batch [1/1] time 1.153 (1.153) data 0.642 (0.642) loss 0.1880 (0.1880) lr 7.7836e-03 eta 0:00:10
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.59s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 2,409
* accuracy: 86.0%
* error: 14.0%
* macro_f1: 85.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [42/50] batch [1/1] time 1.225 (1.225) data 0.700 (0.700) loss 0.2368 (0.2368) lr 6.1847e-03 eta 0:00:09
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.62s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.03it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.39it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.88it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.04it/s] 60%|██████    | 9/15 [00:04<00:01,  3.16it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 2,407
* accuracy: 86.0%
* error: 14.0%
* macro_f1: 85.8%

epoch [43/50] batch [1/1] time 1.143 (1.143) data 0.645 (0.645) loss 0.1562 (0.1562) lr 4.7586e-03 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.83s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,412
* accuracy: 86.1%
* error: 13.9%
* macro_f1: 86.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [44/50] batch [1/1] time 1.186 (1.186) data 0.676 (0.676) loss 0.2886 (0.2886) lr 3.5112e-03 eta 0:00:07
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.61s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:04<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.17it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,414
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [45/50] batch [1/1] time 1.264 (1.264) data 0.730 (0.730) loss 0.1987 (0.1987) lr 2.4472e-03 eta 0:00:06
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.93s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 2,413
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.0%

epoch [46/50] batch [1/1] time 1.176 (1.176) data 0.661 (0.661) loss 0.2388 (0.2388) lr 1.5708e-03 eta 0:00:04
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.75s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,414
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%

epoch [47/50] batch [1/1] time 1.219 (1.219) data 0.689 (0.689) loss 0.1978 (0.1978) lr 8.8564e-04 eta 0:00:03
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.64s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:04<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,415
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [48/50] batch [1/1] time 1.214 (1.214) data 0.699 (0.699) loss 0.2109 (0.2109) lr 3.9426e-04 eta 0:00:02
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.00s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.00s/it] 20%|██        | 3/15 [00:02<00:08,  1.48it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.91it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  4.24it/s]100%|██████████| 15/15 [00:05<00:00,  2.50it/s]=> result
* total: 2,800
* correct: 2,415
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%

epoch [49/50] batch [1/1] time 1.172 (1.172) data 0.658 (0.658) loss 0.2500 (0.2500) lr 9.8664e-05 eta 0:00:01
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.70s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,415
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%

epoch [50/50] batch [1/1] time 1.195 (1.195) data 0.667 (0.667) loss 0.2588 (0.2588) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.69s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.25it/s] 80%|████████  | 12/15 [00:05<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]
=> result
* total: 2,800
* correct: 2,414
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 47)
Evaluate on the *test* set
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:01<00:38,  1.83s/it]  9%|▉         | 2/22 [00:02<00:20,  1.01s/it] 14%|█▎        | 3/22 [00:02<00:15,  1.25it/s] 18%|█▊        | 4/22 [00:03<00:11,  1.51it/s] 23%|██▎       | 5/22 [00:03<00:08,  1.89it/s] 27%|██▋       | 6/22 [00:03<00:07,  2.23it/s] 32%|███▏      | 7/22 [00:04<00:05,  2.52it/s] 36%|███▋      | 8/22 [00:04<00:05,  2.75it/s] 41%|████      | 9/22 [00:04<00:04,  2.94it/s] 45%|████▌     | 10/22 [00:05<00:03,  3.08it/s] 50%|█████     | 11/22 [00:05<00:03,  3.18it/s] 55%|█████▍    | 12/22 [00:05<00:03,  3.26it/s] 59%|█████▉    | 13/22 [00:05<00:02,  3.32it/s] 64%|██████▎   | 14/22 [00:06<00:02,  3.36it/s] 68%|██████▊   | 15/22 [00:06<00:02,  3.38it/s] 73%|███████▎  | 16/22 [00:06<00:01,  3.40it/s] 77%|███████▋  | 17/22 [00:07<00:01,  3.41it/s] 82%|████████▏ | 18/22 [00:07<00:01,  3.42it/s] 86%|████████▋ | 19/22 [00:07<00:00,  3.42it/s] 91%|█████████ | 20/22 [00:07<00:00,  3.43it/s] 95%|█████████▌| 21/22 [00:08<00:00,  3.43it/s]100%|██████████| 22/22 [00:08<00:00,  4.07it/s]100%|██████████| 22/22 [00:08<00:00,  2.60it/s]
=> result
* total: 4,200
* correct: 3,637
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 86.4%
Elapsed: 0:06:10
+ sh scripts/rpo_prime/base2new_test_sdl.sh eurosat 1 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE NEW CLASSES!
80 2600 3900
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,600
# test     3,900
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 47)
Evaluate on the *test* set
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:05<01:36,  5.09s/it] 10%|█         | 2/20 [00:05<00:40,  2.26s/it] 15%|█▌        | 3/20 [00:05<00:23,  1.36s/it] 20%|██        | 4/20 [00:05<00:15,  1.07it/s] 25%|██▌       | 5/20 [00:06<00:10,  1.42it/s] 30%|███       | 6/20 [00:06<00:07,  1.78it/s] 35%|███▌      | 7/20 [00:06<00:06,  2.11it/s] 40%|████      | 8/20 [00:07<00:04,  2.41it/s] 45%|████▌     | 9/20 [00:07<00:04,  2.66it/s] 50%|█████     | 10/20 [00:07<00:03,  2.86it/s] 55%|█████▌    | 11/20 [00:07<00:02,  3.02it/s] 60%|██████    | 12/20 [00:08<00:02,  3.12it/s] 65%|██████▌   | 13/20 [00:08<00:02,  3.20it/s] 70%|███████   | 14/20 [00:08<00:01,  3.26it/s] 75%|███████▌  | 15/20 [00:09<00:01,  3.32it/s] 80%|████████  | 16/20 [00:09<00:01,  3.35it/s] 85%|████████▌ | 17/20 [00:09<00:00,  3.38it/s] 90%|█████████ | 18/20 [00:10<00:00,  3.40it/s] 95%|█████████▌| 19/20 [00:10<00:00,  3.42it/s]100%|██████████| 20/20 [00:10<00:00,  3.53it/s]100%|██████████| 20/20 [00:10<00:00,  1.88it/s]
=> result
* total: 3,900
* correct: 2,267
* accuracy: 58.1%
* error: 41.9%
* macro_f1: 56.1%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh eurosat 2 0 main_tmp1_0.1sdl 16
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE BASE CLASSES!
80 2800 4200
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,800
# test     4,200
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [1/1] time 3.047 (3.047) data 1.115 (1.115) loss 1.2148 (1.2148) lr 9.9901e-02 eta 0:02:29
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.08s/it] 13%|█▎        | 2/15 [00:02<00:16,  1.25s/it] 20%|██        | 3/15 [00:03<00:09,  1.23it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.65it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.04it/s] 40%|████      | 6/15 [00:03<00:03,  2.37it/s] 47%|████▋     | 7/15 [00:04<00:03,  2.64it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.86it/s] 60%|██████    | 9/15 [00:04<00:01,  3.03it/s] 67%|██████▋   | 10/15 [00:05<00:01,  3.15it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.22it/s] 80%|████████  | 12/15 [00:05<00:00,  3.29it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:06<00:00,  3.36it/s]100%|██████████| 15/15 [00:06<00:00,  4.11it/s]100%|██████████| 15/15 [00:06<00:00,  2.32it/s]=> result
* total: 2,800
* correct: 1,752
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 63.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [2/50] batch [1/1] time 1.237 (1.237) data 0.733 (0.733) loss 1.0850 (1.0850) lr 9.9606e-02 eta 0:00:59
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.03s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.01s/it] 20%|██        | 3/15 [00:02<00:08,  1.47it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.89it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.78it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.25it/s] 80%|████████  | 12/15 [00:05<00:00,  3.29it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.17it/s]100%|██████████| 15/15 [00:06<00:00,  2.48it/s]=> result
* total: 2,800
* correct: 1,674
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 59.2%

epoch [3/50] batch [1/1] time 1.167 (1.167) data 0.670 (0.670) loss 0.9370 (0.9370) lr 9.9114e-02 eta 0:00:54
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.70s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.16it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 1,725
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 61.7%

epoch [4/50] batch [1/1] time 1.163 (1.163) data 0.650 (0.650) loss 0.9209 (0.9209) lr 9.8429e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.06s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it] 20%|██        | 3/15 [00:02<00:08,  1.45it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.89it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:06<00:00,  2.47it/s]=> result
* total: 2,800
* correct: 1,767
* accuracy: 63.1%
* error: 36.9%
* macro_f1: 62.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [5/50] batch [1/1] time 1.169 (1.169) data 0.669 (0.669) loss 0.9268 (0.9268) lr 9.7553e-02 eta 0:00:52
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.64s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.88it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.04it/s] 60%|██████    | 9/15 [00:04<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.25it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.36it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 1,759
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 61.8%

epoch [6/50] batch [1/1] time 1.189 (1.189) data 0.680 (0.680) loss 0.8926 (0.8926) lr 9.6489e-02 eta 0:00:52
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.78s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 1,787
* accuracy: 63.8%
* error: 36.2%
* macro_f1: 63.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [7/50] batch [1/1] time 1.168 (1.168) data 0.663 (0.663) loss 0.8418 (0.8418) lr 9.5241e-02 eta 0:00:50
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.74s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.05s/it] 20%|██        | 3/15 [00:02<00:08,  1.42it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.85it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.22it/s] 40%|████      | 6/15 [00:03<00:03,  2.52it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.75it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.93it/s] 60%|██████    | 9/15 [00:04<00:01,  3.07it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.17it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.23it/s] 80%|████████  | 12/15 [00:05<00:00,  3.27it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.30it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.33it/s]100%|██████████| 15/15 [00:05<00:00,  4.14it/s]100%|██████████| 15/15 [00:06<00:00,  2.46it/s]=> result
* total: 2,800
* correct: 1,810
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 64.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [8/50] batch [1/1] time 1.390 (1.390) data 0.763 (0.763) loss 0.7798 (0.7798) lr 9.3815e-02 eta 0:00:58
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 1,823
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 64.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [9/50] batch [1/1] time 1.179 (1.179) data 0.676 (0.676) loss 0.7412 (0.7412) lr 9.2216e-02 eta 0:00:48
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.07it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.15it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.22it/s] 80%|████████  | 12/15 [00:05<00:00,  3.25it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.29it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.31it/s]100%|██████████| 15/15 [00:05<00:00,  4.12it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 1,839
* accuracy: 65.7%
* error: 34.3%
* macro_f1: 65.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [10/50] batch [1/1] time 1.199 (1.199) data 0.694 (0.694) loss 0.8442 (0.8442) lr 9.0451e-02 eta 0:00:47
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 1,869
* accuracy: 66.8%
* error: 33.2%
* macro_f1: 66.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-10

epoch [11/50] batch [1/1] time 1.170 (1.170) data 0.676 (0.676) loss 0.7803 (0.7803) lr 8.8526e-02 eta 0:00:45
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.53s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.14it/s] 20%|██        | 3/15 [00:02<00:07,  1.64it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.07it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.91it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.06it/s] 60%|██████    | 9/15 [00:03<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.25it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.24it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 1,924
* accuracy: 68.7%
* error: 31.3%
* macro_f1: 68.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [12/50] batch [1/1] time 1.170 (1.170) data 0.662 (0.662) loss 0.8213 (0.8213) lr 8.6448e-02 eta 0:00:44
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.09s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.03s/it] 20%|██        | 3/15 [00:02<00:08,  1.44it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.87it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.24it/s] 40%|████      | 6/15 [00:03<00:03,  2.54it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.78it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:06<00:00,  2.47it/s]=> result
* total: 2,800
* correct: 1,904
* accuracy: 68.0%
* error: 32.0%
* macro_f1: 68.1%

epoch [13/50] batch [1/1] time 1.229 (1.229) data 0.670 (0.670) loss 0.6748 (0.6748) lr 8.4227e-02 eta 0:00:45
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.78s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 1,922
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 68.5%

epoch [14/50] batch [1/1] time 1.204 (1.204) data 0.691 (0.691) loss 0.6978 (0.6978) lr 8.1871e-02 eta 0:00:43
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.59s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.62it/s]=> result
* total: 2,800
* correct: 2,018
* accuracy: 72.1%
* error: 27.9%
* macro_f1: 71.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [15/50] batch [1/1] time 1.151 (1.151) data 0.646 (0.646) loss 0.7075 (0.7075) lr 7.9389e-02 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:04<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,938
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 68.7%

epoch [16/50] batch [1/1] time 1.168 (1.168) data 0.651 (0.651) loss 0.6465 (0.6465) lr 7.6791e-02 eta 0:00:39
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:30,  2.16s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.06s/it] 20%|██        | 3/15 [00:02<00:08,  1.41it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.83it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.20it/s] 40%|████      | 6/15 [00:03<00:03,  2.50it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.73it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.91it/s] 60%|██████    | 9/15 [00:04<00:01,  3.04it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.14it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.20it/s] 80%|████████  | 12/15 [00:05<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.29it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.32it/s]100%|██████████| 15/15 [00:06<00:00,  4.14it/s]100%|██████████| 15/15 [00:06<00:00,  2.42it/s]=> result
* total: 2,800
* correct: 2,018
* accuracy: 72.1%
* error: 27.9%
* macro_f1: 70.0%

epoch [17/50] batch [1/1] time 1.195 (1.195) data 0.684 (0.684) loss 0.5869 (0.5869) lr 7.4088e-02 eta 0:00:39
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,083
* accuracy: 74.4%
* error: 25.6%
* macro_f1: 73.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [18/50] batch [1/1] time 1.170 (1.170) data 0.657 (0.657) loss 0.6040 (0.6040) lr 7.1289e-02 eta 0:00:37
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 2,094
* accuracy: 74.8%
* error: 25.2%
* macro_f1: 74.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [19/50] batch [1/1] time 1.215 (1.215) data 0.691 (0.691) loss 0.6943 (0.6943) lr 6.8406e-02 eta 0:00:37
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.04s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.43it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.86it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s] 40%|████      | 6/15 [00:03<00:03,  2.54it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.78it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:06<00:00,  2.47it/s]=> result
* total: 2,800
* correct: 2,019
* accuracy: 72.1%
* error: 27.9%
* macro_f1: 72.2%

epoch [20/50] batch [1/1] time 1.175 (1.175) data 0.664 (0.664) loss 0.4868 (0.4868) lr 6.5451e-02 eta 0:00:35
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.79s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,005
* accuracy: 71.6%
* error: 28.4%
* macro_f1: 71.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-20

epoch [21/50] batch [1/1] time 1.133 (1.133) data 0.624 (0.624) loss 0.4521 (0.4521) lr 6.2434e-02 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.53s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.14it/s] 20%|██        | 3/15 [00:02<00:07,  1.63it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.24it/s] 80%|████████  | 12/15 [00:04<00:00,  3.28it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.31it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.33it/s]100%|██████████| 15/15 [00:05<00:00,  4.14it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 2,102
* accuracy: 75.1%
* error: 24.9%
* macro_f1: 75.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [22/50] batch [1/1] time 1.231 (1.231) data 0.687 (0.687) loss 0.4941 (0.4941) lr 5.9369e-02 eta 0:00:34
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.90s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.01s/it] 20%|██        | 3/15 [00:02<00:08,  1.46it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.89it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.50it/s]=> result
* total: 2,800
* correct: 2,202
* accuracy: 78.6%
* error: 21.4%
* macro_f1: 78.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [23/50] batch [1/1] time 1.208 (1.208) data 0.692 (0.692) loss 0.5264 (0.5264) lr 5.6267e-02 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.91s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,240
* accuracy: 80.0%
* error: 20.0%
* macro_f1: 80.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [24/50] batch [1/1] time 1.199 (1.199) data 0.681 (0.681) loss 0.6240 (0.6240) lr 5.3140e-02 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.58it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:04<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,272
* accuracy: 81.1%
* error: 18.9%
* macro_f1: 81.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [25/50] batch [1/1] time 1.257 (1.257) data 0.723 (0.723) loss 0.4619 (0.4619) lr 5.0000e-02 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.64s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 2,269
* accuracy: 81.0%
* error: 19.0%
* macro_f1: 81.2%

epoch [26/50] batch [1/1] time 1.176 (1.176) data 0.665 (0.665) loss 0.5205 (0.5205) lr 4.6860e-02 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.52s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.15it/s] 20%|██        | 3/15 [00:02<00:07,  1.65it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.08it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.42it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.06it/s] 60%|██████    | 9/15 [00:03<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.25it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.68it/s]=> result
* total: 2,800
* correct: 2,275
* accuracy: 81.2%
* error: 18.8%
* macro_f1: 81.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [27/50] batch [1/1] time 1.198 (1.198) data 0.679 (0.679) loss 0.4707 (0.4707) lr 4.3733e-02 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.92s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:08,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 2,330
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 83.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [28/50] batch [1/1] time 1.255 (1.255) data 0.716 (0.716) loss 0.4717 (0.4717) lr 4.0631e-02 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.06s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it] 20%|██        | 3/15 [00:02<00:08,  1.45it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.88it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.25it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:06<00:00,  2.48it/s]=> result
* total: 2,800
* correct: 2,333
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 83.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [29/50] batch [1/1] time 1.210 (1.210) data 0.697 (0.697) loss 0.3911 (0.3911) lr 3.7566e-02 eta 0:00:25
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.49s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.14it/s] 20%|██        | 3/15 [00:02<00:07,  1.63it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.89it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.05it/s] 60%|██████    | 9/15 [00:03<00:01,  3.16it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.65it/s]=> result
* total: 2,800
* correct: 2,369
* accuracy: 84.6%
* error: 15.4%
* macro_f1: 84.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [30/50] batch [1/1] time 1.225 (1.225) data 0.699 (0.699) loss 0.5020 (0.5020) lr 3.4549e-02 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:04<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.18it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 2,347
* accuracy: 83.8%
* error: 16.2%
* macro_f1: 83.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-30

epoch [31/50] batch [1/1] time 1.222 (1.222) data 0.685 (0.685) loss 0.4189 (0.4189) lr 3.1594e-02 eta 0:00:23
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.72s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,320
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 82.9%

epoch [32/50] batch [1/1] time 1.179 (1.179) data 0.668 (0.668) loss 0.4658 (0.4658) lr 2.8711e-02 eta 0:00:21
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 2,284
* accuracy: 81.6%
* error: 18.4%
* macro_f1: 81.7%

epoch [33/50] batch [1/1] time 1.222 (1.222) data 0.700 (0.700) loss 0.3525 (0.3525) lr 2.5912e-02 eta 0:00:20
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.90s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.18it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 2,413
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 86.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [34/50] batch [1/1] time 1.157 (1.157) data 0.650 (0.650) loss 0.3794 (0.3794) lr 2.3209e-02 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.64s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.62it/s]=> result
* total: 2,800
* correct: 2,388
* accuracy: 85.3%
* error: 14.7%
* macro_f1: 85.1%

epoch [35/50] batch [1/1] time 1.200 (1.200) data 0.689 (0.689) loss 0.4556 (0.4556) lr 2.0611e-02 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.84s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,386
* accuracy: 85.2%
* error: 14.8%
* macro_f1: 85.1%

epoch [36/50] batch [1/1] time 1.214 (1.214) data 0.686 (0.686) loss 0.3652 (0.3652) lr 1.8129e-02 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.10s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.44it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.86it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s] 40%|████      | 6/15 [00:03<00:03,  2.52it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.75it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.93it/s] 60%|██████    | 9/15 [00:04<00:01,  3.06it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.16it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.23it/s] 80%|████████  | 12/15 [00:05<00:00,  3.28it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.32it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:06<00:00,  2.44it/s]=> result
* total: 2,800
* correct: 2,401
* accuracy: 85.8%
* error: 14.2%
* macro_f1: 85.8%

epoch [37/50] batch [1/1] time 1.160 (1.160) data 0.643 (0.643) loss 0.4087 (0.4087) lr 1.5773e-02 eta 0:00:15
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.62s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.24it/s] 80%|████████  | 12/15 [00:04<00:00,  3.28it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.31it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.33it/s]100%|██████████| 15/15 [00:05<00:00,  4.15it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,189
* accuracy: 78.2%
* error: 21.8%
* macro_f1: 77.8%

epoch [38/50] batch [1/1] time 1.175 (1.175) data 0.665 (0.665) loss 0.3682 (0.3682) lr 1.3552e-02 eta 0:00:14
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.74s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,389
* accuracy: 85.3%
* error: 14.7%
* macro_f1: 85.4%

epoch [39/50] batch [1/1] time 1.228 (1.228) data 0.709 (0.709) loss 0.5703 (0.5703) lr 1.1474e-02 eta 0:00:13
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.10s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.43it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.86it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.22it/s] 40%|████      | 6/15 [00:03<00:03,  2.52it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.75it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.94it/s] 60%|██████    | 9/15 [00:04<00:01,  3.07it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.16it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.24it/s] 80%|████████  | 12/15 [00:05<00:00,  3.29it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:06<00:00,  2.44it/s]=> result
* total: 2,800
* correct: 2,410
* accuracy: 86.1%
* error: 13.9%
* macro_f1: 85.9%

epoch [40/50] batch [1/1] time 1.175 (1.175) data 0.657 (0.657) loss 0.4170 (0.4170) lr 9.5492e-03 eta 0:00:11
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.66s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.58it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.01it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:04<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,374
* accuracy: 84.8%
* error: 15.2%
* macro_f1: 84.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-40

epoch [41/50] batch [1/1] time 1.159 (1.159) data 0.639 (0.639) loss 0.5122 (0.5122) lr 7.7836e-03 eta 0:00:10
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,399
* accuracy: 85.7%
* error: 14.3%
* macro_f1: 85.5%

epoch [42/50] batch [1/1] time 1.170 (1.170) data 0.655 (0.655) loss 0.4312 (0.4312) lr 6.1847e-03 eta 0:00:09
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.65s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.08it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.17it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.24it/s] 80%|████████  | 12/15 [00:05<00:00,  3.28it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.31it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.33it/s]100%|██████████| 15/15 [00:05<00:00,  4.14it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 2,444
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 87.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [43/50] batch [1/1] time 1.180 (1.180) data 0.670 (0.670) loss 0.3652 (0.3652) lr 4.7586e-03 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.55s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.14it/s] 20%|██        | 3/15 [00:02<00:07,  1.64it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.05it/s] 60%|██████    | 9/15 [00:03<00:01,  3.16it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.25it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.65it/s]=> result
* total: 2,800
* correct: 2,448
* accuracy: 87.4%
* error: 12.6%
* macro_f1: 87.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [44/50] batch [1/1] time 1.201 (1.201) data 0.683 (0.683) loss 0.4385 (0.4385) lr 3.5112e-03 eta 0:00:07
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.93s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.94it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.30it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 2,450
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 87.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [45/50] batch [1/1] time 1.220 (1.220) data 0.704 (0.704) loss 0.3345 (0.3345) lr 2.4472e-03 eta 0:00:06
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:30,  2.16s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.07s/it] 20%|██        | 3/15 [00:02<00:08,  1.40it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.83it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.19it/s] 40%|████      | 6/15 [00:03<00:03,  2.48it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.72it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.90it/s] 60%|██████    | 9/15 [00:04<00:01,  3.04it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.13it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.21it/s] 80%|████████  | 12/15 [00:05<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.29it/s] 93%|█████████▎| 14/15 [00:06<00:00,  3.32it/s]100%|██████████| 15/15 [00:06<00:00,  4.13it/s]100%|██████████| 15/15 [00:06<00:00,  2.40it/s]=> result
* total: 2,800
* correct: 2,444
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 87.4%

epoch [46/50] batch [1/1] time 1.172 (1.172) data 0.666 (0.666) loss 0.3940 (0.3940) lr 1.5708e-03 eta 0:00:04
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.48it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.90it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.77it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.94it/s] 60%|██████    | 9/15 [00:04<00:01,  3.06it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.15it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.21it/s] 80%|████████  | 12/15 [00:05<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.28it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.31it/s]100%|██████████| 15/15 [00:05<00:00,  4.12it/s]100%|██████████| 15/15 [00:06<00:00,  2.47it/s]=> result
* total: 2,800
* correct: 2,441
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 87.3%

epoch [47/50] batch [1/1] time 1.146 (1.146) data 0.643 (0.643) loss 0.2773 (0.2773) lr 8.8564e-04 eta 0:00:03
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.67s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.08it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.16it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.22it/s] 80%|████████  | 12/15 [00:05<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.30it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.32it/s]100%|██████████| 15/15 [00:05<00:00,  4.13it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,442
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 87.3%

epoch [48/50] batch [1/1] time 1.180 (1.180) data 0.661 (0.661) loss 0.3970 (0.3970) lr 3.9426e-04 eta 0:00:02
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.79s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.30it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.08it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.17it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.23it/s] 80%|████████  | 12/15 [00:05<00:00,  3.27it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.30it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.33it/s]100%|██████████| 15/15 [00:05<00:00,  4.14it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,442
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 87.3%

epoch [49/50] batch [1/1] time 1.152 (1.152) data 0.658 (0.658) loss 0.4185 (0.4185) lr 9.8664e-05 eta 0:00:01
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.74s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,443
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 87.3%

epoch [50/50] batch [1/1] time 1.171 (1.171) data 0.672 (0.672) loss 0.3994 (0.3994) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.11s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.43it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.86it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s] 40%|████      | 6/15 [00:03<00:03,  2.53it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.76it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.95it/s] 60%|██████    | 9/15 [00:04<00:01,  3.08it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:06<00:00,  4.18it/s]100%|██████████| 15/15 [00:06<00:00,  2.45it/s]
=> result
* total: 2,800
* correct: 2,444
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 87.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 44)
Evaluate on the *test* set
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:02<00:44,  2.11s/it]  9%|▉         | 2/22 [00:02<00:24,  1.24s/it] 14%|█▎        | 3/22 [00:03<00:17,  1.11it/s] 18%|█▊        | 4/22 [00:03<00:11,  1.51it/s] 23%|██▎       | 5/22 [00:03<00:08,  1.89it/s] 27%|██▋       | 6/22 [00:04<00:07,  2.24it/s] 32%|███▏      | 7/22 [00:04<00:05,  2.52it/s] 36%|███▋      | 8/22 [00:04<00:05,  2.76it/s] 41%|████      | 9/22 [00:04<00:04,  2.94it/s] 45%|████▌     | 10/22 [00:05<00:03,  3.08it/s] 50%|█████     | 11/22 [00:05<00:03,  3.18it/s] 55%|█████▍    | 12/22 [00:05<00:03,  3.25it/s] 59%|█████▉    | 13/22 [00:06<00:02,  3.30it/s] 64%|██████▎   | 14/22 [00:06<00:02,  3.34it/s] 68%|██████▊   | 15/22 [00:06<00:02,  3.37it/s] 73%|███████▎  | 16/22 [00:07<00:01,  3.39it/s] 77%|███████▋  | 17/22 [00:07<00:01,  3.40it/s] 82%|████████▏ | 18/22 [00:07<00:01,  3.41it/s] 86%|████████▋ | 19/22 [00:07<00:00,  3.42it/s] 91%|█████████ | 20/22 [00:08<00:00,  3.43it/s] 95%|█████████▌| 21/22 [00:08<00:00,  3.43it/s]100%|██████████| 22/22 [00:08<00:00,  4.08it/s]100%|██████████| 22/22 [00:08<00:00,  2.52it/s]
=> result
* total: 4,200
* correct: 3,716
* accuracy: 88.5%
* error: 11.5%
* macro_f1: 88.5%
Elapsed: 0:06:11
+ sh scripts/rpo_prime/base2new_test_sdl.sh eurosat 2 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE NEW CLASSES!
80 2600 3900
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,600
# test     3,900
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 44)
Evaluate on the *test* set
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:05<01:40,  5.26s/it] 10%|█         | 2/20 [00:05<00:42,  2.34s/it] 15%|█▌        | 3/20 [00:05<00:23,  1.40s/it] 20%|██        | 4/20 [00:06<00:15,  1.04it/s] 25%|██▌       | 5/20 [00:06<00:10,  1.39it/s] 30%|███       | 6/20 [00:06<00:08,  1.75it/s] 35%|███▌      | 7/20 [00:06<00:06,  2.08it/s] 40%|████      | 8/20 [00:07<00:05,  2.39it/s] 45%|████▌     | 9/20 [00:07<00:04,  2.64it/s] 50%|█████     | 10/20 [00:07<00:03,  2.85it/s] 55%|█████▌    | 11/20 [00:08<00:02,  3.01it/s] 60%|██████    | 12/20 [00:08<00:02,  3.13it/s] 65%|██████▌   | 13/20 [00:08<00:02,  3.22it/s] 70%|███████   | 14/20 [00:09<00:01,  3.29it/s] 75%|███████▌  | 15/20 [00:09<00:01,  3.34it/s] 80%|████████  | 16/20 [00:09<00:01,  3.36it/s] 85%|████████▌ | 17/20 [00:09<00:00,  3.39it/s] 90%|█████████ | 18/20 [00:10<00:00,  3.41it/s] 95%|█████████▌| 19/20 [00:10<00:00,  3.42it/s]100%|██████████| 20/20 [00:10<00:00,  3.52it/s]100%|██████████| 20/20 [00:10<00:00,  1.85it/s]
=> result
* total: 3,900
* correct: 2,359
* accuracy: 60.5%
* error: 39.5%
* macro_f1: 56.5%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh eurosat 3 0 main_tmp1_0.1sdl 16
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE BASE CLASSES!
80 2800 4200
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,800
# test     4,200
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [1/1] time 3.016 (3.016) data 1.103 (1.103) loss 1.2822 (1.2822) lr 9.9901e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:38,  2.78s/it] 13%|█▎        | 2/15 [00:03<00:17,  1.32s/it] 20%|██        | 3/15 [00:03<00:10,  1.18it/s] 27%|██▋       | 4/15 [00:03<00:06,  1.59it/s] 33%|███▎      | 5/15 [00:03<00:05,  1.98it/s] 40%|████      | 6/15 [00:04<00:03,  2.31it/s] 47%|████▋     | 7/15 [00:04<00:03,  2.59it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.79it/s] 60%|██████    | 9/15 [00:05<00:02,  2.97it/s] 67%|██████▋   | 10/15 [00:05<00:01,  3.10it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.20it/s] 80%|████████  | 12/15 [00:05<00:00,  3.27it/s] 87%|████████▋ | 13/15 [00:06<00:00,  3.32it/s] 93%|█████████▎| 14/15 [00:06<00:00,  3.36it/s]100%|██████████| 15/15 [00:06<00:00,  2.21it/s]=> result
* total: 2,800
* correct: 1,785
* accuracy: 63.8%
* error: 36.2%
* macro_f1: 60.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [2/50] batch [1/1] time 1.163 (1.163) data 0.641 (0.641) loss 1.0049 (1.0049) lr 9.9606e-02 eta 0:00:55
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.54s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.63it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.05it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.40it/s] 40%|████      | 6/15 [00:03<00:03,  2.67it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:04<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.17it/s]100%|██████████| 15/15 [00:05<00:00,  2.63it/s]=> result
* total: 2,800
* correct: 1,759
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 59.7%

epoch [3/50] batch [1/1] time 1.158 (1.158) data 0.642 (0.642) loss 0.9375 (0.9375) lr 9.9114e-02 eta 0:00:54
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.92s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 1,751
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 60.6%

epoch [4/50] batch [1/1] time 1.128 (1.128) data 0.610 (0.610) loss 0.8975 (0.8975) lr 9.8429e-02 eta 0:00:51
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.86s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 1,810
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 63.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [5/50] batch [1/1] time 1.186 (1.186) data 0.658 (0.658) loss 0.7529 (0.7529) lr 9.7553e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.60s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.00it/s] 20%|██        | 3/15 [00:02<00:08,  1.48it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.91it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 1,857
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 65.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [6/50] batch [1/1] time 1.153 (1.153) data 0.638 (0.638) loss 0.8857 (0.8857) lr 9.6489e-02 eta 0:00:50
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.66it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.31it/s] 80%|████████  | 12/15 [00:04<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.39it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.41it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 1,849
* accuracy: 66.0%
* error: 34.0%
* macro_f1: 66.1%

epoch [7/50] batch [1/1] time 1.165 (1.165) data 0.643 (0.643) loss 0.7778 (0.7778) lr 9.5241e-02 eta 0:00:50
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.00s/it] 20%|██        | 3/15 [00:02<00:08,  1.48it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.91it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.16it/s]100%|██████████| 15/15 [00:06<00:00,  2.49it/s]=> result
* total: 2,800
* correct: 1,911
* accuracy: 68.2%
* error: 31.8%
* macro_f1: 68.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [8/50] batch [1/1] time 1.483 (1.483) data 0.803 (0.803) loss 0.7515 (0.7515) lr 9.3815e-02 eta 0:01:02
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.99s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.51it/s]=> result
* total: 2,800
* correct: 1,991
* accuracy: 71.1%
* error: 28.9%
* macro_f1: 70.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [9/50] batch [1/1] time 1.179 (1.179) data 0.657 (0.657) loss 0.7373 (0.7373) lr 9.2216e-02 eta 0:00:48
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.70s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,063
* accuracy: 73.7%
* error: 26.3%
* macro_f1: 73.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [10/50] batch [1/1] time 1.153 (1.153) data 0.637 (0.637) loss 0.7188 (0.7188) lr 9.0451e-02 eta 0:00:46
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.11s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.43it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.86it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s] 40%|████      | 6/15 [00:03<00:03,  2.53it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.77it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.95it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:06<00:00,  2.45it/s]=> result
* total: 2,800
* correct: 2,004
* accuracy: 71.6%
* error: 28.4%
* macro_f1: 71.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-10

epoch [11/50] batch [1/1] time 1.229 (1.229) data 0.677 (0.677) loss 0.7568 (0.7568) lr 8.8526e-02 eta 0:00:47
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 1,899
* accuracy: 67.8%
* error: 32.2%
* macro_f1: 64.1%

epoch [12/50] batch [1/1] time 1.127 (1.127) data 0.624 (0.624) loss 0.6895 (0.6895) lr 8.6448e-02 eta 0:00:42
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.84s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,037
* accuracy: 72.8%
* error: 27.2%
* macro_f1: 72.8%

epoch [13/50] batch [1/1] time 1.124 (1.124) data 0.624 (0.624) loss 0.6406 (0.6406) lr 8.4227e-02 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.91s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 2,045
* accuracy: 73.0%
* error: 27.0%
* macro_f1: 72.9%

epoch [14/50] batch [1/1] time 1.208 (1.208) data 0.684 (0.684) loss 0.6606 (0.6606) lr 8.1871e-02 eta 0:00:43
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.04s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it] 20%|██        | 3/15 [00:02<00:08,  1.46it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.89it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:06<00:00,  2.48it/s]=> result
* total: 2,800
* correct: 2,041
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 72.4%

epoch [15/50] batch [1/1] time 1.150 (1.150) data 0.639 (0.639) loss 0.5322 (0.5322) lr 7.9389e-02 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.83s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 2,182
* accuracy: 77.9%
* error: 22.1%
* macro_f1: 77.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [16/50] batch [1/1] time 1.143 (1.143) data 0.633 (0.633) loss 0.5825 (0.5825) lr 7.6791e-02 eta 0:00:38
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.10it/s] 20%|██        | 3/15 [00:02<00:07,  1.60it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.03it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.36it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:04<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 2,209
* accuracy: 78.9%
* error: 21.1%
* macro_f1: 79.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [17/50] batch [1/1] time 1.228 (1.228) data 0.710 (0.710) loss 0.6221 (0.6221) lr 7.4088e-02 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.85s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,219
* accuracy: 79.2%
* error: 20.8%
* macro_f1: 79.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [18/50] batch [1/1] time 1.120 (1.120) data 0.621 (0.621) loss 0.4971 (0.4971) lr 7.1289e-02 eta 0:00:35
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.57s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.63it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.06it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.41it/s] 40%|████      | 6/15 [00:03<00:03,  2.69it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.05it/s] 60%|██████    | 9/15 [00:04<00:01,  3.16it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.65it/s]=> result
* total: 2,800
* correct: 2,241
* accuracy: 80.0%
* error: 20.0%
* macro_f1: 79.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [19/50] batch [1/1] time 1.158 (1.158) data 0.649 (0.649) loss 0.4995 (0.4995) lr 6.8406e-02 eta 0:00:35
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.75s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,030
* accuracy: 72.5%
* error: 27.5%
* macro_f1: 71.5%

epoch [20/50] batch [1/1] time 1.156 (1.156) data 0.636 (0.636) loss 0.5557 (0.5557) lr 6.5451e-02 eta 0:00:34
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 2,274
* accuracy: 81.2%
* error: 18.8%
* macro_f1: 81.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-20

epoch [21/50] batch [1/1] time 1.112 (1.112) data 0.614 (0.614) loss 0.5889 (0.5889) lr 6.2434e-02 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.79s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 2,311
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 82.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [22/50] batch [1/1] time 1.175 (1.175) data 0.662 (0.662) loss 0.5322 (0.5322) lr 5.9369e-02 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.83s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.08it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.24it/s] 80%|████████  | 12/15 [00:05<00:00,  3.29it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.16it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,310
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 82.4%

epoch [23/50] batch [1/1] time 1.140 (1.140) data 0.627 (0.627) loss 0.4893 (0.4893) lr 5.6267e-02 eta 0:00:30
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.77s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.03it/s] 20%|██        | 3/15 [00:02<00:07,  1.52it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.54it/s]=> result
* total: 2,800
* correct: 2,340
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 83.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [24/50] batch [1/1] time 1.144 (1.144) data 0.643 (0.643) loss 0.4746 (0.4746) lr 5.3140e-02 eta 0:00:29
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.82s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,315
* accuracy: 82.7%
* error: 17.3%
* macro_f1: 82.7%

epoch [25/50] batch [1/1] time 1.189 (1.189) data 0.678 (0.678) loss 0.4663 (0.4663) lr 5.0000e-02 eta 0:00:29
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.70s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.27it/s] 40%|████      | 6/15 [00:03<00:03,  2.55it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.77it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.93it/s] 60%|██████    | 9/15 [00:04<00:01,  3.03it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.14it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.22it/s] 80%|████████  | 12/15 [00:05<00:00,  3.27it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.31it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.18it/s]100%|██████████| 15/15 [00:05<00:00,  2.52it/s]=> result
* total: 2,800
* correct: 2,362
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 84.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [26/50] batch [1/1] time 1.124 (1.124) data 0.625 (0.625) loss 0.4771 (0.4771) lr 4.6860e-02 eta 0:00:26
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.63s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.58it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.60it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.21it/s] 80%|████████  | 12/15 [00:05<00:00,  3.21it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.23it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.26it/s]100%|██████████| 15/15 [00:05<00:00,  4.01it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,270
* accuracy: 81.1%
* error: 18.9%
* macro_f1: 81.1%

epoch [27/50] batch [1/1] time 1.235 (1.235) data 0.630 (0.630) loss 0.4346 (0.4346) lr 4.3733e-02 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.86s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.45it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.87it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s] 40%|████      | 6/15 [00:03<00:03,  2.52it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.75it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.93it/s] 60%|██████    | 9/15 [00:04<00:01,  3.05it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.14it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.20it/s] 80%|████████  | 12/15 [00:05<00:00,  3.25it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.28it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.29it/s]100%|██████████| 15/15 [00:05<00:00,  4.09it/s]100%|██████████| 15/15 [00:06<00:00,  2.47it/s]=> result
* total: 2,800
* correct: 2,372
* accuracy: 84.7%
* error: 15.3%
* macro_f1: 84.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [28/50] batch [1/1] time 1.162 (1.162) data 0.654 (0.654) loss 0.4189 (0.4189) lr 4.0631e-02 eta 0:00:25
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.58s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.12it/s] 20%|██        | 3/15 [00:02<00:07,  1.61it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.03it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.38it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.86it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.17it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.22it/s] 80%|████████  | 12/15 [00:04<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.29it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.32it/s]100%|██████████| 15/15 [00:05<00:00,  4.12it/s]100%|██████████| 15/15 [00:05<00:00,  2.61it/s]=> result
* total: 2,800
* correct: 2,400
* accuracy: 85.7%
* error: 14.3%
* macro_f1: 85.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [29/50] batch [1/1] time 1.140 (1.140) data 0.642 (0.642) loss 0.3936 (0.3936) lr 3.7566e-02 eta 0:00:23
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.48s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.96it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.08it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.16it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.23it/s] 80%|████████  | 12/15 [00:05<00:00,  3.27it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.30it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.33it/s]100%|██████████| 15/15 [00:05<00:00,  4.14it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,403
* accuracy: 85.8%
* error: 14.2%
* macro_f1: 85.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [30/50] batch [1/1] time 1.108 (1.108) data 0.610 (0.610) loss 0.3525 (0.3525) lr 3.4549e-02 eta 0:00:22
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:28,  2.00s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.00it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s] 40%|████      | 6/15 [00:03<00:03,  2.57it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:06<00:00,  2.49it/s]=> result
* total: 2,800
* correct: 2,395
* accuracy: 85.5%
* error: 14.5%
* macro_f1: 85.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-30

epoch [31/50] batch [1/1] time 1.164 (1.164) data 0.652 (0.652) loss 0.4004 (0.4004) lr 3.1594e-02 eta 0:00:22
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.70s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.54it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.31it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.32it/s]100%|██████████| 15/15 [00:05<00:00,  4.12it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,416
* accuracy: 86.3%
* error: 13.7%
* macro_f1: 86.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [32/50] batch [1/1] time 1.195 (1.195) data 0.673 (0.673) loss 0.4043 (0.4043) lr 2.8711e-02 eta 0:00:21
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.94s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.02s/it] 20%|██        | 3/15 [00:02<00:08,  1.45it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.87it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.22it/s] 40%|████      | 6/15 [00:03<00:03,  2.51it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.74it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.92it/s] 60%|██████    | 9/15 [00:04<00:01,  3.04it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.14it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.21it/s] 80%|████████  | 12/15 [00:05<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.30it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.32it/s]100%|██████████| 15/15 [00:05<00:00,  4.13it/s]100%|██████████| 15/15 [00:06<00:00,  2.46it/s]=> result
* total: 2,800
* correct: 2,426
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 86.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [33/50] batch [1/1] time 1.139 (1.139) data 0.636 (0.636) loss 0.3618 (0.3618) lr 2.5912e-02 eta 0:00:19
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.73s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.57it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.00it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.64it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  4.22it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,462
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 88.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [34/50] batch [1/1] time 1.149 (1.149) data 0.644 (0.644) loss 0.3652 (0.3652) lr 2.3209e-02 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.88s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.14it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:05<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.39it/s]100%|██████████| 15/15 [00:05<00:00,  2.56it/s]=> result
* total: 2,800
* correct: 2,477
* accuracy: 88.5%
* error: 11.5%
* macro_f1: 88.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [35/50] batch [1/1] time 1.182 (1.182) data 0.681 (0.681) loss 0.4395 (0.4395) lr 2.0611e-02 eta 0:00:17
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.54s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:04<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  4.18it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,487
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 88.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [36/50] batch [1/1] time 1.184 (1.184) data 0.663 (0.663) loss 0.3140 (0.3140) lr 1.8129e-02 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:22,  1.59s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.11it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.94it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.57it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.18it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.25it/s] 80%|████████  | 12/15 [00:05<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.33it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,499
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 89.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [37/50] batch [1/1] time 1.159 (1.159) data 0.655 (0.655) loss 0.2393 (0.2393) lr 1.5773e-02 eta 0:00:15
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.65s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.08it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.99it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.35it/s] 40%|████      | 6/15 [00:03<00:03,  2.63it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.85it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.02it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:04<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.21it/s]100%|██████████| 15/15 [00:05<00:00,  2.58it/s]=> result
* total: 2,800
* correct: 2,487
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 88.8%

epoch [38/50] batch [1/1] time 1.139 (1.139) data 0.637 (0.637) loss 0.2754 (0.2754) lr 1.3552e-02 eta 0:00:13
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.51s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.16it/s] 20%|██        | 3/15 [00:02<00:07,  1.65it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.08it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.43it/s] 40%|████      | 6/15 [00:03<00:03,  2.70it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.90it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.05it/s] 60%|██████    | 9/15 [00:03<00:01,  3.16it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.24it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.35it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.38it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.40it/s]100%|██████████| 15/15 [00:05<00:00,  4.23it/s]100%|██████████| 15/15 [00:05<00:00,  2.66it/s]=> result
* total: 2,800
* correct: 2,483
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 88.7%

epoch [39/50] batch [1/1] time 1.143 (1.143) data 0.644 (0.644) loss 0.2744 (0.2744) lr 1.1474e-02 eta 0:00:12
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:20,  1.49s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.18it/s] 20%|██        | 3/15 [00:02<00:07,  1.69it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.11it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.46it/s] 40%|████      | 6/15 [00:03<00:03,  2.72it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.92it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.06it/s] 60%|██████    | 9/15 [00:03<00:01,  3.17it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.25it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.30it/s] 80%|████████  | 12/15 [00:04<00:00,  3.34it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.37it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:05<00:00,  2.67it/s]=> result
* total: 2,800
* correct: 2,488
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 88.8%

epoch [40/50] batch [1/1] time 1.194 (1.194) data 0.664 (0.664) loss 0.3604 (0.3604) lr 9.5492e-03 eta 0:00:11
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.02it/s] 20%|██        | 3/15 [00:02<00:07,  1.50it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.93it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.29it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.35it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,514
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 89.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-40

epoch [41/50] batch [1/1] time 1.172 (1.172) data 0.674 (0.674) loss 0.2734 (0.2734) lr 7.7836e-03 eta 0:00:10
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.74s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.05it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.30it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.80it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.91it/s] 60%|██████    | 9/15 [00:04<00:01,  3.04it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.14it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.21it/s] 80%|████████  | 12/15 [00:05<00:00,  3.26it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.30it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.32it/s]100%|██████████| 15/15 [00:05<00:00,  4.14it/s]100%|██████████| 15/15 [00:05<00:00,  2.53it/s]=> result
* total: 2,800
* correct: 2,530
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 90.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [42/50] batch [1/1] time 1.138 (1.138) data 0.633 (0.633) loss 0.2896 (0.2896) lr 6.1847e-03 eta 0:00:09
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.86s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.06it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.33it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.83it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,538
* accuracy: 90.6%
* error: 9.4%
* macro_f1: 90.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [43/50] batch [1/1] time 1.207 (1.207) data 0.698 (0.698) loss 0.2417 (0.2417) lr 4.7586e-03 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:02<00:29,  2.11s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.04s/it] 20%|██        | 3/15 [00:02<00:08,  1.43it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.86it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.23it/s] 40%|████      | 6/15 [00:03<00:03,  2.54it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.78it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.96it/s] 60%|██████    | 9/15 [00:04<00:01,  3.09it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:05<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:06<00:00,  2.46it/s]=> result
* total: 2,800
* correct: 2,542
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 90.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [44/50] batch [1/1] time 1.172 (1.172) data 0.673 (0.673) loss 0.3179 (0.3179) lr 3.5112e-03 eta 0:00:07
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.65s/it] 13%|█▎        | 2/15 [00:02<00:11,  1.09it/s] 20%|██        | 3/15 [00:02<00:07,  1.59it/s] 27%|██▋       | 4/15 [00:02<00:05,  2.02it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.37it/s] 40%|████      | 6/15 [00:03<00:03,  2.65it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.87it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.03it/s] 60%|██████    | 9/15 [00:04<00:01,  3.15it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.23it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.29it/s] 80%|████████  | 12/15 [00:04<00:00,  3.30it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.60it/s]=> result
* total: 2,800
* correct: 2,543
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 90.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [45/50] batch [1/1] time 1.146 (1.146) data 0.650 (0.650) loss 0.2700 (0.2700) lr 2.4472e-03 eta 0:00:05
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:25,  1.80s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.04it/s] 20%|██        | 3/15 [00:02<00:07,  1.53it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.95it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.31it/s] 40%|████      | 6/15 [00:03<00:03,  2.59it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.98it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.55it/s]=> result
* total: 2,800
* correct: 2,539
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 90.7%

epoch [46/50] batch [1/1] time 1.191 (1.191) data 0.667 (0.667) loss 0.3096 (0.3096) lr 1.5708e-03 eta 0:00:04
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.95s/it] 13%|█▎        | 2/15 [00:02<00:13,  1.01s/it] 20%|██        | 3/15 [00:02<00:08,  1.47it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.90it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.26it/s] 40%|████      | 6/15 [00:03<00:03,  2.56it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.79it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.19it/s]100%|██████████| 15/15 [00:06<00:00,  2.49it/s]=> result
* total: 2,800
* correct: 2,543
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 90.9%

epoch [47/50] batch [1/1] time 1.112 (1.112) data 0.611 (0.611) loss 0.2676 (0.2676) lr 8.8564e-04 eta 0:00:03
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:24,  1.78s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.00it/s] 60%|██████    | 9/15 [00:04<00:01,  3.12it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.21it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.36it/s]100%|██████████| 15/15 [00:05<00:00,  2.57it/s]=> result
* total: 2,800
* correct: 2,544
* accuracy: 90.9%
* error: 9.1%
* macro_f1: 90.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [48/50] batch [1/1] time 1.105 (1.105) data 0.606 (0.606) loss 0.2871 (0.2871) lr 3.9426e-04 eta 0:00:02
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:21,  1.56s/it] 13%|█▎        | 2/15 [00:01<00:11,  1.13it/s] 20%|██        | 3/15 [00:02<00:07,  1.55it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.97it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.32it/s] 40%|████      | 6/15 [00:03<00:03,  2.61it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.82it/s] 53%|█████▎    | 8/15 [00:03<00:02,  2.99it/s] 60%|██████    | 9/15 [00:04<00:01,  3.11it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.20it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.27it/s] 80%|████████  | 12/15 [00:04<00:00,  3.32it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.35it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  4.20it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,545
* accuracy: 90.9%
* error: 9.1%
* macro_f1: 90.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [49/50] batch [1/1] time 1.170 (1.170) data 0.641 (0.641) loss 0.3037 (0.3037) lr 9.8664e-05 eta 0:00:01
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:23,  1.67s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.07it/s] 20%|██        | 3/15 [00:02<00:07,  1.56it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.98it/s] 33%|███▎      | 5/15 [00:02<00:04,  2.34it/s] 40%|████      | 6/15 [00:03<00:03,  2.62it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.84it/s] 53%|█████▎    | 8/15 [00:03<00:02,  3.01it/s] 60%|██████    | 9/15 [00:04<00:01,  3.13it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.22it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.28it/s] 80%|████████  | 12/15 [00:05<00:00,  3.33it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.36it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.38it/s]100%|██████████| 15/15 [00:05<00:00,  2.59it/s]=> result
* total: 2,800
* correct: 2,543
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 90.9%

epoch [50/50] batch [1/1] time 1.181 (1.181) data 0.677 (0.677) loss 0.2485 (0.2485) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:27,  1.98s/it] 13%|█▎        | 2/15 [00:02<00:12,  1.01it/s] 20%|██        | 3/15 [00:02<00:08,  1.49it/s] 27%|██▋       | 4/15 [00:02<00:05,  1.92it/s] 33%|███▎      | 5/15 [00:03<00:04,  2.28it/s] 40%|████      | 6/15 [00:03<00:03,  2.58it/s] 47%|████▋     | 7/15 [00:03<00:02,  2.81it/s] 53%|█████▎    | 8/15 [00:04<00:02,  2.97it/s] 60%|██████    | 9/15 [00:04<00:01,  3.10it/s] 67%|██████▋   | 10/15 [00:04<00:01,  3.19it/s] 73%|███████▎  | 11/15 [00:04<00:01,  3.26it/s] 80%|████████  | 12/15 [00:05<00:00,  3.31it/s] 87%|████████▋ | 13/15 [00:05<00:00,  3.34it/s] 93%|█████████▎| 14/15 [00:05<00:00,  3.37it/s]100%|██████████| 15/15 [00:05<00:00,  2.50it/s]
=> result
* total: 2,800
* correct: 2,545
* accuracy: 90.9%
* error: 9.1%
* macro_f1: 90.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar" (epoch = 48)
Evaluate on the *test* set
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:01<00:36,  1.74s/it]  9%|▉         | 2/22 [00:02<00:20,  1.04s/it] 14%|█▎        | 3/22 [00:02<00:15,  1.21it/s] 18%|█▊        | 4/22 [00:03<00:11,  1.61it/s] 23%|██▎       | 5/22 [00:03<00:08,  1.98it/s] 27%|██▋       | 6/22 [00:03<00:06,  2.31it/s] 32%|███▏      | 7/22 [00:04<00:05,  2.59it/s] 36%|███▋      | 8/22 [00:04<00:04,  2.80it/s] 41%|████      | 9/22 [00:04<00:04,  2.97it/s] 45%|████▌     | 10/22 [00:04<00:03,  3.10it/s] 50%|█████     | 11/22 [00:05<00:03,  3.19it/s] 55%|█████▍    | 12/22 [00:05<00:03,  3.26it/s] 59%|█████▉    | 13/22 [00:05<00:02,  3.31it/s] 64%|██████▎   | 14/22 [00:06<00:02,  3.34it/s] 68%|██████▊   | 15/22 [00:06<00:02,  3.37it/s] 73%|███████▎  | 16/22 [00:06<00:01,  3.38it/s] 77%|███████▋  | 17/22 [00:06<00:01,  3.40it/s] 82%|████████▏ | 18/22 [00:07<00:01,  3.40it/s] 86%|████████▋ | 19/22 [00:07<00:00,  3.40it/s] 91%|█████████ | 20/22 [00:07<00:00,  3.40it/s] 95%|█████████▌| 21/22 [00:08<00:00,  3.39it/s]100%|██████████| 22/22 [00:08<00:00,  4.02it/s]100%|██████████| 22/22 [00:08<00:00,  2.61it/s]
=> result
* total: 4,200
* correct: 3,800
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 90.5%
Elapsed: 0:06:09
+ sh scripts/rpo_prime/base2new_test_sdl.sh eurosat 3 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:EuroSAT
Loading dataset: EuroSAT
Reading split from /shared/s2/lab01/dataset/clip/eurosat/split_zhou_EuroSAT.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/eurosat/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE NEW CLASSES!
80 2600 3900
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  5
# train_x  80
# val      2,600
# test     3,900
---------  -------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/eurosat/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar" (epoch = 48)
Evaluate on the *test* set
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:05<01:40,  5.30s/it] 10%|█         | 2/20 [00:05<00:42,  2.36s/it] 15%|█▌        | 3/20 [00:05<00:24,  1.42s/it] 20%|██        | 4/20 [00:06<00:15,  1.02it/s] 25%|██▌       | 5/20 [00:06<00:10,  1.37it/s] 30%|███       | 6/20 [00:06<00:08,  1.72it/s] 35%|███▌      | 7/20 [00:07<00:06,  2.05it/s] 40%|████      | 8/20 [00:07<00:05,  2.34it/s] 45%|████▌     | 9/20 [00:07<00:04,  2.60it/s] 50%|█████     | 10/20 [00:07<00:03,  2.80it/s] 55%|█████▌    | 11/20 [00:08<00:03,  2.96it/s] 60%|██████    | 12/20 [00:08<00:02,  3.08it/s] 65%|██████▌   | 13/20 [00:08<00:02,  3.17it/s] 70%|███████   | 14/20 [00:09<00:01,  3.24it/s] 75%|███████▌  | 15/20 [00:09<00:01,  3.28it/s] 80%|████████  | 16/20 [00:09<00:01,  3.31it/s] 85%|████████▌ | 17/20 [00:10<00:00,  3.34it/s] 90%|█████████ | 18/20 [00:10<00:00,  3.35it/s] 95%|█████████▌| 19/20 [00:10<00:00,  3.37it/s]100%|██████████| 20/20 [00:10<00:00,  3.47it/s]100%|██████████| 20/20 [00:10<00:00,  1.82it/s]
=> result
* total: 3,900
* correct: 2,448
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 60.5%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh dtd 1 0 main_tmp1_0.1sdl 16
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE BASE CLASSES!
384 576 864
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  24
# train_x  384
# val      576
# test     864
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/6] time 0.489 (2.274) data 0.000 (0.955) loss 2.2773 (2.1465) lr 1.0000e-01 eta 0:11:17
epoch [1/50] batch [4/6] time 0.489 (1.380) data 0.000 (0.478) loss 1.8047 (1.9570) lr 1.0000e-01 eta 0:06:48
epoch [1/50] batch [6/6] time 0.487 (1.082) data 0.000 (0.319) loss 1.9355 (1.9347) lr 9.9901e-02 eta 0:05:18
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:03<00:06,  3.03s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.42s/it]100%|██████████| 3/3 [00:03<00:00,  1.11it/s]100%|██████████| 3/3 [00:03<00:00,  1.23s/it]=> result
* total: 576
* correct: 334
* accuracy: 58.0%
* error: 42.0%
* macro_f1: 54.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/6] time 0.488 (1.040) data 0.000 (0.523) loss 1.7607 (1.8774) lr 9.9901e-02 eta 0:05:03
epoch [2/50] batch [4/6] time 0.485 (0.762) data 0.000 (0.262) loss 1.6680 (1.8066) lr 9.9901e-02 eta 0:03:41
epoch [2/50] batch [6/6] time 0.495 (0.672) data 0.000 (0.175) loss 2.1133 (1.8517) lr 9.9606e-02 eta 0:03:13
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 353
* accuracy: 61.3%
* error: 38.7%
* macro_f1: 57.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/6] time 0.511 (1.067) data 0.000 (0.513) loss 1.7422 (1.7793) lr 9.9606e-02 eta 0:05:05
epoch [3/50] batch [4/6] time 0.514 (0.790) data 0.000 (0.257) loss 1.6611 (1.7512) lr 9.9606e-02 eta 0:03:44
epoch [3/50] batch [6/6] time 0.508 (0.697) data 0.000 (0.171) loss 2.0020 (1.8034) lr 9.9114e-02 eta 0:03:16
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.81s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 356
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 58.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/6] time 0.486 (1.058) data 0.000 (0.525) loss 1.7285 (1.7349) lr 9.9114e-02 eta 0:04:56
epoch [4/50] batch [4/6] time 0.490 (0.774) data 0.000 (0.263) loss 1.6416 (1.7126) lr 9.9114e-02 eta 0:03:35
epoch [4/50] batch [6/6] time 0.494 (0.680) data 0.000 (0.175) loss 1.5713 (1.6828) lr 9.8429e-02 eta 0:03:07
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 356
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 58.7%

epoch [5/50] batch [2/6] time 0.506 (1.067) data 0.000 (0.555) loss 1.7363 (1.5610) lr 9.8429e-02 eta 0:04:52
epoch [5/50] batch [4/6] time 0.517 (0.792) data 0.000 (0.278) loss 1.7832 (1.6777) lr 9.8429e-02 eta 0:03:35
epoch [5/50] batch [6/6] time 0.514 (0.699) data 0.000 (0.185) loss 1.5391 (1.6593) lr 9.7553e-02 eta 0:03:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 366
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 60.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [6/50] batch [2/6] time 0.523 (1.107) data 0.001 (0.531) loss 1.5117 (1.5605) lr 9.7553e-02 eta 0:04:56
epoch [6/50] batch [4/6] time 0.504 (0.805) data 0.000 (0.265) loss 1.8535 (1.5994) lr 9.7553e-02 eta 0:03:34
epoch [6/50] batch [6/6] time 0.503 (0.704) data 0.000 (0.177) loss 1.6338 (1.6248) lr 9.6489e-02 eta 0:03:05
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.75s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 363
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 60.3%

epoch [7/50] batch [2/6] time 0.502 (1.047) data 0.000 (0.523) loss 1.6318 (1.6274) lr 9.6489e-02 eta 0:04:34
epoch [7/50] batch [4/6] time 0.500 (0.774) data 0.000 (0.262) loss 1.5576 (1.5598) lr 9.6489e-02 eta 0:03:21
epoch [7/50] batch [6/6] time 0.498 (0.682) data 0.000 (0.175) loss 1.7158 (1.5947) lr 9.5241e-02 eta 0:02:56
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.74s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 365
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 60.6%

epoch [8/50] batch [2/6] time 0.511 (1.059) data 0.000 (0.515) loss 1.7998 (1.7251) lr 9.5241e-02 eta 0:04:31
epoch [8/50] batch [4/6] time 0.505 (0.784) data 0.000 (0.258) loss 1.4336 (1.6675) lr 9.5241e-02 eta 0:03:19
epoch [8/50] batch [6/6] time 0.504 (0.692) data 0.000 (0.172) loss 1.6309 (1.6198) lr 9.3815e-02 eta 0:02:54
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 373
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 62.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/6] time 0.501 (1.095) data 0.000 (0.568) loss 1.7295 (1.5850) lr 9.3815e-02 eta 0:04:33
epoch [9/50] batch [4/6] time 0.502 (0.799) data 0.000 (0.284) loss 1.4814 (1.5969) lr 9.3815e-02 eta 0:03:18
epoch [9/50] batch [6/6] time 0.505 (0.701) data 0.000 (0.190) loss 1.4736 (1.5706) lr 9.2216e-02 eta 0:02:52
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.72s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.29s/it]100%|██████████| 3/3 [00:03<00:00,  1.21it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 373
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 62.0%

epoch [10/50] batch [2/6] time 0.505 (1.056) data 0.000 (0.513) loss 1.5664 (1.4409) lr 9.2216e-02 eta 0:04:17
epoch [10/50] batch [4/6] time 0.507 (0.781) data 0.000 (0.256) loss 1.7334 (1.5559) lr 9.2216e-02 eta 0:03:08
epoch [10/50] batch [6/6] time 0.501 (0.688) data 0.000 (0.171) loss 1.3428 (1.5283) lr 9.0451e-02 eta 0:02:45
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 376
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 62.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/6] time 0.496 (1.064) data 0.000 (0.556) loss 1.3975 (1.4600) lr 9.0451e-02 eta 0:04:13
epoch [11/50] batch [4/6] time 0.509 (0.786) data 0.000 (0.278) loss 1.5049 (1.5012) lr 9.0451e-02 eta 0:03:05
epoch [11/50] batch [6/6] time 0.529 (0.699) data 0.000 (0.185) loss 1.4385 (1.5116) lr 8.8526e-02 eta 0:02:43
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 374
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 62.7%

epoch [12/50] batch [2/6] time 0.504 (1.041) data 0.000 (0.504) loss 1.5029 (1.5420) lr 8.8526e-02 eta 0:04:01
epoch [12/50] batch [4/6] time 0.500 (0.771) data 0.000 (0.252) loss 1.4688 (1.5239) lr 8.8526e-02 eta 0:02:57
epoch [12/50] batch [6/6] time 0.497 (0.680) data 0.000 (0.168) loss 1.5332 (1.5207) lr 8.6448e-02 eta 0:02:35
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.72s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.29s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 382
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 64.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [13/50] batch [2/6] time 0.532 (1.075) data 0.000 (0.507) loss 1.3516 (1.4053) lr 8.6448e-02 eta 0:04:02
epoch [13/50] batch [4/6] time 0.510 (0.791) data 0.000 (0.254) loss 1.6533 (1.4438) lr 8.6448e-02 eta 0:02:57
epoch [13/50] batch [6/6] time 0.512 (0.700) data 0.000 (0.169) loss 1.5068 (1.4512) lr 8.4227e-02 eta 0:02:35
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.77s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 383
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 64.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [14/50] batch [2/6] time 0.526 (1.107) data 0.000 (0.571) loss 1.5000 (1.4277) lr 8.4227e-02 eta 0:04:03
epoch [14/50] batch [4/6] time 0.519 (0.816) data 0.000 (0.286) loss 1.3662 (1.3977) lr 8.4227e-02 eta 0:02:57
epoch [14/50] batch [6/6] time 0.498 (0.711) data 0.000 (0.190) loss 1.3408 (1.4396) lr 8.1871e-02 eta 0:02:33
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.74s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 398
* accuracy: 69.1%
* error: 30.9%
* macro_f1: 67.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [15/50] batch [2/6] time 0.501 (1.079) data 0.000 (0.568) loss 1.2959 (1.3345) lr 8.1871e-02 eta 0:03:50
epoch [15/50] batch [4/6] time 0.502 (0.790) data 0.000 (0.284) loss 1.2461 (1.3494) lr 8.1871e-02 eta 0:02:47
epoch [15/50] batch [6/6] time 0.498 (0.693) data 0.000 (0.189) loss 1.5498 (1.4027) lr 7.9389e-02 eta 0:02:25
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.71s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.29s/it]100%|██████████| 3/3 [00:03<00:00,  1.21it/s]100%|██████████| 3/3 [00:03<00:00,  1.12s/it]=> result
* total: 576
* correct: 394
* accuracy: 68.4%
* error: 31.6%
* macro_f1: 66.1%

epoch [16/50] batch [2/6] time 0.511 (1.075) data 0.000 (0.551) loss 1.4746 (1.3911) lr 7.9389e-02 eta 0:03:43
epoch [16/50] batch [4/6] time 0.510 (0.793) data 0.000 (0.276) loss 1.4346 (1.4241) lr 7.9389e-02 eta 0:02:43
epoch [16/50] batch [6/6] time 0.507 (0.700) data 0.000 (0.184) loss 1.1914 (1.4209) lr 7.6791e-02 eta 0:02:22
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 398
* accuracy: 69.1%
* error: 30.9%
* macro_f1: 67.5%

epoch [17/50] batch [2/6] time 0.504 (1.075) data 0.000 (0.534) loss 1.2686 (1.3164) lr 7.6791e-02 eta 0:03:37
epoch [17/50] batch [4/6] time 0.500 (0.788) data 0.000 (0.267) loss 1.5908 (1.4302) lr 7.6791e-02 eta 0:02:37
epoch [17/50] batch [6/6] time 0.507 (0.693) data 0.000 (0.178) loss 1.4121 (1.4253) lr 7.4088e-02 eta 0:02:17
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.90s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 402
* accuracy: 69.8%
* error: 30.2%
* macro_f1: 67.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [18/50] batch [2/6] time 0.502 (1.155) data 0.000 (0.543) loss 1.3672 (1.3950) lr 7.4088e-02 eta 0:03:46
epoch [18/50] batch [4/6] time 0.503 (0.829) data 0.000 (0.272) loss 1.6797 (1.4888) lr 7.4088e-02 eta 0:02:40
epoch [18/50] batch [6/6] time 0.506 (0.721) data 0.000 (0.181) loss 1.3135 (1.4168) lr 7.1289e-02 eta 0:02:18
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 403
* accuracy: 70.0%
* error: 30.0%
* macro_f1: 68.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [19/50] batch [2/6] time 0.504 (1.073) data 0.000 (0.529) loss 1.4551 (1.4238) lr 7.1289e-02 eta 0:03:23
epoch [19/50] batch [4/6] time 0.514 (0.789) data 0.000 (0.265) loss 1.2451 (1.3716) lr 7.1289e-02 eta 0:02:28
epoch [19/50] batch [6/6] time 0.530 (0.701) data 0.000 (0.177) loss 1.3457 (1.3737) lr 6.8406e-02 eta 0:02:10
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 415
* accuracy: 72.0%
* error: 28.0%
* macro_f1: 70.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [20/50] batch [2/6] time 0.497 (1.059) data 0.000 (0.532) loss 1.2656 (1.3232) lr 6.8406e-02 eta 0:03:14
epoch [20/50] batch [4/6] time 0.499 (0.778) data 0.000 (0.266) loss 1.3545 (1.3164) lr 6.8406e-02 eta 0:02:21
epoch [20/50] batch [6/6] time 0.499 (0.685) data 0.000 (0.177) loss 1.4414 (1.3519) lr 6.5451e-02 eta 0:02:03
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 408
* accuracy: 70.8%
* error: 29.2%
* macro_f1: 69.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/6] time 0.498 (1.038) data 0.000 (0.520) loss 1.5273 (1.4736) lr 6.5451e-02 eta 0:03:04
epoch [21/50] batch [4/6] time 0.502 (0.769) data 0.000 (0.260) loss 1.3770 (1.3723) lr 6.5451e-02 eta 0:02:15
epoch [21/50] batch [6/6] time 0.518 (0.684) data 0.000 (0.173) loss 1.4668 (1.3854) lr 6.2434e-02 eta 0:01:58
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 411
* accuracy: 71.4%
* error: 28.6%
* macro_f1: 69.9%

epoch [22/50] batch [2/6] time 0.527 (1.086) data 0.000 (0.544) loss 1.5000 (1.3633) lr 6.2434e-02 eta 0:03:06
epoch [22/50] batch [4/6] time 0.534 (0.809) data 0.000 (0.272) loss 1.3613 (1.3669) lr 6.2434e-02 eta 0:02:17
epoch [22/50] batch [6/6] time 0.510 (0.711) data 0.000 (0.181) loss 1.3730 (1.3677) lr 5.9369e-02 eta 0:01:59
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 415
* accuracy: 72.0%
* error: 28.0%
* macro_f1: 70.6%

epoch [23/50] batch [2/6] time 0.506 (1.110) data 0.000 (0.578) loss 1.3574 (1.3286) lr 5.9369e-02 eta 0:03:04
epoch [23/50] batch [4/6] time 0.508 (0.808) data 0.000 (0.289) loss 1.3281 (1.3267) lr 5.9369e-02 eta 0:02:12
epoch [23/50] batch [6/6] time 0.501 (0.706) data 0.000 (0.193) loss 1.2715 (1.3078) lr 5.6267e-02 eta 0:01:54
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.75s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 415
* accuracy: 72.0%
* error: 28.0%
* macro_f1: 71.0%

epoch [24/50] batch [2/6] time 0.513 (1.065) data 0.000 (0.529) loss 1.3662 (1.2764) lr 5.6267e-02 eta 0:02:50
epoch [24/50] batch [4/6] time 0.513 (0.789) data 0.000 (0.265) loss 1.3604 (1.2908) lr 5.6267e-02 eta 0:02:04
epoch [24/50] batch [6/6] time 0.510 (0.697) data 0.000 (0.177) loss 1.3750 (1.2905) lr 5.3140e-02 eta 0:01:48
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.87s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 416
* accuracy: 72.2%
* error: 27.8%
* macro_f1: 70.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [25/50] batch [2/6] time 0.500 (1.087) data 0.000 (0.555) loss 1.3232 (1.2778) lr 5.3140e-02 eta 0:02:47
epoch [25/50] batch [4/6] time 0.504 (0.794) data 0.000 (0.278) loss 1.3623 (1.2957) lr 5.3140e-02 eta 0:02:00
epoch [25/50] batch [6/6] time 0.503 (0.697) data 0.000 (0.185) loss 1.2363 (1.2632) lr 5.0000e-02 eta 0:01:44
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 417
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 71.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [26/50] batch [2/6] time 0.498 (1.073) data 0.000 (0.562) loss 1.4219 (1.3706) lr 5.0000e-02 eta 0:02:38
epoch [26/50] batch [4/6] time 0.499 (0.786) data 0.000 (0.281) loss 1.2227 (1.2927) lr 5.0000e-02 eta 0:01:54
epoch [26/50] batch [6/6] time 0.504 (0.693) data 0.000 (0.187) loss 1.2715 (1.2811) lr 4.6860e-02 eta 0:01:39
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.81s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 424
* accuracy: 73.6%
* error: 26.4%
* macro_f1: 72.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [27/50] batch [2/6] time 0.514 (1.085) data 0.000 (0.551) loss 1.3525 (1.2778) lr 4.6860e-02 eta 0:02:34
epoch [27/50] batch [4/6] time 0.507 (0.794) data 0.000 (0.275) loss 1.2080 (1.2188) lr 4.6860e-02 eta 0:01:51
epoch [27/50] batch [6/6] time 0.529 (0.703) data 0.000 (0.184) loss 1.2988 (1.2497) lr 4.3733e-02 eta 0:01:36
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 423
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 72.2%

epoch [28/50] batch [2/6] time 0.502 (1.054) data 0.000 (0.533) loss 1.2100 (1.2627) lr 4.3733e-02 eta 0:02:23
epoch [28/50] batch [4/6] time 0.499 (0.776) data 0.000 (0.267) loss 1.2725 (1.2781) lr 4.3733e-02 eta 0:01:44
epoch [28/50] batch [6/6] time 0.509 (0.685) data 0.000 (0.178) loss 1.2871 (1.2780) lr 4.0631e-02 eta 0:01:30
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 425
* accuracy: 73.8%
* error: 26.2%
* macro_f1: 72.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [29/50] batch [2/6] time 0.500 (1.061) data 0.000 (0.549) loss 1.1367 (1.1816) lr 4.0631e-02 eta 0:02:17
epoch [29/50] batch [4/6] time 0.502 (0.780) data 0.000 (0.274) loss 1.2197 (1.2000) lr 4.0631e-02 eta 0:01:39
epoch [29/50] batch [6/6] time 0.503 (0.687) data 0.000 (0.183) loss 1.1777 (1.2204) lr 3.7566e-02 eta 0:01:26
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 424
* accuracy: 73.6%
* error: 26.4%
* macro_f1: 72.4%

epoch [30/50] batch [2/6] time 0.518 (1.098) data 0.001 (0.553) loss 1.2432 (1.2539) lr 3.7566e-02 eta 0:02:16
epoch [30/50] batch [4/6] time 0.530 (0.814) data 0.000 (0.276) loss 1.4727 (1.3206) lr 3.7566e-02 eta 0:01:39
epoch [30/50] batch [6/6] time 0.505 (0.714) data 0.000 (0.184) loss 1.2158 (1.2764) lr 3.4549e-02 eta 0:01:25
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 423
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 71.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/6] time 0.503 (1.066) data 0.000 (0.539) loss 1.2588 (1.3281) lr 3.4549e-02 eta 0:02:05
epoch [31/50] batch [4/6] time 0.496 (0.785) data 0.000 (0.270) loss 1.2266 (1.2793) lr 3.4549e-02 eta 0:01:31
epoch [31/50] batch [6/6] time 0.499 (0.690) data 0.000 (0.180) loss 1.2812 (1.2695) lr 3.1594e-02 eta 0:01:18
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 73.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [32/50] batch [2/6] time 0.499 (1.061) data 0.000 (0.550) loss 1.2559 (1.2920) lr 3.1594e-02 eta 0:01:58
epoch [32/50] batch [4/6] time 0.500 (0.781) data 0.000 (0.275) loss 1.1816 (1.2715) lr 3.1594e-02 eta 0:01:25
epoch [32/50] batch [6/6] time 0.495 (0.686) data 0.000 (0.183) loss 1.2402 (1.2630) lr 2.8711e-02 eta 0:01:14
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.87s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 425
* accuracy: 73.8%
* error: 26.2%
* macro_f1: 72.8%

epoch [33/50] batch [2/6] time 0.496 (1.116) data 0.000 (0.587) loss 1.1504 (1.1699) lr 2.8711e-02 eta 0:01:58
epoch [33/50] batch [4/6] time 0.489 (0.802) data 0.000 (0.294) loss 1.4375 (1.2471) lr 2.8711e-02 eta 0:01:23
epoch [33/50] batch [6/6] time 0.486 (0.697) data 0.000 (0.196) loss 1.2012 (1.2227) lr 2.5912e-02 eta 0:01:11
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.74s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 73.4%

epoch [34/50] batch [2/6] time 0.493 (1.102) data 0.000 (0.585) loss 1.1641 (1.1602) lr 2.5912e-02 eta 0:01:50
epoch [34/50] batch [4/6] time 0.602 (0.824) data 0.000 (0.293) loss 1.1553 (1.1917) lr 2.5912e-02 eta 0:01:20
epoch [34/50] batch [6/6] time 0.485 (0.712) data 0.000 (0.195) loss 1.1562 (1.1825) lr 2.3209e-02 eta 0:01:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 427
* accuracy: 74.1%
* error: 25.9%
* macro_f1: 73.5%

epoch [35/50] batch [2/6] time 0.491 (1.071) data 0.000 (0.566) loss 1.1699 (1.2026) lr 2.3209e-02 eta 0:01:40
epoch [35/50] batch [4/6] time 0.495 (0.781) data 0.000 (0.283) loss 1.0898 (1.1631) lr 2.3209e-02 eta 0:01:11
epoch [35/50] batch [6/6] time 0.490 (0.683) data 0.000 (0.189) loss 1.1855 (1.1756) lr 2.0611e-02 eta 0:01:01
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.94s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.38s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.20s/it]=> result
* total: 576
* correct: 431
* accuracy: 74.8%
* error: 25.2%
* macro_f1: 73.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [36/50] batch [2/6] time 0.489 (1.019) data 0.000 (0.477) loss 1.1494 (1.2427) lr 2.0611e-02 eta 0:01:29
epoch [36/50] batch [4/6] time 0.491 (0.755) data 0.000 (0.239) loss 1.2432 (1.2180) lr 2.0611e-02 eta 0:01:04
epoch [36/50] batch [6/6] time 0.489 (0.667) data 0.000 (0.159) loss 1.0811 (1.1781) lr 1.8129e-02 eta 0:00:56
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 432
* accuracy: 75.0%
* error: 25.0%
* macro_f1: 74.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [37/50] batch [2/6] time 0.492 (1.031) data 0.000 (0.493) loss 1.1865 (1.1997) lr 1.8129e-02 eta 0:01:24
epoch [37/50] batch [4/6] time 0.489 (0.761) data 0.000 (0.247) loss 1.2617 (1.1838) lr 1.8129e-02 eta 0:01:00
epoch [37/50] batch [6/6] time 0.491 (0.670) data 0.000 (0.165) loss 1.2529 (1.1973) lr 1.5773e-02 eta 0:00:52
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 436
* accuracy: 75.7%
* error: 24.3%
* macro_f1: 74.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [38/50] batch [2/6] time 0.497 (1.028) data 0.000 (0.498) loss 1.1855 (1.2222) lr 1.5773e-02 eta 0:01:18
epoch [38/50] batch [4/6] time 0.516 (0.772) data 0.000 (0.249) loss 1.2930 (1.2190) lr 1.5773e-02 eta 0:00:57
epoch [38/50] batch [6/6] time 0.514 (0.686) data 0.000 (0.166) loss 1.1357 (1.2017) lr 1.3552e-02 eta 0:00:49
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 432
* accuracy: 75.0%
* error: 25.0%
* macro_f1: 74.2%

epoch [39/50] batch [2/6] time 0.492 (1.038) data 0.000 (0.501) loss 1.0605 (1.1802) lr 1.3552e-02 eta 0:01:12
epoch [39/50] batch [4/6] time 0.505 (0.769) data 0.000 (0.251) loss 1.1846 (1.2151) lr 1.3552e-02 eta 0:00:52
epoch [39/50] batch [6/6] time 0.499 (0.679) data 0.000 (0.167) loss 1.1357 (1.1969) lr 1.1474e-02 eta 0:00:44
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.73s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 434
* accuracy: 75.3%
* error: 24.7%
* macro_f1: 74.0%

epoch [40/50] batch [2/6] time 0.492 (1.075) data 0.000 (0.555) loss 1.1318 (1.1909) lr 1.1474e-02 eta 0:01:08
epoch [40/50] batch [4/6] time 0.502 (0.786) data 0.000 (0.278) loss 1.2236 (1.2017) lr 1.1474e-02 eta 0:00:48
epoch [40/50] batch [6/6] time 0.501 (0.691) data 0.000 (0.185) loss 1.1543 (1.1787) lr 9.5492e-03 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 73.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/6] time 0.514 (1.120) data 0.000 (0.595) loss 1.1650 (1.2266) lr 9.5492e-03 eta 0:01:04
epoch [41/50] batch [4/6] time 0.491 (0.808) data 0.000 (0.298) loss 1.2988 (1.2549) lr 9.5492e-03 eta 0:00:45
epoch [41/50] batch [6/6] time 0.486 (0.701) data 0.000 (0.199) loss 1.1533 (1.2087) lr 7.7836e-03 eta 0:00:37
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 435
* accuracy: 75.5%
* error: 24.5%
* macro_f1: 74.6%

epoch [42/50] batch [2/6] time 0.490 (1.033) data 0.000 (0.529) loss 1.1455 (1.1353) lr 7.7836e-03 eta 0:00:53
epoch [42/50] batch [4/6] time 0.488 (0.760) data 0.000 (0.265) loss 1.0986 (1.1294) lr 7.7836e-03 eta 0:00:38
epoch [42/50] batch [6/6] time 0.486 (0.669) data 0.000 (0.176) loss 1.2764 (1.1691) lr 6.1847e-03 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 432
* accuracy: 75.0%
* error: 25.0%
* macro_f1: 73.9%

epoch [43/50] batch [2/6] time 0.499 (1.048) data 0.000 (0.498) loss 1.2080 (1.1792) lr 6.1847e-03 eta 0:00:48
epoch [43/50] batch [4/6] time 0.493 (0.771) data 0.000 (0.249) loss 1.2969 (1.2000) lr 6.1847e-03 eta 0:00:33
epoch [43/50] batch [6/6] time 0.488 (0.678) data 0.000 (0.166) loss 1.1865 (1.1842) lr 4.7586e-03 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 434
* accuracy: 75.3%
* error: 24.7%
* macro_f1: 74.2%

epoch [44/50] batch [2/6] time 0.504 (1.063) data 0.000 (0.538) loss 1.0928 (1.1362) lr 4.7586e-03 eta 0:00:42
epoch [44/50] batch [4/6] time 0.497 (0.780) data 0.000 (0.269) loss 1.1611 (1.1404) lr 4.7586e-03 eta 0:00:29
epoch [44/50] batch [6/6] time 0.495 (0.685) data 0.000 (0.179) loss 1.0381 (1.1517) lr 3.5112e-03 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.77s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 435
* accuracy: 75.5%
* error: 24.5%
* macro_f1: 74.5%

epoch [45/50] batch [2/6] time 0.487 (1.064) data 0.000 (0.566) loss 1.1514 (1.1113) lr 3.5112e-03 eta 0:00:36
epoch [45/50] batch [4/6] time 0.486 (0.776) data 0.000 (0.283) loss 1.0938 (1.1189) lr 3.5112e-03 eta 0:00:24
epoch [45/50] batch [6/6] time 0.485 (0.678) data 0.000 (0.189) loss 1.1084 (1.1450) lr 2.4472e-03 eta 0:00:20
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 436
* accuracy: 75.7%
* error: 24.3%
* macro_f1: 74.7%

epoch [46/50] batch [2/6] time 0.490 (1.057) data 0.000 (0.543) loss 1.1689 (1.1284) lr 2.4472e-03 eta 0:00:29
epoch [46/50] batch [4/6] time 0.500 (0.776) data 0.000 (0.272) loss 1.1270 (1.1499) lr 2.4472e-03 eta 0:00:20
epoch [46/50] batch [6/6] time 0.511 (0.685) data 0.000 (0.181) loss 1.2227 (1.1510) lr 1.5708e-03 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.86s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 435
* accuracy: 75.5%
* error: 24.5%
* macro_f1: 74.5%

epoch [47/50] batch [2/6] time 0.489 (1.019) data 0.000 (0.508) loss 1.0879 (1.1426) lr 1.5708e-03 eta 0:00:22
epoch [47/50] batch [4/6] time 0.487 (0.752) data 0.000 (0.254) loss 1.0898 (1.1609) lr 1.5708e-03 eta 0:00:15
epoch [47/50] batch [6/6] time 0.490 (0.663) data 0.000 (0.170) loss 1.0723 (1.1667) lr 8.8564e-04 eta 0:00:11
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 434
* accuracy: 75.3%
* error: 24.7%
* macro_f1: 74.3%

epoch [48/50] batch [2/6] time 0.483 (1.062) data 0.000 (0.554) loss 1.1689 (1.1411) lr 8.8564e-04 eta 0:00:16
epoch [48/50] batch [4/6] time 0.486 (0.774) data 0.000 (0.277) loss 1.2598 (1.1846) lr 8.8564e-04 eta 0:00:10
epoch [48/50] batch [6/6] time 0.506 (0.683) data 0.000 (0.185) loss 1.1270 (1.1579) lr 3.9426e-04 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 434
* accuracy: 75.3%
* error: 24.7%
* macro_f1: 74.4%

epoch [49/50] batch [2/6] time 0.509 (1.061) data 0.000 (0.544) loss 1.1045 (1.1685) lr 3.9426e-04 eta 0:00:10
epoch [49/50] batch [4/6] time 0.512 (0.787) data 0.000 (0.272) loss 1.2441 (1.1797) lr 3.9426e-04 eta 0:00:06
epoch [49/50] batch [6/6] time 0.499 (0.693) data 0.000 (0.181) loss 1.1084 (1.1512) lr 9.8664e-05 eta 0:00:04
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 434
* accuracy: 75.3%
* error: 24.7%
* macro_f1: 74.3%

epoch [50/50] batch [2/6] time 0.505 (1.038) data 0.001 (0.478) loss 1.0781 (1.1240) lr 9.8664e-05 eta 0:00:04
epoch [50/50] batch [4/6] time 0.497 (0.768) data 0.000 (0.239) loss 1.2295 (1.1731) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [6/6] time 0.496 (0.678) data 0.000 (0.160) loss 1.1719 (1.1707) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.74s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]
=> result
* total: 576
* correct: 434
* accuracy: 75.3%
* error: 24.7%
* macro_f1: 74.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 37)
Evaluate on the *test* set
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:02<00:11,  2.95s/it] 40%|████      | 2/5 [00:03<00:04,  1.39s/it] 60%|██████    | 3/5 [00:03<00:01,  1.12it/s] 80%|████████  | 4/5 [00:03<00:00,  1.52it/s]100%|██████████| 5/5 [00:03<00:00,  2.12it/s]100%|██████████| 5/5 [00:04<00:00,  1.23it/s]
=> result
* total: 864
* correct: 663
* accuracy: 76.7%
* error: 23.3%
* macro_f1: 76.1%
Elapsed: 0:06:33
+ sh scripts/rpo_prime/base2new_test_sdl.sh dtd 1 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE NEW CLASSES!
368 552 828
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  23
# train_x  368
# val      552
# test     828
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 37)
Evaluate on the *test* set
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:05<00:21,  5.33s/it] 40%|████      | 2/5 [00:05<00:07,  2.37s/it] 60%|██████    | 3/5 [00:05<00:02,  1.42s/it] 80%|████████  | 4/5 [00:06<00:00,  1.03it/s]100%|██████████| 5/5 [00:06<00:00,  1.27s/it]
=> result
* total: 828
* correct: 529
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 63.5%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh dtd 2 0 main_tmp1_0.1sdl 16
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE BASE CLASSES!
384 576 864
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  24
# train_x  384
# val      576
# test     864
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/6] time 0.493 (2.192) data 0.000 (0.902) loss 1.9258 (1.9287) lr 1.0000e-01 eta 0:10:53
epoch [1/50] batch [4/6] time 0.500 (1.345) data 0.000 (0.451) loss 1.7480 (1.9097) lr 1.0000e-01 eta 0:06:38
epoch [1/50] batch [6/6] time 0.496 (1.062) data 0.000 (0.301) loss 2.1465 (1.9461) lr 9.9901e-02 eta 0:05:12
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.97s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.39s/it]100%|██████████| 3/3 [00:03<00:00,  1.13it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 330
* accuracy: 57.3%
* error: 42.7%
* macro_f1: 52.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/6] time 0.500 (1.079) data 0.000 (0.533) loss 1.9990 (2.0640) lr 9.9901e-02 eta 0:05:15
epoch [2/50] batch [4/6] time 0.485 (0.782) data 0.000 (0.267) loss 1.9492 (1.9539) lr 9.9901e-02 eta 0:03:46
epoch [2/50] batch [6/6] time 0.480 (0.682) data 0.000 (0.178) loss 1.5400 (1.8809) lr 9.9606e-02 eta 0:03:16
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.77s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 337
* accuracy: 58.5%
* error: 41.5%
* macro_f1: 54.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/6] time 0.490 (1.056) data 0.000 (0.544) loss 1.9854 (1.8530) lr 9.9606e-02 eta 0:05:02
epoch [3/50] batch [4/6] time 0.480 (0.769) data 0.000 (0.272) loss 1.7148 (1.8223) lr 9.9606e-02 eta 0:03:38
epoch [3/50] batch [6/6] time 0.485 (0.674) data 0.000 (0.182) loss 1.6738 (1.8034) lr 9.9114e-02 eta 0:03:10
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.73s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 350
* accuracy: 60.8%
* error: 39.2%
* macro_f1: 56.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/6] time 0.498 (1.087) data 0.000 (0.556) loss 1.8887 (1.8164) lr 9.9114e-02 eta 0:05:04
epoch [4/50] batch [4/6] time 0.490 (0.790) data 0.000 (0.278) loss 1.7334 (1.7712) lr 9.9114e-02 eta 0:03:39
epoch [4/50] batch [6/6] time 0.493 (0.690) data 0.000 (0.186) loss 1.6113 (1.7562) lr 9.8429e-02 eta 0:03:10
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.91s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 356
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 57.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/6] time 0.489 (1.097) data 0.000 (0.572) loss 1.6895 (1.7632) lr 9.8429e-02 eta 0:05:00
epoch [5/50] batch [4/6] time 0.485 (0.792) data 0.000 (0.286) loss 1.9082 (1.8025) lr 9.8429e-02 eta 0:03:35
epoch [5/50] batch [6/6] time 0.484 (0.690) data 0.000 (0.191) loss 1.4268 (1.6755) lr 9.7553e-02 eta 0:03:06
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.81s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 353
* accuracy: 61.3%
* error: 38.7%
* macro_f1: 57.5%

epoch [6/50] batch [2/6] time 0.485 (1.045) data 0.000 (0.509) loss 1.4971 (1.4766) lr 9.7553e-02 eta 0:04:40
epoch [6/50] batch [4/6] time 0.481 (0.763) data 0.000 (0.255) loss 1.5605 (1.5435) lr 9.7553e-02 eta 0:03:22
epoch [6/50] batch [6/6] time 0.480 (0.668) data 0.000 (0.170) loss 1.7930 (1.6019) lr 9.6489e-02 eta 0:02:56
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.81s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 352
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 57.7%

epoch [7/50] batch [2/6] time 0.485 (1.066) data 0.000 (0.545) loss 1.5479 (1.5181) lr 9.6489e-02 eta 0:04:39
epoch [7/50] batch [4/6] time 0.498 (0.780) data 0.000 (0.273) loss 1.7246 (1.5725) lr 9.6489e-02 eta 0:03:22
epoch [7/50] batch [6/6] time 0.509 (0.687) data 0.000 (0.182) loss 1.5664 (1.5902) lr 9.5241e-02 eta 0:02:57
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 356
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 58.5%

epoch [8/50] batch [2/6] time 0.492 (1.036) data 0.000 (0.515) loss 1.6455 (1.6665) lr 9.5241e-02 eta 0:04:25
epoch [8/50] batch [4/6] time 0.487 (0.761) data 0.000 (0.257) loss 1.4248 (1.6023) lr 9.5241e-02 eta 0:03:13
epoch [8/50] batch [6/6] time 0.487 (0.670) data 0.000 (0.172) loss 1.5635 (1.6113) lr 9.3815e-02 eta 0:02:48
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 360
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 59.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/6] time 0.490 (1.027) data 0.000 (0.504) loss 1.4600 (1.5264) lr 9.3815e-02 eta 0:04:16
epoch [9/50] batch [4/6] time 0.490 (0.758) data 0.000 (0.252) loss 1.7607 (1.5803) lr 9.3815e-02 eta 0:03:08
epoch [9/50] batch [6/6] time 0.492 (0.670) data 0.000 (0.168) loss 1.4873 (1.5648) lr 9.2216e-02 eta 0:02:44
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 362
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 60.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [10/50] batch [2/6] time 0.528 (1.055) data 0.000 (0.493) loss 1.5508 (1.5669) lr 9.2216e-02 eta 0:04:17
epoch [10/50] batch [4/6] time 0.510 (0.784) data 0.000 (0.246) loss 1.4824 (1.5474) lr 9.2216e-02 eta 0:03:09
epoch [10/50] batch [6/6] time 0.500 (0.691) data 0.000 (0.164) loss 1.4873 (1.5342) lr 9.0451e-02 eta 0:02:45
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 367
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 61.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/6] time 0.488 (1.058) data 0.000 (0.552) loss 1.5645 (1.5459) lr 9.0451e-02 eta 0:04:11
epoch [11/50] batch [4/6] time 0.492 (0.777) data 0.000 (0.276) loss 1.5508 (1.5242) lr 9.0451e-02 eta 0:03:03
epoch [11/50] batch [6/6] time 0.493 (0.682) data 0.000 (0.184) loss 1.5840 (1.5407) lr 8.8526e-02 eta 0:02:39
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 368
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 61.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [12/50] batch [2/6] time 0.511 (1.059) data 0.000 (0.513) loss 1.4502 (1.5898) lr 8.8526e-02 eta 0:04:05
epoch [12/50] batch [4/6] time 0.500 (0.780) data 0.000 (0.257) loss 1.5234 (1.5386) lr 8.8526e-02 eta 0:02:59
epoch [12/50] batch [6/6] time 0.505 (0.688) data 0.000 (0.171) loss 1.4121 (1.5002) lr 8.6448e-02 eta 0:02:36
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 373
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 62.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [13/50] batch [2/6] time 0.495 (1.073) data 0.000 (0.529) loss 1.3682 (1.4375) lr 8.6448e-02 eta 0:04:02
epoch [13/50] batch [4/6] time 0.496 (0.783) data 0.000 (0.265) loss 1.5234 (1.4761) lr 8.6448e-02 eta 0:02:55
epoch [13/50] batch [6/6] time 0.489 (0.686) data 0.000 (0.177) loss 1.5908 (1.5055) lr 8.4227e-02 eta 0:02:32
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 380
* accuracy: 66.0%
* error: 34.0%
* macro_f1: 63.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [14/50] batch [2/6] time 0.523 (1.049) data 0.001 (0.489) loss 1.5625 (1.4346) lr 8.4227e-02 eta 0:03:50
epoch [14/50] batch [4/6] time 0.503 (0.779) data 0.000 (0.244) loss 1.5459 (1.4497) lr 8.4227e-02 eta 0:02:49
epoch [14/50] batch [6/6] time 0.492 (0.684) data 0.000 (0.163) loss 1.4473 (1.4507) lr 8.1871e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.73s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 381
* accuracy: 66.1%
* error: 33.9%
* macro_f1: 64.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [15/50] batch [2/6] time 0.492 (1.072) data 0.000 (0.549) loss 1.3955 (1.4888) lr 8.1871e-02 eta 0:03:49
epoch [15/50] batch [4/6] time 0.491 (0.784) data 0.000 (0.274) loss 1.4531 (1.4526) lr 8.1871e-02 eta 0:02:46
epoch [15/50] batch [6/6] time 0.516 (0.691) data 0.000 (0.183) loss 1.4014 (1.4300) lr 7.9389e-02 eta 0:02:25
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.95s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.39s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.20s/it]=> result
* total: 576
* correct: 382
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 64.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/6] time 0.494 (1.042) data 0.000 (0.512) loss 1.3369 (1.4482) lr 7.9389e-02 eta 0:03:36
epoch [16/50] batch [4/6] time 0.491 (0.767) data 0.000 (0.256) loss 1.4912 (1.4314) lr 7.9389e-02 eta 0:02:38
epoch [16/50] batch [6/6] time 0.496 (0.676) data 0.000 (0.171) loss 1.4258 (1.4352) lr 7.6791e-02 eta 0:02:17
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.73s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 383
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 64.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [17/50] batch [2/6] time 0.486 (1.067) data 0.000 (0.560) loss 1.4912 (1.4995) lr 7.6791e-02 eta 0:03:35
epoch [17/50] batch [4/6] time 0.485 (0.775) data 0.000 (0.280) loss 1.3682 (1.4741) lr 7.6791e-02 eta 0:02:35
epoch [17/50] batch [6/6] time 0.492 (0.681) data 0.000 (0.187) loss 1.3281 (1.4354) lr 7.4088e-02 eta 0:02:14
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.95s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.39s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 393
* accuracy: 68.2%
* error: 31.8%
* macro_f1: 66.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [18/50] batch [2/6] time 0.497 (1.155) data 0.000 (0.560) loss 1.2441 (1.3047) lr 7.4088e-02 eta 0:03:46
epoch [18/50] batch [4/6] time 0.513 (0.833) data 0.000 (0.280) loss 1.5547 (1.4143) lr 7.4088e-02 eta 0:02:41
epoch [18/50] batch [6/6] time 0.508 (0.727) data 0.000 (0.187) loss 1.2559 (1.3659) lr 7.1289e-02 eta 0:02:19
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 392
* accuracy: 68.1%
* error: 31.9%
* macro_f1: 66.2%

epoch [19/50] batch [2/6] time 0.490 (1.044) data 0.000 (0.516) loss 1.3184 (1.4097) lr 7.1289e-02 eta 0:03:18
epoch [19/50] batch [4/6] time 0.482 (0.763) data 0.000 (0.258) loss 1.3799 (1.3923) lr 7.1289e-02 eta 0:02:23
epoch [19/50] batch [6/6] time 0.486 (0.671) data 0.000 (0.172) loss 1.2920 (1.3810) lr 6.8406e-02 eta 0:02:04
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.72s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 398
* accuracy: 69.1%
* error: 30.9%
* macro_f1: 68.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [20/50] batch [2/6] time 0.491 (1.060) data 0.000 (0.549) loss 1.4072 (1.3911) lr 6.8406e-02 eta 0:03:14
epoch [20/50] batch [4/6] time 0.498 (0.780) data 0.000 (0.274) loss 1.3945 (1.3665) lr 6.8406e-02 eta 0:02:21
epoch [20/50] batch [6/6] time 0.496 (0.685) data 0.000 (0.183) loss 1.2891 (1.3768) lr 6.5451e-02 eta 0:02:03
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 403
* accuracy: 70.0%
* error: 30.0%
* macro_f1: 69.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/6] time 0.524 (1.137) data 0.001 (0.577) loss 1.3848 (1.3535) lr 6.5451e-02 eta 0:03:22
epoch [21/50] batch [4/6] time 0.498 (0.820) data 0.000 (0.288) loss 1.3877 (1.3567) lr 6.5451e-02 eta 0:02:24
epoch [21/50] batch [6/6] time 0.497 (0.713) data 0.000 (0.192) loss 1.3223 (1.3307) lr 6.2434e-02 eta 0:02:04
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 400
* accuracy: 69.4%
* error: 30.6%
* macro_f1: 68.7%

epoch [22/50] batch [2/6] time 0.498 (1.039) data 0.000 (0.508) loss 1.4980 (1.4888) lr 6.2434e-02 eta 0:02:58
epoch [22/50] batch [4/6] time 0.503 (0.770) data 0.000 (0.254) loss 1.3438 (1.3640) lr 6.2434e-02 eta 0:02:10
epoch [22/50] batch [6/6] time 0.498 (0.681) data 0.000 (0.169) loss 1.3604 (1.3239) lr 5.9369e-02 eta 0:01:54
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.73s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 407
* accuracy: 70.7%
* error: 29.3%
* macro_f1: 69.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [23/50] batch [2/6] time 0.507 (1.109) data 0.000 (0.557) loss 1.4678 (1.3975) lr 5.9369e-02 eta 0:03:04
epoch [23/50] batch [4/6] time 0.502 (0.807) data 0.000 (0.279) loss 1.3955 (1.4084) lr 5.9369e-02 eta 0:02:12
epoch [23/50] batch [6/6] time 0.509 (0.706) data 0.000 (0.186) loss 1.3965 (1.3735) lr 5.6267e-02 eta 0:01:54
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.87s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 412
* accuracy: 71.5%
* error: 28.5%
* macro_f1: 70.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [24/50] batch [2/6] time 0.497 (1.058) data 0.000 (0.524) loss 1.3057 (1.2886) lr 5.6267e-02 eta 0:02:49
epoch [24/50] batch [4/6] time 0.494 (0.778) data 0.000 (0.262) loss 1.4922 (1.3206) lr 5.6267e-02 eta 0:02:02
epoch [24/50] batch [6/6] time 0.501 (0.685) data 0.000 (0.175) loss 1.4258 (1.3260) lr 5.3140e-02 eta 0:01:46
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 412
* accuracy: 71.5%
* error: 28.5%
* macro_f1: 70.8%

epoch [25/50] batch [2/6] time 0.500 (1.068) data 0.000 (0.548) loss 1.2002 (1.2739) lr 5.3140e-02 eta 0:02:44
epoch [25/50] batch [4/6] time 0.498 (0.782) data 0.000 (0.274) loss 1.3945 (1.3181) lr 5.3140e-02 eta 0:01:58
epoch [25/50] batch [6/6] time 0.502 (0.689) data 0.000 (0.183) loss 1.4531 (1.3140) lr 5.0000e-02 eta 0:01:43
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 409
* accuracy: 71.0%
* error: 29.0%
* macro_f1: 70.4%

epoch [26/50] batch [2/6] time 0.503 (1.091) data 0.000 (0.558) loss 1.3789 (1.3750) lr 5.0000e-02 eta 0:02:41
epoch [26/50] batch [4/6] time 0.527 (0.809) data 0.000 (0.279) loss 1.1875 (1.2881) lr 5.0000e-02 eta 0:01:58
epoch [26/50] batch [6/6] time 0.528 (0.715) data 0.000 (0.186) loss 1.2900 (1.2858) lr 4.6860e-02 eta 0:01:43
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 420
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 72.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [27/50] batch [2/6] time 0.498 (1.062) data 0.000 (0.519) loss 1.3301 (1.3105) lr 4.6860e-02 eta 0:02:30
epoch [27/50] batch [4/6] time 0.494 (0.778) data 0.000 (0.260) loss 1.2305 (1.3088) lr 4.6860e-02 eta 0:01:48
epoch [27/50] batch [6/6] time 0.497 (0.685) data 0.000 (0.173) loss 1.2109 (1.2733) lr 4.3733e-02 eta 0:01:34
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 421
* accuracy: 73.1%
* error: 26.9%
* macro_f1: 72.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [28/50] batch [2/6] time 0.504 (1.043) data 0.000 (0.520) loss 1.1152 (1.2158) lr 4.3733e-02 eta 0:02:21
epoch [28/50] batch [4/6] time 0.509 (0.779) data 0.000 (0.260) loss 1.3154 (1.2571) lr 4.3733e-02 eta 0:01:44
epoch [28/50] batch [6/6] time 0.509 (0.690) data 0.000 (0.174) loss 1.4238 (1.2915) lr 4.0631e-02 eta 0:01:31
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 420
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 72.5%

epoch [29/50] batch [2/6] time 0.514 (1.117) data 0.000 (0.570) loss 1.1436 (1.2007) lr 4.0631e-02 eta 0:02:25
epoch [29/50] batch [4/6] time 0.503 (0.810) data 0.000 (0.285) loss 1.3018 (1.2559) lr 4.0631e-02 eta 0:01:43
epoch [29/50] batch [6/6] time 0.497 (0.706) data 0.000 (0.190) loss 1.2783 (1.2767) lr 3.7566e-02 eta 0:01:28
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 414
* accuracy: 71.9%
* error: 28.1%
* macro_f1: 71.2%

epoch [30/50] batch [2/6] time 0.503 (1.052) data 0.000 (0.530) loss 1.2588 (1.2427) lr 3.7566e-02 eta 0:02:10
epoch [30/50] batch [4/6] time 0.502 (0.776) data 0.000 (0.265) loss 1.1621 (1.2361) lr 3.7566e-02 eta 0:01:34
epoch [30/50] batch [6/6] time 0.505 (0.685) data 0.000 (0.177) loss 1.2725 (1.2295) lr 3.4549e-02 eta 0:01:22
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 422
* accuracy: 73.3%
* error: 26.7%
* macro_f1: 73.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/6] time 0.511 (1.057) data 0.000 (0.478) loss 1.1914 (1.2656) lr 3.4549e-02 eta 0:02:04
epoch [31/50] batch [4/6] time 0.508 (0.782) data 0.000 (0.239) loss 1.2148 (1.2200) lr 3.4549e-02 eta 0:01:30
epoch [31/50] batch [6/6] time 0.507 (0.689) data 0.000 (0.159) loss 1.3887 (1.2632) lr 3.1594e-02 eta 0:01:18
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.91s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 423
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 73.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [32/50] batch [2/6] time 0.508 (1.050) data 0.000 (0.493) loss 1.2021 (1.1924) lr 3.1594e-02 eta 0:01:57
epoch [32/50] batch [4/6] time 0.501 (0.777) data 0.000 (0.247) loss 1.3652 (1.2439) lr 3.1594e-02 eta 0:01:25
epoch [32/50] batch [6/6] time 0.500 (0.684) data 0.000 (0.165) loss 1.3750 (1.2681) lr 2.8711e-02 eta 0:01:13
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.70s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.29s/it]100%|██████████| 3/3 [00:03<00:00,  1.21it/s]100%|██████████| 3/3 [00:03<00:00,  1.12s/it]=> result
* total: 576
* correct: 425
* accuracy: 73.8%
* error: 26.2%
* macro_f1: 73.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [33/50] batch [2/6] time 0.498 (1.064) data 0.000 (0.546) loss 1.1572 (1.1665) lr 2.8711e-02 eta 0:01:52
epoch [33/50] batch [4/6] time 0.495 (0.781) data 0.000 (0.273) loss 1.4121 (1.2576) lr 2.8711e-02 eta 0:01:21
epoch [33/50] batch [6/6] time 0.499 (0.686) data 0.000 (0.182) loss 1.0977 (1.2339) lr 2.5912e-02 eta 0:01:10
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 429
* accuracy: 74.5%
* error: 25.5%
* macro_f1: 74.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [34/50] batch [2/6] time 0.506 (1.074) data 0.000 (0.546) loss 1.2812 (1.2583) lr 2.5912e-02 eta 0:01:47
epoch [34/50] batch [4/6] time 0.526 (0.800) data 0.000 (0.273) loss 1.1895 (1.2661) lr 2.5912e-02 eta 0:01:18
epoch [34/50] batch [6/6] time 0.526 (0.709) data 0.000 (0.182) loss 1.1475 (1.2515) lr 2.3209e-02 eta 0:01:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.96s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.39s/it]100%|██████████| 3/3 [00:03<00:00,  1.13it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 429
* accuracy: 74.5%
* error: 25.5%
* macro_f1: 74.2%

epoch [35/50] batch [2/6] time 0.504 (1.116) data 0.000 (0.523) loss 1.0869 (1.1406) lr 2.3209e-02 eta 0:01:44
epoch [35/50] batch [4/6] time 0.504 (0.809) data 0.000 (0.261) loss 1.0586 (1.1379) lr 2.3209e-02 eta 0:01:14
epoch [35/50] batch [6/6] time 0.501 (0.706) data 0.000 (0.174) loss 1.3604 (1.2492) lr 2.0611e-02 eta 0:01:03
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 423
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 73.1%

epoch [36/50] batch [2/6] time 0.509 (1.057) data 0.000 (0.511) loss 1.4062 (1.3076) lr 2.0611e-02 eta 0:01:32
epoch [36/50] batch [4/6] time 0.511 (0.784) data 0.000 (0.256) loss 1.3379 (1.2656) lr 2.0611e-02 eta 0:01:07
epoch [36/50] batch [6/6] time 0.510 (0.693) data 0.000 (0.171) loss 1.3682 (1.2681) lr 1.8129e-02 eta 0:00:58
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.74s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 420
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 72.7%

epoch [37/50] batch [2/6] time 0.525 (1.142) data 0.000 (0.589) loss 1.1221 (1.1001) lr 1.8129e-02 eta 0:01:33
epoch [37/50] batch [4/6] time 0.501 (0.823) data 0.000 (0.294) loss 1.2344 (1.2312) lr 1.8129e-02 eta 0:01:05
epoch [37/50] batch [6/6] time 0.500 (0.715) data 0.000 (0.196) loss 1.0986 (1.1929) lr 1.5773e-02 eta 0:00:55
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.77s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 429
* accuracy: 74.5%
* error: 25.5%
* macro_f1: 74.5%

epoch [38/50] batch [2/6] time 0.504 (1.049) data 0.000 (0.525) loss 1.2998 (1.2144) lr 1.5773e-02 eta 0:01:19
epoch [38/50] batch [4/6] time 0.507 (0.777) data 0.000 (0.263) loss 1.2168 (1.2012) lr 1.5773e-02 eta 0:00:57
epoch [38/50] batch [6/6] time 0.505 (0.686) data 0.000 (0.175) loss 1.2930 (1.2043) lr 1.3552e-02 eta 0:00:49
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.71s/it] 67%|██████▋   | 2/3 [00:02<00:01,  1.29s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.12s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [39/50] batch [2/6] time 0.512 (1.062) data 0.000 (0.513) loss 1.1826 (1.1504) lr 1.3552e-02 eta 0:01:14
epoch [39/50] batch [4/6] time 0.504 (0.785) data 0.000 (0.256) loss 1.2832 (1.1743) lr 1.3552e-02 eta 0:00:53
epoch [39/50] batch [6/6] time 0.503 (0.691) data 0.000 (0.171) loss 1.1807 (1.2056) lr 1.1474e-02 eta 0:00:45
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 427
* accuracy: 74.1%
* error: 25.9%
* macro_f1: 74.0%

epoch [40/50] batch [2/6] time 0.495 (1.070) data 0.000 (0.525) loss 1.2021 (1.1670) lr 1.1474e-02 eta 0:01:08
epoch [40/50] batch [4/6] time 0.496 (0.784) data 0.000 (0.263) loss 1.1660 (1.1768) lr 1.1474e-02 eta 0:00:48
epoch [40/50] batch [6/6] time 0.501 (0.689) data 0.000 (0.175) loss 1.2959 (1.2093) lr 9.5492e-03 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.73s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/6] time 0.500 (1.034) data 0.000 (0.505) loss 1.1953 (1.1753) lr 9.5492e-03 eta 0:00:59
epoch [41/50] batch [4/6] time 0.499 (0.768) data 0.000 (0.252) loss 1.1084 (1.1604) lr 9.5492e-03 eta 0:00:43
epoch [41/50] batch [6/6] time 0.503 (0.679) data 0.000 (0.168) loss 1.2383 (1.1877) lr 7.7836e-03 eta 0:00:36
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 426
* accuracy: 74.0%
* error: 26.0%
* macro_f1: 73.8%

epoch [42/50] batch [2/6] time 0.498 (1.048) data 0.000 (0.498) loss 1.2080 (1.1943) lr 7.7836e-03 eta 0:00:54
epoch [42/50] batch [4/6] time 0.502 (0.776) data 0.000 (0.249) loss 1.1533 (1.1938) lr 7.7836e-03 eta 0:00:38
epoch [42/50] batch [6/6] time 0.525 (0.692) data 0.000 (0.166) loss 1.1611 (1.2046) lr 6.1847e-03 eta 0:00:33
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.5%

epoch [43/50] batch [2/6] time 0.498 (1.075) data 0.000 (0.533) loss 1.2979 (1.2192) lr 6.1847e-03 eta 0:00:49
epoch [43/50] batch [4/6] time 0.503 (0.788) data 0.000 (0.266) loss 1.2012 (1.2141) lr 6.1847e-03 eta 0:00:34
epoch [43/50] batch [6/6] time 0.497 (0.691) data 0.000 (0.178) loss 1.1338 (1.1846) lr 4.7586e-03 eta 0:00:29
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.77s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 431
* accuracy: 74.8%
* error: 25.2%
* macro_f1: 74.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [44/50] batch [2/6] time 0.489 (1.047) data 0.000 (0.536) loss 1.0605 (1.1240) lr 4.7586e-03 eta 0:00:41
epoch [44/50] batch [4/6] time 0.492 (0.769) data 0.000 (0.268) loss 1.3359 (1.1553) lr 4.7586e-03 eta 0:00:29
epoch [44/50] batch [6/6] time 0.501 (0.678) data 0.000 (0.179) loss 1.1992 (1.1888) lr 3.5112e-03 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.6%

epoch [45/50] batch [2/6] time 0.512 (1.115) data 0.000 (0.581) loss 1.1719 (1.2378) lr 3.5112e-03 eta 0:00:37
epoch [45/50] batch [4/6] time 0.509 (0.813) data 0.000 (0.291) loss 1.1953 (1.2290) lr 3.5112e-03 eta 0:00:26
epoch [45/50] batch [6/6] time 0.486 (0.706) data 0.000 (0.194) loss 1.1914 (1.2083) lr 2.4472e-03 eta 0:00:21
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 431
* accuracy: 74.8%
* error: 25.2%
* macro_f1: 74.8%

epoch [46/50] batch [2/6] time 0.499 (1.063) data 0.000 (0.528) loss 1.0879 (1.2002) lr 2.4472e-03 eta 0:00:29
epoch [46/50] batch [4/6] time 0.494 (0.779) data 0.000 (0.264) loss 1.2744 (1.1995) lr 2.4472e-03 eta 0:00:20
epoch [46/50] batch [6/6] time 0.491 (0.684) data 0.000 (0.176) loss 1.2236 (1.1938) lr 1.5708e-03 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.71s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.29s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.13s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.6%

epoch [47/50] batch [2/6] time 0.500 (1.078) data 0.000 (0.535) loss 1.1631 (1.1621) lr 1.5708e-03 eta 0:00:23
epoch [47/50] batch [4/6] time 0.497 (0.789) data 0.000 (0.268) loss 1.1621 (1.1780) lr 1.5708e-03 eta 0:00:15
epoch [47/50] batch [6/6] time 0.490 (0.690) data 0.000 (0.179) loss 1.2188 (1.1865) lr 8.8564e-04 eta 0:00:12
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.6%

epoch [48/50] batch [2/6] time 0.490 (1.091) data 0.000 (0.576) loss 1.2578 (1.2363) lr 8.8564e-04 eta 0:00:17
epoch [48/50] batch [4/6] time 0.485 (0.790) data 0.000 (0.288) loss 1.1240 (1.2419) lr 8.8564e-04 eta 0:00:11
epoch [48/50] batch [6/6] time 0.486 (0.688) data 0.000 (0.192) loss 1.1035 (1.1997) lr 3.9426e-04 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.74s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.30s/it]100%|██████████| 3/3 [00:03<00:00,  1.20it/s]100%|██████████| 3/3 [00:03<00:00,  1.14s/it]=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.6%

epoch [49/50] batch [2/6] time 0.486 (1.028) data 0.000 (0.486) loss 1.1631 (1.1709) lr 3.9426e-04 eta 0:00:10
epoch [49/50] batch [4/6] time 0.484 (0.756) data 0.000 (0.243) loss 1.1875 (1.2021) lr 3.9426e-04 eta 0:00:06
epoch [49/50] batch [6/6] time 0.487 (0.666) data 0.000 (0.162) loss 1.1787 (1.1776) lr 9.8664e-05 eta 0:00:03
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 429
* accuracy: 74.5%
* error: 25.5%
* macro_f1: 74.4%

epoch [50/50] batch [2/6] time 0.489 (1.057) data 0.000 (0.530) loss 1.2676 (1.2886) lr 9.8664e-05 eta 0:00:04
epoch [50/50] batch [4/6] time 0.482 (0.771) data 0.000 (0.265) loss 1.1055 (1.2312) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [6/6] time 0.488 (0.677) data 0.000 (0.177) loss 1.2480 (1.2301) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.90s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]
=> result
* total: 576
* correct: 430
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 74.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 43)
Evaluate on the *test* set
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:02<00:11,  2.93s/it] 40%|████      | 2/5 [00:03<00:04,  1.38s/it] 60%|██████    | 3/5 [00:03<00:01,  1.13it/s] 80%|████████  | 4/5 [00:03<00:00,  1.53it/s]100%|██████████| 5/5 [00:03<00:00,  2.15it/s]100%|██████████| 5/5 [00:04<00:00,  1.24it/s]
=> result
* total: 864
* correct: 670
* accuracy: 77.5%
* error: 22.5%
* macro_f1: 77.2%
Elapsed: 0:06:31
+ sh scripts/rpo_prime/base2new_test_sdl.sh dtd 2 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE NEW CLASSES!
368 552 828
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  23
# train_x  368
# val      552
# test     828
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 43)
Evaluate on the *test* set
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:05<00:21,  5.32s/it] 40%|████      | 2/5 [00:05<00:07,  2.36s/it] 60%|██████    | 3/5 [00:05<00:02,  1.42s/it] 80%|████████  | 4/5 [00:06<00:00,  1.03it/s]100%|██████████| 5/5 [00:06<00:00,  1.28s/it]
=> result
* total: 828
* correct: 550
* accuracy: 66.4%
* error: 33.6%
* macro_f1: 64.9%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh dtd 3 0 main_tmp1_0.1sdl 16
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE BASE CLASSES!
384 576 864
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  24
# train_x  384
# val      576
# test     864
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/6] time 0.498 (2.249) data 0.001 (0.855) loss 1.9688 (2.0342) lr 1.0000e-01 eta 0:11:10
epoch [1/50] batch [4/6] time 0.484 (1.366) data 0.000 (0.428) loss 1.6621 (1.8821) lr 1.0000e-01 eta 0:06:44
epoch [1/50] batch [6/6] time 0.481 (1.071) data 0.000 (0.285) loss 1.8828 (1.9132) lr 9.9901e-02 eta 0:05:14
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.98s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.40s/it]100%|██████████| 3/3 [00:03<00:00,  1.13it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 340
* accuracy: 59.0%
* error: 41.0%
* macro_f1: 54.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/6] time 0.497 (1.027) data 0.000 (0.498) loss 1.7910 (1.9229) lr 9.9901e-02 eta 0:04:59
epoch [2/50] batch [4/6] time 0.483 (0.757) data 0.000 (0.249) loss 1.7520 (1.8643) lr 9.9901e-02 eta 0:03:39
epoch [2/50] batch [6/6] time 0.489 (0.666) data 0.000 (0.166) loss 1.5400 (1.8110) lr 9.9606e-02 eta 0:03:11
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.90s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 345
* accuracy: 59.9%
* error: 40.1%
* macro_f1: 55.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/6] time 0.497 (1.061) data 0.000 (0.523) loss 1.7207 (1.8662) lr 9.9606e-02 eta 0:05:03
epoch [3/50] batch [4/6] time 0.514 (0.787) data 0.000 (0.262) loss 1.6826 (1.7976) lr 9.9606e-02 eta 0:03:43
epoch [3/50] batch [6/6] time 0.514 (0.695) data 0.000 (0.174) loss 1.6016 (1.7593) lr 9.9114e-02 eta 0:03:15
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 351
* accuracy: 60.9%
* error: 39.1%
* macro_f1: 57.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/6] time 0.492 (1.065) data 0.000 (0.536) loss 1.5938 (1.5825) lr 9.9114e-02 eta 0:04:58
epoch [4/50] batch [4/6] time 0.489 (0.777) data 0.000 (0.268) loss 1.7598 (1.6965) lr 9.9114e-02 eta 0:03:35
epoch [4/50] batch [6/6] time 0.486 (0.680) data 0.000 (0.179) loss 1.9961 (1.7352) lr 9.8429e-02 eta 0:03:07
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 356
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 58.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/6] time 0.496 (1.068) data 0.000 (0.551) loss 1.5684 (1.5039) lr 9.8429e-02 eta 0:04:52
epoch [5/50] batch [4/6] time 0.497 (0.783) data 0.000 (0.276) loss 1.8467 (1.6677) lr 9.8429e-02 eta 0:03:32
epoch [5/50] batch [6/6] time 0.497 (0.688) data 0.000 (0.184) loss 1.7598 (1.6759) lr 9.7553e-02 eta 0:03:05
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 360
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 59.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [6/50] batch [2/6] time 0.499 (1.120) data 0.000 (0.579) loss 2.0059 (1.8521) lr 9.7553e-02 eta 0:05:00
epoch [6/50] batch [4/6] time 0.484 (0.803) data 0.000 (0.290) loss 1.6543 (1.6946) lr 9.7553e-02 eta 0:03:33
epoch [6/50] batch [6/6] time 0.487 (0.698) data 0.000 (0.193) loss 1.8584 (1.7017) lr 9.6489e-02 eta 0:03:04
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 362
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 59.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [7/50] batch [2/6] time 0.488 (1.039) data 0.000 (0.524) loss 1.5469 (1.5903) lr 9.6489e-02 eta 0:04:32
epoch [7/50] batch [4/6] time 0.483 (0.762) data 0.000 (0.262) loss 1.8096 (1.6338) lr 9.6489e-02 eta 0:03:18
epoch [7/50] batch [6/6] time 0.489 (0.671) data 0.000 (0.175) loss 1.5293 (1.6315) lr 9.5241e-02 eta 0:02:53
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 364
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 60.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [8/50] batch [2/6] time 0.496 (1.038) data 0.000 (0.510) loss 1.4414 (1.5337) lr 9.5241e-02 eta 0:04:25
epoch [8/50] batch [4/6] time 0.488 (0.765) data 0.000 (0.255) loss 1.7168 (1.6113) lr 9.5241e-02 eta 0:03:14
epoch [8/50] batch [6/6] time 0.496 (0.675) data 0.000 (0.170) loss 1.7373 (1.5977) lr 9.3815e-02 eta 0:02:49
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:03<00:06,  3.05s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.43s/it]100%|██████████| 3/3 [00:03<00:00,  1.10it/s]100%|██████████| 3/3 [00:03<00:00,  1.25s/it]=> result
* total: 576
* correct: 368
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 61.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/6] time 0.517 (1.118) data 0.001 (0.553) loss 1.6416 (1.5786) lr 9.3815e-02 eta 0:04:39
epoch [9/50] batch [4/6] time 0.515 (0.817) data 0.000 (0.277) loss 1.5879 (1.5942) lr 9.3815e-02 eta 0:03:22
epoch [9/50] batch [6/6] time 0.567 (0.725) data 0.000 (0.185) loss 1.6123 (1.5998) lr 9.2216e-02 eta 0:02:58
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.95s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.39s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 371
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 62.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [10/50] batch [2/6] time 0.483 (1.041) data 0.000 (0.522) loss 1.4248 (1.4810) lr 9.2216e-02 eta 0:04:14
epoch [10/50] batch [4/6] time 0.484 (0.763) data 0.000 (0.261) loss 1.3086 (1.4995) lr 9.2216e-02 eta 0:03:04
epoch [10/50] batch [6/6] time 0.493 (0.672) data 0.000 (0.174) loss 1.8047 (1.5661) lr 9.0451e-02 eta 0:02:41
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 372
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 62.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/6] time 0.490 (1.066) data 0.000 (0.538) loss 1.4365 (1.4683) lr 9.0451e-02 eta 0:04:13
epoch [11/50] batch [4/6] time 0.484 (0.778) data 0.000 (0.269) loss 1.5029 (1.4954) lr 9.0451e-02 eta 0:03:03
epoch [11/50] batch [6/6] time 0.489 (0.681) data 0.000 (0.179) loss 1.6270 (1.5358) lr 8.8526e-02 eta 0:02:39
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.79s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 382
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 64.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [12/50] batch [2/6] time 0.501 (1.042) data 0.000 (0.510) loss 1.6475 (1.5674) lr 8.8526e-02 eta 0:04:01
epoch [12/50] batch [4/6] time 0.504 (0.771) data 0.000 (0.255) loss 1.5791 (1.5237) lr 8.8526e-02 eta 0:02:57
epoch [12/50] batch [6/6] time 0.537 (0.689) data 0.000 (0.170) loss 1.6211 (1.5441) lr 8.6448e-02 eta 0:02:37
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.96s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.40s/it]100%|██████████| 3/3 [00:03<00:00,  1.12it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 385
* accuracy: 66.8%
* error: 33.2%
* macro_f1: 64.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [13/50] batch [2/6] time 0.509 (1.101) data 0.001 (0.544) loss 1.4707 (1.5142) lr 8.6448e-02 eta 0:04:08
epoch [13/50] batch [4/6] time 0.513 (0.807) data 0.000 (0.272) loss 1.5918 (1.5776) lr 8.6448e-02 eta 0:03:00
epoch [13/50] batch [6/6] time 0.507 (0.708) data 0.000 (0.182) loss 1.3848 (1.5088) lr 8.4227e-02 eta 0:02:37
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 391
* accuracy: 67.9%
* error: 32.1%
* macro_f1: 66.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [14/50] batch [2/6] time 0.495 (1.049) data 0.000 (0.529) loss 1.4385 (1.4902) lr 8.4227e-02 eta 0:03:50
epoch [14/50] batch [4/6] time 0.492 (0.771) data 0.000 (0.265) loss 1.3984 (1.4966) lr 8.4227e-02 eta 0:02:48
epoch [14/50] batch [6/6] time 0.494 (0.678) data 0.000 (0.176) loss 1.5166 (1.5065) lr 8.1871e-02 eta 0:02:26
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.81s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 403
* accuracy: 70.0%
* error: 30.0%
* macro_f1: 69.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [15/50] batch [2/6] time 0.483 (1.050) data 0.000 (0.525) loss 1.4121 (1.4482) lr 8.1871e-02 eta 0:03:44
epoch [15/50] batch [4/6] time 0.485 (0.768) data 0.000 (0.263) loss 1.3008 (1.3965) lr 8.1871e-02 eta 0:02:42
epoch [15/50] batch [6/6] time 0.488 (0.676) data 0.000 (0.175) loss 1.5605 (1.4510) lr 7.9389e-02 eta 0:02:21
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.76s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.31s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 413
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 70.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/6] time 0.515 (1.084) data 0.000 (0.536) loss 1.4131 (1.3696) lr 7.9389e-02 eta 0:03:45
epoch [16/50] batch [4/6] time 0.520 (0.802) data 0.000 (0.268) loss 1.5254 (1.4238) lr 7.9389e-02 eta 0:02:45
epoch [16/50] batch [6/6] time 0.543 (0.714) data 0.001 (0.179) loss 1.4043 (1.4066) lr 7.6791e-02 eta 0:02:25
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 408
* accuracy: 70.8%
* error: 29.2%
* macro_f1: 69.5%

epoch [17/50] batch [2/6] time 0.489 (1.064) data 0.000 (0.554) loss 1.4521 (1.4902) lr 7.6791e-02 eta 0:03:34
epoch [17/50] batch [4/6] time 0.489 (0.776) data 0.000 (0.277) loss 1.4082 (1.4395) lr 7.6791e-02 eta 0:02:35
epoch [17/50] batch [6/6] time 0.490 (0.680) data 0.000 (0.185) loss 1.4170 (1.4315) lr 7.4088e-02 eta 0:02:14
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:03<00:06,  3.01s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.42s/it]100%|██████████| 3/3 [00:03<00:00,  1.11it/s]100%|██████████| 3/3 [00:03<00:00,  1.23s/it]=> result
* total: 576
* correct: 408
* accuracy: 70.8%
* error: 29.2%
* macro_f1: 69.6%

epoch [18/50] batch [2/6] time 0.499 (1.190) data 0.000 (0.579) loss 1.4160 (1.4600) lr 7.4088e-02 eta 0:03:53
epoch [18/50] batch [4/6] time 0.496 (0.842) data 0.000 (0.290) loss 1.4834 (1.4221) lr 7.4088e-02 eta 0:02:43
epoch [18/50] batch [6/6] time 0.527 (0.732) data 0.000 (0.193) loss 1.2461 (1.4092) lr 7.1289e-02 eta 0:02:20
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.92s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.38s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 423
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 72.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [19/50] batch [2/6] time 0.512 (1.129) data 0.000 (0.583) loss 1.2744 (1.3354) lr 7.1289e-02 eta 0:03:34
epoch [19/50] batch [4/6] time 0.505 (0.818) data 0.000 (0.292) loss 1.5078 (1.4087) lr 7.1289e-02 eta 0:02:33
epoch [19/50] batch [6/6] time 0.487 (0.709) data 0.000 (0.195) loss 1.4004 (1.4058) lr 6.8406e-02 eta 0:02:11
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.83s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 418
* accuracy: 72.6%
* error: 27.4%
* macro_f1: 71.0%

epoch [20/50] batch [2/6] time 0.494 (1.058) data 0.000 (0.512) loss 1.4629 (1.4155) lr 6.8406e-02 eta 0:03:14
epoch [20/50] batch [4/6] time 0.488 (0.773) data 0.000 (0.256) loss 1.2363 (1.3904) lr 6.8406e-02 eta 0:02:20
epoch [20/50] batch [6/6] time 0.490 (0.678) data 0.000 (0.171) loss 1.2188 (1.3592) lr 6.5451e-02 eta 0:02:02
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 415
* accuracy: 72.0%
* error: 28.0%
* macro_f1: 71.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/6] time 0.513 (1.074) data 0.000 (0.551) loss 1.2744 (1.3052) lr 6.5451e-02 eta 0:03:11
epoch [21/50] batch [4/6] time 0.499 (0.786) data 0.000 (0.276) loss 1.4062 (1.3757) lr 6.5451e-02 eta 0:02:18
epoch [21/50] batch [6/6] time 0.493 (0.689) data 0.000 (0.184) loss 1.5146 (1.4108) lr 6.2434e-02 eta 0:01:59
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.86s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 420
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 71.9%

epoch [22/50] batch [2/6] time 0.488 (1.084) data 0.000 (0.583) loss 1.5303 (1.4995) lr 6.2434e-02 eta 0:03:06
epoch [22/50] batch [4/6] time 0.487 (0.785) data 0.000 (0.292) loss 1.2246 (1.4170) lr 6.2434e-02 eta 0:02:13
epoch [22/50] batch [6/6] time 0.486 (0.687) data 0.000 (0.195) loss 1.3506 (1.3779) lr 5.9369e-02 eta 0:01:55
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 433
* accuracy: 75.2%
* error: 24.8%
* macro_f1: 74.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [23/50] batch [2/6] time 0.503 (1.038) data 0.000 (0.507) loss 1.3203 (1.3184) lr 5.9369e-02 eta 0:02:52
epoch [23/50] batch [4/6] time 0.496 (0.766) data 0.000 (0.254) loss 1.4531 (1.3481) lr 5.9369e-02 eta 0:02:05
epoch [23/50] batch [6/6] time 0.499 (0.677) data 0.000 (0.169) loss 1.4258 (1.3787) lr 5.6267e-02 eta 0:01:49
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 427
* accuracy: 74.1%
* error: 25.9%
* macro_f1: 73.0%

epoch [24/50] batch [2/6] time 0.504 (1.076) data 0.000 (0.549) loss 1.2871 (1.3213) lr 5.6267e-02 eta 0:02:52
epoch [24/50] batch [4/6] time 0.485 (0.782) data 0.000 (0.274) loss 1.4102 (1.3633) lr 5.6267e-02 eta 0:02:03
epoch [24/50] batch [6/6] time 0.493 (0.686) data 0.000 (0.183) loss 1.4229 (1.3416) lr 5.3140e-02 eta 0:01:47
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.99s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.41s/it]100%|██████████| 3/3 [00:03<00:00,  1.12it/s]100%|██████████| 3/3 [00:03<00:00,  1.22s/it]=> result
* total: 576
* correct: 433
* accuracy: 75.2%
* error: 24.8%
* macro_f1: 74.3%

epoch [25/50] batch [2/6] time 0.501 (1.054) data 0.000 (0.532) loss 1.4277 (1.3770) lr 5.3140e-02 eta 0:02:42
epoch [25/50] batch [4/6] time 0.488 (0.771) data 0.000 (0.266) loss 1.2676 (1.3389) lr 5.3140e-02 eta 0:01:57
epoch [25/50] batch [6/6] time 0.487 (0.676) data 0.000 (0.177) loss 1.2969 (1.3496) lr 5.0000e-02 eta 0:01:41
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 432
* accuracy: 75.0%
* error: 25.0%
* macro_f1: 74.2%

epoch [26/50] batch [2/6] time 0.494 (1.050) data 0.000 (0.507) loss 1.4492 (1.4619) lr 5.0000e-02 eta 0:02:35
epoch [26/50] batch [4/6] time 0.486 (0.769) data 0.000 (0.254) loss 1.2725 (1.3513) lr 5.0000e-02 eta 0:01:52
epoch [26/50] batch [6/6] time 0.492 (0.676) data 0.000 (0.169) loss 1.2793 (1.3306) lr 4.6860e-02 eta 0:01:37
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.93s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.38s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.20s/it]=> result
* total: 576
* correct: 440
* accuracy: 76.4%
* error: 23.6%
* macro_f1: 75.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [27/50] batch [2/6] time 0.516 (1.059) data 0.001 (0.512) loss 1.1982 (1.2261) lr 4.6860e-02 eta 0:02:30
epoch [27/50] batch [4/6] time 0.510 (0.785) data 0.000 (0.256) loss 1.4062 (1.2966) lr 4.6860e-02 eta 0:01:49
epoch [27/50] batch [6/6] time 0.500 (0.692) data 0.000 (0.171) loss 1.2422 (1.3068) lr 4.3733e-02 eta 0:01:35
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 440
* accuracy: 76.4%
* error: 23.6%
* macro_f1: 75.5%

epoch [28/50] batch [2/6] time 0.489 (1.052) data 0.000 (0.523) loss 1.3574 (1.2520) lr 4.3733e-02 eta 0:02:23
epoch [28/50] batch [4/6] time 0.481 (0.767) data 0.000 (0.262) loss 1.2461 (1.2341) lr 4.3733e-02 eta 0:01:42
epoch [28/50] batch [6/6] time 0.479 (0.671) data 0.000 (0.174) loss 1.3682 (1.2513) lr 4.0631e-02 eta 0:01:28
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 438
* accuracy: 76.0%
* error: 24.0%
* macro_f1: 75.7%

epoch [29/50] batch [2/6] time 0.494 (1.051) data 0.000 (0.495) loss 1.3213 (1.2065) lr 4.0631e-02 eta 0:02:16
epoch [29/50] batch [4/6] time 0.498 (0.776) data 0.000 (0.248) loss 1.3613 (1.3030) lr 4.0631e-02 eta 0:01:39
epoch [29/50] batch [6/6] time 0.499 (0.684) data 0.000 (0.165) loss 1.1855 (1.2822) lr 3.7566e-02 eta 0:01:26
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.20s/it]=> result
* total: 576
* correct: 436
* accuracy: 75.7%
* error: 24.3%
* macro_f1: 75.0%

epoch [30/50] batch [2/6] time 0.509 (1.086) data 0.000 (0.553) loss 1.2324 (1.1768) lr 3.7566e-02 eta 0:02:14
epoch [30/50] batch [4/6] time 0.493 (0.789) data 0.000 (0.277) loss 1.3848 (1.2571) lr 3.7566e-02 eta 0:01:36
epoch [30/50] batch [6/6] time 0.492 (0.691) data 0.000 (0.184) loss 1.4180 (1.2710) lr 3.4549e-02 eta 0:01:22
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.86s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 431
* accuracy: 74.8%
* error: 25.2%
* macro_f1: 74.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/6] time 0.490 (1.050) data 0.000 (0.548) loss 1.2949 (1.2881) lr 3.4549e-02 eta 0:02:03
epoch [31/50] batch [4/6] time 0.492 (0.771) data 0.000 (0.274) loss 1.2686 (1.3074) lr 3.4549e-02 eta 0:01:29
epoch [31/50] batch [6/6] time 0.494 (0.678) data 0.000 (0.183) loss 1.1260 (1.2694) lr 3.1594e-02 eta 0:01:17
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.99s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.41s/it]100%|██████████| 3/3 [00:03<00:00,  1.12it/s]100%|██████████| 3/3 [00:03<00:00,  1.22s/it]=> result
* total: 576
* correct: 444
* accuracy: 77.1%
* error: 22.9%
* macro_f1: 76.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [32/50] batch [2/6] time 0.498 (1.069) data 0.000 (0.539) loss 1.1094 (1.1353) lr 3.1594e-02 eta 0:01:59
epoch [32/50] batch [4/6] time 0.495 (0.782) data 0.000 (0.269) loss 1.4180 (1.2117) lr 3.1594e-02 eta 0:01:26
epoch [32/50] batch [6/6] time 0.488 (0.684) data 0.000 (0.180) loss 1.3154 (1.2244) lr 2.8711e-02 eta 0:01:13
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.98s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.40s/it]100%|██████████| 3/3 [00:03<00:00,  1.12it/s]100%|██████████| 3/3 [00:03<00:00,  1.22s/it]=> result
* total: 576
* correct: 440
* accuracy: 76.4%
* error: 23.6%
* macro_f1: 76.1%

epoch [33/50] batch [2/6] time 0.487 (1.040) data 0.001 (0.500) loss 1.3545 (1.3623) lr 2.8711e-02 eta 0:01:50
epoch [33/50] batch [4/6] time 0.485 (0.764) data 0.000 (0.250) loss 1.1279 (1.2576) lr 2.8711e-02 eta 0:01:19
epoch [33/50] batch [6/6] time 0.487 (0.672) data 0.000 (0.167) loss 1.2500 (1.2518) lr 2.5912e-02 eta 0:01:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 444
* accuracy: 77.1%
* error: 22.9%
* macro_f1: 76.7%

epoch [34/50] batch [2/6] time 0.486 (1.060) data 0.000 (0.508) loss 1.3301 (1.3296) lr 2.5912e-02 eta 0:01:45
epoch [34/50] batch [4/6] time 0.487 (0.800) data 0.000 (0.254) loss 1.2744 (1.2983) lr 2.5912e-02 eta 0:01:18
epoch [34/50] batch [6/6] time 0.487 (0.696) data 0.000 (0.169) loss 1.1094 (1.2383) lr 2.3209e-02 eta 0:01:06
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 438
* accuracy: 76.0%
* error: 24.0%
* macro_f1: 75.7%

epoch [35/50] batch [2/6] time 0.494 (1.070) data 0.000 (0.558) loss 1.2637 (1.2832) lr 2.3209e-02 eta 0:01:40
epoch [35/50] batch [4/6] time 0.499 (0.785) data 0.000 (0.279) loss 1.2803 (1.2959) lr 2.3209e-02 eta 0:01:12
epoch [35/50] batch [6/6] time 0.514 (0.695) data 0.000 (0.186) loss 1.2871 (1.2533) lr 2.0611e-02 eta 0:01:02
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 445
* accuracy: 77.3%
* error: 22.7%
* macro_f1: 76.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [36/50] batch [2/6] time 0.492 (1.060) data 0.000 (0.526) loss 1.2939 (1.2163) lr 2.0611e-02 eta 0:01:33
epoch [36/50] batch [4/6] time 0.487 (0.774) data 0.000 (0.263) loss 1.1953 (1.2026) lr 2.0611e-02 eta 0:01:06
epoch [36/50] batch [6/6] time 0.483 (0.677) data 0.000 (0.176) loss 1.2812 (1.2083) lr 1.8129e-02 eta 0:00:56
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 442
* accuracy: 76.7%
* error: 23.3%
* macro_f1: 76.5%

epoch [37/50] batch [2/6] time 0.497 (1.058) data 0.000 (0.537) loss 1.4395 (1.3545) lr 1.8129e-02 eta 0:01:26
epoch [37/50] batch [4/6] time 0.496 (0.777) data 0.000 (0.269) loss 1.2246 (1.2524) lr 1.8129e-02 eta 0:01:02
epoch [37/50] batch [6/6] time 0.499 (0.685) data 0.000 (0.179) loss 1.1182 (1.2096) lr 1.5773e-02 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.91s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.38s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.20s/it]=> result
* total: 576
* correct: 444
* accuracy: 77.1%
* error: 22.9%
* macro_f1: 77.0%

epoch [38/50] batch [2/6] time 0.510 (1.109) data 0.000 (0.575) loss 1.2754 (1.1572) lr 1.5773e-02 eta 0:01:24
epoch [38/50] batch [4/6] time 0.502 (0.808) data 0.000 (0.288) loss 1.1191 (1.1721) lr 1.5773e-02 eta 0:00:59
epoch [38/50] batch [6/6] time 0.487 (0.702) data 0.000 (0.192) loss 1.2383 (1.2108) lr 1.3552e-02 eta 0:00:50
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.88s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.36s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 444
* accuracy: 77.1%
* error: 22.9%
* macro_f1: 76.7%

epoch [39/50] batch [2/6] time 0.507 (1.058) data 0.000 (0.503) loss 1.1650 (1.2124) lr 1.3552e-02 eta 0:01:14
epoch [39/50] batch [4/6] time 0.492 (0.775) data 0.000 (0.252) loss 1.1602 (1.1875) lr 1.3552e-02 eta 0:00:52
epoch [39/50] batch [6/6] time 0.489 (0.680) data 0.000 (0.168) loss 1.2031 (1.1904) lr 1.1474e-02 eta 0:00:44
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.82s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 441
* accuracy: 76.6%
* error: 23.4%
* macro_f1: 76.4%

epoch [40/50] batch [2/6] time 0.508 (1.101) data 0.000 (0.573) loss 1.2656 (1.2998) lr 1.1474e-02 eta 0:01:10
epoch [40/50] batch [4/6] time 0.497 (0.800) data 0.000 (0.286) loss 1.1094 (1.2007) lr 1.1474e-02 eta 0:00:49
epoch [40/50] batch [6/6] time 0.499 (0.699) data 0.000 (0.191) loss 1.1738 (1.1940) lr 9.5492e-03 eta 0:00:41
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.34s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 442
* accuracy: 76.7%
* error: 23.3%
* macro_f1: 76.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/6] time 0.493 (1.047) data 0.000 (0.514) loss 1.2168 (1.1592) lr 9.5492e-03 eta 0:01:00
epoch [41/50] batch [4/6] time 0.490 (0.770) data 0.000 (0.257) loss 1.1807 (1.1853) lr 9.5492e-03 eta 0:00:43
epoch [41/50] batch [6/6] time 0.485 (0.675) data 0.000 (0.171) loss 1.1592 (1.1764) lr 7.7836e-03 eta 0:00:36
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.84s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 451
* accuracy: 78.3%
* error: 21.7%
* macro_f1: 78.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [42/50] batch [2/6] time 0.508 (1.060) data 0.000 (0.533) loss 1.0859 (1.1343) lr 7.7836e-03 eta 0:00:55
epoch [42/50] batch [4/6] time 0.500 (0.781) data 0.000 (0.267) loss 1.0869 (1.1514) lr 7.7836e-03 eta 0:00:39
epoch [42/50] batch [6/6] time 0.499 (0.687) data 0.000 (0.178) loss 1.2539 (1.1737) lr 6.1847e-03 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.89s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.14it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 451
* accuracy: 78.3%
* error: 21.7%
* macro_f1: 78.1%

epoch [43/50] batch [2/6] time 0.491 (1.055) data 0.000 (0.532) loss 1.2939 (1.1870) lr 6.1847e-03 eta 0:00:48
epoch [43/50] batch [4/6] time 0.491 (0.773) data 0.000 (0.266) loss 1.2637 (1.1985) lr 6.1847e-03 eta 0:00:34
epoch [43/50] batch [6/6] time 0.513 (0.683) data 0.000 (0.177) loss 1.1211 (1.1750) lr 4.7586e-03 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.90s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.37s/it]100%|██████████| 3/3 [00:03<00:00,  1.15it/s]100%|██████████| 3/3 [00:03<00:00,  1.19s/it]=> result
* total: 576
* correct: 448
* accuracy: 77.8%
* error: 22.2%
* macro_f1: 77.6%

epoch [44/50] batch [2/6] time 0.487 (1.085) data 0.000 (0.558) loss 1.1270 (1.1255) lr 4.7586e-03 eta 0:00:43
epoch [44/50] batch [4/6] time 0.489 (0.786) data 0.000 (0.279) loss 1.3350 (1.1948) lr 4.7586e-03 eta 0:00:29
epoch [44/50] batch [6/6] time 0.492 (0.688) data 0.000 (0.186) loss 1.1699 (1.1925) lr 3.5112e-03 eta 0:00:24
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.81s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.17it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 447
* accuracy: 77.6%
* error: 22.4%
* macro_f1: 77.4%

epoch [45/50] batch [2/6] time 0.500 (1.060) data 0.000 (0.525) loss 1.1777 (1.2012) lr 3.5112e-03 eta 0:00:36
epoch [45/50] batch [4/6] time 0.492 (0.776) data 0.000 (0.263) loss 1.1270 (1.1917) lr 3.5112e-03 eta 0:00:24
epoch [45/50] batch [6/6] time 0.504 (0.684) data 0.000 (0.175) loss 1.1348 (1.2039) lr 2.4472e-03 eta 0:00:20
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.95s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.39s/it]100%|██████████| 3/3 [00:03<00:00,  1.13it/s]100%|██████████| 3/3 [00:03<00:00,  1.21s/it]=> result
* total: 576
* correct: 446
* accuracy: 77.4%
* error: 22.6%
* macro_f1: 77.2%

epoch [46/50] batch [2/6] time 0.515 (1.072) data 0.000 (0.528) loss 1.0928 (1.1011) lr 2.4472e-03 eta 0:00:30
epoch [46/50] batch [4/6] time 0.520 (0.795) data 0.000 (0.264) loss 1.2939 (1.1826) lr 2.4472e-03 eta 0:00:20
epoch [46/50] batch [6/6] time 0.490 (0.697) data 0.000 (0.176) loss 1.3711 (1.2025) lr 1.5708e-03 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.78s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.19it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]=> result
* total: 576
* correct: 450
* accuracy: 78.1%
* error: 21.9%
* macro_f1: 77.9%

epoch [47/50] batch [2/6] time 0.504 (1.049) data 0.000 (0.499) loss 1.1035 (1.1094) lr 1.5708e-03 eta 0:00:23
epoch [47/50] batch [4/6] time 0.504 (0.776) data 0.000 (0.250) loss 1.1113 (1.1138) lr 1.5708e-03 eta 0:00:15
epoch [47/50] batch [6/6] time 0.498 (0.683) data 0.000 (0.166) loss 1.3730 (1.1634) lr 8.8564e-04 eta 0:00:12
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.80s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.33s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.16s/it]=> result
* total: 576
* correct: 450
* accuracy: 78.1%
* error: 21.9%
* macro_f1: 77.9%

epoch [48/50] batch [2/6] time 0.507 (1.066) data 0.000 (0.535) loss 1.3760 (1.2505) lr 8.8564e-04 eta 0:00:17
epoch [48/50] batch [4/6] time 0.502 (0.785) data 0.000 (0.268) loss 1.1631 (1.2495) lr 8.8564e-04 eta 0:00:10
epoch [48/50] batch [6/6] time 0.499 (0.690) data 0.000 (0.179) loss 1.0771 (1.2088) lr 3.9426e-04 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.18s/it]=> result
* total: 576
* correct: 451
* accuracy: 78.3%
* error: 21.7%
* macro_f1: 78.1%

epoch [49/50] batch [2/6] time 0.484 (1.097) data 0.000 (0.586) loss 1.0068 (1.1240) lr 3.9426e-04 eta 0:00:10
epoch [49/50] batch [4/6] time 0.487 (0.791) data 0.000 (0.293) loss 1.1953 (1.1760) lr 3.9426e-04 eta 0:00:06
epoch [49/50] batch [6/6] time 0.485 (0.690) data 0.000 (0.195) loss 1.1006 (1.1610) lr 9.8664e-05 eta 0:00:04
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.85s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.35s/it]100%|██████████| 3/3 [00:03<00:00,  1.16it/s]100%|██████████| 3/3 [00:03<00:00,  1.17s/it]=> result
* total: 576
* correct: 451
* accuracy: 78.3%
* error: 21.7%
* macro_f1: 78.1%

epoch [50/50] batch [2/6] time 0.500 (1.061) data 0.000 (0.544) loss 1.1729 (1.1279) lr 9.8664e-05 eta 0:00:04
epoch [50/50] batch [4/6] time 0.489 (0.775) data 0.000 (0.272) loss 1.1279 (1.1257) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [6/6] time 0.485 (0.679) data 0.000 (0.182) loss 1.3984 (1.1945) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:02<00:05,  2.77s/it] 67%|██████▋   | 2/3 [00:03<00:01,  1.32s/it]100%|██████████| 3/3 [00:03<00:00,  1.18it/s]100%|██████████| 3/3 [00:03<00:00,  1.15s/it]
=> result
* total: 576
* correct: 451
* accuracy: 78.3%
* error: 21.7%
* macro_f1: 78.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar" (epoch = 41)
Evaluate on the *test* set
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.05s/it] 40%|████      | 2/5 [00:03<00:04,  1.43s/it] 60%|██████    | 3/5 [00:03<00:01,  1.09it/s] 80%|████████  | 4/5 [00:03<00:00,  1.49it/s]100%|██████████| 5/5 [00:04<00:00,  2.09it/s]100%|██████████| 5/5 [00:04<00:00,  1.19it/s]
=> result
* total: 864
* correct: 684
* accuracy: 79.2%
* error: 20.8%
* macro_f1: 78.7%
Elapsed: 0:06:35
+ sh scripts/rpo_prime/base2new_test_sdl.sh dtd 3 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: DescribableTextures
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:DescribableTextures
Loading dataset: DescribableTextures
Reading split from /shared/s2/lab01/dataset/clip/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/dtd/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE NEW CLASSES!
368 552 828
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------
Dataset    DescribableTextures
# classes  23
# train_x  368
# val      552
# test     828
---------  -------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/dtd/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar" (epoch = 41)
Evaluate on the *test* set
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:05<00:21,  5.37s/it] 40%|████      | 2/5 [00:05<00:07,  2.39s/it] 60%|██████    | 3/5 [00:05<00:02,  1.43s/it] 80%|████████  | 4/5 [00:06<00:00,  1.01it/s]100%|██████████| 5/5 [00:06<00:00,  1.29s/it]
=> result
* total: 828
* correct: 533
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 63.6%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh fgvc_aircraft 1 0 main_tmp1_0.1sdl 16
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE BASE CLASSES!
800 1667 1666
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  50
# train_x  800
# val      1,667
# test     1,666
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/12] time 0.509 (3.016) data 0.000 (1.576) loss 3.1250 (3.3047) lr 1.0000e-01 eta 0:30:03
epoch [1/50] batch [4/12] time 0.542 (1.775) data 0.000 (0.788) loss 3.2168 (3.2319) lr 1.0000e-01 eta 0:17:38
epoch [1/50] batch [6/12] time 0.535 (1.361) data 0.000 (0.526) loss 3.0312 (3.1501) lr 1.0000e-01 eta 0:13:28
epoch [1/50] batch [8/12] time 0.515 (1.151) data 0.000 (0.394) loss 3.2227 (3.1345) lr 1.0000e-01 eta 0:11:21
epoch [1/50] batch [10/12] time 0.505 (1.022) data 0.000 (0.315) loss 2.9082 (3.0812) lr 1.0000e-01 eta 0:10:02
epoch [1/50] batch [12/12] time 0.504 (0.935) data 0.000 (0.263) loss 2.8867 (3.0617) lr 9.9901e-02 eta 0:09:10
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:57,  7.24s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.18s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.86s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.11it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.43it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.76it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.07it/s]100%|██████████| 9/9 [00:09<00:00,  2.60it/s]100%|██████████| 9/9 [00:09<00:00,  1.07s/it]=> result
* total: 1,667
* correct: 507
* accuracy: 30.4%
* error: 69.6%
* macro_f1: 27.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/12] time 0.514 (1.984) data 0.000 (1.420) loss 2.7734 (2.8174) lr 9.9901e-02 eta 0:19:22
epoch [2/50] batch [4/12] time 0.503 (1.247) data 0.000 (0.710) loss 2.7207 (2.7754) lr 9.9901e-02 eta 0:12:08
epoch [2/50] batch [6/12] time 0.512 (1.001) data 0.000 (0.474) loss 2.7559 (2.7731) lr 9.9901e-02 eta 0:09:42
epoch [2/50] batch [8/12] time 0.530 (0.882) data 0.000 (0.355) loss 2.9336 (2.8057) lr 9.9901e-02 eta 0:08:31
epoch [2/50] batch [10/12] time 0.537 (0.812) data 0.000 (0.284) loss 3.0176 (2.8393) lr 9.9901e-02 eta 0:07:49
epoch [2/50] batch [12/12] time 0.503 (0.762) data 0.000 (0.237) loss 2.7246 (2.8418) lr 9.9606e-02 eta 0:07:19
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.63s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.97s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.99s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.34s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.35it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.68it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 523
* accuracy: 31.4%
* error: 68.6%
* macro_f1: 28.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/12] time 0.534 (2.006) data 0.000 (1.446) loss 2.7754 (2.7314) lr 9.9606e-02 eta 0:19:11
epoch [3/50] batch [4/12] time 0.525 (1.266) data 0.000 (0.723) loss 2.6113 (2.7358) lr 9.9606e-02 eta 0:12:04
epoch [3/50] batch [6/12] time 0.523 (1.019) data 0.000 (0.482) loss 2.8906 (2.7839) lr 9.9606e-02 eta 0:09:40
epoch [3/50] batch [8/12] time 0.515 (0.894) data 0.000 (0.362) loss 2.8164 (2.7800) lr 9.9606e-02 eta 0:08:27
epoch [3/50] batch [10/12] time 0.520 (0.819) data 0.000 (0.289) loss 2.8008 (2.7674) lr 9.9606e-02 eta 0:07:43
epoch [3/50] batch [12/12] time 0.544 (0.774) data 0.000 (0.241) loss 2.6367 (2.7656) lr 9.9114e-02 eta 0:07:16
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.59s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.96s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.08s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.97it/s]100%|██████████| 9/9 [00:09<00:00,  2.48it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 528
* accuracy: 31.7%
* error: 68.3%
* macro_f1: 28.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/12] time 0.516 (1.935) data 0.000 (1.368) loss 2.7324 (2.7969) lr 9.9114e-02 eta 0:18:07
epoch [4/50] batch [4/12] time 0.511 (1.222) data 0.000 (0.684) loss 2.8477 (2.8125) lr 9.9114e-02 eta 0:11:24
epoch [4/50] batch [6/12] time 0.519 (0.988) data 0.000 (0.456) loss 2.7871 (2.7673) lr 9.9114e-02 eta 0:09:11
epoch [4/50] batch [8/12] time 0.524 (0.872) data 0.000 (0.342) loss 2.7207 (2.7681) lr 9.9114e-02 eta 0:08:04
epoch [4/50] batch [10/12] time 0.513 (0.800) data 0.000 (0.274) loss 2.6602 (2.7684) lr 9.9114e-02 eta 0:07:23
epoch [4/50] batch [12/12] time 0.505 (0.752) data 0.000 (0.228) loss 2.8223 (2.7646) lr 9.8429e-02 eta 0:06:55
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.60s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.54s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.06s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.36s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.98it/s]100%|██████████| 9/9 [00:09<00:00,  2.49it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 533
* accuracy: 32.0%
* error: 68.0%
* macro_f1: 28.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/12] time 0.502 (1.951) data 0.000 (1.428) loss 2.6797 (2.6758) lr 9.8429e-02 eta 0:17:52
epoch [5/50] batch [4/12] time 0.504 (1.227) data 0.000 (0.714) loss 2.7734 (2.7026) lr 9.8429e-02 eta 0:11:12
epoch [5/50] batch [6/12] time 0.508 (0.988) data 0.000 (0.476) loss 2.7168 (2.6855) lr 9.8429e-02 eta 0:08:59
epoch [5/50] batch [8/12] time 0.518 (0.870) data 0.000 (0.357) loss 2.7383 (2.6892) lr 9.8429e-02 eta 0:07:53
epoch [5/50] batch [10/12] time 0.516 (0.799) data 0.000 (0.286) loss 2.8770 (2.7146) lr 9.8429e-02 eta 0:07:13
epoch [5/50] batch [12/12] time 0.511 (0.752) data 0.000 (0.238) loss 2.8574 (2.7393) lr 9.7553e-02 eta 0:06:45
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.64s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.18s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.98s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.32s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 532
* accuracy: 31.9%
* error: 68.1%
* macro_f1: 28.4%

epoch [6/50] batch [2/12] time 0.506 (1.951) data 0.000 (1.400) loss 2.8965 (2.7832) lr 9.7553e-02 eta 0:17:29
epoch [6/50] batch [4/12] time 0.506 (1.228) data 0.000 (0.700) loss 2.8535 (2.7847) lr 9.7553e-02 eta 0:10:58
epoch [6/50] batch [6/12] time 0.508 (0.988) data 0.000 (0.467) loss 2.8867 (2.7689) lr 9.7553e-02 eta 0:08:47
epoch [6/50] batch [8/12] time 0.507 (0.868) data 0.000 (0.350) loss 2.7793 (2.7529) lr 9.7553e-02 eta 0:07:41
epoch [6/50] batch [10/12] time 0.504 (0.795) data 0.000 (0.280) loss 2.4473 (2.7207) lr 9.7553e-02 eta 0:07:01
epoch [6/50] batch [12/12] time 0.508 (0.747) data 0.000 (0.234) loss 2.8340 (2.7148) lr 9.6489e-02 eta 0:06:34
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.63s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.59s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.09s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.96it/s]100%|██████████| 9/9 [00:10<00:00,  2.49it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 540
* accuracy: 32.4%
* error: 67.6%
* macro_f1: 28.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [7/50] batch [2/12] time 0.617 (1.749) data 0.000 (1.089) loss 2.8438 (2.7666) lr 9.6489e-02 eta 0:15:19
epoch [7/50] batch [4/12] time 0.502 (1.126) data 0.000 (0.544) loss 2.7207 (2.7437) lr 9.6489e-02 eta 0:09:49
epoch [7/50] batch [6/12] time 0.503 (0.919) data 0.000 (0.363) loss 2.6445 (2.7539) lr 9.6489e-02 eta 0:07:59
epoch [7/50] batch [8/12] time 0.505 (0.815) data 0.000 (0.272) loss 2.7793 (2.7312) lr 9.6489e-02 eta 0:07:03
epoch [7/50] batch [10/12] time 0.506 (0.753) data 0.000 (0.218) loss 2.6875 (2.7057) lr 9.6489e-02 eta 0:06:30
epoch [7/50] batch [12/12] time 0.511 (0.712) data 0.000 (0.182) loss 2.6875 (2.7196) lr 9.5241e-02 eta 0:06:07
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.53s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.50s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.54it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.85it/s]100%|██████████| 9/9 [00:09<00:00,  2.34it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 537
* accuracy: 32.2%
* error: 67.8%
* macro_f1: 28.8%

epoch [8/50] batch [2/12] time 0.503 (1.946) data 0.000 (1.427) loss 2.8711 (2.7803) lr 9.5241e-02 eta 0:16:40
epoch [8/50] batch [4/12] time 0.506 (1.226) data 0.000 (0.714) loss 2.7578 (2.7539) lr 9.5241e-02 eta 0:10:27
epoch [8/50] batch [6/12] time 0.509 (0.987) data 0.000 (0.476) loss 2.7891 (2.7474) lr 9.5241e-02 eta 0:08:23
epoch [8/50] batch [8/12] time 0.511 (0.868) data 0.000 (0.357) loss 2.8184 (2.7371) lr 9.5241e-02 eta 0:07:20
epoch [8/50] batch [10/12] time 0.507 (0.796) data 0.000 (0.286) loss 2.6641 (2.7166) lr 9.5241e-02 eta 0:06:42
epoch [8/50] batch [12/12] time 0.506 (0.747) data 0.000 (0.238) loss 2.7246 (2.7166) lr 9.3815e-02 eta 0:06:16
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.43s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.08it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.40it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.03s/it]=> result
* total: 1,667
* correct: 545
* accuracy: 32.7%
* error: 67.3%
* macro_f1: 29.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/12] time 0.517 (2.036) data 0.000 (1.508) loss 2.7285 (2.7979) lr 9.3815e-02 eta 0:17:02
epoch [9/50] batch [4/12] time 0.520 (1.281) data 0.000 (0.754) loss 2.5273 (2.7134) lr 9.3815e-02 eta 0:10:40
epoch [9/50] batch [6/12] time 0.518 (1.026) data 0.000 (0.503) loss 2.6152 (2.7266) lr 9.3815e-02 eta 0:08:31
epoch [9/50] batch [8/12] time 0.517 (0.899) data 0.000 (0.377) loss 2.7109 (2.6992) lr 9.3815e-02 eta 0:07:26
epoch [9/50] batch [10/12] time 0.517 (0.823) data 0.000 (0.302) loss 2.7734 (2.7115) lr 9.3815e-02 eta 0:06:46
epoch [9/50] batch [12/12] time 0.520 (0.772) data 0.000 (0.252) loss 2.7363 (2.7158) lr 9.2216e-02 eta 0:06:20
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:58,  7.27s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.24s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.90s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.27s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.08it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.41it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.73it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.56it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 556
* accuracy: 33.4%
* error: 66.6%
* macro_f1: 29.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [10/50] batch [2/12] time 0.680 (2.137) data 0.000 (1.514) loss 2.8789 (2.7920) lr 9.2216e-02 eta 0:17:27
epoch [10/50] batch [4/12] time 0.508 (1.328) data 0.000 (0.757) loss 2.5957 (2.7339) lr 9.2216e-02 eta 0:10:47
epoch [10/50] batch [6/12] time 0.510 (1.055) data 0.000 (0.505) loss 2.6895 (2.7201) lr 9.2216e-02 eta 0:08:32
epoch [10/50] batch [8/12] time 0.512 (0.919) data 0.000 (0.379) loss 2.4902 (2.6833) lr 9.2216e-02 eta 0:07:24
epoch [10/50] batch [10/12] time 0.509 (0.837) data 0.000 (0.303) loss 2.7598 (2.6975) lr 9.2216e-02 eta 0:06:43
epoch [10/50] batch [12/12] time 0.508 (0.782) data 0.000 (0.252) loss 2.8105 (2.7054) lr 9.0451e-02 eta 0:06:15
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.45s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:09<00:00,  2.37it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 554
* accuracy: 33.2%
* error: 66.8%
* macro_f1: 29.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/12] time 0.520 (1.973) data 0.000 (1.450) loss 2.5195 (2.6084) lr 9.0451e-02 eta 0:15:42
epoch [11/50] batch [4/12] time 0.530 (1.249) data 0.000 (0.725) loss 2.6855 (2.6372) lr 9.0451e-02 eta 0:09:54
epoch [11/50] batch [6/12] time 0.536 (1.011) data 0.000 (0.484) loss 2.5996 (2.6702) lr 9.0451e-02 eta 0:07:58
epoch [11/50] batch [8/12] time 0.508 (0.887) data 0.000 (0.363) loss 2.6074 (2.6826) lr 9.0451e-02 eta 0:06:58
epoch [11/50] batch [10/12] time 0.509 (0.811) data 0.000 (0.290) loss 2.9805 (2.7039) lr 9.0451e-02 eta 0:06:21
epoch [11/50] batch [12/12] time 0.513 (0.761) data 0.000 (0.242) loss 2.6934 (2.6979) lr 8.8526e-02 eta 0:05:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:00,  7.57s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.29s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.93s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.28s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.08it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.40it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.73it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.57it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 552
* accuracy: 33.1%
* error: 66.9%
* macro_f1: 29.2%

epoch [12/50] batch [2/12] time 0.519 (1.976) data 0.000 (1.433) loss 2.6484 (2.6221) lr 8.8526e-02 eta 0:15:20
epoch [12/50] batch [4/12] time 0.520 (1.247) data 0.000 (0.716) loss 2.7012 (2.6191) lr 8.8526e-02 eta 0:09:38
epoch [12/50] batch [6/12] time 0.518 (1.005) data 0.000 (0.478) loss 2.5312 (2.6497) lr 8.8526e-02 eta 0:07:44
epoch [12/50] batch [8/12] time 0.541 (0.889) data 0.000 (0.358) loss 2.6211 (2.6421) lr 8.8526e-02 eta 0:06:48
epoch [12/50] batch [10/12] time 0.541 (0.820) data 0.000 (0.287) loss 2.8809 (2.6439) lr 8.8526e-02 eta 0:06:15
epoch [12/50] batch [12/12] time 0.504 (0.769) data 0.000 (0.239) loss 2.8262 (2.6525) lr 8.6448e-02 eta 0:05:50
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.23s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.13it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.44it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.76it/s]100%|██████████| 9/9 [00:09<00:00,  2.26it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 557
* accuracy: 33.4%
* error: 66.6%
* macro_f1: 29.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [13/50] batch [2/12] time 0.539 (1.752) data 0.001 (1.094) loss 2.6289 (2.7129) lr 8.6448e-02 eta 0:13:15
epoch [13/50] batch [4/12] time 0.522 (1.136) data 0.000 (0.547) loss 2.5840 (2.6987) lr 8.6448e-02 eta 0:08:33
epoch [13/50] batch [6/12] time 0.514 (0.929) data 0.000 (0.365) loss 2.7598 (2.7344) lr 8.6448e-02 eta 0:06:57
epoch [13/50] batch [8/12] time 0.500 (0.824) data 0.000 (0.274) loss 2.7637 (2.7485) lr 8.6448e-02 eta 0:06:09
epoch [13/50] batch [10/12] time 0.513 (0.761) data 0.000 (0.219) loss 2.7773 (2.7447) lr 8.6448e-02 eta 0:05:39
epoch [13/50] batch [12/12] time 0.531 (0.722) data 0.000 (0.183) loss 2.4512 (2.7171) lr 8.4227e-02 eta 0:05:20
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:57,  7.20s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.21s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.88s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.26s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.10it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.42it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.75it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.06it/s]100%|██████████| 9/9 [00:09<00:00,  2.59it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 552
* accuracy: 33.1%
* error: 66.9%
* macro_f1: 28.8%

epoch [14/50] batch [2/12] time 0.503 (1.983) data 0.000 (1.465) loss 2.7812 (2.8105) lr 8.4227e-02 eta 0:14:36
epoch [14/50] batch [4/12] time 0.514 (1.247) data 0.000 (0.733) loss 2.6016 (2.7065) lr 8.4227e-02 eta 0:09:08
epoch [14/50] batch [6/12] time 0.518 (1.003) data 0.000 (0.488) loss 2.6836 (2.6865) lr 8.4227e-02 eta 0:07:19
epoch [14/50] batch [8/12] time 0.518 (0.882) data 0.000 (0.366) loss 2.7578 (2.6895) lr 8.4227e-02 eta 0:06:24
epoch [14/50] batch [10/12] time 0.511 (0.808) data 0.000 (0.293) loss 2.7246 (2.6750) lr 8.4227e-02 eta 0:05:50
epoch [14/50] batch [12/12] time 0.511 (0.759) data 0.000 (0.244) loss 2.6055 (2.6680) lr 8.1871e-02 eta 0:05:27
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:02,  7.79s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.44s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.01s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.34s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.68it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:10<00:00,  2.52it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 562
* accuracy: 33.7%
* error: 66.3%
* macro_f1: 29.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [15/50] batch [2/12] time 0.515 (1.969) data 0.000 (1.399) loss 2.8574 (2.7959) lr 8.1871e-02 eta 0:14:06
epoch [15/50] batch [4/12] time 0.520 (1.245) data 0.000 (0.700) loss 2.7070 (2.7568) lr 8.1871e-02 eta 0:08:52
epoch [15/50] batch [6/12] time 0.528 (1.005) data 0.000 (0.466) loss 2.5098 (2.6751) lr 8.1871e-02 eta 0:07:08
epoch [15/50] batch [8/12] time 0.524 (0.886) data 0.000 (0.350) loss 2.6035 (2.6628) lr 8.1871e-02 eta 0:06:15
epoch [15/50] batch [10/12] time 0.532 (0.815) data 0.000 (0.280) loss 2.5938 (2.6549) lr 8.1871e-02 eta 0:05:43
epoch [15/50] batch [12/12] time 0.522 (0.767) data 0.000 (0.233) loss 2.7695 (2.6618) lr 7.9389e-02 eta 0:05:22
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.72s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.02s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.83s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.26s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.05s/it] 67%|██████▋   | 6/9 [00:08<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.89it/s]100%|██████████| 9/9 [00:09<00:00,  2.40it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 569
* accuracy: 34.1%
* error: 65.9%
* macro_f1: 30.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/12] time 0.503 (1.958) data 0.000 (1.441) loss 2.5527 (2.5000) lr 7.9389e-02 eta 0:13:38
epoch [16/50] batch [4/12] time 0.501 (1.230) data 0.000 (0.720) loss 2.7500 (2.6050) lr 7.9389e-02 eta 0:08:31
epoch [16/50] batch [6/12] time 0.503 (0.988) data 0.000 (0.480) loss 2.6465 (2.6074) lr 7.9389e-02 eta 0:06:48
epoch [16/50] batch [8/12] time 0.512 (0.868) data 0.000 (0.360) loss 2.7812 (2.6467) lr 7.9389e-02 eta 0:05:57
epoch [16/50] batch [10/12] time 0.509 (0.796) data 0.000 (0.288) loss 2.8359 (2.6561) lr 7.9389e-02 eta 0:05:26
epoch [16/50] batch [12/12] time 0.510 (0.748) data 0.000 (0.240) loss 2.6680 (2.6618) lr 7.6791e-02 eta 0:05:05
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.73s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.36s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.97s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.31s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:10<00:00,  2.54it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 566
* accuracy: 34.0%
* error: 66.0%
* macro_f1: 30.4%

epoch [17/50] batch [2/12] time 0.502 (2.040) data 0.000 (1.495) loss 2.3652 (2.4688) lr 7.6791e-02 eta 0:13:48
epoch [17/50] batch [4/12] time 0.503 (1.272) data 0.000 (0.748) loss 2.7656 (2.6221) lr 7.6791e-02 eta 0:08:33
epoch [17/50] batch [6/12] time 0.501 (1.014) data 0.000 (0.499) loss 2.5820 (2.6094) lr 7.6791e-02 eta 0:06:47
epoch [17/50] batch [8/12] time 0.501 (0.886) data 0.000 (0.374) loss 2.7461 (2.6294) lr 7.6791e-02 eta 0:05:54
epoch [17/50] batch [10/12] time 0.505 (0.810) data 0.000 (0.299) loss 2.6758 (2.6393) lr 7.6791e-02 eta 0:05:22
epoch [17/50] batch [12/12] time 0.507 (0.759) data 0.000 (0.249) loss 2.6680 (2.6556) lr 7.4088e-02 eta 0:05:00
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.47s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.55s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:09<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 566
* accuracy: 34.0%
* error: 66.0%
* macro_f1: 29.8%

epoch [18/50] batch [2/12] time 0.669 (1.794) data 0.104 (1.152) loss 2.5781 (2.6660) lr 7.4088e-02 eta 0:11:47
epoch [18/50] batch [4/12] time 0.509 (1.152) data 0.000 (0.576) loss 2.7422 (2.6899) lr 7.4088e-02 eta 0:07:31
epoch [18/50] batch [6/12] time 0.512 (0.938) data 0.000 (0.384) loss 2.5762 (2.6462) lr 7.4088e-02 eta 0:06:05
epoch [18/50] batch [8/12] time 0.508 (0.831) data 0.000 (0.288) loss 2.6738 (2.6362) lr 7.4088e-02 eta 0:05:22
epoch [18/50] batch [10/12] time 0.505 (0.765) data 0.000 (0.231) loss 2.5879 (2.6313) lr 7.4088e-02 eta 0:04:55
epoch [18/50] batch [12/12] time 0.506 (0.722) data 0.000 (0.192) loss 2.4961 (2.6273) lr 7.1289e-02 eta 0:04:37
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:00,  7.60s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.31s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.93s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.29s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:10<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 572
* accuracy: 34.3%
* error: 65.7%
* macro_f1: 31.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [19/50] batch [2/12] time 0.581 (1.813) data 0.000 (1.157) loss 2.6504 (2.6221) lr 7.1289e-02 eta 0:11:32
epoch [19/50] batch [4/12] time 0.515 (1.163) data 0.000 (0.579) loss 2.6016 (2.6274) lr 7.1289e-02 eta 0:07:22
epoch [19/50] batch [6/12] time 0.516 (0.948) data 0.000 (0.386) loss 2.7441 (2.6126) lr 7.1289e-02 eta 0:05:58
epoch [19/50] batch [8/12] time 0.502 (0.838) data 0.000 (0.290) loss 2.6250 (2.6023) lr 7.1289e-02 eta 0:05:14
epoch [19/50] batch [10/12] time 0.504 (0.771) data 0.000 (0.232) loss 2.7266 (2.6074) lr 7.1289e-02 eta 0:04:48
epoch [19/50] batch [12/12] time 0.505 (0.726) data 0.000 (0.193) loss 2.6426 (2.6134) lr 6.8406e-02 eta 0:04:30
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.53s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.58s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.09s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.47it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 577
* accuracy: 34.6%
* error: 65.4%
* macro_f1: 31.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [20/50] batch [2/12] time 0.533 (2.025) data 0.000 (1.436) loss 2.7188 (2.6924) lr 6.8406e-02 eta 0:12:29
epoch [20/50] batch [4/12] time 0.653 (1.306) data 0.000 (0.718) loss 2.4844 (2.6392) lr 6.8406e-02 eta 0:08:00
epoch [20/50] batch [6/12] time 0.506 (1.039) data 0.000 (0.479) loss 2.7754 (2.6569) lr 6.8406e-02 eta 0:06:20
epoch [20/50] batch [8/12] time 0.507 (0.906) data 0.000 (0.359) loss 2.6660 (2.6626) lr 6.8406e-02 eta 0:05:29
epoch [20/50] batch [10/12] time 0.503 (0.826) data 0.000 (0.287) loss 2.7812 (2.6766) lr 6.8406e-02 eta 0:04:58
epoch [20/50] batch [12/12] time 0.506 (0.772) data 0.000 (0.240) loss 2.6191 (2.6465) lr 6.5451e-02 eta 0:04:37
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.53s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.54s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.06s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.96it/s]100%|██████████| 9/9 [00:09<00:00,  2.48it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 581
* accuracy: 34.9%
* error: 65.1%
* macro_f1: 31.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/12] time 0.527 (2.004) data 0.000 (1.443) loss 2.6680 (2.6475) lr 6.5451e-02 eta 0:11:57
epoch [21/50] batch [4/12] time 0.532 (1.268) data 0.000 (0.722) loss 2.5957 (2.6343) lr 6.5451e-02 eta 0:07:31
epoch [21/50] batch [6/12] time 0.527 (1.022) data 0.000 (0.481) loss 2.4844 (2.6393) lr 6.5451e-02 eta 0:06:01
epoch [21/50] batch [8/12] time 0.503 (0.892) data 0.000 (0.361) loss 2.6016 (2.6208) lr 6.5451e-02 eta 0:05:14
epoch [21/50] batch [10/12] time 0.503 (0.815) data 0.000 (0.289) loss 2.5801 (2.6180) lr 6.5451e-02 eta 0:04:45
epoch [21/50] batch [12/12] time 0.505 (0.763) data 0.000 (0.241) loss 2.5918 (2.6092) lr 6.2434e-02 eta 0:04:25
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.60s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.97s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.25s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.48s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.06s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.56it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:10<00:00,  2.37it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 589
* accuracy: 35.3%
* error: 64.7%
* macro_f1: 31.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [22/50] batch [2/12] time 0.505 (2.003) data 0.001 (1.438) loss 2.5430 (2.6318) lr 6.2434e-02 eta 0:11:33
epoch [22/50] batch [4/12] time 0.512 (1.255) data 0.000 (0.719) loss 2.4844 (2.5864) lr 6.2434e-02 eta 0:07:11
epoch [22/50] batch [6/12] time 0.528 (1.010) data 0.000 (0.479) loss 2.6895 (2.6003) lr 6.2434e-02 eta 0:05:45
epoch [22/50] batch [8/12] time 0.541 (0.892) data 0.000 (0.360) loss 2.6660 (2.6165) lr 6.2434e-02 eta 0:05:03
epoch [22/50] batch [10/12] time 0.524 (0.820) data 0.000 (0.288) loss 2.8379 (2.6314) lr 6.2434e-02 eta 0:04:37
epoch [22/50] batch [12/12] time 0.520 (0.770) data 0.000 (0.240) loss 2.5293 (2.6234) lr 5.9369e-02 eta 0:04:18
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.51s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.98s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.81s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.49s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.06s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.88it/s]100%|██████████| 9/9 [00:09<00:00,  2.40it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 582
* accuracy: 34.9%
* error: 65.1%
* macro_f1: 30.7%

epoch [23/50] batch [2/12] time 0.530 (2.000) data 0.000 (1.440) loss 2.6953 (2.6758) lr 5.9369e-02 eta 0:11:08
epoch [23/50] batch [4/12] time 0.522 (1.262) data 0.000 (0.720) loss 2.7227 (2.6475) lr 5.9369e-02 eta 0:06:58
epoch [23/50] batch [6/12] time 0.523 (1.015) data 0.000 (0.480) loss 2.5781 (2.6165) lr 5.9369e-02 eta 0:05:34
epoch [23/50] batch [8/12] time 0.526 (0.891) data 0.000 (0.360) loss 2.8047 (2.6399) lr 5.9369e-02 eta 0:04:52
epoch [23/50] batch [10/12] time 0.539 (0.819) data 0.000 (0.288) loss 2.7207 (2.6445) lr 5.9369e-02 eta 0:04:26
epoch [23/50] batch [12/12] time 0.538 (0.772) data 0.000 (0.240) loss 2.6406 (2.6367) lr 5.6267e-02 eta 0:04:10
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.71s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.40s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.99s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.32s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:10<00:00,  2.53it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 584
* accuracy: 35.0%
* error: 65.0%
* macro_f1: 31.3%

epoch [24/50] batch [2/12] time 0.512 (2.001) data 0.001 (1.457) loss 2.7363 (2.6514) lr 5.6267e-02 eta 0:10:44
epoch [24/50] batch [4/12] time 0.518 (1.261) data 0.000 (0.729) loss 2.3828 (2.6006) lr 5.6267e-02 eta 0:06:43
epoch [24/50] batch [6/12] time 0.517 (1.014) data 0.000 (0.486) loss 2.6914 (2.6071) lr 5.6267e-02 eta 0:05:22
epoch [24/50] batch [8/12] time 0.514 (0.889) data 0.000 (0.365) loss 2.5762 (2.6099) lr 5.6267e-02 eta 0:04:40
epoch [24/50] batch [10/12] time 0.505 (0.813) data 0.000 (0.292) loss 2.6543 (2.6141) lr 5.6267e-02 eta 0:04:15
epoch [24/50] batch [12/12] time 0.512 (0.763) data 0.000 (0.243) loss 2.6875 (2.6154) lr 5.3140e-02 eta 0:03:58
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.73s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.58s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.08s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.97it/s]100%|██████████| 9/9 [00:10<00:00,  2.48it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 590
* accuracy: 35.4%
* error: 64.6%
* macro_f1: 31.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [25/50] batch [2/12] time 0.519 (2.038) data 0.000 (1.492) loss 2.6660 (2.5889) lr 5.3140e-02 eta 0:10:31
epoch [25/50] batch [4/12] time 0.518 (1.278) data 0.000 (0.746) loss 2.6641 (2.6201) lr 5.3140e-02 eta 0:06:33
epoch [25/50] batch [6/12] time 0.530 (1.027) data 0.000 (0.498) loss 2.7246 (2.6100) lr 5.3140e-02 eta 0:05:14
epoch [25/50] batch [8/12] time 0.531 (0.903) data 0.000 (0.373) loss 2.7363 (2.6252) lr 5.3140e-02 eta 0:04:34
epoch [25/50] batch [10/12] time 0.523 (0.828) data 0.000 (0.299) loss 2.5254 (2.6082) lr 5.3140e-02 eta 0:04:09
epoch [25/50] batch [12/12] time 0.522 (0.777) data 0.000 (0.249) loss 2.6406 (2.6077) lr 5.0000e-02 eta 0:03:53
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.69s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.00s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.82s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.27s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.09it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.41it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.74it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.05it/s]100%|██████████| 9/9 [00:09<00:00,  2.58it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 604
* accuracy: 36.2%
* error: 63.8%
* macro_f1: 32.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [26/50] batch [2/12] time 0.623 (1.727) data 0.062 (1.063) loss 2.6914 (2.6387) lr 5.0000e-02 eta 0:08:34
epoch [26/50] batch [4/12] time 0.513 (1.120) data 0.000 (0.531) loss 2.7520 (2.6108) lr 5.0000e-02 eta 0:05:31
epoch [26/50] batch [6/12] time 0.512 (0.917) data 0.000 (0.354) loss 2.5977 (2.6273) lr 5.0000e-02 eta 0:04:29
epoch [26/50] batch [8/12] time 0.513 (0.816) data 0.000 (0.266) loss 2.7832 (2.6501) lr 5.0000e-02 eta 0:03:58
epoch [26/50] batch [10/12] time 0.517 (0.756) data 0.000 (0.213) loss 2.8457 (2.6627) lr 5.0000e-02 eta 0:03:39
epoch [26/50] batch [12/12] time 0.530 (0.719) data 0.000 (0.177) loss 2.4824 (2.6353) lr 4.6860e-02 eta 0:03:26
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.72s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.02s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.83s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.29s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.40it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.56it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 594
* accuracy: 35.6%
* error: 64.4%
* macro_f1: 32.2%

epoch [27/50] batch [2/12] time 0.506 (1.972) data 0.000 (1.421) loss 2.6270 (2.5518) lr 4.6860e-02 eta 0:09:24
epoch [27/50] batch [4/12] time 0.511 (1.241) data 0.000 (0.711) loss 2.5039 (2.5732) lr 4.6860e-02 eta 0:05:52
epoch [27/50] batch [6/12] time 0.507 (0.996) data 0.000 (0.474) loss 2.7168 (2.6045) lr 4.6860e-02 eta 0:04:40
epoch [27/50] batch [8/12] time 0.506 (0.873) data 0.000 (0.355) loss 2.5488 (2.6011) lr 4.6860e-02 eta 0:04:04
epoch [27/50] batch [10/12] time 0.505 (0.799) data 0.000 (0.284) loss 2.6426 (2.6033) lr 4.6860e-02 eta 0:03:42
epoch [27/50] batch [12/12] time 0.505 (0.750) data 0.000 (0.237) loss 2.5039 (2.6048) lr 4.3733e-02 eta 0:03:27
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.60s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.58s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.08s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.47it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 597
* accuracy: 35.8%
* error: 64.2%
* macro_f1: 32.3%

epoch [28/50] batch [2/12] time 0.507 (1.963) data 0.000 (1.407) loss 2.7891 (2.6611) lr 4.3733e-02 eta 0:08:57
epoch [28/50] batch [4/12] time 0.505 (1.236) data 0.000 (0.703) loss 2.5938 (2.6284) lr 4.3733e-02 eta 0:05:36
epoch [28/50] batch [6/12] time 0.502 (0.992) data 0.000 (0.469) loss 2.4609 (2.5990) lr 4.3733e-02 eta 0:04:27
epoch [28/50] batch [8/12] time 0.502 (0.870) data 0.000 (0.352) loss 2.4902 (2.5723) lr 4.3733e-02 eta 0:03:53
epoch [28/50] batch [10/12] time 0.503 (0.796) data 0.000 (0.282) loss 2.5684 (2.5812) lr 4.3733e-02 eta 0:03:31
epoch [28/50] batch [12/12] time 0.508 (0.748) data 0.000 (0.235) loss 2.5117 (2.5788) lr 4.0631e-02 eta 0:03:17
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.54s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.95s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.39s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:09<00:00,  2.46it/s]100%|██████████| 9/9 [00:09<00:00,  1.07s/it]=> result
* total: 1,667
* correct: 600
* accuracy: 36.0%
* error: 64.0%
* macro_f1: 32.9%

epoch [29/50] batch [2/12] time 0.517 (2.001) data 0.000 (1.429) loss 2.7246 (2.6973) lr 4.0631e-02 eta 0:08:44
epoch [29/50] batch [4/12] time 0.647 (1.290) data 0.000 (0.715) loss 2.5703 (2.6597) lr 4.0631e-02 eta 0:05:35
epoch [29/50] batch [6/12] time 0.511 (1.030) data 0.000 (0.477) loss 2.6367 (2.6344) lr 4.0631e-02 eta 0:04:25
epoch [29/50] batch [8/12] time 0.507 (0.900) data 0.000 (0.357) loss 2.6738 (2.6191) lr 4.0631e-02 eta 0:03:50
epoch [29/50] batch [10/12] time 0.506 (0.821) data 0.000 (0.286) loss 2.7227 (2.6258) lr 4.0631e-02 eta 0:03:28
epoch [29/50] batch [12/12] time 0.504 (0.768) data 0.000 (0.238) loss 2.7559 (2.6432) lr 3.7566e-02 eta 0:03:13
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.57s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.99s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.97it/s]100%|██████████| 9/9 [00:09<00:00,  2.48it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 589
* accuracy: 35.3%
* error: 64.7%
* macro_f1: 31.6%

epoch [30/50] batch [2/12] time 0.530 (1.999) data 0.001 (1.413) loss 2.5996 (2.6738) lr 3.7566e-02 eta 0:08:19
epoch [30/50] batch [4/12] time 0.508 (1.254) data 0.000 (0.706) loss 2.7324 (2.6655) lr 3.7566e-02 eta 0:05:11
epoch [30/50] batch [6/12] time 0.503 (1.004) data 0.000 (0.471) loss 2.6406 (2.6497) lr 3.7566e-02 eta 0:04:06
epoch [30/50] batch [8/12] time 0.505 (0.879) data 0.000 (0.353) loss 2.6055 (2.6333) lr 3.7566e-02 eta 0:03:34
epoch [30/50] batch [10/12] time 0.504 (0.804) data 0.000 (0.283) loss 2.5430 (2.6293) lr 3.7566e-02 eta 0:03:14
epoch [30/50] batch [12/12] time 0.509 (0.755) data 0.000 (0.236) loss 2.6797 (2.6317) lr 3.4549e-02 eta 0:03:01
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.31s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.94s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 591
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/12] time 0.529 (1.998) data 0.000 (1.418) loss 2.6191 (2.6025) lr 3.4549e-02 eta 0:07:55
epoch [31/50] batch [4/12] time 0.531 (1.265) data 0.000 (0.709) loss 2.6738 (2.6162) lr 3.4549e-02 eta 0:04:58
epoch [31/50] batch [6/12] time 0.531 (1.021) data 0.000 (0.473) loss 2.5820 (2.6123) lr 3.4549e-02 eta 0:03:58
epoch [31/50] batch [8/12] time 0.502 (0.891) data 0.000 (0.355) loss 2.7285 (2.6084) lr 3.4549e-02 eta 0:03:26
epoch [31/50] batch [10/12] time 0.505 (0.814) data 0.000 (0.284) loss 2.4414 (2.5961) lr 3.4549e-02 eta 0:03:07
epoch [31/50] batch [12/12] time 0.505 (0.762) data 0.000 (0.237) loss 2.4922 (2.5905) lr 3.1594e-02 eta 0:02:53
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:04,  8.09s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.51s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.05s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.36s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.98it/s]100%|██████████| 9/9 [00:10<00:00,  2.50it/s]100%|██████████| 9/9 [00:10<00:00,  1.16s/it]=> result
* total: 1,667
* correct: 611
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 33.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [32/50] batch [2/12] time 0.511 (2.022) data 0.000 (1.484) loss 2.6543 (2.5723) lr 3.1594e-02 eta 0:07:36
epoch [32/50] batch [4/12] time 0.517 (1.267) data 0.000 (0.742) loss 2.6152 (2.6362) lr 3.1594e-02 eta 0:04:43
epoch [32/50] batch [6/12] time 0.535 (1.023) data 0.000 (0.495) loss 2.6992 (2.6592) lr 3.1594e-02 eta 0:03:47
epoch [32/50] batch [8/12] time 0.534 (0.901) data 0.000 (0.371) loss 2.4531 (2.6116) lr 3.1594e-02 eta 0:03:18
epoch [32/50] batch [10/12] time 0.509 (0.824) data 0.000 (0.297) loss 2.2793 (2.5689) lr 3.1594e-02 eta 0:02:59
epoch [32/50] batch [12/12] time 0.510 (0.771) data 0.000 (0.248) loss 2.6953 (2.5840) lr 2.8711e-02 eta 0:02:46
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.98s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.81s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.29s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.56it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 594
* accuracy: 35.6%
* error: 64.4%
* macro_f1: 32.0%

epoch [33/50] batch [2/12] time 0.594 (1.754) data 0.001 (1.046) loss 2.5605 (2.5693) lr 2.8711e-02 eta 0:06:15
epoch [33/50] batch [4/12] time 0.514 (1.136) data 0.000 (0.523) loss 2.6523 (2.5562) lr 2.8711e-02 eta 0:04:00
epoch [33/50] batch [6/12] time 0.510 (0.927) data 0.000 (0.349) loss 2.6738 (2.5687) lr 2.8711e-02 eta 0:03:14
epoch [33/50] batch [8/12] time 0.510 (0.822) data 0.000 (0.262) loss 2.5391 (2.5542) lr 2.8711e-02 eta 0:02:50
epoch [33/50] batch [10/12] time 0.530 (0.762) data 0.000 (0.209) loss 2.5859 (2.6031) lr 2.8711e-02 eta 0:02:36
epoch [33/50] batch [12/12] time 0.531 (0.723) data 0.000 (0.175) loss 2.5430 (2.5965) lr 2.5912e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.68s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.99s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.82s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.34s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.97it/s]100%|██████████| 9/9 [00:09<00:00,  2.49it/s]100%|██████████| 9/9 [00:09<00:00,  1.07s/it]=> result
* total: 1,667
* correct: 601
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 33.2%

epoch [34/50] batch [2/12] time 0.503 (1.863) data 0.000 (1.230) loss 2.6465 (2.5918) lr 2.5912e-02 eta 0:06:16
epoch [34/50] batch [4/12] time 0.506 (1.184) data 0.000 (0.615) loss 2.4199 (2.5273) lr 2.5912e-02 eta 0:03:56
epoch [34/50] batch [6/12] time 0.516 (0.962) data 0.000 (0.410) loss 2.6680 (2.5348) lr 2.5912e-02 eta 0:03:10
epoch [34/50] batch [8/12] time 0.515 (0.850) data 0.000 (0.308) loss 2.8574 (2.5750) lr 2.5912e-02 eta 0:02:46
epoch [34/50] batch [10/12] time 0.508 (0.782) data 0.000 (0.246) loss 2.5723 (2.5775) lr 2.5912e-02 eta 0:02:31
epoch [34/50] batch [12/12] time 0.506 (0.736) data 0.000 (0.205) loss 2.7539 (2.5833) lr 2.3209e-02 eta 0:02:21
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.74s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.02s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.83s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.08s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:09<00:00,  2.38it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 606
* accuracy: 36.4%
* error: 63.6%
* macro_f1: 33.0%

epoch [35/50] batch [2/12] time 0.508 (2.016) data 0.000 (1.495) loss 2.5391 (2.5605) lr 2.3209e-02 eta 0:06:23
epoch [35/50] batch [4/12] time 0.506 (1.261) data 0.000 (0.747) loss 2.4453 (2.5854) lr 2.3209e-02 eta 0:03:57
epoch [35/50] batch [6/12] time 0.508 (1.009) data 0.000 (0.498) loss 2.7051 (2.6383) lr 2.3209e-02 eta 0:03:07
epoch [35/50] batch [8/12] time 0.526 (0.886) data 0.000 (0.374) loss 2.5469 (2.6238) lr 2.3209e-02 eta 0:02:43
epoch [35/50] batch [10/12] time 0.524 (0.813) data 0.000 (0.299) loss 2.6484 (2.6260) lr 2.3209e-02 eta 0:02:28
epoch [35/50] batch [12/12] time 0.519 (0.764) data 0.000 (0.249) loss 2.4609 (2.6139) lr 2.0611e-02 eta 0:02:17
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.80s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.05s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.85s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.33s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.07s/it]=> result
* total: 1,667
* correct: 611
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 33.7%

epoch [36/50] batch [2/12] time 0.511 (1.972) data 0.000 (1.420) loss 2.5352 (2.5811) lr 2.0611e-02 eta 0:05:50
epoch [36/50] batch [4/12] time 0.507 (1.240) data 0.000 (0.710) loss 2.6562 (2.6426) lr 2.0611e-02 eta 0:03:38
epoch [36/50] batch [6/12] time 0.506 (0.995) data 0.000 (0.473) loss 2.5039 (2.6097) lr 2.0611e-02 eta 0:02:53
epoch [36/50] batch [8/12] time 0.504 (0.872) data 0.000 (0.355) loss 2.4668 (2.5876) lr 2.0611e-02 eta 0:02:30
epoch [36/50] batch [10/12] time 0.503 (0.798) data 0.000 (0.284) loss 2.5156 (2.5850) lr 2.0611e-02 eta 0:02:15
epoch [36/50] batch [12/12] time 0.523 (0.751) data 0.000 (0.237) loss 2.5840 (2.5824) lr 1.8129e-02 eta 0:02:06
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.75s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.61s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.10s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.39s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.94it/s]100%|██████████| 9/9 [00:10<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 599
* accuracy: 35.9%
* error: 64.1%
* macro_f1: 33.1%

epoch [37/50] batch [2/12] time 0.646 (1.806) data 0.113 (1.175) loss 2.6074 (2.6738) lr 1.8129e-02 eta 0:04:59
epoch [37/50] batch [4/12] time 0.503 (1.155) data 0.000 (0.587) loss 2.5137 (2.6323) lr 1.8129e-02 eta 0:03:09
epoch [37/50] batch [6/12] time 0.501 (0.937) data 0.000 (0.392) loss 2.5859 (2.6426) lr 1.8129e-02 eta 0:02:31
epoch [37/50] batch [8/12] time 0.504 (0.829) data 0.000 (0.294) loss 2.3496 (2.5935) lr 1.8129e-02 eta 0:02:12
epoch [37/50] batch [10/12] time 0.503 (0.764) data 0.000 (0.235) loss 2.4883 (2.5725) lr 1.8129e-02 eta 0:02:00
epoch [37/50] batch [12/12] time 0.510 (0.721) data 0.000 (0.196) loss 2.6465 (2.5910) lr 1.5773e-02 eta 0:01:52
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.70s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.35s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.96s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.31s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 601
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 33.2%

epoch [38/50] batch [2/12] time 0.504 (1.970) data 0.000 (1.398) loss 2.5645 (2.6240) lr 1.5773e-02 eta 0:05:03
epoch [38/50] batch [4/12] time 0.505 (1.271) data 0.000 (0.699) loss 2.4727 (2.6104) lr 1.5773e-02 eta 0:03:13
epoch [38/50] batch [6/12] time 0.505 (1.016) data 0.000 (0.466) loss 2.3242 (2.5547) lr 1.5773e-02 eta 0:02:32
epoch [38/50] batch [8/12] time 0.502 (0.888) data 0.000 (0.350) loss 2.6465 (2.5847) lr 1.5773e-02 eta 0:02:11
epoch [38/50] batch [10/12] time 0.506 (0.811) data 0.000 (0.280) loss 2.6113 (2.5844) lr 1.5773e-02 eta 0:01:58
epoch [38/50] batch [12/12] time 0.508 (0.760) data 0.000 (0.233) loss 2.6621 (2.5780) lr 1.3552e-02 eta 0:01:49
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 610
* accuracy: 36.6%
* error: 63.4%
* macro_f1: 33.5%

epoch [39/50] batch [2/12] time 0.507 (2.004) data 0.000 (1.414) loss 2.4297 (2.4902) lr 1.3552e-02 eta 0:04:44
epoch [39/50] batch [4/12] time 0.507 (1.256) data 0.000 (0.707) loss 2.6602 (2.5552) lr 1.3552e-02 eta 0:02:55
epoch [39/50] batch [6/12] time 0.505 (1.006) data 0.000 (0.471) loss 2.3809 (2.5260) lr 1.3552e-02 eta 0:02:18
epoch [39/50] batch [8/12] time 0.504 (0.880) data 0.000 (0.354) loss 2.5000 (2.5071) lr 1.3552e-02 eta 0:01:59
epoch [39/50] batch [10/12] time 0.504 (0.805) data 0.000 (0.283) loss 2.6016 (2.5229) lr 1.3552e-02 eta 0:01:47
epoch [39/50] batch [12/12] time 0.506 (0.755) data 0.000 (0.236) loss 2.5859 (2.5221) lr 1.1474e-02 eta 0:01:39
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.73s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.36s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.96s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.31s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:10<00:00,  2.51it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 611
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 33.6%

epoch [40/50] batch [2/12] time 0.540 (2.031) data 0.000 (1.442) loss 2.6191 (2.5977) lr 1.1474e-02 eta 0:04:24
epoch [40/50] batch [4/12] time 0.547 (1.288) data 0.000 (0.721) loss 2.5352 (2.5820) lr 1.1474e-02 eta 0:02:44
epoch [40/50] batch [6/12] time 0.543 (1.039) data 0.000 (0.481) loss 2.5566 (2.5837) lr 1.1474e-02 eta 0:02:10
epoch [40/50] batch [8/12] time 0.544 (0.915) data 0.000 (0.361) loss 2.5566 (2.5708) lr 1.1474e-02 eta 0:01:53
epoch [40/50] batch [10/12] time 0.550 (0.841) data 0.000 (0.289) loss 2.6836 (2.5682) lr 1.1474e-02 eta 0:01:42
epoch [40/50] batch [12/12] time 0.531 (0.789) data 0.001 (0.241) loss 2.5098 (2.5721) lr 9.5492e-03 eta 0:01:34
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.64s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.53s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.06s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.36s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.98it/s]100%|██████████| 9/9 [00:09<00:00,  2.50it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 613
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 33.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/12] time 0.508 (1.948) data 0.000 (1.388) loss 2.6777 (2.6504) lr 9.5492e-03 eta 0:03:49
epoch [41/50] batch [4/12] time 0.501 (1.226) data 0.000 (0.694) loss 2.5234 (2.5977) lr 9.5492e-03 eta 0:02:22
epoch [41/50] batch [6/12] time 0.501 (0.984) data 0.000 (0.463) loss 2.6172 (2.5830) lr 9.5492e-03 eta 0:01:52
epoch [41/50] batch [8/12] time 0.512 (0.865) data 0.000 (0.347) loss 2.5664 (2.5542) lr 9.5492e-03 eta 0:01:36
epoch [41/50] batch [10/12] time 0.504 (0.793) data 0.000 (0.278) loss 2.6543 (2.5551) lr 9.5492e-03 eta 0:01:27
epoch [41/50] batch [12/12] time 0.502 (0.744) data 0.000 (0.232) loss 2.5938 (2.5594) lr 7.7836e-03 eta 0:01:20
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.73s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.62s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.11s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.40s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.01s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.30it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.61it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.92it/s]100%|██████████| 9/9 [00:10<00:00,  2.42it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 601
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 33.0%

epoch [42/50] batch [2/12] time 0.518 (2.071) data 0.000 (1.497) loss 2.4395 (2.6191) lr 7.7836e-03 eta 0:03:39
epoch [42/50] batch [4/12] time 0.517 (1.295) data 0.000 (0.749) loss 2.5137 (2.5806) lr 7.7836e-03 eta 0:02:14
epoch [42/50] batch [6/12] time 0.520 (1.036) data 0.000 (0.499) loss 2.6465 (2.6074) lr 7.7836e-03 eta 0:01:45
epoch [42/50] batch [8/12] time 0.518 (0.906) data 0.000 (0.374) loss 2.3887 (2.5706) lr 7.7836e-03 eta 0:01:30
epoch [42/50] batch [10/12] time 0.514 (0.828) data 0.000 (0.300) loss 2.5664 (2.5791) lr 7.7836e-03 eta 0:01:21
epoch [42/50] batch [12/12] time 0.526 (0.777) data 0.000 (0.250) loss 2.5156 (2.5617) lr 6.1847e-03 eta 0:01:14
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.42s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.48s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.05s/it] 67%|██████▋   | 6/9 [00:08<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.58it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.89it/s]100%|██████████| 9/9 [00:09<00:00,  2.41it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 608
* accuracy: 36.5%
* error: 63.5%
* macro_f1: 33.7%

epoch [43/50] batch [2/12] time 0.558 (1.730) data 0.000 (1.090) loss 2.4668 (2.4766) lr 6.1847e-03 eta 0:02:42
epoch [43/50] batch [4/12] time 0.517 (1.122) data 0.000 (0.545) loss 2.6758 (2.4819) lr 6.1847e-03 eta 0:01:43
epoch [43/50] batch [6/12] time 0.532 (0.924) data 0.000 (0.363) loss 2.5840 (2.5140) lr 6.1847e-03 eta 0:01:23
epoch [43/50] batch [8/12] time 0.504 (0.822) data 0.000 (0.273) loss 2.6758 (2.5461) lr 6.1847e-03 eta 0:01:12
epoch [43/50] batch [10/12] time 0.506 (0.759) data 0.000 (0.218) loss 2.6719 (2.5555) lr 6.1847e-03 eta 0:01:05
epoch [43/50] batch [12/12] time 0.504 (0.717) data 0.000 (0.182) loss 2.7871 (2.5768) lr 4.7586e-03 eta 0:01:00
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:59,  7.39s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.22s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.89s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.26s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.09it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.42it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.75it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.06it/s]100%|██████████| 9/9 [00:09<00:00,  2.59it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 613
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 33.8%

epoch [44/50] batch [2/12] time 0.502 (1.973) data 0.000 (1.442) loss 2.5430 (2.5205) lr 4.7586e-03 eta 0:02:41
epoch [44/50] batch [4/12] time 0.509 (1.240) data 0.000 (0.721) loss 2.5000 (2.5444) lr 4.7586e-03 eta 0:01:39
epoch [44/50] batch [6/12] time 0.499 (0.994) data 0.000 (0.481) loss 2.4258 (2.5361) lr 4.7586e-03 eta 0:01:17
epoch [44/50] batch [8/12] time 0.507 (0.872) data 0.000 (0.361) loss 2.5039 (2.5544) lr 4.7586e-03 eta 0:01:06
epoch [44/50] batch [10/12] time 0.496 (0.798) data 0.000 (0.289) loss 2.5371 (2.5330) lr 4.7586e-03 eta 0:00:59
epoch [44/50] batch [12/12] time 0.497 (0.748) data 0.000 (0.241) loss 2.5371 (2.5352) lr 3.5112e-03 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.49s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.93s/it] 33%|███▎      | 3/9 [00:07<00:12,  2.08s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.97it/s]100%|██████████| 9/9 [00:09<00:00,  2.49it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 608
* accuracy: 36.5%
* error: 63.5%
* macro_f1: 33.5%

epoch [45/50] batch [2/12] time 0.634 (1.781) data 0.082 (1.138) loss 2.5293 (2.5879) lr 3.5112e-03 eta 0:02:04
epoch [45/50] batch [4/12] time 0.510 (1.146) data 0.000 (0.569) loss 2.4551 (2.5542) lr 3.5112e-03 eta 0:01:17
epoch [45/50] batch [6/12] time 0.506 (0.933) data 0.000 (0.380) loss 2.4531 (2.5518) lr 3.5112e-03 eta 0:01:01
epoch [45/50] batch [8/12] time 0.516 (0.828) data 0.000 (0.285) loss 2.5273 (2.5464) lr 3.5112e-03 eta 0:00:53
epoch [45/50] batch [10/12] time 0.503 (0.764) data 0.000 (0.228) loss 2.6055 (2.5492) lr 3.5112e-03 eta 0:00:47
epoch [45/50] batch [12/12] time 0.514 (0.721) data 0.000 (0.190) loss 2.7305 (2.5542) lr 2.4472e-03 eta 0:00:43
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.75s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.22s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:08<00:02,  1.24it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.56it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.88it/s]100%|██████████| 9/9 [00:09<00:00,  2.39it/s]100%|██████████| 9/9 [00:09<00:00,  1.07s/it]=> result
* total: 1,667
* correct: 606
* accuracy: 36.4%
* error: 63.6%
* macro_f1: 33.5%

epoch [46/50] batch [2/12] time 0.509 (1.962) data 0.000 (1.417) loss 2.5312 (2.5938) lr 2.4472e-03 eta 0:01:53
epoch [46/50] batch [4/12] time 0.505 (1.235) data 0.000 (0.709) loss 2.3652 (2.4897) lr 2.4472e-03 eta 0:01:09
epoch [46/50] batch [6/12] time 0.511 (0.993) data 0.000 (0.473) loss 2.5078 (2.4893) lr 2.4472e-03 eta 0:00:53
epoch [46/50] batch [8/12] time 0.508 (0.873) data 0.000 (0.354) loss 2.6875 (2.4954) lr 2.4472e-03 eta 0:00:45
epoch [46/50] batch [10/12] time 0.504 (0.800) data 0.000 (0.284) loss 2.7129 (2.5338) lr 2.4472e-03 eta 0:00:39
epoch [46/50] batch [12/12] time 0.510 (0.751) data 0.000 (0.236) loss 2.4980 (2.5264) lr 1.5708e-03 eta 0:00:36
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.54s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:09<00:00,  2.38it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 606
* accuracy: 36.4%
* error: 63.6%
* macro_f1: 33.5%

epoch [47/50] batch [2/12] time 0.508 (1.942) data 0.000 (1.356) loss 2.5566 (2.5557) lr 1.5708e-03 eta 0:01:29
epoch [47/50] batch [4/12] time 0.524 (1.231) data 0.000 (0.678) loss 2.5605 (2.5347) lr 1.5708e-03 eta 0:00:54
epoch [47/50] batch [6/12] time 0.518 (0.995) data 0.000 (0.452) loss 2.5508 (2.5426) lr 1.5708e-03 eta 0:00:41
epoch [47/50] batch [8/12] time 0.519 (0.876) data 0.000 (0.339) loss 2.4688 (2.5500) lr 1.5708e-03 eta 0:00:35
epoch [47/50] batch [10/12] time 0.635 (0.816) data 0.000 (0.271) loss 2.6094 (2.5646) lr 1.5708e-03 eta 0:00:31
epoch [47/50] batch [12/12] time 0.520 (0.767) data 0.000 (0.226) loss 2.5215 (2.5713) lr 8.8564e-04 eta 0:00:27
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.49s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.80s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.21s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.45s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.04s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.60it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.92it/s]100%|██████████| 9/9 [00:10<00:00,  2.43it/s]100%|██████████| 9/9 [00:10<00:00,  1.17s/it]=> result
* total: 1,667
* correct: 609
* accuracy: 36.5%
* error: 63.5%
* macro_f1: 33.5%

epoch [48/50] batch [2/12] time 0.571 (1.753) data 0.000 (1.125) loss 2.6641 (2.5752) lr 8.8564e-04 eta 0:00:59
epoch [48/50] batch [4/12] time 0.501 (1.131) data 0.000 (0.563) loss 2.7402 (2.6494) lr 8.8564e-04 eta 0:00:36
epoch [48/50] batch [6/12] time 0.504 (0.922) data 0.000 (0.375) loss 2.8301 (2.6618) lr 8.8564e-04 eta 0:00:27
epoch [48/50] batch [8/12] time 0.509 (0.818) data 0.000 (0.282) loss 2.5723 (2.6409) lr 8.8564e-04 eta 0:00:22
epoch [48/50] batch [10/12] time 0.510 (0.756) data 0.000 (0.225) loss 2.5312 (2.6207) lr 8.8564e-04 eta 0:00:19
epoch [48/50] batch [12/12] time 0.505 (0.715) data 0.000 (0.188) loss 2.6562 (2.6143) lr 3.9426e-04 eta 0:00:17
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.45s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:12,  2.06s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.98it/s]100%|██████████| 9/9 [00:09<00:00,  2.50it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 608
* accuracy: 36.5%
* error: 63.5%
* macro_f1: 33.4%

epoch [49/50] batch [2/12] time 0.515 (1.970) data 0.001 (1.436) loss 2.5000 (2.4980) lr 3.9426e-04 eta 0:00:43
epoch [49/50] batch [4/12] time 0.500 (1.236) data 0.000 (0.718) loss 2.6250 (2.5181) lr 3.9426e-04 eta 0:00:24
epoch [49/50] batch [6/12] time 0.503 (0.991) data 0.000 (0.479) loss 2.7383 (2.5479) lr 3.9426e-04 eta 0:00:17
epoch [49/50] batch [8/12] time 0.507 (0.869) data 0.000 (0.359) loss 2.6797 (2.5486) lr 3.9426e-04 eta 0:00:13
epoch [49/50] batch [10/12] time 0.504 (0.797) data 0.000 (0.287) loss 2.6992 (2.5557) lr 3.9426e-04 eta 0:00:11
epoch [49/50] batch [12/12] time 0.517 (0.749) data 0.000 (0.240) loss 2.6816 (2.5833) lr 9.8664e-05 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.45s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.08it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.40it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.73it/s] 89%|████████▉ | 8/9 [00:08<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.57it/s]100%|██████████| 9/9 [00:09<00:00,  1.03s/it]=> result
* total: 1,667
* correct: 611
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 33.6%

epoch [50/50] batch [2/12] time 0.510 (1.956) data 0.000 (1.409) loss 2.5000 (2.5625) lr 9.8664e-05 eta 0:00:19
epoch [50/50] batch [4/12] time 0.507 (1.233) data 0.000 (0.705) loss 2.5605 (2.5103) lr 9.8664e-05 eta 0:00:09
epoch [50/50] batch [6/12] time 0.513 (0.992) data 0.000 (0.470) loss 2.7832 (2.5459) lr 9.8664e-05 eta 0:00:05
epoch [50/50] batch [8/12] time 0.508 (0.871) data 0.000 (0.352) loss 2.5547 (2.5503) lr 9.8664e-05 eta 0:00:03
epoch [50/50] batch [10/12] time 0.505 (0.798) data 0.000 (0.282) loss 2.6797 (2.5520) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [12/12] time 0.507 (0.749) data 0.000 (0.235) loss 2.5391 (2.5459) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.49s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.54it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]
=> result
* total: 1,667
* correct: 610
* accuracy: 36.6%
* error: 63.4%
* macro_f1: 33.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 40)
Evaluate on the *test* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.82s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.06s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.83s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.23s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.12it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.44it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.77it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.08it/s]100%|██████████| 9/9 [00:09<00:00,  2.61it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]
=> result
* total: 1,666
* correct: 604
* accuracy: 36.3%
* error: 63.7%
* macro_f1: 33.1%
Elapsed: 0:16:03
+ sh scripts/rpo_prime/base2new_test_sdl.sh fgvc_aircraft 1 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE NEW CLASSES!
800 1666 1667
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  50
# train_x  800
# val      1,666
# test     1,667
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 40)
Evaluate on the *test* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:09<01:13,  9.13s/it] 22%|██▏       | 2/9 [00:09<00:27,  3.94s/it] 33%|███▎      | 3/9 [00:09<00:13,  2.27s/it] 44%|████▍     | 4/9 [00:10<00:07,  1.49s/it] 56%|█████▌    | 5/9 [00:10<00:04,  1.06s/it] 67%|██████▋   | 6/9 [00:10<00:02,  1.24it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:11<00:00,  1.89it/s]100%|██████████| 9/9 [00:11<00:00,  2.40it/s]100%|██████████| 9/9 [00:11<00:00,  1.28s/it]
=> result
* total: 1,667
* correct: 548
* accuracy: 32.9%
* error: 67.1%
* macro_f1: 29.9%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh fgvc_aircraft 2 0 main_tmp1_0.1sdl 16
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE BASE CLASSES!
800 1667 1666
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  50
# train_x  800
# val      1,667
# test     1,666
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/12] time 0.530 (2.906) data 0.001 (1.555) loss 2.7480 (2.9951) lr 1.0000e-01 eta 0:28:57
epoch [1/50] batch [4/12] time 0.516 (1.711) data 0.000 (0.778) loss 2.7402 (2.9390) lr 1.0000e-01 eta 0:17:00
epoch [1/50] batch [6/12] time 0.515 (1.313) data 0.000 (0.519) loss 2.8555 (2.8906) lr 1.0000e-01 eta 0:12:59
epoch [1/50] batch [8/12] time 0.520 (1.115) data 0.000 (0.389) loss 2.7852 (2.8784) lr 1.0000e-01 eta 0:11:00
epoch [1/50] batch [10/12] time 0.518 (0.995) data 0.000 (0.311) loss 2.8379 (2.8889) lr 1.0000e-01 eta 0:09:47
epoch [1/50] batch [12/12] time 0.516 (0.916) data 0.000 (0.259) loss 2.7520 (2.8732) lr 9.9901e-02 eta 0:08:58
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.91s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.06s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.85s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.28s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.97it/s]100%|██████████| 9/9 [00:09<00:00,  2.48it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 492
* accuracy: 29.5%
* error: 70.5%
* macro_f1: 25.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/12] time 0.681 (1.733) data 0.000 (0.988) loss 2.8477 (2.8438) lr 9.9901e-02 eta 0:16:55
epoch [2/50] batch [4/12] time 0.519 (1.127) data 0.000 (0.494) loss 2.9883 (2.8657) lr 9.9901e-02 eta 0:10:58
epoch [2/50] batch [6/12] time 0.526 (0.926) data 0.000 (0.329) loss 2.8379 (2.8532) lr 9.9901e-02 eta 0:08:58
epoch [2/50] batch [8/12] time 0.519 (0.825) data 0.000 (0.247) loss 2.7363 (2.8218) lr 9.9901e-02 eta 0:07:58
epoch [2/50] batch [10/12] time 0.520 (0.764) data 0.000 (0.198) loss 2.8320 (2.8303) lr 9.9901e-02 eta 0:07:21
epoch [2/50] batch [12/12] time 0.519 (0.723) data 0.000 (0.165) loss 2.7441 (2.8088) lr 9.9606e-02 eta 0:06:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.50s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.93s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.29s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:10<00:00,  2.37it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 522
* accuracy: 31.3%
* error: 68.7%
* macro_f1: 27.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/12] time 0.530 (1.950) data 0.000 (1.343) loss 2.7461 (2.7520) lr 9.9606e-02 eta 0:18:39
epoch [3/50] batch [4/12] time 0.517 (1.232) data 0.000 (0.671) loss 2.6738 (2.7095) lr 9.9606e-02 eta 0:11:44
epoch [3/50] batch [6/12] time 0.519 (0.995) data 0.000 (0.448) loss 2.8164 (2.7324) lr 9.9606e-02 eta 0:09:26
epoch [3/50] batch [8/12] time 0.521 (0.876) data 0.000 (0.336) loss 2.7910 (2.7605) lr 9.9606e-02 eta 0:08:17
epoch [3/50] batch [10/12] time 0.532 (0.805) data 0.000 (0.269) loss 2.9062 (2.7965) lr 9.9606e-02 eta 0:07:35
epoch [3/50] batch [12/12] time 0.523 (0.759) data 0.000 (0.224) loss 2.6660 (2.7928) lr 9.9114e-02 eta 0:07:07
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.44s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.90s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.76s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.22s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.08it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.54it/s]100%|██████████| 9/9 [00:09<00:00,  1.03s/it]=> result
* total: 1,667
* correct: 544
* accuracy: 32.6%
* error: 67.4%
* macro_f1: 28.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/12] time 0.529 (1.918) data 0.000 (1.332) loss 2.6934 (2.7305) lr 9.9114e-02 eta 0:17:57
epoch [4/50] batch [4/12] time 0.521 (1.219) data 0.000 (0.666) loss 2.8945 (2.7871) lr 9.9114e-02 eta 0:11:22
epoch [4/50] batch [6/12] time 0.521 (0.987) data 0.000 (0.444) loss 2.7344 (2.7650) lr 9.9114e-02 eta 0:09:10
epoch [4/50] batch [8/12] time 0.523 (0.871) data 0.000 (0.333) loss 2.8711 (2.7925) lr 9.9114e-02 eta 0:08:04
epoch [4/50] batch [10/12] time 0.518 (0.800) data 0.000 (0.267) loss 2.8086 (2.7752) lr 9.9114e-02 eta 0:07:23
epoch [4/50] batch [12/12] time 0.529 (0.755) data 0.000 (0.222) loss 2.7930 (2.7567) lr 9.8429e-02 eta 0:06:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.54s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:12,  2.04s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.35s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 550
* accuracy: 33.0%
* error: 67.0%
* macro_f1: 29.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/12] time 0.531 (1.971) data 0.000 (1.432) loss 2.6914 (2.7344) lr 9.8429e-02 eta 0:18:03
epoch [5/50] batch [4/12] time 0.523 (1.247) data 0.000 (0.716) loss 2.8027 (2.7451) lr 9.8429e-02 eta 0:11:23
epoch [5/50] batch [6/12] time 0.520 (1.005) data 0.000 (0.477) loss 2.6719 (2.7337) lr 9.8429e-02 eta 0:09:08
epoch [5/50] batch [8/12] time 0.523 (0.884) data 0.000 (0.358) loss 2.5039 (2.7065) lr 9.8429e-02 eta 0:08:00
epoch [5/50] batch [10/12] time 0.520 (0.813) data 0.000 (0.287) loss 2.7070 (2.6893) lr 9.8429e-02 eta 0:07:20
epoch [5/50] batch [12/12] time 0.523 (0.764) data 0.000 (0.239) loss 2.7090 (2.6984) lr 9.7553e-02 eta 0:06:52
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.40s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.11it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.43it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.76it/s] 89%|████████▉ | 8/9 [00:08<00:00,  2.06it/s]100%|██████████| 9/9 [00:09<00:00,  2.58it/s]100%|██████████| 9/9 [00:09<00:00,  1.02s/it]=> result
* total: 1,667
* correct: 549
* accuracy: 32.9%
* error: 67.1%
* macro_f1: 29.4%

epoch [6/50] batch [2/12] time 0.553 (1.715) data 0.001 (1.067) loss 2.6895 (2.8125) lr 9.7553e-02 eta 0:15:22
epoch [6/50] batch [4/12] time 0.538 (1.122) data 0.000 (0.534) loss 2.8027 (2.7969) lr 9.7553e-02 eta 0:10:01
epoch [6/50] batch [6/12] time 0.518 (0.924) data 0.000 (0.356) loss 2.5586 (2.7646) lr 9.7553e-02 eta 0:08:13
epoch [6/50] batch [8/12] time 0.519 (0.822) data 0.000 (0.267) loss 2.8691 (2.7563) lr 9.7553e-02 eta 0:07:17
epoch [6/50] batch [10/12] time 0.534 (0.763) data 0.000 (0.214) loss 2.6523 (2.7398) lr 9.7553e-02 eta 0:06:44
epoch [6/50] batch [12/12] time 0.510 (0.721) data 0.000 (0.178) loss 2.5684 (2.7214) lr 9.6489e-02 eta 0:06:20
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:06,  8.34s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.61s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.10s/it] 44%|████▍     | 4/9 [00:09<00:06,  1.39s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.97it/s]100%|██████████| 9/9 [00:10<00:00,  2.49it/s]100%|██████████| 9/9 [00:10<00:00,  1.19s/it]=> result
* total: 1,667
* correct: 553
* accuracy: 33.2%
* error: 66.8%
* macro_f1: 29.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [7/50] batch [2/12] time 0.533 (1.933) data 0.000 (1.354) loss 2.7910 (2.7451) lr 9.6489e-02 eta 0:16:56
epoch [7/50] batch [4/12] time 0.517 (1.225) data 0.000 (0.677) loss 2.6250 (2.7251) lr 9.6489e-02 eta 0:10:42
epoch [7/50] batch [6/12] time 0.518 (0.989) data 0.000 (0.451) loss 2.7441 (2.7292) lr 9.6489e-02 eta 0:08:36
epoch [7/50] batch [8/12] time 0.521 (0.871) data 0.000 (0.339) loss 2.7812 (2.7241) lr 9.6489e-02 eta 0:07:33
epoch [7/50] batch [10/12] time 0.516 (0.800) data 0.000 (0.271) loss 2.8887 (2.7564) lr 9.6489e-02 eta 0:06:54
epoch [7/50] batch [12/12] time 0.513 (0.752) data 0.000 (0.226) loss 2.4980 (2.7272) lr 9.5241e-02 eta 0:06:28
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.53s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.09it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.41it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.74it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.05it/s]100%|██████████| 9/9 [00:09<00:00,  2.57it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 563
* accuracy: 33.8%
* error: 66.2%
* macro_f1: 29.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [8/50] batch [2/12] time 0.516 (1.984) data 0.000 (1.444) loss 2.7305 (2.7285) lr 9.5241e-02 eta 0:16:59
epoch [8/50] batch [4/12] time 0.516 (1.250) data 0.000 (0.722) loss 2.7871 (2.7300) lr 9.5241e-02 eta 0:10:40
epoch [8/50] batch [6/12] time 0.522 (1.007) data 0.000 (0.481) loss 2.4688 (2.6875) lr 9.5241e-02 eta 0:08:33
epoch [8/50] batch [8/12] time 0.524 (0.886) data 0.000 (0.361) loss 2.6504 (2.6750) lr 9.5241e-02 eta 0:07:29
epoch [8/50] batch [10/12] time 0.522 (0.813) data 0.000 (0.289) loss 2.7422 (2.6777) lr 9.5241e-02 eta 0:06:51
epoch [8/50] batch [12/12] time 0.520 (0.765) data 0.000 (0.241) loss 2.5801 (2.6655) lr 9.3815e-02 eta 0:06:25
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:50,  6.37s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.74s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.17s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.43s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.02s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.29it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.61it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.93it/s]100%|██████████| 9/9 [00:10<00:00,  2.44it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 566
* accuracy: 34.0%
* error: 66.0%
* macro_f1: 30.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/12] time 0.515 (1.975) data 0.000 (1.424) loss 2.7559 (2.6494) lr 9.3815e-02 eta 0:16:31
epoch [9/50] batch [4/12] time 0.519 (1.246) data 0.000 (0.712) loss 2.7930 (2.6519) lr 9.3815e-02 eta 0:10:23
epoch [9/50] batch [6/12] time 0.519 (1.004) data 0.000 (0.475) loss 2.6465 (2.6663) lr 9.3815e-02 eta 0:08:19
epoch [9/50] batch [8/12] time 0.514 (0.882) data 0.000 (0.356) loss 2.5742 (2.6741) lr 9.3815e-02 eta 0:07:17
epoch [9/50] batch [10/12] time 0.534 (0.812) data 0.000 (0.285) loss 2.7500 (2.6986) lr 9.3815e-02 eta 0:06:41
epoch [9/50] batch [12/12] time 0.515 (0.773) data 0.000 (0.238) loss 2.5742 (2.6777) lr 9.2216e-02 eta 0:06:20
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.46s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.50s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.04s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.35s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.35it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 573
* accuracy: 34.4%
* error: 65.6%
* macro_f1: 30.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [10/50] batch [2/12] time 0.678 (1.790) data 0.113 (1.120) loss 2.7031 (2.7119) lr 9.2216e-02 eta 0:14:36
epoch [10/50] batch [4/12] time 0.511 (1.152) data 0.000 (0.560) loss 2.6992 (2.7061) lr 9.2216e-02 eta 0:09:21
epoch [10/50] batch [6/12] time 0.504 (0.937) data 0.000 (0.373) loss 2.6914 (2.7145) lr 9.2216e-02 eta 0:07:35
epoch [10/50] batch [8/12] time 0.512 (0.830) data 0.000 (0.280) loss 2.5605 (2.6865) lr 9.2216e-02 eta 0:06:41
epoch [10/50] batch [10/12] time 0.503 (0.766) data 0.000 (0.224) loss 2.8164 (2.6904) lr 9.2216e-02 eta 0:06:09
epoch [10/50] batch [12/12] time 0.505 (0.723) data 0.000 (0.187) loss 2.6035 (2.6756) lr 9.0451e-02 eta 0:05:46
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.49s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.93s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.11s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.40s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.00s/it] 67%|██████▋   | 6/9 [00:08<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.96it/s]100%|██████████| 9/9 [00:09<00:00,  2.47it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 574
* accuracy: 34.4%
* error: 65.6%
* macro_f1: 30.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/12] time 0.581 (1.761) data 0.027 (1.117) loss 2.6348 (2.6592) lr 9.0451e-02 eta 0:14:01
epoch [11/50] batch [4/12] time 0.511 (1.136) data 0.000 (0.559) loss 2.6602 (2.6250) lr 9.0451e-02 eta 0:09:00
epoch [11/50] batch [6/12] time 0.512 (0.927) data 0.000 (0.372) loss 2.6074 (2.6087) lr 9.0451e-02 eta 0:07:19
epoch [11/50] batch [8/12] time 0.516 (0.824) data 0.000 (0.279) loss 2.8438 (2.6333) lr 9.0451e-02 eta 0:06:29
epoch [11/50] batch [10/12] time 0.505 (0.761) data 0.000 (0.224) loss 2.7227 (2.6662) lr 9.0451e-02 eta 0:05:57
epoch [11/50] batch [12/12] time 0.514 (0.719) data 0.000 (0.186) loss 2.5332 (2.6476) lr 8.8526e-02 eta 0:05:36
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:00,  7.61s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.31s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.93s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.29s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:10<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 561
* accuracy: 33.7%
* error: 66.3%
* macro_f1: 30.2%

epoch [12/50] batch [2/12] time 0.518 (1.947) data 0.000 (1.360) loss 2.7070 (2.7744) lr 8.8526e-02 eta 0:15:07
epoch [12/50] batch [4/12] time 0.512 (1.227) data 0.000 (0.680) loss 2.7168 (2.6836) lr 8.8526e-02 eta 0:09:29
epoch [12/50] batch [6/12] time 0.515 (0.990) data 0.000 (0.453) loss 2.4941 (2.6250) lr 8.8526e-02 eta 0:07:37
epoch [12/50] batch [8/12] time 0.505 (0.868) data 0.000 (0.340) loss 2.6914 (2.6287) lr 8.8526e-02 eta 0:06:39
epoch [12/50] batch [10/12] time 0.512 (0.796) data 0.000 (0.272) loss 2.6816 (2.6230) lr 8.8526e-02 eta 0:06:04
epoch [12/50] batch [12/12] time 0.511 (0.749) data 0.000 (0.227) loss 2.5742 (2.6126) lr 8.6448e-02 eta 0:05:41
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.49s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.92s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 574
* accuracy: 34.4%
* error: 65.6%
* macro_f1: 31.0%

epoch [13/50] batch [2/12] time 0.580 (1.687) data 0.000 (1.031) loss 2.8633 (2.6895) lr 8.6448e-02 eta 0:12:45
epoch [13/50] batch [4/12] time 0.510 (1.099) data 0.000 (0.516) loss 2.6113 (2.6396) lr 8.6448e-02 eta 0:08:16
epoch [13/50] batch [6/12] time 0.517 (0.904) data 0.000 (0.344) loss 2.5664 (2.6146) lr 8.6448e-02 eta 0:06:47
epoch [13/50] batch [8/12] time 0.508 (0.806) data 0.000 (0.258) loss 2.6973 (2.6399) lr 8.6448e-02 eta 0:06:00
epoch [13/50] batch [10/12] time 0.511 (0.747) data 0.000 (0.206) loss 2.6602 (2.6482) lr 8.6448e-02 eta 0:05:32
epoch [13/50] batch [12/12] time 0.511 (0.708) data 0.000 (0.172) loss 2.5020 (2.6349) lr 8.4227e-02 eta 0:05:14
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.40s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.50s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:08<00:02,  1.24it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.56it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.88it/s]100%|██████████| 9/9 [00:09<00:00,  2.39it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 573
* accuracy: 34.4%
* error: 65.6%
* macro_f1: 30.6%

epoch [14/50] batch [2/12] time 0.529 (1.720) data 0.000 (1.098) loss 2.6074 (2.6201) lr 8.4227e-02 eta 0:12:40
epoch [14/50] batch [4/12] time 0.507 (1.113) data 0.000 (0.549) loss 2.6621 (2.6094) lr 8.4227e-02 eta 0:08:09
epoch [14/50] batch [6/12] time 0.516 (0.913) data 0.000 (0.366) loss 2.5156 (2.5817) lr 8.4227e-02 eta 0:06:39
epoch [14/50] batch [8/12] time 0.500 (0.810) data 0.000 (0.275) loss 2.6934 (2.6104) lr 8.4227e-02 eta 0:05:53
epoch [14/50] batch [10/12] time 0.509 (0.749) data 0.000 (0.220) loss 2.5234 (2.6010) lr 8.4227e-02 eta 0:05:25
epoch [14/50] batch [12/12] time 0.510 (0.709) data 0.000 (0.183) loss 2.6035 (2.6195) lr 8.1871e-02 eta 0:05:06
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.62s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.98s/it] 33%|███▎      | 3/9 [00:07<00:12,  2.05s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.36s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.98it/s]100%|██████████| 9/9 [00:09<00:00,  2.50it/s]100%|██████████| 9/9 [00:09<00:00,  1.09s/it]=> result
* total: 1,667
* correct: 571
* accuracy: 34.3%
* error: 65.7%
* macro_f1: 30.8%

epoch [15/50] batch [2/12] time 0.504 (1.994) data 0.000 (1.471) loss 2.6230 (2.6289) lr 8.1871e-02 eta 0:14:17
epoch [15/50] batch [4/12] time 0.513 (1.253) data 0.000 (0.736) loss 2.7051 (2.6221) lr 8.1871e-02 eta 0:08:56
epoch [15/50] batch [6/12] time 0.502 (1.005) data 0.000 (0.491) loss 2.6680 (2.6312) lr 8.1871e-02 eta 0:07:08
epoch [15/50] batch [8/12] time 0.504 (0.880) data 0.000 (0.368) loss 2.6543 (2.6538) lr 8.1871e-02 eta 0:06:12
epoch [15/50] batch [10/12] time 0.510 (0.805) data 0.000 (0.294) loss 2.7578 (2.6627) lr 8.1871e-02 eta 0:05:39
epoch [15/50] batch [12/12] time 0.508 (0.756) data 0.000 (0.245) loss 2.6758 (2.6545) lr 7.9389e-02 eta 0:05:17
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.46s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.53s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.06s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.96it/s]100%|██████████| 9/9 [00:09<00:00,  2.47it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 586
* accuracy: 35.2%
* error: 64.8%
* macro_f1: 31.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/12] time 0.513 (1.938) data 0.000 (1.394) loss 2.6094 (2.6084) lr 7.9389e-02 eta 0:13:29
epoch [16/50] batch [4/12] time 0.500 (1.222) data 0.000 (0.697) loss 2.7129 (2.6260) lr 7.9389e-02 eta 0:08:28
epoch [16/50] batch [6/12] time 0.504 (0.983) data 0.000 (0.465) loss 2.6816 (2.6439) lr 7.9389e-02 eta 0:06:46
epoch [16/50] batch [8/12] time 0.510 (0.864) data 0.000 (0.349) loss 2.6934 (2.6392) lr 7.9389e-02 eta 0:05:56
epoch [16/50] batch [10/12] time 0.510 (0.794) data 0.000 (0.279) loss 2.5977 (2.6297) lr 7.9389e-02 eta 0:05:25
epoch [16/50] batch [12/12] time 0.507 (0.746) data 0.000 (0.233) loss 2.6035 (2.6232) lr 7.6791e-02 eta 0:05:04
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.53s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.27s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.49s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.06s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.40it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 587
* accuracy: 35.2%
* error: 64.8%
* macro_f1: 32.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [17/50] batch [2/12] time 0.509 (1.972) data 0.000 (1.422) loss 2.7656 (2.5986) lr 7.6791e-02 eta 0:13:20
epoch [17/50] batch [4/12] time 0.508 (1.240) data 0.000 (0.711) loss 2.5879 (2.6353) lr 7.6791e-02 eta 0:08:20
epoch [17/50] batch [6/12] time 0.508 (0.996) data 0.000 (0.474) loss 2.5371 (2.6136) lr 7.6791e-02 eta 0:06:40
epoch [17/50] batch [8/12] time 0.510 (0.875) data 0.000 (0.356) loss 2.5215 (2.5789) lr 7.6791e-02 eta 0:05:49
epoch [17/50] batch [10/12] time 0.507 (0.801) data 0.000 (0.285) loss 2.5059 (2.5984) lr 7.6791e-02 eta 0:05:18
epoch [17/50] batch [12/12] time 0.514 (0.753) data 0.000 (0.237) loss 2.4824 (2.5731) lr 7.4088e-02 eta 0:04:58
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:00,  7.60s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.33s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.95s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 592
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [18/50] batch [2/12] time 0.503 (1.793) data 0.000 (1.167) loss 2.7031 (2.7734) lr 7.4088e-02 eta 0:11:46
epoch [18/50] batch [4/12] time 0.508 (1.150) data 0.000 (0.584) loss 2.5742 (2.7036) lr 7.4088e-02 eta 0:07:30
epoch [18/50] batch [6/12] time 0.507 (0.936) data 0.000 (0.389) loss 2.8691 (2.6849) lr 7.4088e-02 eta 0:06:05
epoch [18/50] batch [8/12] time 0.500 (0.828) data 0.000 (0.292) loss 2.4824 (2.6462) lr 7.4088e-02 eta 0:05:21
epoch [18/50] batch [10/12] time 0.520 (0.777) data 0.000 (0.234) loss 2.6777 (2.6580) lr 7.4088e-02 eta 0:04:59
epoch [18/50] batch [12/12] time 0.508 (0.732) data 0.000 (0.195) loss 2.5996 (2.6535) lr 7.1289e-02 eta 0:04:41
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.46s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.93s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.28s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 583
* accuracy: 35.0%
* error: 65.0%
* macro_f1: 31.6%

epoch [19/50] batch [2/12] time 0.538 (1.713) data 0.001 (1.084) loss 2.5859 (2.5791) lr 7.1289e-02 eta 0:10:54
epoch [19/50] batch [4/12] time 0.509 (1.110) data 0.000 (0.542) loss 2.5703 (2.6274) lr 7.1289e-02 eta 0:07:01
epoch [19/50] batch [6/12] time 0.509 (0.909) data 0.000 (0.361) loss 2.4512 (2.5605) lr 7.1289e-02 eta 0:05:43
epoch [19/50] batch [8/12] time 0.503 (0.808) data 0.000 (0.271) loss 2.7500 (2.5652) lr 7.1289e-02 eta 0:05:03
epoch [19/50] batch [10/12] time 0.514 (0.749) data 0.000 (0.217) loss 2.5957 (2.5863) lr 7.1289e-02 eta 0:04:39
epoch [19/50] batch [12/12] time 0.505 (0.709) data 0.000 (0.181) loss 2.7871 (2.6006) lr 6.8406e-02 eta 0:04:23
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.41s/it] 22%|██▏       | 2/9 [00:08<00:27,  3.86s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.24s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.47s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.05s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.26it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.58it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.90it/s]100%|██████████| 9/9 [00:10<00:00,  2.41it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 599
* accuracy: 35.9%
* error: 64.1%
* macro_f1: 32.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [20/50] batch [2/12] time 0.511 (1.917) data 0.000 (1.335) loss 2.7520 (2.6562) lr 6.8406e-02 eta 0:11:49
epoch [20/50] batch [4/12] time 0.508 (1.214) data 0.000 (0.668) loss 2.5996 (2.5659) lr 6.8406e-02 eta 0:07:26
epoch [20/50] batch [6/12] time 0.521 (0.980) data 0.000 (0.445) loss 2.6504 (2.5824) lr 6.8406e-02 eta 0:05:58
epoch [20/50] batch [8/12] time 0.511 (0.864) data 0.000 (0.334) loss 2.6953 (2.5942) lr 6.8406e-02 eta 0:05:14
epoch [20/50] batch [10/12] time 0.506 (0.792) data 0.000 (0.267) loss 2.6289 (2.6152) lr 6.8406e-02 eta 0:04:46
epoch [20/50] batch [12/12] time 0.516 (0.745) data 0.000 (0.223) loss 2.6992 (2.6219) lr 6.5451e-02 eta 0:04:28
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.52s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.93s/it] 33%|███▎      | 3/9 [00:08<00:14,  2.34s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.54s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.09s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.22it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.54it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.86it/s]100%|██████████| 9/9 [00:10<00:00,  2.37it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 579
* accuracy: 34.7%
* error: 65.3%
* macro_f1: 31.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/12] time 0.517 (1.949) data 0.000 (1.371) loss 2.5566 (2.5967) lr 6.5451e-02 eta 0:11:37
epoch [21/50] batch [4/12] time 0.518 (1.235) data 0.000 (0.686) loss 2.8359 (2.6807) lr 6.5451e-02 eta 0:07:19
epoch [21/50] batch [6/12] time 0.512 (0.997) data 0.000 (0.457) loss 2.4277 (2.6338) lr 6.5451e-02 eta 0:05:52
epoch [21/50] batch [8/12] time 0.509 (0.875) data 0.000 (0.343) loss 2.6133 (2.6477) lr 6.5451e-02 eta 0:05:08
epoch [21/50] batch [10/12] time 0.517 (0.803) data 0.000 (0.274) loss 2.5957 (2.6428) lr 6.5451e-02 eta 0:04:41
epoch [21/50] batch [12/12] time 0.520 (0.756) data 0.000 (0.229) loss 2.6582 (2.6287) lr 6.2434e-02 eta 0:04:23
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.46s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.33s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 592
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.1%

epoch [22/50] batch [2/12] time 0.502 (1.936) data 0.000 (1.376) loss 2.7559 (2.6787) lr 6.2434e-02 eta 0:11:09
epoch [22/50] batch [4/12] time 0.518 (1.227) data 0.000 (0.688) loss 2.5410 (2.6372) lr 6.2434e-02 eta 0:07:01
epoch [22/50] batch [6/12] time 0.503 (0.987) data 0.000 (0.459) loss 2.5195 (2.6380) lr 6.2434e-02 eta 0:05:37
epoch [22/50] batch [8/12] time 0.501 (0.866) data 0.000 (0.344) loss 2.5527 (2.6416) lr 6.2434e-02 eta 0:04:54
epoch [22/50] batch [10/12] time 0.509 (0.794) data 0.000 (0.275) loss 2.8965 (2.6486) lr 6.2434e-02 eta 0:04:28
epoch [22/50] batch [12/12] time 0.507 (0.747) data 0.000 (0.230) loss 2.4453 (2.6323) lr 5.9369e-02 eta 0:04:10
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.45s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.96s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.30s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.08s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:10<00:00,  2.38it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 594
* accuracy: 35.6%
* error: 64.4%
* macro_f1: 32.2%

epoch [23/50] batch [2/12] time 0.513 (1.934) data 0.000 (1.411) loss 2.4180 (2.5508) lr 5.9369e-02 eta 0:10:46
epoch [23/50] batch [4/12] time 0.502 (1.221) data 0.000 (0.706) loss 2.5742 (2.6006) lr 5.9369e-02 eta 0:06:45
epoch [23/50] batch [6/12] time 0.503 (0.982) data 0.000 (0.471) loss 2.4316 (2.5638) lr 5.9369e-02 eta 0:05:23
epoch [23/50] batch [8/12] time 0.520 (0.865) data 0.000 (0.353) loss 2.6992 (2.5669) lr 5.9369e-02 eta 0:04:43
epoch [23/50] batch [10/12] time 0.512 (0.795) data 0.000 (0.282) loss 2.4395 (2.5582) lr 5.9369e-02 eta 0:04:19
epoch [23/50] batch [12/12] time 0.507 (0.747) data 0.000 (0.235) loss 2.6797 (2.5812) lr 5.6267e-02 eta 0:04:02
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.49s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.34s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 602
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 33.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [24/50] batch [2/12] time 0.748 (1.744) data 0.224 (1.116) loss 2.5625 (2.5742) lr 5.6267e-02 eta 0:09:21
epoch [24/50] batch [4/12] time 0.503 (1.126) data 0.000 (0.558) loss 2.6387 (2.5767) lr 5.6267e-02 eta 0:06:00
epoch [24/50] batch [6/12] time 0.504 (0.919) data 0.000 (0.372) loss 2.5938 (2.5967) lr 5.6267e-02 eta 0:04:52
epoch [24/50] batch [8/12] time 0.509 (0.817) data 0.000 (0.279) loss 2.4961 (2.5974) lr 5.6267e-02 eta 0:04:18
epoch [24/50] batch [10/12] time 0.509 (0.755) data 0.000 (0.223) loss 2.6816 (2.6184) lr 5.6267e-02 eta 0:03:57
epoch [24/50] batch [12/12] time 0.508 (0.714) data 0.000 (0.186) loss 2.5254 (2.5941) lr 5.3140e-02 eta 0:03:42
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.65s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.33s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.95s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 592
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.5%

epoch [25/50] batch [2/12] time 0.613 (1.747) data 0.001 (1.053) loss 2.5664 (2.6035) lr 5.3140e-02 eta 0:09:01
epoch [25/50] batch [4/12] time 0.526 (1.138) data 0.000 (0.527) loss 2.5000 (2.5303) lr 5.3140e-02 eta 0:05:50
epoch [25/50] batch [6/12] time 0.514 (0.932) data 0.000 (0.351) loss 2.6250 (2.5798) lr 5.3140e-02 eta 0:04:45
epoch [25/50] batch [8/12] time 0.501 (0.825) data 0.000 (0.264) loss 2.6152 (2.5933) lr 5.3140e-02 eta 0:04:10
epoch [25/50] batch [10/12] time 0.502 (0.760) data 0.000 (0.211) loss 2.5176 (2.6012) lr 5.3140e-02 eta 0:03:49
epoch [25/50] batch [12/12] time 0.503 (0.717) data 0.000 (0.176) loss 2.5215 (2.5908) lr 5.0000e-02 eta 0:03:35
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:50,  6.37s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.87s/it] 33%|███▎      | 3/9 [00:07<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.98it/s]100%|██████████| 9/9 [00:09<00:00,  2.50it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 586
* accuracy: 35.2%
* error: 64.8%
* macro_f1: 31.6%

epoch [26/50] batch [2/12] time 0.607 (1.696) data 0.000 (1.002) loss 2.6074 (2.6123) lr 5.0000e-02 eta 0:08:25
epoch [26/50] batch [4/12] time 0.499 (1.098) data 0.000 (0.501) loss 2.5742 (2.5815) lr 5.0000e-02 eta 0:05:25
epoch [26/50] batch [6/12] time 0.506 (0.900) data 0.000 (0.334) loss 2.6797 (2.6051) lr 5.0000e-02 eta 0:04:24
epoch [26/50] batch [8/12] time 0.511 (0.803) data 0.000 (0.251) loss 2.7871 (2.6111) lr 5.0000e-02 eta 0:03:54
epoch [26/50] batch [10/12] time 0.517 (0.745) data 0.000 (0.201) loss 2.5879 (2.5943) lr 5.0000e-02 eta 0:03:36
epoch [26/50] batch [12/12] time 0.531 (0.709) data 0.000 (0.167) loss 2.5371 (2.5942) lr 4.6860e-02 eta 0:03:24
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:57,  7.17s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.19s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.87s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.10it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.43it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.76it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.07it/s]100%|██████████| 9/9 [00:09<00:00,  2.60it/s]100%|██████████| 9/9 [00:09<00:00,  1.08s/it]=> result
* total: 1,667
* correct: 601
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 32.9%

epoch [27/50] batch [2/12] time 0.501 (1.912) data 0.000 (1.391) loss 2.6035 (2.5273) lr 4.6860e-02 eta 0:09:06
epoch [27/50] batch [4/12] time 0.506 (1.208) data 0.000 (0.695) loss 2.6230 (2.5552) lr 4.6860e-02 eta 0:05:42
epoch [27/50] batch [6/12] time 0.503 (0.973) data 0.000 (0.464) loss 2.5039 (2.5576) lr 4.6860e-02 eta 0:04:34
epoch [27/50] batch [8/12] time 0.500 (0.855) data 0.000 (0.348) loss 2.6895 (2.5913) lr 4.6860e-02 eta 0:03:59
epoch [27/50] batch [10/12] time 0.502 (0.785) data 0.000 (0.278) loss 2.5352 (2.5814) lr 4.6860e-02 eta 0:03:38
epoch [27/50] batch [12/12] time 0.505 (0.738) data 0.000 (0.232) loss 2.6270 (2.5680) lr 4.3733e-02 eta 0:03:23
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.51s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.54it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 610
* accuracy: 36.6%
* error: 63.4%
* macro_f1: 33.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [28/50] batch [2/12] time 0.523 (1.957) data 0.000 (1.422) loss 2.7051 (2.6670) lr 4.3733e-02 eta 0:08:56
epoch [28/50] batch [4/12] time 0.511 (1.234) data 0.000 (0.711) loss 2.6270 (2.6318) lr 4.3733e-02 eta 0:05:35
epoch [28/50] batch [6/12] time 0.507 (0.993) data 0.000 (0.474) loss 2.6660 (2.6279) lr 4.3733e-02 eta 0:04:27
epoch [28/50] batch [8/12] time 0.511 (0.872) data 0.000 (0.356) loss 2.7285 (2.6060) lr 4.3733e-02 eta 0:03:53
epoch [28/50] batch [10/12] time 0.506 (0.800) data 0.000 (0.285) loss 2.5742 (2.6002) lr 4.3733e-02 eta 0:03:32
epoch [28/50] batch [12/12] time 0.503 (0.759) data 0.000 (0.237) loss 2.5176 (2.5832) lr 4.0631e-02 eta 0:03:20
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.45s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.54s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.96it/s]100%|██████████| 9/9 [00:09<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 583
* accuracy: 35.0%
* error: 65.0%
* macro_f1: 31.9%

epoch [29/50] batch [2/12] time 0.575 (1.743) data 0.000 (1.067) loss 2.7285 (2.6631) lr 4.0631e-02 eta 0:07:36
epoch [29/50] batch [4/12] time 0.519 (1.131) data 0.000 (0.533) loss 2.7363 (2.6724) lr 4.0631e-02 eta 0:04:54
epoch [29/50] batch [6/12] time 0.527 (0.928) data 0.000 (0.356) loss 2.4473 (2.6152) lr 4.0631e-02 eta 0:03:59
epoch [29/50] batch [8/12] time 0.523 (0.828) data 0.000 (0.267) loss 2.4473 (2.5796) lr 4.0631e-02 eta 0:03:32
epoch [29/50] batch [10/12] time 0.515 (0.766) data 0.000 (0.214) loss 2.5918 (2.5883) lr 4.0631e-02 eta 0:03:14
epoch [29/50] batch [12/12] time 0.532 (0.726) data 0.000 (0.178) loss 2.5078 (2.5773) lr 3.7566e-02 eta 0:03:02
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.44s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.32s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 607
* accuracy: 36.4%
* error: 63.6%
* macro_f1: 33.3%

epoch [30/50] batch [2/12] time 0.537 (1.993) data 0.000 (1.452) loss 2.4219 (2.4639) lr 3.7566e-02 eta 0:08:18
epoch [30/50] batch [4/12] time 0.515 (1.255) data 0.000 (0.726) loss 2.5488 (2.4785) lr 3.7566e-02 eta 0:05:11
epoch [30/50] batch [6/12] time 0.543 (1.017) data 0.000 (0.484) loss 2.6367 (2.5260) lr 3.7566e-02 eta 0:04:10
epoch [30/50] batch [8/12] time 0.517 (0.892) data 0.000 (0.363) loss 2.6035 (2.5559) lr 3.7566e-02 eta 0:03:37
epoch [30/50] batch [10/12] time 0.522 (0.818) data 0.000 (0.291) loss 2.4492 (2.5463) lr 3.7566e-02 eta 0:03:17
epoch [30/50] batch [12/12] time 0.520 (0.769) data 0.000 (0.242) loss 2.5547 (2.5474) lr 3.4549e-02 eta 0:03:04
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.69s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.36s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.96s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.31s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 609
* accuracy: 36.5%
* error: 63.5%
* macro_f1: 33.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/12] time 0.531 (1.908) data 0.000 (1.344) loss 2.6406 (2.6123) lr 3.4549e-02 eta 0:07:34
epoch [31/50] batch [4/12] time 0.528 (1.218) data 0.000 (0.672) loss 2.5605 (2.5815) lr 3.4549e-02 eta 0:04:47
epoch [31/50] batch [6/12] time 0.518 (0.986) data 0.000 (0.448) loss 2.4844 (2.5758) lr 3.4549e-02 eta 0:03:50
epoch [31/50] batch [8/12] time 0.533 (0.871) data 0.000 (0.336) loss 2.5742 (2.5735) lr 3.4549e-02 eta 0:03:22
epoch [31/50] batch [10/12] time 0.519 (0.801) data 0.000 (0.269) loss 2.5371 (2.5697) lr 3.4549e-02 eta 0:03:04
epoch [31/50] batch [12/12] time 0.522 (0.755) data 0.000 (0.224) loss 2.4414 (2.5661) lr 3.1594e-02 eta 0:02:52
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.56s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.98it/s]100%|██████████| 9/9 [00:09<00:00,  2.50it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 602
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 32.9%

epoch [32/50] batch [2/12] time 0.527 (1.928) data 0.001 (1.327) loss 2.5254 (2.5928) lr 3.1594e-02 eta 0:07:15
epoch [32/50] batch [4/12] time 0.519 (1.224) data 0.000 (0.664) loss 2.4551 (2.5430) lr 3.1594e-02 eta 0:04:34
epoch [32/50] batch [6/12] time 0.520 (0.990) data 0.000 (0.443) loss 2.4844 (2.5661) lr 3.1594e-02 eta 0:03:39
epoch [32/50] batch [8/12] time 0.522 (0.873) data 0.000 (0.332) loss 2.5332 (2.5803) lr 3.1594e-02 eta 0:03:11
epoch [32/50] batch [10/12] time 0.521 (0.802) data 0.000 (0.266) loss 2.4961 (2.5867) lr 3.1594e-02 eta 0:02:54
epoch [32/50] batch [12/12] time 0.520 (0.754) data 0.000 (0.221) loss 2.6562 (2.5944) lr 2.8711e-02 eta 0:02:42
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:00,  7.59s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.30s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.93s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.29s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.08it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.56it/s]100%|██████████| 9/9 [00:09<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 605
* accuracy: 36.3%
* error: 63.7%
* macro_f1: 33.1%

epoch [33/50] batch [2/12] time 0.604 (1.755) data 0.000 (1.067) loss 2.4629 (2.5537) lr 2.8711e-02 eta 0:06:15
epoch [33/50] batch [4/12] time 0.503 (1.129) data 0.000 (0.533) loss 2.5137 (2.5400) lr 2.8711e-02 eta 0:03:59
epoch [33/50] batch [6/12] time 0.509 (0.923) data 0.000 (0.356) loss 2.6367 (2.5664) lr 2.8711e-02 eta 0:03:13
epoch [33/50] batch [8/12] time 0.511 (0.819) data 0.000 (0.267) loss 2.3164 (2.5166) lr 2.8711e-02 eta 0:02:50
epoch [33/50] batch [10/12] time 0.503 (0.757) data 0.000 (0.214) loss 2.5449 (2.5232) lr 2.8711e-02 eta 0:02:35
epoch [33/50] batch [12/12] time 0.509 (0.715) data 0.000 (0.178) loss 2.4844 (2.5239) lr 2.5912e-02 eta 0:02:25
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.47s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.77s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.33s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 33.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [34/50] batch [2/12] time 0.507 (1.962) data 0.000 (1.440) loss 2.6504 (2.6113) lr 2.5912e-02 eta 0:06:36
epoch [34/50] batch [4/12] time 0.512 (1.237) data 0.000 (0.720) loss 2.4629 (2.5669) lr 2.5912e-02 eta 0:04:07
epoch [34/50] batch [6/12] time 0.508 (0.995) data 0.000 (0.480) loss 2.4805 (2.5371) lr 2.5912e-02 eta 0:03:16
epoch [34/50] batch [8/12] time 0.508 (0.873) data 0.000 (0.360) loss 2.6406 (2.5601) lr 2.5912e-02 eta 0:02:51
epoch [34/50] batch [10/12] time 0.511 (0.800) data 0.000 (0.288) loss 2.5098 (2.5801) lr 2.5912e-02 eta 0:02:35
epoch [34/50] batch [12/12] time 0.519 (0.752) data 0.000 (0.240) loss 2.5527 (2.5579) lr 2.3209e-02 eta 0:02:24
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.43s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.48s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.02s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.34s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.35it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.68it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.50it/s]100%|██████████| 9/9 [00:09<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 33.9%

epoch [35/50] batch [2/12] time 0.501 (1.994) data 0.000 (1.477) loss 2.6465 (2.5254) lr 2.3209e-02 eta 0:06:18
epoch [35/50] batch [4/12] time 0.504 (1.250) data 0.000 (0.739) loss 2.5996 (2.5288) lr 2.3209e-02 eta 0:03:55
epoch [35/50] batch [6/12] time 0.505 (1.001) data 0.000 (0.493) loss 2.6738 (2.5625) lr 2.3209e-02 eta 0:03:06
epoch [35/50] batch [8/12] time 0.504 (0.877) data 0.000 (0.369) loss 2.4570 (2.5361) lr 2.3209e-02 eta 0:02:41
epoch [35/50] batch [10/12] time 0.517 (0.804) data 0.000 (0.296) loss 2.5000 (2.5473) lr 2.3209e-02 eta 0:02:26
epoch [35/50] batch [12/12] time 0.506 (0.754) data 0.000 (0.246) loss 2.5859 (2.5649) lr 2.0611e-02 eta 0:02:15
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.48s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.09it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.41it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.73it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:09<00:00,  1.03s/it]=> result
* total: 1,667
* correct: 619
* accuracy: 37.1%
* error: 62.9%
* macro_f1: 34.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [36/50] batch [2/12] time 0.515 (1.954) data 0.001 (1.423) loss 2.5820 (2.5518) lr 2.0611e-02 eta 0:05:47
epoch [36/50] batch [4/12] time 0.524 (1.241) data 0.000 (0.712) loss 2.6895 (2.5713) lr 2.0611e-02 eta 0:03:38
epoch [36/50] batch [6/12] time 0.520 (1.001) data 0.000 (0.474) loss 2.4492 (2.5465) lr 2.0611e-02 eta 0:02:54
epoch [36/50] batch [8/12] time 0.518 (0.880) data 0.000 (0.356) loss 2.6113 (2.5496) lr 2.0611e-02 eta 0:02:31
epoch [36/50] batch [10/12] time 0.524 (0.808) data 0.000 (0.285) loss 2.5879 (2.5604) lr 2.0611e-02 eta 0:02:17
epoch [36/50] batch [12/12] time 0.514 (0.759) data 0.000 (0.237) loss 2.6094 (2.5467) lr 1.8129e-02 eta 0:02:07
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.44s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.52s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.05s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.36s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.34it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:10<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 621
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [37/50] batch [2/12] time 0.512 (1.947) data 0.001 (1.416) loss 2.6367 (2.6240) lr 1.8129e-02 eta 0:05:23
epoch [37/50] batch [4/12] time 0.511 (1.228) data 0.000 (0.708) loss 2.5977 (2.5806) lr 1.8129e-02 eta 0:03:21
epoch [37/50] batch [6/12] time 0.512 (0.988) data 0.000 (0.472) loss 2.5605 (2.5469) lr 1.8129e-02 eta 0:02:40
epoch [37/50] batch [8/12] time 0.517 (0.870) data 0.000 (0.354) loss 2.6250 (2.5642) lr 1.8129e-02 eta 0:02:19
epoch [37/50] batch [10/12] time 0.507 (0.798) data 0.000 (0.283) loss 2.5879 (2.5670) lr 1.8129e-02 eta 0:02:06
epoch [37/50] batch [12/12] time 0.515 (0.758) data 0.000 (0.236) loss 2.5020 (2.5514) lr 1.5773e-02 eta 0:01:58
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.56s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.95s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.30s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:10<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 624
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 34.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [38/50] batch [2/12] time 0.505 (1.920) data 0.000 (1.364) loss 2.7598 (2.6504) lr 1.5773e-02 eta 0:04:55
epoch [38/50] batch [4/12] time 0.509 (1.214) data 0.000 (0.682) loss 2.5000 (2.6250) lr 1.5773e-02 eta 0:03:04
epoch [38/50] batch [6/12] time 0.505 (0.979) data 0.000 (0.455) loss 2.6738 (2.6048) lr 1.5773e-02 eta 0:02:26
epoch [38/50] batch [8/12] time 0.506 (0.861) data 0.000 (0.341) loss 2.5801 (2.5913) lr 1.5773e-02 eta 0:02:07
epoch [38/50] batch [10/12] time 0.511 (0.791) data 0.000 (0.273) loss 2.4453 (2.5799) lr 1.5773e-02 eta 0:01:55
epoch [38/50] batch [12/12] time 0.508 (0.744) data 0.000 (0.228) loss 2.5195 (2.5815) lr 1.3552e-02 eta 0:01:47
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.51s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.93s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.56it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 614
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 33.6%

epoch [39/50] batch [2/12] time 0.684 (1.728) data 0.152 (1.078) loss 2.5879 (2.4443) lr 1.3552e-02 eta 0:04:05
epoch [39/50] batch [4/12] time 0.517 (1.119) data 0.000 (0.539) loss 2.4648 (2.4604) lr 1.3552e-02 eta 0:02:36
epoch [39/50] batch [6/12] time 0.515 (0.919) data 0.000 (0.360) loss 2.3887 (2.4723) lr 1.3552e-02 eta 0:02:06
epoch [39/50] batch [8/12] time 0.514 (0.817) data 0.000 (0.270) loss 2.7383 (2.5059) lr 1.3552e-02 eta 0:01:51
epoch [39/50] batch [10/12] time 0.513 (0.756) data 0.000 (0.216) loss 2.7148 (2.5457) lr 1.3552e-02 eta 0:01:41
epoch [39/50] batch [12/12] time 0.509 (0.715) data 0.000 (0.180) loss 2.4219 (2.5441) lr 1.1474e-02 eta 0:01:34
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.45s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.90s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.27s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.49s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.06s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.24it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.40it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 33.8%

epoch [40/50] batch [2/12] time 0.574 (1.693) data 0.000 (1.028) loss 2.4805 (2.5244) lr 1.1474e-02 eta 0:03:40
epoch [40/50] batch [4/12] time 0.514 (1.102) data 0.000 (0.514) loss 2.6426 (2.5610) lr 1.1474e-02 eta 0:02:21
epoch [40/50] batch [6/12] time 0.501 (0.902) data 0.000 (0.343) loss 2.5664 (2.5563) lr 1.1474e-02 eta 0:01:53
epoch [40/50] batch [8/12] time 0.503 (0.802) data 0.000 (0.257) loss 2.4746 (2.5437) lr 1.1474e-02 eta 0:01:39
epoch [40/50] batch [10/12] time 0.509 (0.743) data 0.000 (0.206) loss 2.6055 (2.5463) lr 1.1474e-02 eta 0:01:30
epoch [40/50] batch [12/12] time 0.509 (0.704) data 0.000 (0.172) loss 2.3926 (2.5273) lr 9.5492e-03 eta 0:01:24
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.43s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.91s/it] 33%|███▎      | 3/9 [00:07<00:12,  2.03s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.35s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.35it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.07s/it]=> result
* total: 1,667
* correct: 620
* accuracy: 37.2%
* error: 62.8%
* macro_f1: 33.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/12] time 0.575 (1.727) data 0.000 (1.079) loss 2.4004 (2.4355) lr 9.5492e-03 eta 0:03:23
epoch [41/50] batch [4/12] time 0.520 (1.123) data 0.000 (0.539) loss 2.6484 (2.5479) lr 9.5492e-03 eta 0:02:10
epoch [41/50] batch [6/12] time 0.505 (0.918) data 0.000 (0.360) loss 2.3516 (2.5088) lr 9.5492e-03 eta 0:01:44
epoch [41/50] batch [8/12] time 0.513 (0.817) data 0.000 (0.270) loss 2.4473 (2.4805) lr 9.5492e-03 eta 0:01:31
epoch [41/50] batch [10/12] time 0.510 (0.756) data 0.000 (0.216) loss 2.6543 (2.5014) lr 9.5492e-03 eta 0:01:23
epoch [41/50] batch [12/12] time 0.509 (0.715) data 0.000 (0.180) loss 2.6875 (2.5213) lr 7.7836e-03 eta 0:01:17
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.52s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.78s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.24s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.11it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.43it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.76it/s] 89%|████████▉ | 8/9 [00:08<00:00,  2.08it/s]100%|██████████| 9/9 [00:09<00:00,  2.61it/s]100%|██████████| 9/9 [00:09<00:00,  1.03s/it]=> result
* total: 1,667
* correct: 611
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 33.4%

epoch [42/50] batch [2/12] time 0.615 (1.708) data 0.004 (1.021) loss 2.5371 (2.5371) lr 7.7836e-03 eta 0:03:01
epoch [42/50] batch [4/12] time 0.509 (1.108) data 0.000 (0.511) loss 2.5156 (2.5640) lr 7.7836e-03 eta 0:01:55
epoch [42/50] batch [6/12] time 0.501 (0.908) data 0.000 (0.341) loss 2.7871 (2.5664) lr 7.7836e-03 eta 0:01:32
epoch [42/50] batch [8/12] time 0.501 (0.806) data 0.000 (0.256) loss 2.3242 (2.5415) lr 7.7836e-03 eta 0:01:20
epoch [42/50] batch [10/12] time 0.508 (0.746) data 0.000 (0.204) loss 2.5898 (2.5344) lr 7.7836e-03 eta 0:01:13
epoch [42/50] batch [12/12] time 0.508 (0.707) data 0.000 (0.170) loss 2.2754 (2.5090) lr 6.1847e-03 eta 0:01:07
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.63s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.32s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.94s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.04it/s]100%|██████████| 9/9 [00:09<00:00,  2.56it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 33.8%

epoch [43/50] batch [2/12] time 0.519 (1.953) data 0.000 (1.398) loss 2.6387 (2.6426) lr 6.1847e-03 eta 0:03:03
epoch [43/50] batch [4/12] time 0.518 (1.239) data 0.000 (0.699) loss 2.5566 (2.5571) lr 6.1847e-03 eta 0:01:53
epoch [43/50] batch [6/12] time 0.515 (0.998) data 0.000 (0.466) loss 2.4629 (2.5348) lr 6.1847e-03 eta 0:01:29
epoch [43/50] batch [8/12] time 0.519 (0.878) data 0.000 (0.350) loss 2.5020 (2.5232) lr 6.1847e-03 eta 0:01:17
epoch [43/50] batch [10/12] time 0.520 (0.806) data 0.000 (0.280) loss 2.3594 (2.4998) lr 6.1847e-03 eta 0:01:09
epoch [43/50] batch [12/12] time 0.516 (0.758) data 0.000 (0.233) loss 2.5605 (2.4992) lr 4.7586e-03 eta 0:01:03
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.72s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.36s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.97s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.31s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:10<00:00,  2.53it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 619
* accuracy: 37.1%
* error: 62.9%
* macro_f1: 33.8%

epoch [44/50] batch [2/12] time 0.588 (1.752) data 0.000 (1.100) loss 2.6172 (2.6035) lr 4.7586e-03 eta 0:02:23
epoch [44/50] batch [4/12] time 0.510 (1.131) data 0.000 (0.550) loss 2.4707 (2.6104) lr 4.7586e-03 eta 0:01:30
epoch [44/50] batch [6/12] time 0.509 (0.924) data 0.000 (0.367) loss 2.4570 (2.5518) lr 4.7586e-03 eta 0:01:12
epoch [44/50] batch [8/12] time 0.511 (0.820) data 0.000 (0.275) loss 2.3242 (2.5242) lr 4.7586e-03 eta 0:01:02
epoch [44/50] batch [10/12] time 0.512 (0.759) data 0.000 (0.220) loss 2.5273 (2.5131) lr 4.7586e-03 eta 0:00:56
epoch [44/50] batch [12/12] time 0.509 (0.717) data 0.000 (0.184) loss 2.8281 (2.5392) lr 3.5112e-03 eta 0:00:51
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.46s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.50s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.03s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.35s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.35it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 622
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.1%

epoch [45/50] batch [2/12] time 0.673 (1.825) data 0.025 (1.129) loss 2.4141 (2.4609) lr 3.5112e-03 eta 0:02:07
epoch [45/50] batch [4/12] time 0.506 (1.168) data 0.000 (0.564) loss 2.6680 (2.5464) lr 3.5112e-03 eta 0:01:19
epoch [45/50] batch [6/12] time 0.506 (0.947) data 0.000 (0.376) loss 2.7539 (2.5355) lr 3.5112e-03 eta 0:01:02
epoch [45/50] batch [8/12] time 0.502 (0.836) data 0.000 (0.282) loss 2.6289 (2.5398) lr 3.5112e-03 eta 0:00:53
epoch [45/50] batch [10/12] time 0.503 (0.770) data 0.000 (0.226) loss 2.5020 (2.5428) lr 3.5112e-03 eta 0:00:47
epoch [45/50] batch [12/12] time 0.505 (0.726) data 0.000 (0.188) loss 2.3750 (2.5231) lr 2.4472e-03 eta 0:00:43
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.46s/it] 22%|██▏       | 2/9 [00:07<00:24,  3.44s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.01s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.33s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 622
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.2%

epoch [46/50] batch [2/12] time 0.585 (1.726) data 0.000 (1.050) loss 2.4395 (2.5078) lr 2.4472e-03 eta 0:01:40
epoch [46/50] batch [4/12] time 0.507 (1.117) data 0.000 (0.525) loss 2.5332 (2.5156) lr 2.4472e-03 eta 0:01:02
epoch [46/50] batch [6/12] time 0.510 (0.914) data 0.000 (0.350) loss 2.2734 (2.4821) lr 2.4472e-03 eta 0:00:49
epoch [46/50] batch [8/12] time 0.506 (0.812) data 0.000 (0.263) loss 2.4922 (2.5125) lr 2.4472e-03 eta 0:00:42
epoch [46/50] batch [10/12] time 0.508 (0.752) data 0.000 (0.210) loss 2.6016 (2.5145) lr 2.4472e-03 eta 0:00:37
epoch [46/50] batch [12/12] time 0.510 (0.711) data 0.000 (0.175) loss 2.3633 (2.5073) lr 1.5708e-03 eta 0:00:34
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:50,  6.32s/it] 22%|██▏       | 2/9 [00:08<00:28,  4.03s/it] 33%|███▎      | 3/9 [00:09<00:13,  2.33s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.53s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.09s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.22it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.54it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.86it/s]100%|██████████| 9/9 [00:10<00:00,  2.37it/s]100%|██████████| 9/9 [00:10<00:00,  1.21s/it]=> result
* total: 1,667
* correct: 623
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 34.2%

epoch [47/50] batch [2/12] time 0.518 (2.081) data 0.000 (1.467) loss 2.4277 (2.4336) lr 1.5708e-03 eta 0:01:35
epoch [47/50] batch [4/12] time 0.524 (1.302) data 0.000 (0.734) loss 2.5215 (2.4888) lr 1.5708e-03 eta 0:00:57
epoch [47/50] batch [6/12] time 0.539 (1.047) data 0.001 (0.489) loss 2.4883 (2.5088) lr 1.5708e-03 eta 0:00:43
epoch [47/50] batch [8/12] time 0.540 (0.921) data 0.000 (0.367) loss 2.4961 (2.4929) lr 1.5708e-03 eta 0:00:36
epoch [47/50] batch [10/12] time 0.542 (0.845) data 0.000 (0.294) loss 2.5605 (2.4998) lr 1.5708e-03 eta 0:00:32
epoch [47/50] batch [12/12] time 0.554 (0.796) data 0.000 (0.245) loss 2.3418 (2.4902) lr 8.8564e-04 eta 0:00:28
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.01s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.76s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.18s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.44s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.03s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.59it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 622
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.2%

epoch [48/50] batch [2/12] time 0.708 (1.862) data 0.184 (1.216) loss 2.5547 (2.4873) lr 8.8564e-04 eta 0:01:03
epoch [48/50] batch [4/12] time 0.508 (1.185) data 0.000 (0.608) loss 2.5762 (2.5410) lr 8.8564e-04 eta 0:00:37
epoch [48/50] batch [6/12] time 0.509 (0.960) data 0.000 (0.405) loss 2.5410 (2.5456) lr 8.8564e-04 eta 0:00:28
epoch [48/50] batch [8/12] time 0.503 (0.846) data 0.000 (0.304) loss 2.5117 (2.5330) lr 8.8564e-04 eta 0:00:23
epoch [48/50] batch [10/12] time 0.508 (0.779) data 0.000 (0.243) loss 2.4219 (2.5191) lr 8.8564e-04 eta 0:00:20
epoch [48/50] batch [12/12] time 0.509 (0.733) data 0.000 (0.203) loss 2.4727 (2.5187) lr 3.9426e-04 eta 0:00:17
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.50s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:09<00:00,  1.04s/it]=> result
* total: 1,667
* correct: 621
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.1%

epoch [49/50] batch [2/12] time 0.544 (2.068) data 0.001 (1.495) loss 2.5312 (2.5234) lr 3.9426e-04 eta 0:00:45
epoch [49/50] batch [4/12] time 0.554 (1.312) data 0.000 (0.748) loss 2.4043 (2.5332) lr 3.9426e-04 eta 0:00:26
epoch [49/50] batch [6/12] time 0.558 (1.060) data 0.000 (0.499) loss 2.4883 (2.4834) lr 3.9426e-04 eta 0:00:19
epoch [49/50] batch [8/12] time 0.546 (0.931) data 0.000 (0.374) loss 2.4844 (2.4761) lr 3.9426e-04 eta 0:00:14
epoch [49/50] batch [10/12] time 0.541 (0.854) data 0.000 (0.299) loss 2.7109 (2.5160) lr 3.9426e-04 eta 0:00:11
epoch [49/50] batch [12/12] time 0.530 (0.800) data 0.000 (0.249) loss 2.3926 (2.5062) lr 9.8664e-05 eta 0:00:09
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.92s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.10s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.88s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.43s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.02s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.29it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.61it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.93it/s]100%|██████████| 9/9 [00:09<00:00,  2.45it/s]100%|██████████| 9/9 [00:10<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 619
* accuracy: 37.1%
* error: 62.9%
* macro_f1: 34.0%

epoch [50/50] batch [2/12] time 0.509 (1.941) data 0.000 (1.368) loss 2.5566 (2.5547) lr 9.8664e-05 eta 0:00:19
epoch [50/50] batch [4/12] time 0.512 (1.226) data 0.000 (0.684) loss 2.6758 (2.5503) lr 9.8664e-05 eta 0:00:09
epoch [50/50] batch [6/12] time 0.524 (0.990) data 0.000 (0.456) loss 2.3457 (2.5205) lr 9.8664e-05 eta 0:00:05
epoch [50/50] batch [8/12] time 0.513 (0.873) data 0.000 (0.342) loss 2.4316 (2.5132) lr 9.8664e-05 eta 0:00:03
epoch [50/50] batch [10/12] time 0.511 (0.801) data 0.000 (0.274) loss 2.4727 (2.5154) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [12/12] time 0.512 (0.753) data 0.000 (0.228) loss 2.4434 (2.5067) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.53s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.58s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.09s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.94it/s]100%|██████████| 9/9 [00:10<00:00,  2.44it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]
=> result
* total: 1,667
* correct: 620
* accuracy: 37.2%
* error: 62.8%
* macro_f1: 34.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 37)
Evaluate on the *test* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:59,  7.46s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.49s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.06s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]
=> result
* total: 1,666
* correct: 639
* accuracy: 38.4%
* error: 61.6%
* macro_f1: 35.0%
Elapsed: 0:15:58
+ sh scripts/rpo_prime/base2new_test_sdl.sh fgvc_aircraft 2 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE NEW CLASSES!
800 1666 1667
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  50
# train_x  800
# val      1,666
# test     1,667
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 37)
Evaluate on the *test* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:10<01:20, 10.09s/it] 22%|██▏       | 2/9 [00:10<00:30,  4.33s/it] 33%|███▎      | 3/9 [00:10<00:14,  2.49s/it] 44%|████▍     | 4/9 [00:11<00:08,  1.63s/it] 56%|█████▌    | 5/9 [00:11<00:04,  1.15s/it] 67%|██████▋   | 6/9 [00:11<00:02,  1.16it/s] 78%|███████▊  | 7/9 [00:11<00:01,  1.47it/s] 89%|████████▉ | 8/9 [00:12<00:00,  1.79it/s]100%|██████████| 9/9 [00:12<00:00,  2.27it/s]100%|██████████| 9/9 [00:12<00:00,  1.39s/it]
=> result
* total: 1,667
* correct: 591
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.1%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh fgvc_aircraft 3 0 main_tmp1_0.1sdl 16
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE BASE CLASSES!
800 1667 1666
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  50
# train_x  800
# val      1,667
# test     1,666
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/12] time 0.504 (2.953) data 0.000 (1.586) loss 3.2402 (3.2822) lr 1.0000e-01 eta 0:29:25
epoch [1/50] batch [4/12] time 0.520 (1.733) data 0.000 (0.793) loss 2.9961 (3.1543) lr 1.0000e-01 eta 0:17:12
epoch [1/50] batch [6/12] time 0.534 (1.330) data 0.000 (0.529) loss 2.9121 (3.0846) lr 1.0000e-01 eta 0:13:09
epoch [1/50] batch [8/12] time 0.541 (1.131) data 0.000 (0.397) loss 2.9141 (3.0627) lr 1.0000e-01 eta 0:11:09
epoch [1/50] batch [10/12] time 0.534 (1.012) data 0.000 (0.317) loss 2.6895 (3.0059) lr 1.0000e-01 eta 0:09:56
epoch [1/50] batch [12/12] time 0.533 (0.933) data 0.000 (0.265) loss 2.6387 (2.9539) lr 9.9901e-02 eta 0:09:08
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:58,  7.33s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.77s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.19s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.45s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.04s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.59it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.90it/s]100%|██████████| 9/9 [00:10<00:00,  2.41it/s]100%|██████████| 9/9 [00:10<00:00,  1.20s/it]=> result
* total: 1,667
* correct: 526
* accuracy: 31.6%
* error: 68.4%
* macro_f1: 28.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/12] time 0.623 (1.831) data 0.091 (1.197) loss 2.9121 (2.8799) lr 9.9901e-02 eta 0:17:52
epoch [2/50] batch [4/12] time 0.500 (1.166) data 0.000 (0.599) loss 2.8828 (2.8931) lr 9.9901e-02 eta 0:11:20
epoch [2/50] batch [6/12] time 0.504 (0.945) data 0.000 (0.399) loss 2.8008 (2.8451) lr 9.9901e-02 eta 0:09:09
epoch [2/50] batch [8/12] time 0.501 (0.834) data 0.000 (0.299) loss 2.5469 (2.7937) lr 9.9901e-02 eta 0:08:03
epoch [2/50] batch [10/12] time 0.504 (0.768) data 0.000 (0.240) loss 2.9668 (2.8256) lr 9.9901e-02 eta 0:07:23
epoch [2/50] batch [12/12] time 0.504 (0.724) data 0.000 (0.200) loss 2.5879 (2.7987) lr 9.9606e-02 eta 0:06:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.73s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.59s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.09s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.96it/s]100%|██████████| 9/9 [00:10<00:00,  2.47it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 531
* accuracy: 31.9%
* error: 68.1%
* macro_f1: 28.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/12] time 0.532 (2.092) data 0.000 (1.513) loss 2.7656 (2.7646) lr 9.9606e-02 eta 0:20:00
epoch [3/50] batch [4/12] time 0.547 (1.315) data 0.000 (0.756) loss 2.6719 (2.7729) lr 9.9606e-02 eta 0:12:32
epoch [3/50] batch [6/12] time 0.540 (1.056) data 0.000 (0.504) loss 2.7520 (2.8001) lr 9.9606e-02 eta 0:10:01
epoch [3/50] batch [8/12] time 0.533 (0.925) data 0.000 (0.378) loss 2.7285 (2.7664) lr 9.9606e-02 eta 0:08:45
epoch [3/50] batch [10/12] time 0.541 (0.847) data 0.000 (0.303) loss 2.8691 (2.7807) lr 9.9606e-02 eta 0:07:59
epoch [3/50] batch [12/12] time 0.547 (0.797) data 0.000 (0.252) loss 2.8164 (2.7567) lr 9.9114e-02 eta 0:07:29
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:04,  8.06s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.56s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:09<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.66it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.97it/s]100%|██████████| 9/9 [00:10<00:00,  2.50it/s]100%|██████████| 9/9 [00:10<00:00,  1.17s/it]=> result
* total: 1,667
* correct: 539
* accuracy: 32.3%
* error: 67.7%
* macro_f1: 28.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/12] time 0.542 (2.008) data 0.000 (1.435) loss 2.4492 (2.6230) lr 9.9114e-02 eta 0:18:48
epoch [4/50] batch [4/12] time 0.515 (1.267) data 0.000 (0.718) loss 2.7617 (2.7085) lr 9.9114e-02 eta 0:11:49
epoch [4/50] batch [6/12] time 0.514 (1.016) data 0.000 (0.479) loss 2.5898 (2.6934) lr 9.9114e-02 eta 0:09:26
epoch [4/50] batch [8/12] time 0.514 (0.891) data 0.000 (0.359) loss 2.9004 (2.7180) lr 9.9114e-02 eta 0:08:15
epoch [4/50] batch [10/12] time 0.511 (0.815) data 0.000 (0.287) loss 2.7930 (2.7131) lr 9.9114e-02 eta 0:07:31
epoch [4/50] batch [12/12] time 0.512 (0.765) data 0.000 (0.239) loss 2.5996 (2.6919) lr 9.8429e-02 eta 0:07:02
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.91s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.76s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.18s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.44s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.03s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.58it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.88it/s]100%|██████████| 9/9 [00:10<00:00,  2.37it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 547
* accuracy: 32.8%
* error: 67.2%
* macro_f1: 29.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/12] time 0.556 (1.902) data 0.001 (1.245) loss 2.8438 (2.8018) lr 9.8429e-02 eta 0:17:26
epoch [5/50] batch [4/12] time 0.534 (1.219) data 0.000 (0.623) loss 2.7832 (2.7339) lr 9.8429e-02 eta 0:11:07
epoch [5/50] batch [6/12] time 0.534 (0.991) data 0.000 (0.415) loss 2.7812 (2.7536) lr 9.8429e-02 eta 0:09:00
epoch [5/50] batch [8/12] time 0.537 (0.877) data 0.000 (0.312) loss 2.8184 (2.7673) lr 9.8429e-02 eta 0:07:57
epoch [5/50] batch [10/12] time 0.535 (0.809) data 0.000 (0.249) loss 2.7051 (2.7629) lr 9.8429e-02 eta 0:07:18
epoch [5/50] batch [12/12] time 0.521 (0.762) data 0.000 (0.208) loss 2.6406 (2.7404) lr 9.7553e-02 eta 0:06:51
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.60s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.96s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.81s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.26s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.14it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.45it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.77it/s]100%|██████████| 9/9 [00:09<00:00,  2.26it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 548
* accuracy: 32.9%
* error: 67.1%
* macro_f1: 29.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [6/50] batch [2/12] time 0.566 (1.787) data 0.000 (1.118) loss 2.7422 (2.7695) lr 9.7553e-02 eta 0:16:01
epoch [6/50] batch [4/12] time 0.516 (1.149) data 0.000 (0.559) loss 2.7520 (2.7798) lr 9.7553e-02 eta 0:10:15
epoch [6/50] batch [6/12] time 0.531 (0.941) data 0.000 (0.373) loss 2.6113 (2.7327) lr 9.7553e-02 eta 0:08:22
epoch [6/50] batch [8/12] time 0.530 (0.838) data 0.000 (0.280) loss 2.6953 (2.7258) lr 9.7553e-02 eta 0:07:25
epoch [6/50] batch [10/12] time 0.532 (0.777) data 0.000 (0.224) loss 2.7461 (2.7367) lr 9.7553e-02 eta 0:06:51
epoch [6/50] batch [12/12] time 0.533 (0.736) data 0.000 (0.187) loss 2.6250 (2.7144) lr 9.6489e-02 eta 0:06:28
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.02s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.14s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.20s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.45s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.04s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.26it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.58it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 560
* accuracy: 33.6%
* error: 66.4%
* macro_f1: 30.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [7/50] batch [2/12] time 0.510 (2.006) data 0.000 (1.409) loss 2.6738 (2.7324) lr 9.6489e-02 eta 0:17:34
epoch [7/50] batch [4/12] time 0.504 (1.256) data 0.000 (0.705) loss 2.6895 (2.6943) lr 9.6489e-02 eta 0:10:58
epoch [7/50] batch [6/12] time 0.506 (1.006) data 0.000 (0.470) loss 2.6680 (2.6663) lr 9.6489e-02 eta 0:08:45
epoch [7/50] batch [8/12] time 0.508 (0.881) data 0.000 (0.352) loss 2.8438 (2.6980) lr 9.6489e-02 eta 0:07:38
epoch [7/50] batch [10/12] time 0.502 (0.806) data 0.000 (0.282) loss 2.7422 (2.6984) lr 9.6489e-02 eta 0:06:57
epoch [7/50] batch [12/12] time 0.505 (0.755) data 0.000 (0.235) loss 2.6055 (2.6909) lr 9.5241e-02 eta 0:06:29
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.65s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.98s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.81s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.26s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:09<00:00,  2.52it/s]100%|██████████| 9/9 [00:09<00:00,  1.06s/it]=> result
* total: 1,667
* correct: 561
* accuracy: 33.7%
* error: 66.3%
* macro_f1: 30.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [8/50] batch [2/12] time 0.534 (2.098) data 0.000 (1.538) loss 2.6523 (2.6211) lr 9.5241e-02 eta 0:17:58
epoch [8/50] batch [4/12] time 0.537 (1.318) data 0.000 (0.769) loss 2.4727 (2.5996) lr 9.5241e-02 eta 0:11:14
epoch [8/50] batch [6/12] time 0.536 (1.057) data 0.000 (0.513) loss 2.7109 (2.6514) lr 9.5241e-02 eta 0:08:59
epoch [8/50] batch [8/12] time 0.546 (0.929) data 0.000 (0.385) loss 2.7500 (2.6716) lr 9.5241e-02 eta 0:07:51
epoch [8/50] batch [10/12] time 0.535 (0.851) data 0.000 (0.308) loss 2.6016 (2.6645) lr 9.5241e-02 eta 0:07:10
epoch [8/50] batch [12/12] time 0.539 (0.799) data 0.000 (0.257) loss 2.9531 (2.6891) lr 9.3815e-02 eta 0:06:42
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.04s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.15s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.17s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.43s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.02s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.29it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.61it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.93it/s]100%|██████████| 9/9 [00:10<00:00,  2.44it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 575
* accuracy: 34.5%
* error: 65.5%
* macro_f1: 30.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/12] time 0.523 (2.014) data 0.000 (1.464) loss 2.5684 (2.6055) lr 9.3815e-02 eta 0:16:51
epoch [9/50] batch [4/12] time 0.549 (1.275) data 0.000 (0.732) loss 2.6816 (2.6001) lr 9.3815e-02 eta 0:10:37
epoch [9/50] batch [6/12] time 0.630 (1.043) data 0.000 (0.488) loss 2.6523 (2.6084) lr 9.3815e-02 eta 0:08:39
epoch [9/50] batch [8/12] time 0.517 (0.911) data 0.000 (0.366) loss 2.6055 (2.6265) lr 9.3815e-02 eta 0:07:32
epoch [9/50] batch [10/12] time 0.517 (0.832) data 0.000 (0.293) loss 2.8770 (2.6514) lr 9.3815e-02 eta 0:06:51
epoch [9/50] batch [12/12] time 0.523 (0.781) data 0.000 (0.244) loss 2.6934 (2.6413) lr 9.2216e-02 eta 0:06:24
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.80s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.06s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.22s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.47s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.05s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.87it/s]100%|██████████| 9/9 [00:10<00:00,  2.36it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 569
* accuracy: 34.1%
* error: 65.9%
* macro_f1: 30.7%

epoch [10/50] batch [2/12] time 0.585 (1.832) data 0.038 (1.182) loss 2.6875 (2.6758) lr 9.2216e-02 eta 0:14:57
epoch [10/50] batch [4/12] time 0.526 (1.178) data 0.000 (0.591) loss 2.7012 (2.6353) lr 9.2216e-02 eta 0:09:34
epoch [10/50] batch [6/12] time 0.527 (0.961) data 0.000 (0.394) loss 2.6738 (2.6605) lr 9.2216e-02 eta 0:07:47
epoch [10/50] batch [8/12] time 0.524 (0.852) data 0.000 (0.296) loss 2.7852 (2.6755) lr 9.2216e-02 eta 0:06:52
epoch [10/50] batch [10/12] time 0.528 (0.787) data 0.000 (0.237) loss 2.7734 (2.6881) lr 9.2216e-02 eta 0:06:19
epoch [10/50] batch [12/12] time 0.526 (0.743) data 0.000 (0.197) loss 2.5156 (2.6782) lr 9.0451e-02 eta 0:05:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.63s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.32s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.94s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.29s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:10<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 580
* accuracy: 34.8%
* error: 65.2%
* macro_f1: 31.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/12] time 0.578 (1.768) data 0.000 (1.103) loss 2.5977 (2.6787) lr 9.0451e-02 eta 0:14:04
epoch [11/50] batch [4/12] time 0.505 (1.136) data 0.000 (0.552) loss 2.6836 (2.6455) lr 9.0451e-02 eta 0:09:00
epoch [11/50] batch [6/12] time 0.506 (0.925) data 0.000 (0.368) loss 2.8262 (2.6761) lr 9.0451e-02 eta 0:07:18
epoch [11/50] batch [8/12] time 0.537 (0.825) data 0.000 (0.276) loss 2.6191 (2.6467) lr 9.0451e-02 eta 0:06:29
epoch [11/50] batch [10/12] time 0.533 (0.768) data 0.000 (0.221) loss 2.5898 (2.6375) lr 9.0451e-02 eta 0:06:00
epoch [11/50] batch [12/12] time 0.529 (0.728) data 0.000 (0.184) loss 2.5605 (2.6343) lr 8.8526e-02 eta 0:05:40
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:06,  8.32s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.67s/it] 33%|███▎      | 3/9 [00:09<00:12,  2.13s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.41s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.01s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.30it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.62it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.93it/s]100%|██████████| 9/9 [00:10<00:00,  2.44it/s]100%|██████████| 9/9 [00:10<00:00,  1.21s/it]=> result
* total: 1,667
* correct: 571
* accuracy: 34.3%
* error: 65.7%
* macro_f1: 30.9%

epoch [12/50] batch [2/12] time 0.707 (1.940) data 0.190 (1.314) loss 2.6562 (2.6309) lr 8.8526e-02 eta 0:15:04
epoch [12/50] batch [4/12] time 0.506 (1.226) data 0.000 (0.657) loss 2.6426 (2.6670) lr 8.8526e-02 eta 0:09:29
epoch [12/50] batch [6/12] time 0.504 (0.987) data 0.001 (0.438) loss 2.7969 (2.6865) lr 8.8526e-02 eta 0:07:35
epoch [12/50] batch [8/12] time 0.504 (0.866) data 0.000 (0.329) loss 2.6660 (2.6729) lr 8.8526e-02 eta 0:06:38
epoch [12/50] batch [10/12] time 0.507 (0.794) data 0.000 (0.263) loss 2.7422 (2.6719) lr 8.8526e-02 eta 0:06:03
epoch [12/50] batch [12/12] time 0.507 (0.746) data 0.000 (0.219) loss 2.8242 (2.6960) lr 8.6448e-02 eta 0:05:40
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.71s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.38s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.97s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.31s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.38it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:10<00:00,  2.53it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 591
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [13/50] batch [2/12] time 0.530 (1.977) data 0.001 (1.315) loss 2.8555 (2.6973) lr 8.6448e-02 eta 0:14:57
epoch [13/50] batch [4/12] time 0.534 (1.255) data 0.000 (0.657) loss 2.6270 (2.6885) lr 8.6448e-02 eta 0:09:27
epoch [13/50] batch [6/12] time 0.532 (1.014) data 0.000 (0.438) loss 2.6836 (2.6826) lr 8.6448e-02 eta 0:07:36
epoch [13/50] batch [8/12] time 0.544 (0.895) data 0.000 (0.329) loss 2.5996 (2.6482) lr 8.6448e-02 eta 0:06:41
epoch [13/50] batch [10/12] time 0.546 (0.825) data 0.000 (0.263) loss 2.7949 (2.6549) lr 8.6448e-02 eta 0:06:08
epoch [13/50] batch [12/12] time 0.540 (0.778) data 0.000 (0.219) loss 2.5156 (2.6401) lr 8.4227e-02 eta 0:05:45
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:04,  8.09s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.57s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.08s/it] 44%|████▍     | 4/9 [00:09<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.96it/s]100%|██████████| 9/9 [00:10<00:00,  2.47it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 588
* accuracy: 35.3%
* error: 64.7%
* macro_f1: 32.1%

epoch [14/50] batch [2/12] time 0.524 (2.004) data 0.001 (1.452) loss 2.5801 (2.7812) lr 8.4227e-02 eta 0:14:45
epoch [14/50] batch [4/12] time 0.536 (1.273) data 0.000 (0.726) loss 2.6367 (2.7153) lr 8.4227e-02 eta 0:09:19
epoch [14/50] batch [6/12] time 0.516 (1.020) data 0.000 (0.484) loss 2.4648 (2.6693) lr 8.4227e-02 eta 0:07:26
epoch [14/50] batch [8/12] time 0.524 (0.896) data 0.000 (0.363) loss 2.4941 (2.6433) lr 8.4227e-02 eta 0:06:30
epoch [14/50] batch [10/12] time 0.521 (0.821) data 0.000 (0.291) loss 2.6289 (2.6336) lr 8.4227e-02 eta 0:05:56
epoch [14/50] batch [12/12] time 0.517 (0.770) data 0.000 (0.242) loss 2.7695 (2.6278) lr 8.1871e-02 eta 0:05:32
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.88s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.09s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.85s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.60s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.13s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.17it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.49it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.80it/s]100%|██████████| 9/9 [00:10<00:00,  2.28it/s]100%|██████████| 9/9 [00:10<00:00,  1.16s/it]=> result
* total: 1,667
* correct: 579
* accuracy: 34.7%
* error: 65.3%
* macro_f1: 31.5%

epoch [15/50] batch [2/12] time 0.545 (2.054) data 0.000 (1.435) loss 2.5898 (2.6885) lr 8.1871e-02 eta 0:14:43
epoch [15/50] batch [4/12] time 0.537 (1.296) data 0.000 (0.718) loss 2.5098 (2.5884) lr 8.1871e-02 eta 0:09:14
epoch [15/50] batch [6/12] time 0.535 (1.043) data 0.000 (0.479) loss 2.9395 (2.6553) lr 8.1871e-02 eta 0:07:24
epoch [15/50] batch [8/12] time 0.536 (0.916) data 0.000 (0.359) loss 2.6582 (2.6445) lr 8.1871e-02 eta 0:06:28
epoch [15/50] batch [10/12] time 0.536 (0.840) data 0.000 (0.287) loss 2.6016 (2.6311) lr 8.1871e-02 eta 0:05:54
epoch [15/50] batch [12/12] time 0.530 (0.789) data 0.000 (0.239) loss 2.5410 (2.6227) lr 7.9389e-02 eta 0:05:31
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.54s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.12s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.41s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.01s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.30it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:09<00:00,  2.46it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 596
* accuracy: 35.8%
* error: 64.2%
* macro_f1: 32.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/12] time 0.501 (1.950) data 0.000 (1.394) loss 2.4883 (2.6094) lr 7.9389e-02 eta 0:13:35
epoch [16/50] batch [4/12] time 0.504 (1.228) data 0.000 (0.697) loss 2.8926 (2.6895) lr 7.9389e-02 eta 0:08:30
epoch [16/50] batch [6/12] time 0.533 (0.993) data 0.000 (0.465) loss 2.7422 (2.6673) lr 7.9389e-02 eta 0:06:51
epoch [16/50] batch [8/12] time 0.532 (0.878) data 0.000 (0.349) loss 2.5918 (2.6572) lr 7.9389e-02 eta 0:06:01
epoch [16/50] batch [10/12] time 0.531 (0.809) data 0.000 (0.279) loss 2.5742 (2.6412) lr 7.9389e-02 eta 0:05:31
epoch [16/50] batch [12/12] time 0.532 (0.762) data 0.000 (0.233) loss 2.5312 (2.6299) lr 7.6791e-02 eta 0:05:11
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.98s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.76s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.18s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.44s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.03s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.28it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.60it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.91it/s]100%|██████████| 9/9 [00:10<00:00,  2.42it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 597
* accuracy: 35.8%
* error: 64.2%
* macro_f1: 32.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [17/50] batch [2/12] time 0.623 (1.846) data 0.011 (1.165) loss 2.6777 (2.5869) lr 7.6791e-02 eta 0:12:29
epoch [17/50] batch [4/12] time 0.517 (1.181) data 0.000 (0.583) loss 2.6836 (2.6206) lr 7.6791e-02 eta 0:07:57
epoch [17/50] batch [6/12] time 0.516 (0.959) data 0.000 (0.389) loss 2.5234 (2.6156) lr 7.6791e-02 eta 0:06:25
epoch [17/50] batch [8/12] time 0.517 (0.849) data 0.000 (0.292) loss 2.4453 (2.6013) lr 7.6791e-02 eta 0:05:39
epoch [17/50] batch [10/12] time 0.517 (0.783) data 0.000 (0.233) loss 2.8184 (2.6088) lr 7.6791e-02 eta 0:05:11
epoch [17/50] batch [12/12] time 0.517 (0.739) data 0.000 (0.194) loss 2.5684 (2.6144) lr 7.4088e-02 eta 0:04:52
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.61s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.84s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.23s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.47s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.05s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.26it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.58it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.19s/it]=> result
* total: 1,667
* correct: 590
* accuracy: 35.4%
* error: 64.6%
* macro_f1: 32.1%

epoch [18/50] batch [2/12] time 0.571 (2.110) data 0.001 (1.476) loss 2.5703 (2.6279) lr 7.4088e-02 eta 0:13:51
epoch [18/50] batch [4/12] time 0.545 (1.329) data 0.000 (0.738) loss 2.6133 (2.6519) lr 7.4088e-02 eta 0:08:41
epoch [18/50] batch [6/12] time 0.549 (1.069) data 0.000 (0.492) loss 2.6777 (2.6615) lr 7.4088e-02 eta 0:06:56
epoch [18/50] batch [8/12] time 0.529 (0.935) data 0.000 (0.369) loss 2.4980 (2.6455) lr 7.4088e-02 eta 0:06:02
epoch [18/50] batch [10/12] time 0.533 (0.854) data 0.000 (0.295) loss 2.4570 (2.6260) lr 7.4088e-02 eta 0:05:29
epoch [18/50] batch [12/12] time 0.528 (0.800) data 0.000 (0.246) loss 2.5352 (2.6159) lr 7.1289e-02 eta 0:05:07
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:04,  8.03s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.48s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.03s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.35s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.03it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.35it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.67it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.99it/s]100%|██████████| 9/9 [00:10<00:00,  2.51it/s]100%|██████████| 9/9 [00:10<00:00,  1.16s/it]=> result
* total: 1,667
* correct: 597
* accuracy: 35.8%
* error: 64.2%
* macro_f1: 32.6%

epoch [19/50] batch [2/12] time 0.532 (2.016) data 0.001 (1.435) loss 2.5137 (2.5557) lr 7.1289e-02 eta 0:12:50
epoch [19/50] batch [4/12] time 0.502 (1.290) data 0.000 (0.718) loss 2.7441 (2.6489) lr 7.1289e-02 eta 0:08:10
epoch [19/50] batch [6/12] time 0.506 (1.028) data 0.000 (0.479) loss 2.5996 (2.6198) lr 7.1289e-02 eta 0:06:28
epoch [19/50] batch [8/12] time 0.504 (0.897) data 0.000 (0.359) loss 2.5137 (2.6106) lr 7.1289e-02 eta 0:05:37
epoch [19/50] batch [10/12] time 0.507 (0.819) data 0.000 (0.287) loss 2.7129 (2.5900) lr 7.1289e-02 eta 0:05:06
epoch [19/50] batch [12/12] time 0.503 (0.767) data 0.000 (0.239) loss 2.8594 (2.6208) lr 6.8406e-02 eta 0:04:45
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:05,  8.14s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.57s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.08s/it] 44%|████▍     | 4/9 [00:09<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 592
* accuracy: 35.5%
* error: 64.5%
* macro_f1: 32.6%

epoch [20/50] batch [2/12] time 0.529 (2.091) data 0.000 (1.511) loss 2.6016 (2.6777) lr 6.8406e-02 eta 0:12:53
epoch [20/50] batch [4/12] time 0.538 (1.312) data 0.000 (0.756) loss 2.5098 (2.5996) lr 6.8406e-02 eta 0:08:02
epoch [20/50] batch [6/12] time 0.541 (1.054) data 0.000 (0.504) loss 2.6230 (2.6195) lr 6.8406e-02 eta 0:06:25
epoch [20/50] batch [8/12] time 0.530 (0.923) data 0.000 (0.378) loss 2.3203 (2.5837) lr 6.8406e-02 eta 0:05:35
epoch [20/50] batch [10/12] time 0.521 (0.843) data 0.000 (0.302) loss 2.6758 (2.6023) lr 6.8406e-02 eta 0:05:05
epoch [20/50] batch [12/12] time 0.508 (0.788) data 0.000 (0.252) loss 2.5605 (2.5942) lr 6.5451e-02 eta 0:04:43
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.60s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.97s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.81s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.24it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.56it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.88it/s]100%|██████████| 9/9 [00:09<00:00,  2.39it/s]100%|██████████| 9/9 [00:09<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 586
* accuracy: 35.2%
* error: 64.8%
* macro_f1: 31.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/12] time 0.510 (1.951) data 0.000 (1.419) loss 2.6484 (2.6055) lr 6.5451e-02 eta 0:11:38
epoch [21/50] batch [4/12] time 0.532 (1.237) data 0.000 (0.710) loss 2.6934 (2.6484) lr 6.5451e-02 eta 0:07:20
epoch [21/50] batch [6/12] time 0.537 (1.003) data 0.000 (0.473) loss 2.4551 (2.6172) lr 6.5451e-02 eta 0:05:54
epoch [21/50] batch [8/12] time 0.530 (0.885) data 0.000 (0.355) loss 2.5918 (2.6165) lr 6.5451e-02 eta 0:05:11
epoch [21/50] batch [10/12] time 0.533 (0.814) data 0.000 (0.284) loss 2.7305 (2.6277) lr 6.5451e-02 eta 0:04:44
epoch [21/50] batch [12/12] time 0.528 (0.766) data 0.000 (0.237) loss 2.7930 (2.6261) lr 6.2434e-02 eta 0:04:26
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.07s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.17s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.21s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.46s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.04s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.59it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.90it/s]100%|██████████| 9/9 [00:10<00:00,  2.41it/s]100%|██████████| 9/9 [00:10<00:00,  1.16s/it]=> result
* total: 1,667
* correct: 603
* accuracy: 36.2%
* error: 63.8%
* macro_f1: 33.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [22/50] batch [2/12] time 0.520 (2.010) data 0.000 (1.424) loss 2.6230 (2.5947) lr 6.2434e-02 eta 0:11:35
epoch [22/50] batch [4/12] time 0.514 (1.261) data 0.000 (0.712) loss 2.6270 (2.6069) lr 6.2434e-02 eta 0:07:13
epoch [22/50] batch [6/12] time 0.512 (1.012) data 0.000 (0.475) loss 2.7441 (2.6387) lr 6.2434e-02 eta 0:05:46
epoch [22/50] batch [8/12] time 0.519 (0.888) data 0.000 (0.356) loss 2.6777 (2.6575) lr 6.2434e-02 eta 0:05:01
epoch [22/50] batch [10/12] time 0.510 (0.812) data 0.000 (0.285) loss 2.6582 (2.6443) lr 6.2434e-02 eta 0:04:34
epoch [22/50] batch [12/12] time 0.517 (0.763) data 0.000 (0.238) loss 2.4531 (2.6131) lr 5.9369e-02 eta 0:04:16
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.58s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.96s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.80s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.71it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.02it/s]100%|██████████| 9/9 [00:09<00:00,  2.53it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 603
* accuracy: 36.2%
* error: 63.8%
* macro_f1: 33.0%

epoch [23/50] batch [2/12] time 0.533 (2.090) data 0.001 (1.493) loss 2.5332 (2.5654) lr 5.9369e-02 eta 0:11:38
epoch [23/50] batch [4/12] time 0.561 (1.319) data 0.000 (0.747) loss 2.6465 (2.5352) lr 5.9369e-02 eta 0:07:17
epoch [23/50] batch [6/12] time 0.539 (1.060) data 0.000 (0.498) loss 2.6816 (2.5482) lr 5.9369e-02 eta 0:05:49
epoch [23/50] batch [8/12] time 0.540 (0.930) data 0.000 (0.373) loss 2.7832 (2.5686) lr 5.9369e-02 eta 0:05:05
epoch [23/50] batch [10/12] time 0.535 (0.851) data 0.000 (0.299) loss 2.7227 (2.5783) lr 5.9369e-02 eta 0:04:37
epoch [23/50] batch [12/12] time 0.535 (0.798) data 0.000 (0.249) loss 2.6875 (2.5926) lr 5.6267e-02 eta 0:04:18
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.88s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.65s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.12s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.40s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.01s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.16s/it]=> result
* total: 1,667
* correct: 598
* accuracy: 35.9%
* error: 64.1%
* macro_f1: 32.7%

epoch [24/50] batch [2/12] time 0.524 (2.041) data 0.000 (1.491) loss 2.5508 (2.5127) lr 5.6267e-02 eta 0:10:57
epoch [24/50] batch [4/12] time 0.502 (1.271) data 0.000 (0.745) loss 2.5000 (2.5190) lr 5.6267e-02 eta 0:06:46
epoch [24/50] batch [6/12] time 0.501 (1.015) data 0.000 (0.497) loss 2.7324 (2.5850) lr 5.6267e-02 eta 0:05:22
epoch [24/50] batch [8/12] time 0.504 (0.887) data 0.000 (0.373) loss 2.5625 (2.5776) lr 5.6267e-02 eta 0:04:40
epoch [24/50] batch [10/12] time 0.503 (0.810) data 0.000 (0.298) loss 2.5352 (2.5715) lr 5.6267e-02 eta 0:04:14
epoch [24/50] batch [12/12] time 0.503 (0.759) data 0.000 (0.249) loss 2.2852 (2.5465) lr 5.3140e-02 eta 0:03:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.06s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.17s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.92s/it] 44%|████▍     | 4/9 [00:09<00:08,  1.62s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.15s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.16it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.47it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.78it/s]100%|██████████| 9/9 [00:10<00:00,  2.27it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 613
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 33.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [25/50] batch [2/12] time 0.533 (2.061) data 0.000 (1.449) loss 2.4883 (2.5664) lr 5.3140e-02 eta 0:10:38
epoch [25/50] batch [4/12] time 0.529 (1.296) data 0.000 (0.725) loss 2.6016 (2.5776) lr 5.3140e-02 eta 0:06:39
epoch [25/50] batch [6/12] time 0.532 (1.041) data 0.000 (0.483) loss 2.5410 (2.5596) lr 5.3140e-02 eta 0:05:18
epoch [25/50] batch [8/12] time 0.526 (0.913) data 0.000 (0.362) loss 2.7559 (2.5874) lr 5.3140e-02 eta 0:04:37
epoch [25/50] batch [10/12] time 0.527 (0.836) data 0.000 (0.290) loss 2.8262 (2.6096) lr 5.3140e-02 eta 0:04:12
epoch [25/50] batch [12/12] time 0.510 (0.782) data 0.000 (0.242) loss 2.4668 (2.5990) lr 5.0000e-02 eta 0:03:54
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.57s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.02s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.83s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.27s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.07it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.39it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.72it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.03it/s]100%|██████████| 9/9 [00:09<00:00,  2.55it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 599
* accuracy: 35.9%
* error: 64.1%
* macro_f1: 33.1%

epoch [26/50] batch [2/12] time 0.559 (1.748) data 0.001 (1.104) loss 2.5176 (2.5820) lr 5.0000e-02 eta 0:08:40
epoch [26/50] batch [4/12] time 0.509 (1.128) data 0.000 (0.552) loss 2.6309 (2.6230) lr 5.0000e-02 eta 0:05:33
epoch [26/50] batch [6/12] time 0.532 (0.928) data 0.000 (0.368) loss 2.5293 (2.5843) lr 5.0000e-02 eta 0:04:32
epoch [26/50] batch [8/12] time 0.531 (0.828) data 0.000 (0.276) loss 2.5664 (2.5876) lr 5.0000e-02 eta 0:04:01
epoch [26/50] batch [10/12] time 0.535 (0.769) data 0.000 (0.221) loss 2.5566 (2.6025) lr 5.0000e-02 eta 0:03:43
epoch [26/50] batch [12/12] time 0.529 (0.729) data 0.000 (0.184) loss 2.5586 (2.6034) lr 4.6860e-02 eta 0:03:30
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.05s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.16s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.91s/it] 44%|████▍     | 4/9 [00:09<00:08,  1.64s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.16s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.15it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.46it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.78it/s]100%|██████████| 9/9 [00:10<00:00,  2.27it/s]100%|██████████| 9/9 [00:10<00:00,  1.19s/it]=> result
* total: 1,667
* correct: 607
* accuracy: 36.4%
* error: 63.6%
* macro_f1: 33.5%

epoch [27/50] batch [2/12] time 0.582 (1.811) data 0.000 (1.136) loss 2.5977 (2.6006) lr 4.6860e-02 eta 0:08:37
epoch [27/50] batch [4/12] time 0.505 (1.159) data 0.000 (0.568) loss 2.5059 (2.5801) lr 4.6860e-02 eta 0:05:29
epoch [27/50] batch [6/12] time 0.508 (0.942) data 0.000 (0.379) loss 2.8750 (2.6484) lr 4.6860e-02 eta 0:04:25
epoch [27/50] batch [8/12] time 0.507 (0.833) data 0.000 (0.284) loss 2.5430 (2.6021) lr 4.6860e-02 eta 0:03:53
epoch [27/50] batch [10/12] time 0.504 (0.767) data 0.000 (0.227) loss 2.4883 (2.5965) lr 4.6860e-02 eta 0:03:33
epoch [27/50] batch [12/12] time 0.507 (0.724) data 0.000 (0.190) loss 2.5234 (2.5924) lr 4.3733e-02 eta 0:03:19
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.58s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.95s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:08<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:08<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:09<00:00,  2.51it/s]100%|██████████| 9/9 [00:09<00:00,  1.05s/it]=> result
* total: 1,667
* correct: 615
* accuracy: 36.9%
* error: 63.1%
* macro_f1: 33.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [28/50] batch [2/12] time 0.543 (2.060) data 0.000 (1.458) loss 2.4336 (2.5547) lr 4.3733e-02 eta 0:09:24
epoch [28/50] batch [4/12] time 0.533 (1.297) data 0.000 (0.729) loss 2.5664 (2.5884) lr 4.3733e-02 eta 0:05:52
epoch [28/50] batch [6/12] time 0.531 (1.042) data 0.000 (0.486) loss 2.5957 (2.5882) lr 4.3733e-02 eta 0:04:41
epoch [28/50] batch [8/12] time 0.530 (0.914) data 0.000 (0.365) loss 2.6094 (2.5842) lr 4.3733e-02 eta 0:04:04
epoch [28/50] batch [10/12] time 0.673 (0.851) data 0.000 (0.292) loss 2.6309 (2.5748) lr 4.3733e-02 eta 0:03:46
epoch [28/50] batch [12/12] time 0.529 (0.798) data 0.000 (0.243) loss 2.6699 (2.5701) lr 4.0631e-02 eta 0:03:30
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.99s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.12s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.88s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.04it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.11it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.42it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.74it/s]100%|██████████| 9/9 [00:10<00:00,  2.24it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 613
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 33.9%

epoch [29/50] batch [2/12] time 0.520 (2.007) data 0.000 (1.421) loss 2.2520 (2.4209) lr 4.0631e-02 eta 0:08:45
epoch [29/50] batch [4/12] time 0.510 (1.265) data 0.000 (0.711) loss 2.3945 (2.4482) lr 4.0631e-02 eta 0:05:29
epoch [29/50] batch [6/12] time 0.507 (1.013) data 0.000 (0.474) loss 2.5547 (2.5085) lr 4.0631e-02 eta 0:04:21
epoch [29/50] batch [8/12] time 0.506 (0.886) data 0.000 (0.356) loss 2.6133 (2.5398) lr 4.0631e-02 eta 0:03:46
epoch [29/50] batch [10/12] time 0.522 (0.811) data 0.000 (0.284) loss 2.5859 (2.5492) lr 4.0631e-02 eta 0:03:26
epoch [29/50] batch [12/12] time 0.507 (0.761) data 0.000 (0.237) loss 2.5156 (2.5412) lr 3.7566e-02 eta 0:03:11
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.83s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.06s/it] 33%|███▎      | 3/9 [00:08<00:14,  2.45s/it] 44%|████▍     | 4/9 [00:09<00:08,  1.61s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.14s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.17it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.48it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.80it/s]100%|██████████| 9/9 [00:10<00:00,  2.29it/s]100%|██████████| 9/9 [00:10<00:00,  1.20s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 34.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [30/50] batch [2/12] time 0.531 (2.081) data 0.001 (1.523) loss 2.4258 (2.5156) lr 3.7566e-02 eta 0:08:40
epoch [30/50] batch [4/12] time 0.530 (1.307) data 0.000 (0.762) loss 2.5430 (2.5879) lr 3.7566e-02 eta 0:05:24
epoch [30/50] batch [6/12] time 0.530 (1.047) data 0.000 (0.508) loss 2.6426 (2.5986) lr 3.7566e-02 eta 0:04:17
epoch [30/50] batch [8/12] time 0.531 (0.919) data 0.000 (0.381) loss 2.5234 (2.5930) lr 3.7566e-02 eta 0:03:44
epoch [30/50] batch [10/12] time 0.536 (0.842) data 0.000 (0.305) loss 2.5527 (2.5918) lr 3.7566e-02 eta 0:03:23
epoch [30/50] batch [12/12] time 0.521 (0.788) data 0.000 (0.254) loss 2.4453 (2.5949) lr 3.4549e-02 eta 0:03:09
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.52s/it] 22%|██▏       | 2/9 [00:08<00:27,  3.92s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.27s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.49s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.06s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.40it/s]100%|██████████| 9/9 [00:10<00:00,  1.19s/it]=> result
* total: 1,667
* correct: 621
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/12] time 0.516 (1.956) data 0.000 (1.349) loss 2.3613 (2.5391) lr 3.4549e-02 eta 0:07:45
epoch [31/50] batch [4/12] time 0.534 (1.245) data 0.000 (0.675) loss 2.5371 (2.5522) lr 3.4549e-02 eta 0:04:53
epoch [31/50] batch [6/12] time 0.533 (1.007) data 0.000 (0.450) loss 2.6250 (2.5775) lr 3.4549e-02 eta 0:03:55
epoch [31/50] batch [8/12] time 0.539 (0.890) data 0.000 (0.338) loss 2.7500 (2.5938) lr 3.4549e-02 eta 0:03:26
epoch [31/50] batch [10/12] time 0.544 (0.819) data 0.000 (0.270) loss 2.3535 (2.5756) lr 3.4549e-02 eta 0:03:08
epoch [31/50] batch [12/12] time 0.547 (0.773) data 0.000 (0.225) loss 2.4883 (2.5589) lr 3.1594e-02 eta 0:02:56
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.97s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.18s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.92s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.38s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.00it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.93it/s]100%|██████████| 9/9 [00:09<00:00,  2.43it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 618
* accuracy: 37.1%
* error: 62.9%
* macro_f1: 34.2%

epoch [32/50] batch [2/12] time 0.517 (2.042) data 0.000 (1.513) loss 2.2578 (2.3662) lr 3.1594e-02 eta 0:07:41
epoch [32/50] batch [4/12] time 0.515 (1.277) data 0.000 (0.757) loss 2.5000 (2.4492) lr 3.1594e-02 eta 0:04:46
epoch [32/50] batch [6/12] time 0.517 (1.023) data 0.000 (0.504) loss 2.6074 (2.5391) lr 3.1594e-02 eta 0:03:47
epoch [32/50] batch [8/12] time 0.519 (0.896) data 0.000 (0.378) loss 2.3906 (2.4998) lr 3.1594e-02 eta 0:03:17
epoch [32/50] batch [10/12] time 0.516 (0.820) data 0.000 (0.303) loss 2.5215 (2.5193) lr 3.1594e-02 eta 0:02:58
epoch [32/50] batch [12/12] time 0.527 (0.771) data 0.000 (0.252) loss 2.6973 (2.5373) lr 2.8711e-02 eta 0:02:46
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.59s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.55s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.07s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.37s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.01it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.32it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 34.0%

epoch [33/50] batch [2/12] time 0.546 (2.145) data 0.000 (1.533) loss 2.5781 (2.5410) lr 2.8711e-02 eta 0:07:38
epoch [33/50] batch [4/12] time 0.545 (1.345) data 0.000 (0.767) loss 2.8770 (2.5879) lr 2.8711e-02 eta 0:04:45
epoch [33/50] batch [6/12] time 0.540 (1.077) data 0.000 (0.511) loss 2.3379 (2.5430) lr 2.8711e-02 eta 0:03:46
epoch [33/50] batch [8/12] time 0.532 (0.940) data 0.000 (0.383) loss 2.6660 (2.5544) lr 2.8711e-02 eta 0:03:15
epoch [33/50] batch [10/12] time 0.527 (0.858) data 0.000 (0.307) loss 2.5547 (2.5480) lr 2.8711e-02 eta 0:02:56
epoch [33/50] batch [12/12] time 0.540 (0.804) data 0.000 (0.256) loss 2.6250 (2.5537) lr 2.5912e-02 eta 0:02:43
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.81s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.08s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.86s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.56s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.11s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.20it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.52it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.84it/s]100%|██████████| 9/9 [00:10<00:00,  2.34it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 624
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 34.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [34/50] batch [2/12] time 0.519 (2.014) data 0.000 (1.457) loss 2.5703 (2.4795) lr 2.5912e-02 eta 0:06:46
epoch [34/50] batch [4/12] time 0.517 (1.265) data 0.000 (0.728) loss 2.8047 (2.5396) lr 2.5912e-02 eta 0:04:13
epoch [34/50] batch [6/12] time 0.521 (1.017) data 0.000 (0.486) loss 2.4648 (2.5273) lr 2.5912e-02 eta 0:03:21
epoch [34/50] batch [8/12] time 0.522 (0.893) data 0.000 (0.364) loss 2.6387 (2.5513) lr 2.5912e-02 eta 0:02:55
epoch [34/50] batch [10/12] time 0.521 (0.819) data 0.000 (0.291) loss 2.5156 (2.5330) lr 2.5912e-02 eta 0:02:38
epoch [34/50] batch [12/12] time 0.530 (0.770) data 0.000 (0.243) loss 2.5840 (2.5578) lr 2.3209e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.05s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.15s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.90s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.32s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.59it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.89it/s]100%|██████████| 9/9 [00:09<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 617
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 34.1%

epoch [35/50] batch [2/12] time 0.539 (2.065) data 0.000 (1.474) loss 2.4316 (2.4658) lr 2.3209e-02 eta 0:06:32
epoch [35/50] batch [4/12] time 0.546 (1.305) data 0.000 (0.737) loss 2.6055 (2.5215) lr 2.3209e-02 eta 0:04:05
epoch [35/50] batch [6/12] time 0.549 (1.052) data 0.000 (0.492) loss 2.4844 (2.5091) lr 2.3209e-02 eta 0:03:15
epoch [35/50] batch [8/12] time 0.527 (0.922) data 0.000 (0.369) loss 2.8281 (2.5420) lr 2.3209e-02 eta 0:02:49
epoch [35/50] batch [10/12] time 0.507 (0.840) data 0.000 (0.295) loss 2.4707 (2.5275) lr 2.3209e-02 eta 0:02:32
epoch [35/50] batch [12/12] time 0.507 (0.785) data 0.000 (0.246) loss 2.4902 (2.5293) lr 2.0611e-02 eta 0:02:21
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.61s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.97s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.80s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.13it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.45it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.77it/s]100%|██████████| 9/9 [00:09<00:00,  2.26it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 625
* accuracy: 37.5%
* error: 62.5%
* macro_f1: 34.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [36/50] batch [2/12] time 0.542 (2.008) data 0.000 (1.457) loss 2.5742 (2.4512) lr 2.0611e-02 eta 0:05:57
epoch [36/50] batch [4/12] time 0.541 (1.273) data 0.000 (0.729) loss 2.5449 (2.4941) lr 2.0611e-02 eta 0:03:44
epoch [36/50] batch [6/12] time 0.541 (1.029) data 0.000 (0.486) loss 2.5273 (2.5065) lr 2.0611e-02 eta 0:02:59
epoch [36/50] batch [8/12] time 0.539 (0.907) data 0.000 (0.365) loss 2.5371 (2.5139) lr 2.0611e-02 eta 0:02:36
epoch [36/50] batch [10/12] time 0.540 (0.834) data 0.000 (0.292) loss 2.4453 (2.5072) lr 2.0611e-02 eta 0:02:21
epoch [36/50] batch [12/12] time 0.540 (0.785) data 0.000 (0.243) loss 2.6230 (2.5272) lr 1.8129e-02 eta 0:02:11
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  7.00s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.13s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.27s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.50s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.85it/s]100%|██████████| 9/9 [00:10<00:00,  2.34it/s]100%|██████████| 9/9 [00:10<00:00,  1.17s/it]=> result
* total: 1,667
* correct: 613
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 34.0%

epoch [37/50] batch [2/12] time 0.503 (1.976) data 0.000 (1.444) loss 2.3633 (2.4600) lr 1.8129e-02 eta 0:05:27
epoch [37/50] batch [4/12] time 0.506 (1.242) data 0.000 (0.722) loss 2.5957 (2.5298) lr 1.8129e-02 eta 0:03:23
epoch [37/50] batch [6/12] time 0.507 (0.996) data 0.000 (0.482) loss 2.8594 (2.6084) lr 1.8129e-02 eta 0:02:41
epoch [37/50] batch [8/12] time 0.509 (0.874) data 0.000 (0.361) loss 2.5859 (2.5974) lr 1.8129e-02 eta 0:02:19
epoch [37/50] batch [10/12] time 0.515 (0.803) data 0.000 (0.289) loss 2.3926 (2.5889) lr 1.8129e-02 eta 0:02:06
epoch [37/50] batch [12/12] time 0.527 (0.758) data 0.000 (0.241) loss 2.4688 (2.5535) lr 1.5773e-02 eta 0:01:58
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.52s/it] 22%|██▏       | 2/9 [00:06<00:20,  2.94s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.10s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.40s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.00s/it] 67%|██████▋   | 6/9 [00:08<00:02,  1.30it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.62it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.93it/s]100%|██████████| 9/9 [00:09<00:00,  2.44it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]=> result
* total: 1,667
* correct: 616
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 34.2%

epoch [38/50] batch [2/12] time 0.639 (1.898) data 0.097 (1.246) loss 2.6191 (2.6133) lr 1.5773e-02 eta 0:04:52
epoch [38/50] batch [4/12] time 0.529 (1.214) data 0.000 (0.623) loss 2.6055 (2.5889) lr 1.5773e-02 eta 0:03:04
epoch [38/50] batch [6/12] time 0.524 (0.984) data 0.000 (0.416) loss 2.4727 (2.5049) lr 1.5773e-02 eta 0:02:27
epoch [38/50] batch [8/12] time 0.534 (0.870) data 0.000 (0.312) loss 2.6348 (2.5188) lr 1.5773e-02 eta 0:02:08
epoch [38/50] batch [10/12] time 0.538 (0.816) data 0.000 (0.249) loss 2.6973 (2.5436) lr 1.5773e-02 eta 0:01:59
epoch [38/50] batch [12/12] time 0.535 (0.769) data 0.000 (0.208) loss 2.6133 (2.5475) lr 1.3552e-02 eta 0:01:50
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.82s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.05s/it] 33%|███▎      | 3/9 [00:07<00:11,  1.84s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.53s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.09s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.22it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.54it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.85it/s]100%|██████████| 9/9 [00:10<00:00,  2.36it/s]100%|██████████| 9/9 [00:10<00:00,  1.14s/it]=> result
* total: 1,667
* correct: 620
* accuracy: 37.2%
* error: 62.8%
* macro_f1: 34.4%

epoch [39/50] batch [2/12] time 0.514 (2.009) data 0.000 (1.449) loss 2.5488 (2.4990) lr 1.3552e-02 eta 0:04:45
epoch [39/50] batch [4/12] time 0.512 (1.261) data 0.000 (0.725) loss 2.3809 (2.4258) lr 1.3552e-02 eta 0:02:56
epoch [39/50] batch [6/12] time 0.513 (1.011) data 0.000 (0.483) loss 2.4980 (2.4385) lr 1.3552e-02 eta 0:02:19
epoch [39/50] batch [8/12] time 0.513 (0.886) data 0.000 (0.362) loss 2.7500 (2.4924) lr 1.3552e-02 eta 0:02:00
epoch [39/50] batch [10/12] time 0.515 (0.813) data 0.000 (0.290) loss 2.4023 (2.5025) lr 1.3552e-02 eta 0:01:48
epoch [39/50] batch [12/12] time 0.521 (0.764) data 0.000 (0.242) loss 2.4121 (2.5107) lr 1.1474e-02 eta 0:01:40
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.02s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.14s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.19s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.45s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.04s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.58it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.89it/s]100%|██████████| 9/9 [00:10<00:00,  2.38it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 621
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.4%

epoch [40/50] batch [2/12] time 0.583 (1.868) data 0.001 (1.187) loss 2.5527 (2.4971) lr 1.1474e-02 eta 0:04:02
epoch [40/50] batch [4/12] time 0.531 (1.199) data 0.000 (0.594) loss 2.5469 (2.5200) lr 1.1474e-02 eta 0:02:33
epoch [40/50] batch [6/12] time 0.529 (0.977) data 0.000 (0.396) loss 2.5938 (2.5286) lr 1.1474e-02 eta 0:02:03
epoch [40/50] batch [8/12] time 0.525 (0.865) data 0.000 (0.297) loss 2.6211 (2.5386) lr 1.1474e-02 eta 0:01:47
epoch [40/50] batch [10/12] time 0.519 (0.795) data 0.000 (0.238) loss 2.6973 (2.5537) lr 1.1474e-02 eta 0:01:37
epoch [40/50] batch [12/12] time 0.505 (0.747) data 0.000 (0.198) loss 2.2188 (2.5176) lr 9.5492e-03 eta 0:01:29
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.65s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.99s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.50s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.24it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.56it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.88it/s]100%|██████████| 9/9 [00:09<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.11s/it]=> result
* total: 1,667
* correct: 623
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 34.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/12] time 0.528 (1.964) data 0.000 (1.377) loss 2.5391 (2.5068) lr 9.5492e-03 eta 0:03:51
epoch [41/50] batch [4/12] time 0.533 (1.249) data 0.000 (0.688) loss 2.5195 (2.4995) lr 9.5492e-03 eta 0:02:24
epoch [41/50] batch [6/12] time 0.531 (1.010) data 0.000 (0.459) loss 2.4395 (2.4941) lr 9.5492e-03 eta 0:01:55
epoch [41/50] batch [8/12] time 0.533 (0.891) data 0.000 (0.344) loss 2.6914 (2.5269) lr 9.5492e-03 eta 0:01:39
epoch [41/50] batch [10/12] time 0.536 (0.820) data 0.000 (0.276) loss 2.5977 (2.5391) lr 9.5492e-03 eta 0:01:30
epoch [41/50] batch [12/12] time 0.532 (0.772) data 0.000 (0.230) loss 2.3145 (2.5296) lr 7.7836e-03 eta 0:01:23
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.96s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.77s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.19s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.44s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.03s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.27it/s] 78%|███████▊  | 7/9 [00:10<00:01,  1.59it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.91it/s]100%|██████████| 9/9 [00:10<00:00,  2.41it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 620
* accuracy: 37.2%
* error: 62.8%
* macro_f1: 34.5%

epoch [42/50] batch [2/12] time 0.572 (1.769) data 0.000 (1.051) loss 2.6641 (2.5713) lr 7.7836e-03 eta 0:03:07
epoch [42/50] batch [4/12] time 0.503 (1.137) data 0.000 (0.526) loss 2.5508 (2.5454) lr 7.7836e-03 eta 0:01:58
epoch [42/50] batch [6/12] time 0.501 (0.926) data 0.000 (0.351) loss 2.4746 (2.4896) lr 7.7836e-03 eta 0:01:34
epoch [42/50] batch [8/12] time 0.502 (0.820) data 0.000 (0.263) loss 2.3398 (2.4688) lr 7.7836e-03 eta 0:01:21
epoch [42/50] batch [10/12] time 0.508 (0.757) data 0.000 (0.210) loss 2.5645 (2.5035) lr 7.7836e-03 eta 0:01:14
epoch [42/50] batch [12/12] time 0.538 (0.719) data 0.000 (0.175) loss 2.5156 (2.5065) lr 6.1847e-03 eta 0:01:08
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.58s/it] 22%|██▏       | 2/9 [00:07<00:20,  2.96s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.79s/it] 44%|████▍     | 4/9 [00:07<00:06,  1.25s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.09it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.39it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.70it/s]100%|██████████| 9/9 [00:09<00:00,  2.17it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 623
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 34.7%

epoch [43/50] batch [2/12] time 0.545 (2.083) data 0.001 (1.502) loss 2.6387 (2.5820) lr 6.1847e-03 eta 0:03:15
epoch [43/50] batch [4/12] time 0.548 (1.317) data 0.000 (0.751) loss 2.5586 (2.6069) lr 6.1847e-03 eta 0:02:01
epoch [43/50] batch [6/12] time 0.527 (1.055) data 0.000 (0.501) loss 2.4883 (2.5488) lr 6.1847e-03 eta 0:01:34
epoch [43/50] batch [8/12] time 0.529 (0.923) data 0.000 (0.376) loss 2.4805 (2.5508) lr 6.1847e-03 eta 0:01:21
epoch [43/50] batch [10/12] time 0.544 (0.846) data 0.000 (0.301) loss 2.5078 (2.5496) lr 6.1847e-03 eta 0:01:12
epoch [43/50] batch [12/12] time 0.536 (0.795) data 0.000 (0.251) loss 2.3125 (2.5290) lr 4.7586e-03 eta 0:01:06
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.87s/it] 22%|██▏       | 2/9 [00:08<00:25,  3.64s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.11s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.40s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.00s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.31it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.64it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.96it/s]100%|██████████| 9/9 [00:10<00:00,  2.48it/s]100%|██████████| 9/9 [00:10<00:00,  1.15s/it]=> result
* total: 1,667
* correct: 629
* accuracy: 37.7%
* error: 62.3%
* macro_f1: 35.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [44/50] batch [2/12] time 0.507 (1.959) data 0.000 (1.381) loss 2.5645 (2.5127) lr 4.7586e-03 eta 0:02:40
epoch [44/50] batch [4/12] time 0.509 (1.234) data 0.000 (0.690) loss 2.5547 (2.5005) lr 4.7586e-03 eta 0:01:38
epoch [44/50] batch [6/12] time 0.502 (0.990) data 0.000 (0.460) loss 2.7168 (2.5345) lr 4.7586e-03 eta 0:01:17
epoch [44/50] batch [8/12] time 0.504 (0.869) data 0.000 (0.345) loss 2.6484 (2.5408) lr 4.7586e-03 eta 0:01:06
epoch [44/50] batch [10/12] time 0.508 (0.797) data 0.000 (0.276) loss 2.4375 (2.5328) lr 4.7586e-03 eta 0:00:58
epoch [44/50] batch [12/12] time 0.509 (0.748) data 0.000 (0.230) loss 2.5508 (2.5308) lr 3.5112e-03 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:56,  7.00s/it] 22%|██▏       | 2/9 [00:08<00:26,  3.73s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.16s/it] 44%|████▍     | 4/9 [00:09<00:07,  1.43s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.02s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.28it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.60it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.91it/s]100%|██████████| 9/9 [00:10<00:00,  2.41it/s]100%|██████████| 9/9 [00:10<00:00,  1.18s/it]=> result
* total: 1,667
* correct: 622
* accuracy: 37.3%
* error: 62.7%
* macro_f1: 34.5%

epoch [45/50] batch [2/12] time 0.528 (2.102) data 0.000 (1.556) loss 2.4727 (2.5596) lr 3.5112e-03 eta 0:02:27
epoch [45/50] batch [4/12] time 0.527 (1.314) data 0.000 (0.778) loss 2.4160 (2.5132) lr 3.5112e-03 eta 0:01:29
epoch [45/50] batch [6/12] time 0.537 (1.055) data 0.000 (0.519) loss 2.5625 (2.5111) lr 3.5112e-03 eta 0:01:09
epoch [45/50] batch [8/12] time 0.536 (0.926) data 0.000 (0.389) loss 2.7109 (2.5198) lr 3.5112e-03 eta 0:00:59
epoch [45/50] batch [10/12] time 0.527 (0.847) data 0.000 (0.311) loss 2.7051 (2.5449) lr 3.5112e-03 eta 0:00:52
epoch [45/50] batch [12/12] time 0.511 (0.791) data 0.000 (0.260) loss 2.3867 (2.5278) lr 2.4472e-03 eta 0:00:47
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.70s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.41s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.99s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.32s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.70it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.01it/s]100%|██████████| 9/9 [00:10<00:00,  2.54it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 627
* accuracy: 37.6%
* error: 62.4%
* macro_f1: 34.7%

epoch [46/50] batch [2/12] time 0.537 (1.975) data 0.000 (1.395) loss 2.5977 (2.5703) lr 2.4472e-03 eta 0:01:54
epoch [46/50] batch [4/12] time 0.539 (1.256) data 0.000 (0.698) loss 2.7090 (2.6079) lr 2.4472e-03 eta 0:01:10
epoch [46/50] batch [6/12] time 0.540 (1.017) data 0.000 (0.465) loss 2.4863 (2.5758) lr 2.4472e-03 eta 0:00:54
epoch [46/50] batch [8/12] time 0.536 (0.898) data 0.000 (0.349) loss 2.3945 (2.5454) lr 2.4472e-03 eta 0:00:46
epoch [46/50] batch [10/12] time 0.538 (0.826) data 0.000 (0.279) loss 2.4297 (2.5369) lr 2.4472e-03 eta 0:00:41
epoch [46/50] batch [12/12] time 0.547 (0.779) data 0.000 (0.233) loss 2.5586 (2.5449) lr 1.5708e-03 eta 0:00:37
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.97s/it] 22%|██▏       | 2/9 [00:07<00:22,  3.15s/it] 33%|███▎      | 3/9 [00:08<00:13,  2.23s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.47s/it] 56%|█████▌    | 5/9 [00:09<00:04,  1.05s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.25it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.57it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.88it/s]100%|██████████| 9/9 [00:10<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.16s/it]=> result
* total: 1,667
* correct: 627
* accuracy: 37.6%
* error: 62.4%
* macro_f1: 34.9%

epoch [47/50] batch [2/12] time 0.571 (1.783) data 0.000 (1.129) loss 2.6250 (2.5459) lr 1.5708e-03 eta 0:01:22
epoch [47/50] batch [4/12] time 0.508 (1.148) data 0.000 (0.565) loss 2.5605 (2.5522) lr 1.5708e-03 eta 0:00:50
epoch [47/50] batch [6/12] time 0.509 (0.934) data 0.000 (0.377) loss 2.6953 (2.5586) lr 1.5708e-03 eta 0:00:39
epoch [47/50] batch [8/12] time 0.501 (0.826) data 0.000 (0.282) loss 2.5527 (2.5444) lr 1.5708e-03 eta 0:00:33
epoch [47/50] batch [10/12] time 0.510 (0.762) data 0.000 (0.226) loss 2.4160 (2.5496) lr 1.5708e-03 eta 0:00:28
epoch [47/50] batch [12/12] time 0.528 (0.721) data 0.000 (0.188) loss 2.4453 (2.5262) lr 8.8564e-04 eta 0:00:25
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:01,  7.68s/it] 22%|██▏       | 2/9 [00:07<00:23,  3.34s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.96s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.30s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.06it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.37it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  2.00it/s]100%|██████████| 9/9 [00:10<00:00,  2.51it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]=> result
* total: 1,667
* correct: 630
* accuracy: 37.8%
* error: 62.2%
* macro_f1: 35.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [48/50] batch [2/12] time 0.781 (1.913) data 0.000 (1.112) loss 2.4473 (2.4746) lr 8.8564e-04 eta 0:01:05
epoch [48/50] batch [4/12] time 0.539 (1.226) data 0.000 (0.556) loss 2.8047 (2.6089) lr 8.8564e-04 eta 0:00:39
epoch [48/50] batch [6/12] time 0.540 (0.998) data 0.000 (0.371) loss 2.5020 (2.5840) lr 8.8564e-04 eta 0:00:29
epoch [48/50] batch [8/12] time 0.537 (0.883) data 0.000 (0.278) loss 2.5586 (2.5801) lr 8.8564e-04 eta 0:00:24
epoch [48/50] batch [10/12] time 0.529 (0.813) data 0.000 (0.223) loss 2.5723 (2.5584) lr 8.8564e-04 eta 0:00:21
epoch [48/50] batch [12/12] time 0.535 (0.766) data 0.000 (0.186) loss 2.5586 (2.5431) lr 3.9426e-04 eta 0:00:18
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:54,  6.80s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.07s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.13s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.41s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.01s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.30it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.63it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.95it/s]100%|██████████| 9/9 [00:09<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]=> result
* total: 1,667
* correct: 628
* accuracy: 37.7%
* error: 62.3%
* macro_f1: 34.9%

epoch [49/50] batch [2/12] time 0.521 (2.002) data 0.000 (1.449) loss 2.5801 (2.6045) lr 3.9426e-04 eta 0:00:44
epoch [49/50] batch [4/12] time 0.516 (1.259) data 0.000 (0.724) loss 2.4238 (2.5405) lr 3.9426e-04 eta 0:00:25
epoch [49/50] batch [6/12] time 0.516 (1.011) data 0.000 (0.483) loss 2.4883 (2.5042) lr 3.9426e-04 eta 0:00:18
epoch [49/50] batch [8/12] time 0.513 (0.887) data 0.000 (0.362) loss 2.6289 (2.5188) lr 3.9426e-04 eta 0:00:14
epoch [49/50] batch [10/12] time 0.516 (0.813) data 0.000 (0.290) loss 2.5000 (2.5129) lr 3.9426e-04 eta 0:00:11
epoch [49/50] batch [12/12] time 0.513 (0.763) data 0.000 (0.242) loss 2.5352 (2.5195) lr 9.8664e-05 eta 0:00:09
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:04,  8.09s/it] 22%|██▏       | 2/9 [00:08<00:24,  3.51s/it] 33%|███▎      | 3/9 [00:08<00:12,  2.05s/it] 44%|████▍     | 4/9 [00:09<00:06,  1.36s/it] 56%|█████▌    | 5/9 [00:09<00:03,  1.02it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.33it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.65it/s] 89%|████████▉ | 8/9 [00:10<00:00,  1.95it/s]100%|██████████| 9/9 [00:10<00:00,  2.46it/s]100%|██████████| 9/9 [00:10<00:00,  1.17s/it]=> result
* total: 1,667
* correct: 633
* accuracy: 38.0%
* error: 62.0%
* macro_f1: 35.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [50/50] batch [2/12] time 0.536 (2.078) data 0.001 (1.482) loss 2.5586 (2.5771) lr 9.8664e-05 eta 0:00:20
epoch [50/50] batch [4/12] time 0.525 (1.302) data 0.000 (0.741) loss 2.5391 (2.5454) lr 9.8664e-05 eta 0:00:10
epoch [50/50] batch [6/12] time 0.528 (1.045) data 0.000 (0.494) loss 2.4785 (2.5511) lr 9.8664e-05 eta 0:00:06
epoch [50/50] batch [8/12] time 0.520 (0.914) data 0.000 (0.371) loss 2.5137 (2.5261) lr 9.8664e-05 eta 0:00:03
epoch [50/50] batch [10/12] time 0.511 (0.834) data 0.000 (0.297) loss 2.6055 (2.5318) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [12/12] time 0.514 (0.780) data 0.000 (0.247) loss 2.3008 (2.4977) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:52,  6.56s/it] 22%|██▏       | 2/9 [00:07<00:21,  3.02s/it] 33%|███▎      | 3/9 [00:07<00:10,  1.82s/it] 44%|████▍     | 4/9 [00:08<00:07,  1.51s/it] 56%|█████▌    | 5/9 [00:08<00:04,  1.07s/it] 67%|██████▋   | 6/9 [00:09<00:02,  1.23it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.55it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.87it/s]100%|██████████| 9/9 [00:09<00:00,  2.39it/s]100%|██████████| 9/9 [00:10<00:00,  1.12s/it]
=> result
* total: 1,667
* correct: 629
* accuracy: 37.7%
* error: 62.3%
* macro_f1: 35.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar" (epoch = 49)
Evaluate on the *test* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<01:00,  7.61s/it] 22%|██▏       | 2/9 [00:08<00:23,  3.39s/it] 33%|███▎      | 3/9 [00:08<00:11,  1.98s/it] 44%|████▍     | 4/9 [00:08<00:06,  1.32s/it] 56%|█████▌    | 5/9 [00:08<00:03,  1.05it/s] 67%|██████▋   | 6/9 [00:09<00:02,  1.36it/s] 78%|███████▊  | 7/9 [00:09<00:01,  1.69it/s] 89%|████████▉ | 8/9 [00:09<00:00,  1.99it/s]100%|██████████| 9/9 [00:10<00:00,  2.49it/s]100%|██████████| 9/9 [00:10<00:00,  1.13s/it]
=> result
* total: 1,666
* correct: 642
* accuracy: 38.5%
* error: 61.5%
* macro_f1: 35.6%
Elapsed: 0:16:33
+ sh scripts/rpo_prime/base2new_test_sdl.sh fgvc_aircraft 3 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/fgvc_aircraft.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: FGVCAircraft
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:FGVCAircraft
Loading dataset: FGVCAircraft
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/fgvc-aircraft/data/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE NEW CLASSES!
800 1666 1667
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------
Dataset    FGVCAircraft
# classes  50
# train_x  800
# val      1,666
# test     1,667
---------  ------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/fgvc_aircraft/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar" (epoch = 49)
Evaluate on the *test* set
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:09<01:14,  9.26s/it] 22%|██▏       | 2/9 [00:09<00:27,  3.99s/it] 33%|███▎      | 3/9 [00:09<00:13,  2.31s/it] 44%|████▍     | 4/9 [00:10<00:07,  1.52s/it] 56%|█████▌    | 5/9 [00:10<00:04,  1.08s/it] 67%|██████▋   | 6/9 [00:10<00:02,  1.22it/s] 78%|███████▊  | 7/9 [00:11<00:01,  1.54it/s] 89%|████████▉ | 8/9 [00:11<00:00,  1.85it/s]100%|██████████| 9/9 [00:11<00:00,  2.35it/s]100%|██████████| 9/9 [00:11<00:00,  1.30s/it]
=> result
* total: 1,667
* correct: 575
* accuracy: 34.5%
* error: 65.5%
* macro_f1: 31.5%
+ for dataset in eurosat dtd fgvc_aircraft oxford_flowers
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh oxford_flowers 1 0 main_tmp1_0.1sdl 16
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordFlowers
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:OxfordFlowers
Loading dataset: OxfordFlowers
Reading split from /shared/s2/lab01/dataset/clip/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_flowers/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE BASE CLASSES!
816 696 1053
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------
Dataset    OxfordFlowers
# classes  51
# train_x  816
# val      696
# test     1,053
---------  -------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/12] time 0.517 (2.300) data 0.001 (0.746) loss 2.9844 (3.1396) lr 1.0000e-01 eta 0:22:55
epoch [1/50] batch [4/12] time 0.518 (1.409) data 0.000 (0.373) loss 2.9336 (2.9927) lr 1.0000e-01 eta 0:13:59
epoch [1/50] batch [6/12] time 0.524 (1.113) data 0.000 (0.249) loss 2.3926 (2.8255) lr 1.0000e-01 eta 0:11:01
epoch [1/50] batch [8/12] time 0.545 (0.971) data 0.000 (0.187) loss 2.0000 (2.6592) lr 1.0000e-01 eta 0:09:34
epoch [1/50] batch [10/12] time 0.512 (0.879) data 0.000 (0.149) loss 2.2051 (2.5824) lr 1.0000e-01 eta 0:08:38
epoch [1/50] batch [12/12] time 0.513 (0.818) data 0.000 (0.125) loss 2.1582 (2.5070) lr 9.9901e-02 eta 0:08:01
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.44s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 495
* accuracy: 71.1%
* error: 28.9%
* macro_f1: 63.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/12] time 0.531 (1.446) data 0.000 (0.900) loss 2.0547 (2.1455) lr 9.9901e-02 eta 0:14:07
epoch [2/50] batch [4/12] time 0.534 (0.990) data 0.000 (0.450) loss 2.2559 (2.2192) lr 9.9901e-02 eta 0:09:38
epoch [2/50] batch [6/12] time 0.529 (0.837) data 0.000 (0.300) loss 2.0605 (2.1579) lr 9.9901e-02 eta 0:08:07
epoch [2/50] batch [8/12] time 0.530 (0.760) data 0.000 (0.225) loss 2.1660 (2.1188) lr 9.9901e-02 eta 0:07:20
epoch [2/50] batch [10/12] time 0.528 (0.713) data 0.000 (0.180) loss 1.8672 (2.1009) lr 9.9901e-02 eta 0:06:52
epoch [2/50] batch [12/12] time 0.535 (0.683) data 0.000 (0.150) loss 1.8408 (2.0755) lr 9.9606e-02 eta 0:06:33
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.37s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 504
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 64.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/12] time 0.525 (1.292) data 0.001 (0.661) loss 1.9727 (2.0449) lr 9.9606e-02 eta 0:12:21
epoch [3/50] batch [4/12] time 0.527 (0.909) data 0.000 (0.331) loss 1.8945 (2.0610) lr 9.9606e-02 eta 0:08:40
epoch [3/50] batch [6/12] time 0.516 (0.780) data 0.000 (0.220) loss 2.0645 (2.0365) lr 9.9606e-02 eta 0:07:24
epoch [3/50] batch [8/12] time 0.504 (0.711) data 0.000 (0.165) loss 1.9150 (2.0206) lr 9.9606e-02 eta 0:06:44
epoch [3/50] batch [10/12] time 0.502 (0.670) data 0.000 (0.132) loss 1.9863 (2.0259) lr 9.9606e-02 eta 0:06:18
epoch [3/50] batch [12/12] time 0.512 (0.643) data 0.000 (0.110) loss 1.8066 (1.9972) lr 9.9114e-02 eta 0:06:02
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.16s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.01s/it]=> result
* total: 696
* correct: 511
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 67.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/12] time 0.513 (1.260) data 0.001 (0.636) loss 1.9160 (1.8623) lr 9.9114e-02 eta 0:11:48
epoch [4/50] batch [4/12] time 0.512 (0.887) data 0.000 (0.318) loss 1.6914 (1.8774) lr 9.9114e-02 eta 0:08:16
epoch [4/50] batch [6/12] time 0.516 (0.763) data 0.000 (0.212) loss 1.6484 (1.8617) lr 9.9114e-02 eta 0:07:05
epoch [4/50] batch [8/12] time 0.509 (0.700) data 0.000 (0.159) loss 1.9453 (1.8804) lr 9.9114e-02 eta 0:06:29
epoch [4/50] batch [10/12] time 0.509 (0.662) data 0.000 (0.128) loss 2.1992 (1.9128) lr 9.9114e-02 eta 0:06:06
epoch [4/50] batch [12/12] time 0.518 (0.637) data 0.000 (0.106) loss 1.8779 (1.9066) lr 9.8429e-02 eta 0:05:51
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 509
* accuracy: 73.1%
* error: 26.9%
* macro_f1: 66.9%

epoch [5/50] batch [2/12] time 0.531 (1.305) data 0.001 (0.673) loss 2.0957 (1.9995) lr 9.8429e-02 eta 0:11:57
epoch [5/50] batch [4/12] time 0.532 (0.918) data 0.000 (0.337) loss 1.9160 (2.0046) lr 9.8429e-02 eta 0:08:23
epoch [5/50] batch [6/12] time 0.530 (0.789) data 0.000 (0.225) loss 1.6855 (1.9447) lr 9.8429e-02 eta 0:07:10
epoch [5/50] batch [8/12] time 0.527 (0.723) data 0.000 (0.169) loss 1.6904 (1.9111) lr 9.8429e-02 eta 0:06:33
epoch [5/50] batch [10/12] time 0.529 (0.684) data 0.000 (0.135) loss 1.7939 (1.8897) lr 9.8429e-02 eta 0:06:10
epoch [5/50] batch [12/12] time 0.527 (0.658) data 0.000 (0.112) loss 1.9824 (1.8865) lr 9.7553e-02 eta 0:05:55
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.39s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 518
* accuracy: 74.4%
* error: 25.6%
* macro_f1: 68.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [6/50] batch [2/12] time 0.504 (1.309) data 0.000 (0.780) loss 1.7217 (1.8447) lr 9.7553e-02 eta 0:11:44
epoch [6/50] batch [4/12] time 0.504 (0.907) data 0.000 (0.390) loss 2.1621 (1.9377) lr 9.7553e-02 eta 0:08:06
epoch [6/50] batch [6/12] time 0.504 (0.773) data 0.000 (0.260) loss 1.7979 (1.8779) lr 9.7553e-02 eta 0:06:52
epoch [6/50] batch [8/12] time 0.505 (0.706) data 0.000 (0.195) loss 1.9062 (1.8740) lr 9.7553e-02 eta 0:06:15
epoch [6/50] batch [10/12] time 0.513 (0.667) data 0.000 (0.156) loss 1.7803 (1.8697) lr 9.7553e-02 eta 0:05:53
epoch [6/50] batch [12/12] time 0.521 (0.642) data 0.000 (0.130) loss 1.7969 (1.8674) lr 9.6489e-02 eta 0:05:38
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 528
* accuracy: 75.9%
* error: 24.1%
* macro_f1: 71.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [7/50] batch [2/12] time 0.516 (1.245) data 0.001 (0.629) loss 1.9678 (1.9214) lr 9.6489e-02 eta 0:10:55
epoch [7/50] batch [4/12] time 0.517 (0.880) data 0.000 (0.315) loss 1.8535 (1.8923) lr 9.6489e-02 eta 0:07:41
epoch [7/50] batch [6/12] time 0.542 (0.764) data 0.000 (0.210) loss 1.6211 (1.8739) lr 9.6489e-02 eta 0:06:38
epoch [7/50] batch [8/12] time 0.541 (0.708) data 0.000 (0.157) loss 1.5527 (1.8368) lr 9.6489e-02 eta 0:06:08
epoch [7/50] batch [10/12] time 0.551 (0.677) data 0.000 (0.126) loss 1.8652 (1.8343) lr 9.6489e-02 eta 0:05:50
epoch [7/50] batch [12/12] time 0.547 (0.656) data 0.000 (0.105) loss 1.9375 (1.8534) lr 9.5241e-02 eta 0:05:38
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.37s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 519
* accuracy: 74.6%
* error: 25.4%
* macro_f1: 69.6%

epoch [8/50] batch [2/12] time 0.692 (1.371) data 0.001 (0.661) loss 2.0371 (1.9194) lr 9.5241e-02 eta 0:11:44
epoch [8/50] batch [4/12] time 0.527 (0.949) data 0.000 (0.331) loss 1.5020 (1.7834) lr 9.5241e-02 eta 0:08:06
epoch [8/50] batch [6/12] time 0.530 (0.809) data 0.000 (0.221) loss 1.7402 (1.8092) lr 9.5241e-02 eta 0:06:52
epoch [8/50] batch [8/12] time 0.525 (0.738) data 0.000 (0.166) loss 1.9355 (1.8147) lr 9.5241e-02 eta 0:06:14
epoch [8/50] batch [10/12] time 0.525 (0.695) data 0.000 (0.132) loss 1.6699 (1.8299) lr 9.5241e-02 eta 0:05:51
epoch [8/50] batch [12/12] time 0.528 (0.667) data 0.000 (0.110) loss 1.8818 (1.8291) lr 9.3815e-02 eta 0:05:36
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 526
* accuracy: 75.6%
* error: 24.4%
* macro_f1: 71.4%

epoch [9/50] batch [2/12] time 0.505 (1.289) data 0.000 (0.742) loss 1.6895 (1.6211) lr 9.3815e-02 eta 0:10:47
epoch [9/50] batch [4/12] time 0.511 (0.901) data 0.000 (0.371) loss 1.7041 (1.6638) lr 9.3815e-02 eta 0:07:30
epoch [9/50] batch [6/12] time 0.536 (0.778) data 0.000 (0.247) loss 1.8975 (1.7178) lr 9.3815e-02 eta 0:06:27
epoch [9/50] batch [8/12] time 0.513 (0.712) data 0.000 (0.186) loss 1.8867 (1.7322) lr 9.3815e-02 eta 0:05:53
epoch [9/50] batch [10/12] time 0.514 (0.673) data 0.000 (0.149) loss 1.9922 (1.7701) lr 9.3815e-02 eta 0:05:32
epoch [9/50] batch [12/12] time 0.515 (0.647) data 0.000 (0.124) loss 1.9990 (1.7988) lr 9.2216e-02 eta 0:05:18
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.15s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 526
* accuracy: 75.6%
* error: 24.4%
* macro_f1: 71.3%

epoch [10/50] batch [2/12] time 0.532 (1.386) data 0.000 (0.809) loss 1.7021 (1.7715) lr 9.2216e-02 eta 0:11:19
epoch [10/50] batch [4/12] time 0.535 (0.960) data 0.000 (0.404) loss 1.6475 (1.7678) lr 9.2216e-02 eta 0:07:48
epoch [10/50] batch [6/12] time 0.531 (0.818) data 0.000 (0.270) loss 1.8086 (1.7559) lr 9.2216e-02 eta 0:06:37
epoch [10/50] batch [8/12] time 0.542 (0.747) data 0.000 (0.202) loss 1.8516 (1.7582) lr 9.2216e-02 eta 0:06:01
epoch [10/50] batch [10/12] time 0.541 (0.706) data 0.000 (0.162) loss 1.8936 (1.7650) lr 9.2216e-02 eta 0:05:40
epoch [10/50] batch [12/12] time 0.537 (0.678) data 0.000 (0.135) loss 2.1172 (1.7904) lr 9.0451e-02 eta 0:05:25
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.32s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 536
* accuracy: 77.0%
* error: 23.0%
* macro_f1: 72.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/12] time 0.531 (1.371) data 0.000 (0.813) loss 1.5869 (1.6562) lr 9.0451e-02 eta 0:10:55
epoch [11/50] batch [4/12] time 0.543 (0.953) data 0.000 (0.407) loss 1.6689 (1.6941) lr 9.0451e-02 eta 0:07:33
epoch [11/50] batch [6/12] time 0.510 (0.810) data 0.000 (0.271) loss 1.9170 (1.7676) lr 9.0451e-02 eta 0:06:23
epoch [11/50] batch [8/12] time 0.504 (0.733) data 0.000 (0.204) loss 1.8936 (1.7930) lr 9.0451e-02 eta 0:05:45
epoch [11/50] batch [10/12] time 0.502 (0.686) data 0.000 (0.163) loss 1.7490 (1.7844) lr 9.0451e-02 eta 0:05:22
epoch [11/50] batch [12/12] time 0.503 (0.656) data 0.000 (0.136) loss 1.7158 (1.7772) lr 8.8526e-02 eta 0:05:07
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 532
* accuracy: 76.4%
* error: 23.6%
* macro_f1: 72.3%

epoch [12/50] batch [2/12] time 0.507 (1.321) data 0.000 (0.781) loss 1.7979 (1.7178) lr 8.8526e-02 eta 0:10:15
epoch [12/50] batch [4/12] time 0.510 (0.915) data 0.000 (0.391) loss 1.4834 (1.6787) lr 8.8526e-02 eta 0:07:04
epoch [12/50] batch [6/12] time 0.512 (0.780) data 0.000 (0.261) loss 1.5830 (1.7056) lr 8.8526e-02 eta 0:06:00
epoch [12/50] batch [8/12] time 0.506 (0.712) data 0.000 (0.195) loss 1.9629 (1.7328) lr 8.8526e-02 eta 0:05:27
epoch [12/50] batch [10/12] time 0.511 (0.671) data 0.000 (0.156) loss 1.5410 (1.7218) lr 8.8526e-02 eta 0:05:07
epoch [12/50] batch [12/12] time 0.518 (0.645) data 0.000 (0.130) loss 2.0898 (1.7563) lr 8.6448e-02 eta 0:04:54
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 536
* accuracy: 77.0%
* error: 23.0%
* macro_f1: 73.0%

epoch [13/50] batch [2/12] time 0.533 (1.368) data 0.000 (0.768) loss 1.9688 (1.9292) lr 8.6448e-02 eta 0:10:20
epoch [13/50] batch [4/12] time 0.539 (0.953) data 0.000 (0.384) loss 1.5615 (1.7993) lr 8.6448e-02 eta 0:07:10
epoch [13/50] batch [6/12] time 0.530 (0.812) data 0.000 (0.256) loss 1.8057 (1.7931) lr 8.6448e-02 eta 0:06:05
epoch [13/50] batch [8/12] time 0.527 (0.740) data 0.000 (0.192) loss 1.7559 (1.7661) lr 8.6448e-02 eta 0:05:31
epoch [13/50] batch [10/12] time 0.529 (0.698) data 0.000 (0.154) loss 1.6719 (1.7553) lr 8.6448e-02 eta 0:05:11
epoch [13/50] batch [12/12] time 0.532 (0.670) data 0.000 (0.128) loss 1.8174 (1.7526) lr 8.4227e-02 eta 0:04:57
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.32s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 546
* accuracy: 78.4%
* error: 21.6%
* macro_f1: 74.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [14/50] batch [2/12] time 0.517 (1.322) data 0.000 (0.766) loss 1.6689 (1.7485) lr 8.4227e-02 eta 0:09:44
epoch [14/50] batch [4/12] time 0.516 (0.920) data 0.000 (0.383) loss 1.6338 (1.6912) lr 8.4227e-02 eta 0:06:44
epoch [14/50] batch [6/12] time 0.516 (0.785) data 0.000 (0.255) loss 1.8086 (1.7057) lr 8.4227e-02 eta 0:05:43
epoch [14/50] batch [8/12] time 0.513 (0.717) data 0.000 (0.192) loss 1.8789 (1.7290) lr 8.4227e-02 eta 0:05:12
epoch [14/50] batch [10/12] time 0.519 (0.677) data 0.000 (0.153) loss 1.7051 (1.7148) lr 8.4227e-02 eta 0:04:53
epoch [14/50] batch [12/12] time 0.529 (0.652) data 0.000 (0.128) loss 1.6514 (1.7179) lr 8.1871e-02 eta 0:04:41
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.23s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 546
* accuracy: 78.4%
* error: 21.6%
* macro_f1: 75.0%

epoch [15/50] batch [2/12] time 0.508 (1.297) data 0.000 (0.768) loss 1.6719 (1.7241) lr 8.1871e-02 eta 0:09:17
epoch [15/50] batch [4/12] time 0.531 (0.909) data 0.000 (0.384) loss 1.7178 (1.7407) lr 8.1871e-02 eta 0:06:28
epoch [15/50] batch [6/12] time 0.530 (0.783) data 0.000 (0.256) loss 1.6348 (1.7049) lr 8.1871e-02 eta 0:05:33
epoch [15/50] batch [8/12] time 0.532 (0.720) data 0.000 (0.192) loss 1.6533 (1.7153) lr 8.1871e-02 eta 0:05:05
epoch [15/50] batch [10/12] time 0.532 (0.683) data 0.000 (0.154) loss 1.7207 (1.7405) lr 8.1871e-02 eta 0:04:48
epoch [15/50] batch [12/12] time 0.528 (0.657) data 0.000 (0.128) loss 1.7666 (1.7316) lr 7.9389e-02 eta 0:04:35
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.43s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 546
* accuracy: 78.4%
* error: 21.6%
* macro_f1: 74.8%

epoch [16/50] batch [2/12] time 0.530 (1.261) data 0.000 (0.633) loss 1.6738 (1.6792) lr 7.9389e-02 eta 0:08:47
epoch [16/50] batch [4/12] time 0.525 (0.894) data 0.000 (0.317) loss 1.8799 (1.7512) lr 7.9389e-02 eta 0:06:11
epoch [16/50] batch [6/12] time 0.530 (0.773) data 0.000 (0.211) loss 1.5693 (1.6701) lr 7.9389e-02 eta 0:05:20
epoch [16/50] batch [8/12] time 0.526 (0.712) data 0.000 (0.158) loss 1.7822 (1.6803) lr 7.9389e-02 eta 0:04:53
epoch [16/50] batch [10/12] time 0.530 (0.675) data 0.000 (0.127) loss 1.6113 (1.6839) lr 7.9389e-02 eta 0:04:36
epoch [16/50] batch [12/12] time 0.519 (0.650) data 0.000 (0.106) loss 1.8604 (1.6879) lr 7.6791e-02 eta 0:04:25
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 547
* accuracy: 78.6%
* error: 21.4%
* macro_f1: 75.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [17/50] batch [2/12] time 0.509 (1.313) data 0.000 (0.770) loss 1.6006 (1.6670) lr 7.6791e-02 eta 0:08:53
epoch [17/50] batch [4/12] time 0.530 (0.917) data 0.000 (0.385) loss 1.6631 (1.7058) lr 7.6791e-02 eta 0:06:10
epoch [17/50] batch [6/12] time 0.521 (0.788) data 0.000 (0.257) loss 1.7861 (1.7202) lr 7.6791e-02 eta 0:05:16
epoch [17/50] batch [8/12] time 0.518 (0.721) data 0.000 (0.193) loss 1.9375 (1.7626) lr 7.6791e-02 eta 0:04:48
epoch [17/50] batch [10/12] time 0.629 (0.691) data 0.000 (0.154) loss 1.4531 (1.7197) lr 7.6791e-02 eta 0:04:35
epoch [17/50] batch [12/12] time 0.504 (0.660) data 0.000 (0.129) loss 1.6172 (1.7147) lr 7.4088e-02 eta 0:04:21
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.26s/it] 50%|█████     | 2/4 [00:03<00:03,  1.53s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 558
* accuracy: 80.2%
* error: 19.8%
* macro_f1: 77.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [18/50] batch [2/12] time 0.549 (1.403) data 0.000 (0.800) loss 1.6689 (1.7148) lr 7.4088e-02 eta 0:09:12
epoch [18/50] batch [4/12] time 0.546 (0.979) data 0.000 (0.400) loss 1.5020 (1.6409) lr 7.4088e-02 eta 0:06:23
epoch [18/50] batch [6/12] time 0.545 (0.835) data 0.000 (0.267) loss 1.6631 (1.6370) lr 7.4088e-02 eta 0:05:25
epoch [18/50] batch [8/12] time 0.540 (0.761) data 0.000 (0.200) loss 1.4609 (1.6216) lr 7.4088e-02 eta 0:04:55
epoch [18/50] batch [10/12] time 0.536 (0.716) data 0.000 (0.160) loss 1.7383 (1.6533) lr 7.4088e-02 eta 0:04:36
epoch [18/50] batch [12/12] time 0.543 (0.687) data 0.000 (0.134) loss 1.6660 (1.6389) lr 7.1289e-02 eta 0:04:23
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.38s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 564
* accuracy: 81.0%
* error: 19.0%
* macro_f1: 78.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [19/50] batch [2/12] time 0.534 (1.373) data 0.000 (0.793) loss 1.6650 (1.7935) lr 7.1289e-02 eta 0:08:44
epoch [19/50] batch [4/12] time 0.520 (0.950) data 0.000 (0.397) loss 1.6855 (1.7517) lr 7.1289e-02 eta 0:06:00
epoch [19/50] batch [6/12] time 0.517 (0.806) data 0.000 (0.265) loss 1.5195 (1.7261) lr 7.1289e-02 eta 0:05:04
epoch [19/50] batch [8/12] time 0.516 (0.733) data 0.000 (0.199) loss 1.5723 (1.6890) lr 7.1289e-02 eta 0:04:35
epoch [19/50] batch [10/12] time 0.515 (0.690) data 0.000 (0.159) loss 1.7031 (1.6819) lr 7.1289e-02 eta 0:04:17
epoch [19/50] batch [12/12] time 0.519 (0.661) data 0.000 (0.132) loss 1.5967 (1.6643) lr 6.8406e-02 eta 0:04:06
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.23s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 569
* accuracy: 81.8%
* error: 18.2%
* macro_f1: 79.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [20/50] batch [2/12] time 0.513 (1.290) data 0.000 (0.746) loss 1.5723 (1.6514) lr 6.8406e-02 eta 0:07:57
epoch [20/50] batch [4/12] time 0.513 (0.902) data 0.000 (0.373) loss 1.5000 (1.6189) lr 6.8406e-02 eta 0:05:32
epoch [20/50] batch [6/12] time 0.516 (0.774) data 0.000 (0.249) loss 1.7617 (1.6138) lr 6.8406e-02 eta 0:04:43
epoch [20/50] batch [8/12] time 0.520 (0.710) data 0.000 (0.187) loss 1.6660 (1.6161) lr 6.8406e-02 eta 0:04:18
epoch [20/50] batch [10/12] time 0.548 (0.675) data 0.000 (0.149) loss 1.6816 (1.6333) lr 6.8406e-02 eta 0:04:04
epoch [20/50] batch [12/12] time 0.545 (0.654) data 0.000 (0.125) loss 1.7236 (1.6582) lr 6.5451e-02 eta 0:03:55
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.45s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 573
* accuracy: 82.3%
* error: 17.7%
* macro_f1: 79.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/12] time 0.546 (1.385) data 0.000 (0.787) loss 1.6602 (1.7310) lr 6.5451e-02 eta 0:08:15
epoch [21/50] batch [4/12] time 0.541 (0.964) data 0.000 (0.394) loss 1.5898 (1.6414) lr 6.5451e-02 eta 0:05:43
epoch [21/50] batch [6/12] time 0.549 (0.825) data 0.000 (0.263) loss 1.6211 (1.6434) lr 6.5451e-02 eta 0:04:52
epoch [21/50] batch [8/12] time 0.547 (0.755) data 0.000 (0.197) loss 1.6406 (1.6285) lr 6.5451e-02 eta 0:04:25
epoch [21/50] batch [10/12] time 0.536 (0.712) data 0.000 (0.158) loss 1.7148 (1.6489) lr 6.5451e-02 eta 0:04:09
epoch [21/50] batch [12/12] time 0.530 (0.681) data 0.000 (0.132) loss 1.5459 (1.6369) lr 6.2434e-02 eta 0:03:57
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.35s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 581
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 80.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [22/50] batch [2/12] time 0.509 (1.311) data 0.000 (0.788) loss 1.4531 (1.5522) lr 6.2434e-02 eta 0:07:33
epoch [22/50] batch [4/12] time 0.504 (0.908) data 0.000 (0.394) loss 1.6631 (1.5586) lr 6.2434e-02 eta 0:05:12
epoch [22/50] batch [6/12] time 0.508 (0.775) data 0.000 (0.263) loss 1.7354 (1.6034) lr 6.2434e-02 eta 0:04:25
epoch [22/50] batch [8/12] time 0.513 (0.709) data 0.000 (0.197) loss 1.6768 (1.6049) lr 6.2434e-02 eta 0:04:01
epoch [22/50] batch [10/12] time 0.528 (0.674) data 0.000 (0.158) loss 1.5801 (1.6044) lr 6.2434e-02 eta 0:03:47
epoch [22/50] batch [12/12] time 0.506 (0.646) data 0.000 (0.132) loss 1.6797 (1.6200) lr 5.9369e-02 eta 0:03:36
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 582
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 80.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [23/50] batch [2/12] time 0.530 (1.340) data 0.000 (0.770) loss 1.5088 (1.5532) lr 5.9369e-02 eta 0:07:27
epoch [23/50] batch [4/12] time 0.531 (0.936) data 0.000 (0.385) loss 1.8125 (1.6177) lr 5.9369e-02 eta 0:05:10
epoch [23/50] batch [6/12] time 0.533 (0.802) data 0.000 (0.257) loss 1.5713 (1.6090) lr 5.9369e-02 eta 0:04:24
epoch [23/50] batch [8/12] time 0.535 (0.735) data 0.000 (0.193) loss 1.6318 (1.6021) lr 5.9369e-02 eta 0:04:01
epoch [23/50] batch [10/12] time 0.533 (0.695) data 0.000 (0.154) loss 1.4971 (1.5781) lr 5.9369e-02 eta 0:03:46
epoch [23/50] batch [12/12] time 0.542 (0.669) data 0.000 (0.129) loss 1.7393 (1.5893) lr 5.6267e-02 eta 0:03:36
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 585
* accuracy: 84.1%
* error: 15.9%
* macro_f1: 81.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [24/50] batch [2/12] time 0.536 (1.379) data 0.000 (0.807) loss 1.4609 (1.5454) lr 5.6267e-02 eta 0:07:23
epoch [24/50] batch [4/12] time 0.529 (0.954) data 0.000 (0.404) loss 1.5820 (1.5649) lr 5.6267e-02 eta 0:05:05
epoch [24/50] batch [6/12] time 0.532 (0.812) data 0.000 (0.269) loss 1.6055 (1.5464) lr 5.6267e-02 eta 0:04:18
epoch [24/50] batch [8/12] time 0.520 (0.740) data 0.000 (0.202) loss 1.7725 (1.5840) lr 5.6267e-02 eta 0:03:53
epoch [24/50] batch [10/12] time 0.513 (0.695) data 0.000 (0.162) loss 1.5947 (1.5913) lr 5.6267e-02 eta 0:03:38
epoch [24/50] batch [12/12] time 0.504 (0.663) data 0.000 (0.135) loss 1.5078 (1.5761) lr 5.3140e-02 eta 0:03:27
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 587
* accuracy: 84.3%
* error: 15.7%
* macro_f1: 81.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [25/50] batch [2/12] time 0.524 (1.355) data 0.000 (0.792) loss 1.4551 (1.5425) lr 5.3140e-02 eta 0:07:00
epoch [25/50] batch [4/12] time 0.507 (0.933) data 0.000 (0.396) loss 1.5586 (1.5916) lr 5.3140e-02 eta 0:04:47
epoch [25/50] batch [6/12] time 0.507 (0.790) data 0.000 (0.264) loss 1.5918 (1.6167) lr 5.3140e-02 eta 0:04:01
epoch [25/50] batch [8/12] time 0.504 (0.720) data 0.000 (0.198) loss 1.4746 (1.5865) lr 5.3140e-02 eta 0:03:38
epoch [25/50] batch [10/12] time 0.503 (0.676) data 0.000 (0.159) loss 1.4893 (1.5875) lr 5.3140e-02 eta 0:03:24
epoch [25/50] batch [12/12] time 0.506 (0.648) data 0.000 (0.132) loss 1.4922 (1.5722) lr 5.0000e-02 eta 0:03:14
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.34s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 600
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 83.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [26/50] batch [2/12] time 0.538 (1.390) data 0.001 (0.813) loss 1.5518 (1.5586) lr 5.0000e-02 eta 0:06:54
epoch [26/50] batch [4/12] time 0.539 (0.964) data 0.000 (0.407) loss 1.5098 (1.5542) lr 5.0000e-02 eta 0:04:45
epoch [26/50] batch [6/12] time 0.536 (0.821) data 0.000 (0.271) loss 1.5811 (1.5426) lr 5.0000e-02 eta 0:04:01
epoch [26/50] batch [8/12] time 0.534 (0.749) data 0.000 (0.203) loss 1.5098 (1.5328) lr 5.0000e-02 eta 0:03:38
epoch [26/50] batch [10/12] time 0.658 (0.718) data 0.000 (0.163) loss 1.5840 (1.5406) lr 5.0000e-02 eta 0:03:28
epoch [26/50] batch [12/12] time 0.530 (0.686) data 0.000 (0.136) loss 1.4326 (1.5253) lr 4.6860e-02 eta 0:03:17
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.34s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 601
* accuracy: 86.4%
* error: 13.6%
* macro_f1: 84.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [27/50] batch [2/12] time 0.504 (1.354) data 0.000 (0.774) loss 1.4717 (1.4424) lr 4.6860e-02 eta 0:06:27
epoch [27/50] batch [4/12] time 0.507 (0.931) data 0.000 (0.387) loss 1.5898 (1.4788) lr 4.6860e-02 eta 0:04:24
epoch [27/50] batch [6/12] time 0.510 (0.790) data 0.000 (0.258) loss 1.5049 (1.5184) lr 4.6860e-02 eta 0:03:42
epoch [27/50] batch [8/12] time 0.506 (0.719) data 0.000 (0.194) loss 1.5596 (1.5330) lr 4.6860e-02 eta 0:03:21
epoch [27/50] batch [10/12] time 0.507 (0.677) data 0.000 (0.155) loss 1.5625 (1.5355) lr 4.6860e-02 eta 0:03:08
epoch [27/50] batch [12/12] time 0.508 (0.649) data 0.000 (0.129) loss 1.4424 (1.5225) lr 4.3733e-02 eta 0:02:59
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.38s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 607
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 85.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [28/50] batch [2/12] time 0.503 (1.311) data 0.000 (0.777) loss 1.6709 (1.6367) lr 4.3733e-02 eta 0:05:59
epoch [28/50] batch [4/12] time 0.504 (0.909) data 0.000 (0.389) loss 1.5479 (1.5889) lr 4.3733e-02 eta 0:04:07
epoch [28/50] batch [6/12] time 0.516 (0.777) data 0.000 (0.259) loss 1.5703 (1.5519) lr 4.3733e-02 eta 0:03:29
epoch [28/50] batch [8/12] time 0.536 (0.717) data 0.000 (0.195) loss 1.5029 (1.5540) lr 4.3733e-02 eta 0:03:12
epoch [28/50] batch [10/12] time 0.534 (0.680) data 0.000 (0.156) loss 1.6904 (1.5769) lr 4.3733e-02 eta 0:03:00
epoch [28/50] batch [12/12] time 0.541 (0.657) data 0.000 (0.130) loss 1.5742 (1.5834) lr 4.0631e-02 eta 0:02:53
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 610
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 85.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [29/50] batch [2/12] time 0.540 (1.382) data 0.001 (0.798) loss 1.4463 (1.5537) lr 4.0631e-02 eta 0:06:02
epoch [29/50] batch [4/12] time 0.543 (0.961) data 0.000 (0.399) loss 1.6221 (1.5823) lr 4.0631e-02 eta 0:04:09
epoch [29/50] batch [6/12] time 0.541 (0.821) data 0.000 (0.266) loss 1.5859 (1.5783) lr 4.0631e-02 eta 0:03:31
epoch [29/50] batch [8/12] time 0.543 (0.751) data 0.000 (0.200) loss 1.5156 (1.5750) lr 4.0631e-02 eta 0:03:12
epoch [29/50] batch [10/12] time 0.539 (0.709) data 0.000 (0.160) loss 1.5127 (1.5799) lr 4.0631e-02 eta 0:03:00
epoch [29/50] batch [12/12] time 0.539 (0.681) data 0.000 (0.133) loss 1.5723 (1.5592) lr 3.7566e-02 eta 0:02:51
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 605
* accuracy: 86.9%
* error: 13.1%
* macro_f1: 84.7%

epoch [30/50] batch [2/12] time 0.508 (1.320) data 0.000 (0.767) loss 1.4082 (1.5322) lr 3.7566e-02 eta 0:05:30
epoch [30/50] batch [4/12] time 0.506 (0.913) data 0.000 (0.384) loss 1.5508 (1.5132) lr 3.7566e-02 eta 0:03:46
epoch [30/50] batch [6/12] time 0.514 (0.781) data 0.000 (0.256) loss 1.5850 (1.5205) lr 3.7566e-02 eta 0:03:12
epoch [30/50] batch [8/12] time 0.519 (0.720) data 0.000 (0.192) loss 1.5869 (1.5283) lr 3.7566e-02 eta 0:02:55
epoch [30/50] batch [10/12] time 0.510 (0.678) data 0.000 (0.154) loss 1.5693 (1.5210) lr 3.7566e-02 eta 0:02:44
epoch [30/50] batch [12/12] time 0.510 (0.650) data 0.000 (0.128) loss 1.5205 (1.5188) lr 3.4549e-02 eta 0:02:35
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.14s/it] 50%|█████     | 2/4 [00:03<00:02,  1.47s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.07it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.01s/it]=> result
* total: 696
* correct: 611
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 85.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/12] time 0.532 (1.276) data 0.000 (0.647) loss 1.4697 (1.4482) lr 3.4549e-02 eta 0:05:03
epoch [31/50] batch [4/12] time 0.535 (0.905) data 0.000 (0.324) loss 1.5391 (1.4812) lr 3.4549e-02 eta 0:03:33
epoch [31/50] batch [6/12] time 0.535 (0.781) data 0.000 (0.216) loss 1.6211 (1.5125) lr 3.4549e-02 eta 0:03:02
epoch [31/50] batch [8/12] time 0.532 (0.719) data 0.000 (0.162) loss 1.5742 (1.5293) lr 3.4549e-02 eta 0:02:46
epoch [31/50] batch [10/12] time 0.530 (0.681) data 0.000 (0.130) loss 1.4219 (1.5187) lr 3.4549e-02 eta 0:02:36
epoch [31/50] batch [12/12] time 0.530 (0.656) data 0.000 (0.108) loss 1.6152 (1.5355) lr 3.1594e-02 eta 0:02:29
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.38s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 612
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 86.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [32/50] batch [2/12] time 0.537 (1.299) data 0.000 (0.661) loss 1.4844 (1.6270) lr 3.1594e-02 eta 0:04:53
epoch [32/50] batch [4/12] time 0.543 (0.920) data 0.000 (0.330) loss 1.3330 (1.5698) lr 3.1594e-02 eta 0:03:26
epoch [32/50] batch [6/12] time 0.529 (0.790) data 0.000 (0.220) loss 1.3828 (1.5513) lr 3.1594e-02 eta 0:02:55
epoch [32/50] batch [8/12] time 0.517 (0.723) data 0.000 (0.165) loss 1.4326 (1.5227) lr 3.1594e-02 eta 0:02:38
epoch [32/50] batch [10/12] time 0.508 (0.679) data 0.000 (0.132) loss 1.4092 (1.5012) lr 3.1594e-02 eta 0:02:28
epoch [32/50] batch [12/12] time 0.510 (0.651) data 0.000 (0.110) loss 1.4951 (1.4957) lr 2.8711e-02 eta 0:02:20
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.15s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 607
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 85.1%

epoch [33/50] batch [2/12] time 0.509 (1.290) data 0.001 (0.678) loss 1.3945 (1.4463) lr 2.8711e-02 eta 0:04:36
epoch [33/50] batch [4/12] time 0.510 (0.900) data 0.000 (0.339) loss 1.5371 (1.5083) lr 2.8711e-02 eta 0:03:10
epoch [33/50] batch [6/12] time 0.508 (0.769) data 0.000 (0.226) loss 1.3877 (1.5112) lr 2.8711e-02 eta 0:02:41
epoch [33/50] batch [8/12] time 0.510 (0.704) data 0.000 (0.170) loss 1.7090 (1.5201) lr 2.8711e-02 eta 0:02:26
epoch [33/50] batch [10/12] time 0.509 (0.666) data 0.000 (0.136) loss 1.4434 (1.5225) lr 2.8711e-02 eta 0:02:17
epoch [33/50] batch [12/12] time 0.509 (0.640) data 0.000 (0.113) loss 1.4912 (1.5139) lr 2.5912e-02 eta 0:02:10
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 614
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 86.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [34/50] batch [2/12] time 0.534 (1.423) data 0.000 (0.862) loss 1.3857 (1.4209) lr 2.5912e-02 eta 0:04:47
epoch [34/50] batch [4/12] time 0.546 (0.983) data 0.000 (0.431) loss 1.5635 (1.5129) lr 2.5912e-02 eta 0:03:16
epoch [34/50] batch [6/12] time 0.533 (0.834) data 0.000 (0.287) loss 1.2695 (1.4937) lr 2.5912e-02 eta 0:02:45
epoch [34/50] batch [8/12] time 0.532 (0.758) data 0.000 (0.216) loss 1.6387 (1.5139) lr 2.5912e-02 eta 0:02:28
epoch [34/50] batch [10/12] time 0.527 (0.712) data 0.000 (0.173) loss 1.4365 (1.4954) lr 2.5912e-02 eta 0:02:18
epoch [34/50] batch [12/12] time 0.533 (0.682) data 0.000 (0.144) loss 1.4883 (1.4959) lr 2.3209e-02 eta 0:02:10
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.37s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 618
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 86.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [35/50] batch [2/12] time 0.507 (1.251) data 0.000 (0.626) loss 1.6318 (1.5205) lr 2.3209e-02 eta 0:03:57
epoch [35/50] batch [4/12] time 0.508 (0.880) data 0.000 (0.313) loss 1.3467 (1.4597) lr 2.3209e-02 eta 0:02:45
epoch [35/50] batch [6/12] time 0.510 (0.756) data 0.000 (0.209) loss 1.4668 (1.4762) lr 2.3209e-02 eta 0:02:20
epoch [35/50] batch [8/12] time 0.509 (0.694) data 0.000 (0.157) loss 1.3271 (1.4601) lr 2.3209e-02 eta 0:02:07
epoch [35/50] batch [10/12] time 0.509 (0.657) data 0.000 (0.125) loss 1.3555 (1.4668) lr 2.3209e-02 eta 0:01:59
epoch [35/50] batch [12/12] time 0.509 (0.632) data 0.000 (0.105) loss 1.4736 (1.4583) lr 2.0611e-02 eta 0:01:53
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 612
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 85.9%

epoch [36/50] batch [2/12] time 0.503 (1.297) data 0.000 (0.756) loss 1.3926 (1.4697) lr 2.0611e-02 eta 0:03:50
epoch [36/50] batch [4/12] time 0.507 (0.928) data 0.000 (0.378) loss 1.3418 (1.4387) lr 2.0611e-02 eta 0:02:43
epoch [36/50] batch [6/12] time 0.513 (0.790) data 0.000 (0.252) loss 1.4619 (1.4653) lr 2.0611e-02 eta 0:02:17
epoch [36/50] batch [8/12] time 0.534 (0.726) data 0.000 (0.189) loss 1.4922 (1.4695) lr 2.0611e-02 eta 0:02:04
epoch [36/50] batch [10/12] time 0.537 (0.688) data 0.000 (0.151) loss 1.4395 (1.4550) lr 2.0611e-02 eta 0:01:56
epoch [36/50] batch [12/12] time 0.537 (0.663) data 0.000 (0.126) loss 1.4863 (1.4583) lr 1.8129e-02 eta 0:01:51
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.43s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 620
* accuracy: 89.1%
* error: 10.9%
* macro_f1: 87.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [37/50] batch [2/12] time 0.528 (1.354) data 0.000 (0.800) loss 1.5791 (1.5190) lr 1.8129e-02 eta 0:03:44
epoch [37/50] batch [4/12] time 0.527 (0.941) data 0.000 (0.400) loss 1.3818 (1.4578) lr 1.8129e-02 eta 0:02:34
epoch [37/50] batch [6/12] time 0.528 (0.803) data 0.000 (0.267) loss 1.4238 (1.4458) lr 1.8129e-02 eta 0:02:10
epoch [37/50] batch [8/12] time 0.529 (0.734) data 0.000 (0.200) loss 1.3301 (1.4503) lr 1.8129e-02 eta 0:01:57
epoch [37/50] batch [10/12] time 0.535 (0.694) data 0.000 (0.160) loss 1.5977 (1.4687) lr 1.8129e-02 eta 0:01:49
epoch [37/50] batch [12/12] time 0.540 (0.668) data 0.000 (0.134) loss 1.6367 (1.4813) lr 1.5773e-02 eta 0:01:44
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.19s/it] 50%|█████     | 2/4 [00:03<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 620
* accuracy: 89.1%
* error: 10.9%
* macro_f1: 87.2%

epoch [38/50] batch [2/12] time 0.508 (1.230) data 0.001 (0.598) loss 1.5205 (1.4780) lr 1.5773e-02 eta 0:03:09
epoch [38/50] batch [4/12] time 0.504 (0.867) data 0.000 (0.299) loss 1.5449 (1.5291) lr 1.5773e-02 eta 0:02:11
epoch [38/50] batch [6/12] time 0.520 (0.750) data 0.000 (0.199) loss 1.3359 (1.4829) lr 1.5773e-02 eta 0:01:52
epoch [38/50] batch [8/12] time 0.538 (0.698) data 0.000 (0.150) loss 1.5371 (1.4778) lr 1.5773e-02 eta 0:01:43
epoch [38/50] batch [10/12] time 0.542 (0.666) data 0.000 (0.120) loss 1.3926 (1.4727) lr 1.5773e-02 eta 0:01:37
epoch [38/50] batch [12/12] time 0.547 (0.646) data 0.000 (0.100) loss 1.5146 (1.4853) lr 1.3552e-02 eta 0:01:32
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.57s/it] 50%|█████     | 2/4 [00:03<00:03,  1.65s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.04s/it]100%|██████████| 4/4 [00:04<00:00,  1.42it/s]100%|██████████| 4/4 [00:04<00:00,  1.12s/it]=> result
* total: 696
* correct: 624
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 87.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [39/50] batch [2/12] time 0.537 (1.397) data 0.000 (0.808) loss 1.5508 (1.5083) lr 1.3552e-02 eta 0:03:18
epoch [39/50] batch [4/12] time 0.536 (0.967) data 0.000 (0.404) loss 1.4531 (1.4858) lr 1.3552e-02 eta 0:02:15
epoch [39/50] batch [6/12] time 0.537 (0.824) data 0.000 (0.269) loss 1.4150 (1.4915) lr 1.3552e-02 eta 0:01:53
epoch [39/50] batch [8/12] time 0.539 (0.752) data 0.000 (0.202) loss 1.2305 (1.4530) lr 1.3552e-02 eta 0:01:42
epoch [39/50] batch [10/12] time 0.537 (0.710) data 0.000 (0.162) loss 1.5742 (1.4811) lr 1.3552e-02 eta 0:01:35
epoch [39/50] batch [12/12] time 0.543 (0.682) data 0.000 (0.135) loss 1.3096 (1.4626) lr 1.1474e-02 eta 0:01:29
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 619
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 86.8%

epoch [40/50] batch [2/12] time 0.531 (1.394) data 0.001 (0.846) loss 1.5049 (1.4604) lr 1.1474e-02 eta 0:03:01
epoch [40/50] batch [4/12] time 0.532 (0.964) data 0.000 (0.423) loss 1.4258 (1.4768) lr 1.1474e-02 eta 0:02:03
epoch [40/50] batch [6/12] time 0.539 (0.821) data 0.000 (0.282) loss 1.3975 (1.4645) lr 1.1474e-02 eta 0:01:43
epoch [40/50] batch [8/12] time 0.534 (0.750) data 0.000 (0.212) loss 1.4834 (1.4672) lr 1.1474e-02 eta 0:01:32
epoch [40/50] batch [10/12] time 0.535 (0.707) data 0.000 (0.169) loss 1.4355 (1.4677) lr 1.1474e-02 eta 0:01:26
epoch [40/50] batch [12/12] time 0.534 (0.678) data 0.000 (0.141) loss 1.4209 (1.4694) lr 9.5492e-03 eta 0:01:21
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 626
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 87.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/12] time 0.514 (1.245) data 0.001 (0.634) loss 1.5020 (1.4980) lr 9.5492e-03 eta 0:02:26
epoch [41/50] batch [4/12] time 0.514 (0.881) data 0.000 (0.317) loss 1.2734 (1.4497) lr 9.5492e-03 eta 0:01:42
epoch [41/50] batch [6/12] time 0.510 (0.758) data 0.000 (0.211) loss 1.5039 (1.4647) lr 9.5492e-03 eta 0:01:26
epoch [41/50] batch [8/12] time 0.519 (0.697) data 0.000 (0.159) loss 1.3633 (1.4613) lr 9.5492e-03 eta 0:01:18
epoch [41/50] batch [10/12] time 0.519 (0.662) data 0.000 (0.127) loss 1.5537 (1.4502) lr 9.5492e-03 eta 0:01:12
epoch [41/50] batch [12/12] time 0.521 (0.638) data 0.000 (0.106) loss 1.5488 (1.4604) lr 7.7836e-03 eta 0:01:08
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.15s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.01s/it]=> result
* total: 696
* correct: 623
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 87.6%

epoch [42/50] batch [2/12] time 0.514 (1.247) data 0.000 (0.624) loss 1.5098 (1.4258) lr 7.7836e-03 eta 0:02:12
epoch [42/50] batch [4/12] time 0.511 (0.879) data 0.000 (0.312) loss 1.3701 (1.4270) lr 7.7836e-03 eta 0:01:31
epoch [42/50] batch [6/12] time 0.509 (0.757) data 0.000 (0.208) loss 1.4707 (1.4512) lr 7.7836e-03 eta 0:01:17
epoch [42/50] batch [8/12] time 0.512 (0.695) data 0.000 (0.156) loss 1.3301 (1.4364) lr 7.7836e-03 eta 0:01:09
epoch [42/50] batch [10/12] time 0.511 (0.658) data 0.000 (0.125) loss 1.4395 (1.4277) lr 7.7836e-03 eta 0:01:04
epoch [42/50] batch [12/12] time 0.510 (0.634) data 0.000 (0.104) loss 1.4980 (1.4453) lr 6.1847e-03 eta 0:01:00
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.16s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.01s/it]=> result
* total: 696
* correct: 629
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 88.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [43/50] batch [2/12] time 0.511 (1.203) data 0.001 (0.600) loss 1.4648 (1.4761) lr 6.1847e-03 eta 0:01:53
epoch [43/50] batch [4/12] time 0.509 (0.857) data 0.000 (0.300) loss 1.4473 (1.4570) lr 6.1847e-03 eta 0:01:18
epoch [43/50] batch [6/12] time 0.524 (0.745) data 0.000 (0.200) loss 1.4590 (1.4380) lr 6.1847e-03 eta 0:01:07
epoch [43/50] batch [8/12] time 0.536 (0.693) data 0.001 (0.150) loss 1.2471 (1.4265) lr 6.1847e-03 eta 0:01:00
epoch [43/50] batch [10/12] time 0.537 (0.662) data 0.000 (0.120) loss 1.3105 (1.4309) lr 6.1847e-03 eta 0:00:56
epoch [43/50] batch [12/12] time 0.536 (0.641) data 0.000 (0.100) loss 1.5645 (1.4511) lr 4.7586e-03 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.45s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.2%

epoch [44/50] batch [2/12] time 0.545 (1.318) data 0.001 (0.668) loss 1.4336 (1.4771) lr 4.7586e-03 eta 0:01:48
epoch [44/50] batch [4/12] time 0.535 (0.927) data 0.000 (0.334) loss 1.4141 (1.4343) lr 4.7586e-03 eta 0:01:14
epoch [44/50] batch [6/12] time 0.542 (0.797) data 0.001 (0.223) loss 1.4609 (1.4391) lr 4.7586e-03 eta 0:01:02
epoch [44/50] batch [8/12] time 0.554 (0.735) data 0.000 (0.167) loss 1.3936 (1.4550) lr 4.7586e-03 eta 0:00:55
epoch [44/50] batch [10/12] time 0.556 (0.698) data 0.000 (0.134) loss 1.3975 (1.4362) lr 4.7586e-03 eta 0:00:51
epoch [44/50] batch [12/12] time 0.545 (0.672) data 0.000 (0.112) loss 1.4951 (1.4425) lr 3.5112e-03 eta 0:00:48
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.49s/it] 50%|█████     | 2/4 [00:03<00:03,  1.62s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 625
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 88.1%

epoch [45/50] batch [2/12] time 0.533 (1.334) data 0.000 (0.693) loss 1.4150 (1.4355) lr 3.5112e-03 eta 0:01:33
epoch [45/50] batch [4/12] time 0.537 (0.972) data 0.000 (0.347) loss 1.4844 (1.5063) lr 3.5112e-03 eta 0:01:06
epoch [45/50] batch [6/12] time 0.539 (0.828) data 0.000 (0.231) loss 1.4590 (1.4928) lr 3.5112e-03 eta 0:00:54
epoch [45/50] batch [8/12] time 0.544 (0.757) data 0.000 (0.173) loss 1.4160 (1.4720) lr 3.5112e-03 eta 0:00:48
epoch [45/50] batch [10/12] time 0.541 (0.713) data 0.000 (0.139) loss 1.4033 (1.4565) lr 3.5112e-03 eta 0:00:44
epoch [45/50] batch [12/12] time 0.533 (0.683) data 0.000 (0.116) loss 1.3809 (1.4352) lr 2.4472e-03 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.33s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 629
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 88.6%

epoch [46/50] batch [2/12] time 0.514 (1.328) data 0.001 (0.774) loss 1.3340 (1.4004) lr 2.4472e-03 eta 0:01:16
epoch [46/50] batch [4/12] time 0.513 (0.921) data 0.000 (0.387) loss 1.4336 (1.4250) lr 2.4472e-03 eta 0:00:51
epoch [46/50] batch [6/12] time 0.525 (0.789) data 0.000 (0.258) loss 1.4404 (1.4365) lr 2.4472e-03 eta 0:00:42
epoch [46/50] batch [8/12] time 0.523 (0.722) data 0.000 (0.194) loss 1.6230 (1.4598) lr 2.4472e-03 eta 0:00:37
epoch [46/50] batch [10/12] time 0.518 (0.681) data 0.000 (0.155) loss 1.3789 (1.4505) lr 2.4472e-03 eta 0:00:34
epoch [46/50] batch [12/12] time 0.517 (0.654) data 0.000 (0.129) loss 1.4570 (1.4412) lr 1.5708e-03 eta 0:00:31
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.23s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 631
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 88.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar

epoch [47/50] batch [2/12] time 0.511 (1.333) data 0.000 (0.797) loss 1.4727 (1.5649) lr 1.5708e-03 eta 0:01:01
epoch [47/50] batch [4/12] time 0.510 (0.922) data 0.000 (0.399) loss 1.4746 (1.5103) lr 1.5708e-03 eta 0:00:40
epoch [47/50] batch [6/12] time 0.509 (0.785) data 0.000 (0.266) loss 1.4570 (1.5114) lr 1.5708e-03 eta 0:00:32
epoch [47/50] batch [8/12] time 0.503 (0.715) data 0.000 (0.200) loss 1.5156 (1.5070) lr 1.5708e-03 eta 0:00:28
epoch [47/50] batch [10/12] time 0.511 (0.673) data 0.000 (0.160) loss 1.4619 (1.4830) lr 1.5708e-03 eta 0:00:25
epoch [47/50] batch [12/12] time 0.510 (0.646) data 0.000 (0.133) loss 1.4551 (1.4873) lr 8.8564e-04 eta 0:00:23
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 631
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 88.9%

epoch [48/50] batch [2/12] time 0.503 (1.306) data 0.000 (0.768) loss 1.4004 (1.4126) lr 8.8564e-04 eta 0:00:44
epoch [48/50] batch [4/12] time 0.508 (0.908) data 0.000 (0.384) loss 1.4443 (1.3975) lr 8.8564e-04 eta 0:00:29
epoch [48/50] batch [6/12] time 0.509 (0.774) data 0.000 (0.256) loss 1.3184 (1.4279) lr 8.8564e-04 eta 0:00:23
epoch [48/50] batch [8/12] time 0.533 (0.712) data 0.000 (0.192) loss 1.5342 (1.4482) lr 8.8564e-04 eta 0:00:19
epoch [48/50] batch [10/12] time 0.517 (0.675) data 0.000 (0.154) loss 1.4268 (1.4399) lr 8.8564e-04 eta 0:00:17
epoch [48/50] batch [12/12] time 0.509 (0.647) data 0.000 (0.128) loss 1.3789 (1.4300) lr 3.9426e-04 eta 0:00:15
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.23s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 631
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 88.9%

epoch [49/50] batch [2/12] time 0.518 (1.314) data 0.000 (0.765) loss 1.5635 (1.5181) lr 3.9426e-04 eta 0:00:28
epoch [49/50] batch [4/12] time 0.534 (0.924) data 0.000 (0.382) loss 1.5088 (1.4932) lr 3.9426e-04 eta 0:00:18
epoch [49/50] batch [6/12] time 0.535 (0.795) data 0.000 (0.255) loss 1.5176 (1.4928) lr 3.9426e-04 eta 0:00:14
epoch [49/50] batch [8/12] time 0.537 (0.730) data 0.000 (0.191) loss 1.3301 (1.4714) lr 3.9426e-04 eta 0:00:11
epoch [49/50] batch [10/12] time 0.538 (0.692) data 0.000 (0.153) loss 1.3535 (1.4528) lr 3.9426e-04 eta 0:00:09
epoch [49/50] batch [12/12] time 0.541 (0.671) data 0.000 (0.128) loss 1.5303 (1.4625) lr 9.8664e-05 eta 0:00:08
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 631
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 88.9%

epoch [50/50] batch [2/12] time 0.533 (1.394) data 0.000 (0.798) loss 1.3574 (1.4204) lr 9.8664e-05 eta 0:00:13
epoch [50/50] batch [4/12] time 0.529 (0.962) data 0.000 (0.399) loss 1.4473 (1.4104) lr 9.8664e-05 eta 0:00:07
epoch [50/50] batch [6/12] time 0.533 (0.819) data 0.000 (0.266) loss 1.6143 (1.4699) lr 9.8664e-05 eta 0:00:04
epoch [50/50] batch [8/12] time 0.540 (0.748) data 0.000 (0.200) loss 1.4463 (1.4689) lr 9.8664e-05 eta 0:00:02
epoch [50/50] batch [10/12] time 0.539 (0.706) data 0.000 (0.160) loss 1.4561 (1.4710) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [12/12] time 0.526 (0.676) data 0.000 (0.133) loss 1.5273 (1.4639) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]
=> result
* total: 696
* correct: 631
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 88.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 46)
Evaluate on the *test* set
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:03<00:18,  3.63s/it] 33%|███▎      | 2/6 [00:03<00:06,  1.68s/it] 50%|█████     | 3/6 [00:04<00:03,  1.05s/it] 67%|██████▋   | 4/6 [00:04<00:01,  1.33it/s] 83%|████████▎ | 5/6 [00:04<00:00,  1.69it/s]100%|██████████| 6/6 [00:04<00:00,  2.29it/s]100%|██████████| 6/6 [00:05<00:00,  1.18it/s]
=> result
* total: 1,053
* correct: 991
* accuracy: 94.1%
* error: 5.9%
* macro_f1: 93.8%
Elapsed: 0:10:20
+ sh scripts/rpo_prime/base2new_test_sdl.sh oxford_flowers 1 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 1
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 1
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordFlowers
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:OxfordFlowers
Loading dataset: OxfordFlowers
Reading split from /shared/s2/lab01/dataset/clip/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_flowers/split_fewshot_taesup/shot_16-seed_1.pkl
SUBSAMPLE NEW CLASSES!
816 937 1410
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------
Dataset    OxfordFlowers
# classes  51
# train_x  816
# val      937
# test     1,410
---------  -------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.img_prompt', 'prompt_learner.text_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed1/prompt_learner/model-best.pth.tar" (epoch = 46)
Evaluate on the *test* set
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:06<00:44,  6.37s/it] 25%|██▌       | 2/8 [00:06<00:16,  2.80s/it] 38%|███▊      | 3/8 [00:06<00:08,  1.66s/it] 50%|█████     | 4/8 [00:07<00:04,  1.12s/it] 62%|██████▎   | 5/8 [00:07<00:02,  1.21it/s] 75%|███████▌  | 6/8 [00:07<00:01,  1.54it/s] 88%|████████▊ | 7/8 [00:08<00:00,  1.87it/s]100%|██████████| 8/8 [00:08<00:00,  1.05s/it]
=> result
* total: 1,410
* correct: 1,047
* accuracy: 74.3%
* error: 25.7%
* macro_f1: 69.2%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh oxford_flowers 2 0 main_tmp1_0.1sdl 16
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordFlowers
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:OxfordFlowers
Loading dataset: OxfordFlowers
Reading split from /shared/s2/lab01/dataset/clip/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_flowers/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE BASE CLASSES!
816 696 1053
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------
Dataset    OxfordFlowers
# classes  51
# train_x  816
# val      696
# test     1,053
---------  -------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/12] time 0.537 (2.562) data 0.000 (0.967) loss 2.4199 (2.6475) lr 1.0000e-01 eta 0:25:31
epoch [1/50] batch [4/12] time 0.550 (1.552) data 0.000 (0.483) loss 2.1699 (2.4326) lr 1.0000e-01 eta 0:15:25
epoch [1/50] batch [6/12] time 0.532 (1.213) data 0.000 (0.322) loss 2.0566 (2.3590) lr 1.0000e-01 eta 0:12:00
epoch [1/50] batch [8/12] time 0.533 (1.043) data 0.000 (0.242) loss 2.1484 (2.3420) lr 1.0000e-01 eta 0:10:17
epoch [1/50] batch [10/12] time 0.528 (0.941) data 0.000 (0.194) loss 2.1094 (2.3162) lr 1.0000e-01 eta 0:09:14
epoch [1/50] batch [12/12] time 0.532 (0.872) data 0.000 (0.161) loss 1.9502 (2.2940) lr 9.9901e-02 eta 0:08:32
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.54s/it] 50%|█████     | 2/4 [00:03<00:03,  1.64s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.03s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.11s/it]=> result
* total: 696
* correct: 488
* accuracy: 70.1%
* error: 29.9%
* macro_f1: 62.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/12] time 0.523 (1.399) data 0.001 (0.814) loss 1.9756 (1.9185) lr 9.9901e-02 eta 0:13:39
epoch [2/50] batch [4/12] time 0.505 (0.954) data 0.000 (0.407) loss 2.2598 (1.9827) lr 9.9901e-02 eta 0:09:17
epoch [2/50] batch [6/12] time 0.505 (0.804) data 0.000 (0.272) loss 2.1035 (1.9935) lr 9.9901e-02 eta 0:07:47
epoch [2/50] batch [8/12] time 0.508 (0.730) data 0.000 (0.204) loss 2.0430 (2.0176) lr 9.9901e-02 eta 0:07:03
epoch [2/50] batch [10/12] time 0.504 (0.685) data 0.000 (0.163) loss 1.9004 (1.9851) lr 9.9901e-02 eta 0:06:35
epoch [2/50] batch [12/12] time 0.503 (0.655) data 0.000 (0.136) loss 2.0234 (1.9923) lr 9.9606e-02 eta 0:06:17
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.27s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.52it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 500
* accuracy: 71.8%
* error: 28.2%
* macro_f1: 65.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/12] time 0.503 (1.335) data 0.000 (0.804) loss 2.0898 (1.9204) lr 9.9606e-02 eta 0:12:46
epoch [3/50] batch [4/12] time 0.506 (0.919) data 0.000 (0.402) loss 1.7793 (1.8650) lr 9.9606e-02 eta 0:08:45
epoch [3/50] batch [6/12] time 0.505 (0.781) data 0.000 (0.268) loss 2.0449 (1.8649) lr 9.9606e-02 eta 0:07:24
epoch [3/50] batch [8/12] time 0.525 (0.716) data 0.000 (0.201) loss 1.7666 (1.9052) lr 9.9606e-02 eta 0:06:46
epoch [3/50] batch [10/12] time 0.547 (0.682) data 0.000 (0.161) loss 2.0391 (1.9528) lr 9.9606e-02 eta 0:06:25
epoch [3/50] batch [12/12] time 0.548 (0.661) data 0.001 (0.134) loss 1.8867 (1.9349) lr 9.9114e-02 eta 0:06:12
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.54s/it] 50%|█████     | 2/4 [00:03<00:03,  1.64s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.03s/it]100%|██████████| 4/4 [00:04<00:00,  1.43it/s]100%|██████████| 4/4 [00:04<00:00,  1.12s/it]=> result
* total: 696
* correct: 503
* accuracy: 72.3%
* error: 27.7%
* macro_f1: 66.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/12] time 0.531 (1.286) data 0.000 (0.652) loss 2.0684 (2.1133) lr 9.9114e-02 eta 0:12:02
epoch [4/50] batch [4/12] time 0.531 (0.909) data 0.000 (0.326) loss 2.2188 (2.0752) lr 9.9114e-02 eta 0:08:29
epoch [4/50] batch [6/12] time 0.533 (0.784) data 0.000 (0.217) loss 1.9531 (1.9852) lr 9.9114e-02 eta 0:07:17
epoch [4/50] batch [8/12] time 0.529 (0.721) data 0.000 (0.163) loss 2.0352 (1.9924) lr 9.9114e-02 eta 0:06:40
epoch [4/50] batch [10/12] time 0.527 (0.682) data 0.000 (0.131) loss 1.6768 (1.9369) lr 9.9114e-02 eta 0:06:18
epoch [4/50] batch [12/12] time 0.530 (0.657) data 0.000 (0.109) loss 2.0117 (1.9324) lr 9.8429e-02 eta 0:06:02
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.35s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 510
* accuracy: 73.3%
* error: 26.7%
* macro_f1: 67.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/12] time 0.504 (1.366) data 0.000 (0.841) loss 1.8750 (1.7637) lr 9.8429e-02 eta 0:12:31
epoch [5/50] batch [4/12] time 0.506 (0.938) data 0.000 (0.421) loss 1.8252 (1.8743) lr 9.8429e-02 eta 0:08:33
epoch [5/50] batch [6/12] time 0.513 (0.795) data 0.000 (0.281) loss 1.9277 (1.9162) lr 9.8429e-02 eta 0:07:14
epoch [5/50] batch [8/12] time 0.535 (0.727) data 0.000 (0.211) loss 1.8340 (1.8912) lr 9.8429e-02 eta 0:06:35
epoch [5/50] batch [10/12] time 0.518 (0.687) data 0.000 (0.169) loss 1.8545 (1.9008) lr 9.8429e-02 eta 0:06:12
epoch [5/50] batch [12/12] time 0.517 (0.658) data 0.000 (0.140) loss 1.7607 (1.8826) lr 9.7553e-02 eta 0:05:55
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.18s/it] 50%|█████     | 2/4 [00:03<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 510
* accuracy: 73.3%
* error: 26.7%
* macro_f1: 67.6%

epoch [6/50] batch [2/12] time 0.533 (1.363) data 0.000 (0.794) loss 1.8896 (1.8735) lr 9.7553e-02 eta 0:12:13
epoch [6/50] batch [4/12] time 0.535 (0.949) data 0.000 (0.397) loss 1.8154 (1.8135) lr 9.7553e-02 eta 0:08:28
epoch [6/50] batch [6/12] time 0.546 (0.814) data 0.001 (0.265) loss 1.8770 (1.8717) lr 9.7553e-02 eta 0:07:14
epoch [6/50] batch [8/12] time 0.546 (0.747) data 0.000 (0.199) loss 2.0898 (1.9117) lr 9.7553e-02 eta 0:06:37
epoch [6/50] batch [10/12] time 0.545 (0.707) data 0.000 (0.159) loss 1.7910 (1.9173) lr 9.7553e-02 eta 0:06:14
epoch [6/50] batch [12/12] time 0.549 (0.680) data 0.000 (0.133) loss 1.8330 (1.9041) lr 9.6489e-02 eta 0:05:58
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.37s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 510
* accuracy: 73.3%
* error: 26.7%
* macro_f1: 67.8%

epoch [7/50] batch [2/12] time 0.543 (1.307) data 0.000 (0.657) loss 2.0039 (1.8618) lr 9.6489e-02 eta 0:11:27
epoch [7/50] batch [4/12] time 0.539 (0.923) data 0.000 (0.329) loss 2.0410 (1.9709) lr 9.6489e-02 eta 0:08:03
epoch [7/50] batch [6/12] time 0.533 (0.794) data 0.000 (0.219) loss 1.7227 (1.8818) lr 9.6489e-02 eta 0:06:54
epoch [7/50] batch [8/12] time 0.514 (0.746) data 0.000 (0.164) loss 1.9902 (1.8871) lr 9.6489e-02 eta 0:06:27
epoch [7/50] batch [10/12] time 0.519 (0.701) data 0.000 (0.132) loss 1.7549 (1.8727) lr 9.6489e-02 eta 0:06:02
epoch [7/50] batch [12/12] time 0.515 (0.670) data 0.000 (0.110) loss 1.7363 (1.8656) lr 9.5241e-02 eta 0:05:45
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.26s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 519
* accuracy: 74.6%
* error: 25.4%
* macro_f1: 69.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [8/50] batch [2/12] time 0.513 (1.256) data 0.000 (0.642) loss 1.8311 (1.7803) lr 9.5241e-02 eta 0:10:45
epoch [8/50] batch [4/12] time 0.513 (0.884) data 0.000 (0.321) loss 1.8047 (1.8071) lr 9.5241e-02 eta 0:07:32
epoch [8/50] batch [6/12] time 0.522 (0.762) data 0.000 (0.214) loss 1.8262 (1.8068) lr 9.5241e-02 eta 0:06:28
epoch [8/50] batch [8/12] time 0.523 (0.703) data 0.000 (0.161) loss 1.7490 (1.8101) lr 9.5241e-02 eta 0:05:57
epoch [8/50] batch [10/12] time 0.513 (0.665) data 0.000 (0.129) loss 1.9814 (1.8226) lr 9.5241e-02 eta 0:05:36
epoch [8/50] batch [12/12] time 0.519 (0.640) data 0.000 (0.107) loss 1.7051 (1.8192) lr 9.3815e-02 eta 0:05:22
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.51s/it] 50%|█████     | 2/4 [00:03<00:03,  1.63s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 520
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 69.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/12] time 0.546 (1.342) data 0.001 (0.691) loss 1.8926 (1.9492) lr 9.3815e-02 eta 0:11:13
epoch [9/50] batch [4/12] time 0.550 (0.947) data 0.000 (0.346) loss 1.7812 (1.8525) lr 9.3815e-02 eta 0:07:53
epoch [9/50] batch [6/12] time 0.540 (0.811) data 0.000 (0.231) loss 1.7402 (1.8368) lr 9.3815e-02 eta 0:06:44
epoch [9/50] batch [8/12] time 0.526 (0.740) data 0.000 (0.173) loss 1.7891 (1.7993) lr 9.3815e-02 eta 0:06:07
epoch [9/50] batch [10/12] time 0.529 (0.698) data 0.000 (0.139) loss 1.9326 (1.8155) lr 9.3815e-02 eta 0:05:44
epoch [9/50] batch [12/12] time 0.546 (0.672) data 0.000 (0.115) loss 1.5186 (1.7949) lr 9.2216e-02 eta 0:05:30
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.39s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 527
* accuracy: 75.7%
* error: 24.3%
* macro_f1: 71.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [10/50] batch [2/12] time 0.517 (1.364) data 0.000 (0.799) loss 1.8916 (1.8247) lr 9.2216e-02 eta 0:11:08
epoch [10/50] batch [4/12] time 0.511 (0.939) data 0.000 (0.400) loss 1.9727 (1.8892) lr 9.2216e-02 eta 0:07:38
epoch [10/50] batch [6/12] time 0.517 (0.798) data 0.000 (0.267) loss 1.8643 (1.8582) lr 9.2216e-02 eta 0:06:27
epoch [10/50] batch [8/12] time 0.512 (0.728) data 0.000 (0.200) loss 1.5996 (1.8156) lr 9.2216e-02 eta 0:05:52
epoch [10/50] batch [10/12] time 0.516 (0.686) data 0.000 (0.160) loss 2.1230 (1.8443) lr 9.2216e-02 eta 0:05:30
epoch [10/50] batch [12/12] time 0.535 (0.660) data 0.000 (0.133) loss 1.7529 (1.8261) lr 9.0451e-02 eta 0:05:16
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 527
* accuracy: 75.7%
* error: 24.3%
* macro_f1: 71.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/12] time 0.521 (1.353) data 0.000 (0.807) loss 1.7109 (1.7397) lr 9.0451e-02 eta 0:10:46
epoch [11/50] batch [4/12] time 0.541 (0.944) data 0.000 (0.404) loss 1.8193 (1.7295) lr 9.0451e-02 eta 0:07:29
epoch [11/50] batch [6/12] time 0.547 (0.811) data 0.000 (0.269) loss 1.8604 (1.7686) lr 9.0451e-02 eta 0:06:24
epoch [11/50] batch [8/12] time 0.545 (0.745) data 0.000 (0.202) loss 1.6709 (1.7645) lr 9.0451e-02 eta 0:05:51
epoch [11/50] batch [10/12] time 0.544 (0.704) data 0.000 (0.162) loss 1.6797 (1.7396) lr 9.0451e-02 eta 0:05:31
epoch [11/50] batch [12/12] time 0.531 (0.675) data 0.000 (0.135) loss 1.6553 (1.7398) lr 8.8526e-02 eta 0:05:16
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.44s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 531
* accuracy: 76.3%
* error: 23.7%
* macro_f1: 71.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [12/50] batch [2/12] time 0.529 (1.401) data 0.000 (0.849) loss 1.9326 (1.9321) lr 8.8526e-02 eta 0:10:52
epoch [12/50] batch [4/12] time 0.529 (0.965) data 0.000 (0.425) loss 1.7002 (1.8081) lr 8.8526e-02 eta 0:07:27
epoch [12/50] batch [6/12] time 0.525 (0.819) data 0.000 (0.283) loss 1.9580 (1.7795) lr 8.8526e-02 eta 0:06:18
epoch [12/50] batch [8/12] time 0.528 (0.747) data 0.000 (0.213) loss 1.9639 (1.7823) lr 8.8526e-02 eta 0:05:43
epoch [12/50] batch [10/12] time 0.520 (0.702) data 0.000 (0.170) loss 1.7812 (1.7678) lr 8.8526e-02 eta 0:05:21
epoch [12/50] batch [12/12] time 0.527 (0.673) data 0.000 (0.142) loss 1.7217 (1.7647) lr 8.6448e-02 eta 0:05:06
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 535
* accuracy: 76.9%
* error: 23.1%
* macro_f1: 72.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [13/50] batch [2/12] time 0.521 (1.253) data 0.001 (0.604) loss 1.5420 (1.6812) lr 8.6448e-02 eta 0:09:28
epoch [13/50] batch [4/12] time 0.537 (0.897) data 0.000 (0.302) loss 1.6855 (1.7617) lr 8.6448e-02 eta 0:06:45
epoch [13/50] batch [6/12] time 0.514 (0.771) data 0.000 (0.202) loss 1.6553 (1.7425) lr 8.6448e-02 eta 0:05:46
epoch [13/50] batch [8/12] time 0.519 (0.708) data 0.000 (0.151) loss 1.6924 (1.7595) lr 8.6448e-02 eta 0:05:17
epoch [13/50] batch [10/12] time 0.521 (0.670) data 0.000 (0.121) loss 1.5859 (1.7396) lr 8.6448e-02 eta 0:04:58
epoch [13/50] batch [12/12] time 0.522 (0.645) data 0.000 (0.101) loss 1.6406 (1.7314) lr 8.4227e-02 eta 0:04:46
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.35s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 536
* accuracy: 77.0%
* error: 23.0%
* macro_f1: 73.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [14/50] batch [2/12] time 0.549 (1.433) data 0.000 (0.859) loss 1.9014 (1.8413) lr 8.4227e-02 eta 0:10:33
epoch [14/50] batch [4/12] time 0.543 (0.989) data 0.000 (0.430) loss 1.5908 (1.7278) lr 8.4227e-02 eta 0:07:15
epoch [14/50] batch [6/12] time 0.561 (0.844) data 0.000 (0.287) loss 1.7393 (1.7044) lr 8.4227e-02 eta 0:06:09
epoch [14/50] batch [8/12] time 0.542 (0.769) data 0.000 (0.215) loss 1.7129 (1.6782) lr 8.4227e-02 eta 0:05:35
epoch [14/50] batch [10/12] time 0.531 (0.722) data 0.000 (0.172) loss 1.6416 (1.6847) lr 8.4227e-02 eta 0:05:13
epoch [14/50] batch [12/12] time 0.525 (0.690) data 0.000 (0.143) loss 1.5537 (1.6672) lr 8.1871e-02 eta 0:04:58
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 543
* accuracy: 78.0%
* error: 22.0%
* macro_f1: 74.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [15/50] batch [2/12] time 0.519 (1.319) data 0.001 (0.691) loss 1.7158 (1.6792) lr 8.1871e-02 eta 0:09:27
epoch [15/50] batch [4/12] time 0.506 (0.912) data 0.000 (0.346) loss 1.7676 (1.6482) lr 8.1871e-02 eta 0:06:30
epoch [15/50] batch [6/12] time 0.502 (0.775) data 0.000 (0.230) loss 1.7725 (1.6590) lr 8.1871e-02 eta 0:05:30
epoch [15/50] batch [8/12] time 0.506 (0.708) data 0.000 (0.173) loss 1.5889 (1.6555) lr 8.1871e-02 eta 0:05:00
epoch [15/50] batch [10/12] time 0.508 (0.668) data 0.000 (0.138) loss 1.7969 (1.6708) lr 8.1871e-02 eta 0:04:41
epoch [15/50] batch [12/12] time 0.508 (0.641) data 0.000 (0.115) loss 1.5137 (1.6640) lr 7.9389e-02 eta 0:04:29
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 547
* accuracy: 78.6%
* error: 21.4%
* macro_f1: 75.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/12] time 0.502 (1.319) data 0.000 (0.780) loss 1.7949 (1.6714) lr 7.9389e-02 eta 0:09:11
epoch [16/50] batch [4/12] time 0.503 (0.912) data 0.000 (0.390) loss 1.6543 (1.7212) lr 7.9389e-02 eta 0:06:19
epoch [16/50] batch [6/12] time 0.506 (0.776) data 0.000 (0.260) loss 1.6641 (1.7326) lr 7.9389e-02 eta 0:05:21
epoch [16/50] batch [8/12] time 0.527 (0.711) data 0.000 (0.195) loss 1.7695 (1.7336) lr 7.9389e-02 eta 0:04:53
epoch [16/50] batch [10/12] time 0.528 (0.675) data 0.000 (0.156) loss 1.7812 (1.7267) lr 7.9389e-02 eta 0:04:36
epoch [16/50] batch [12/12] time 0.529 (0.650) data 0.000 (0.130) loss 1.6309 (1.7248) lr 7.6791e-02 eta 0:04:25
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 552
* accuracy: 79.3%
* error: 20.7%
* macro_f1: 75.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [17/50] batch [2/12] time 0.676 (1.464) data 0.000 (0.840) loss 1.6016 (1.6016) lr 7.6791e-02 eta 0:09:54
epoch [17/50] batch [4/12] time 0.542 (1.002) data 0.000 (0.420) loss 1.6318 (1.6035) lr 7.6791e-02 eta 0:06:44
epoch [17/50] batch [6/12] time 0.540 (0.848) data 0.000 (0.280) loss 1.5439 (1.6270) lr 7.6791e-02 eta 0:05:40
epoch [17/50] batch [8/12] time 0.540 (0.771) data 0.000 (0.210) loss 1.5879 (1.6586) lr 7.6791e-02 eta 0:05:08
epoch [17/50] batch [10/12] time 0.544 (0.726) data 0.000 (0.168) loss 1.5537 (1.6411) lr 7.6791e-02 eta 0:04:48
epoch [17/50] batch [12/12] time 0.532 (0.694) data 0.001 (0.140) loss 1.7227 (1.6528) lr 7.4088e-02 eta 0:04:34
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.32s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 566
* accuracy: 81.3%
* error: 18.7%
* macro_f1: 79.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [18/50] batch [2/12] time 0.504 (1.340) data 0.000 (0.795) loss 1.5811 (1.5430) lr 7.4088e-02 eta 0:08:48
epoch [18/50] batch [4/12] time 0.510 (0.924) data 0.000 (0.398) loss 1.6211 (1.5632) lr 7.4088e-02 eta 0:06:02
epoch [18/50] batch [6/12] time 0.517 (0.788) data 0.000 (0.265) loss 1.5557 (1.5716) lr 7.4088e-02 eta 0:05:07
epoch [18/50] batch [8/12] time 0.524 (0.723) data 0.000 (0.199) loss 1.5703 (1.6005) lr 7.4088e-02 eta 0:04:40
epoch [18/50] batch [10/12] time 0.508 (0.680) data 0.000 (0.159) loss 1.6953 (1.6186) lr 7.4088e-02 eta 0:04:22
epoch [18/50] batch [12/12] time 0.515 (0.652) data 0.000 (0.133) loss 1.6445 (1.6328) lr 7.1289e-02 eta 0:04:10
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 559
* accuracy: 80.3%
* error: 19.7%
* macro_f1: 78.1%

epoch [19/50] batch [2/12] time 0.535 (1.425) data 0.000 (0.876) loss 1.6172 (1.5195) lr 7.1289e-02 eta 0:09:04
epoch [19/50] batch [4/12] time 0.552 (0.983) data 0.000 (0.438) loss 1.4199 (1.5195) lr 7.1289e-02 eta 0:06:13
epoch [19/50] batch [6/12] time 0.536 (0.835) data 0.000 (0.292) loss 1.5537 (1.6001) lr 7.1289e-02 eta 0:05:15
epoch [19/50] batch [8/12] time 0.534 (0.760) data 0.000 (0.219) loss 1.6289 (1.6183) lr 7.1289e-02 eta 0:04:45
epoch [19/50] batch [10/12] time 0.535 (0.715) data 0.000 (0.175) loss 1.7510 (1.6360) lr 7.1289e-02 eta 0:04:27
epoch [19/50] batch [12/12] time 0.534 (0.685) data 0.000 (0.146) loss 1.8926 (1.6752) lr 6.8406e-02 eta 0:04:14
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 571
* accuracy: 82.0%
* error: 18.0%
* macro_f1: 79.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [20/50] batch [2/12] time 0.529 (1.329) data 0.000 (0.673) loss 1.6494 (1.6074) lr 6.8406e-02 eta 0:08:11
epoch [20/50] batch [4/12] time 0.528 (0.928) data 0.000 (0.337) loss 1.6738 (1.6282) lr 6.8406e-02 eta 0:05:41
epoch [20/50] batch [6/12] time 0.534 (0.796) data 0.000 (0.225) loss 1.7129 (1.6340) lr 6.8406e-02 eta 0:04:51
epoch [20/50] batch [8/12] time 0.515 (0.726) data 0.000 (0.169) loss 1.6699 (1.6356) lr 6.8406e-02 eta 0:04:24
epoch [20/50] batch [10/12] time 0.513 (0.684) data 0.000 (0.135) loss 1.6904 (1.6297) lr 6.8406e-02 eta 0:04:07
epoch [20/50] batch [12/12] time 0.512 (0.655) data 0.000 (0.112) loss 1.5752 (1.6200) lr 6.5451e-02 eta 0:03:55
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 583
* accuracy: 83.8%
* error: 16.2%
* macro_f1: 81.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/12] time 0.518 (1.360) data 0.000 (0.813) loss 1.5273 (1.6841) lr 6.5451e-02 eta 0:08:06
epoch [21/50] batch [4/12] time 0.515 (0.937) data 0.000 (0.407) loss 1.6514 (1.6558) lr 6.5451e-02 eta 0:05:33
epoch [21/50] batch [6/12] time 0.513 (0.796) data 0.000 (0.271) loss 1.7617 (1.6582) lr 6.5451e-02 eta 0:04:41
epoch [21/50] batch [8/12] time 0.514 (0.725) data 0.000 (0.204) loss 1.5352 (1.6154) lr 6.5451e-02 eta 0:04:15
epoch [21/50] batch [10/12] time 0.517 (0.683) data 0.000 (0.163) loss 1.5918 (1.6074) lr 6.5451e-02 eta 0:03:59
epoch [21/50] batch [12/12] time 0.547 (0.658) data 0.000 (0.136) loss 1.7109 (1.6202) lr 6.2434e-02 eta 0:03:49
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.52s/it] 50%|█████     | 2/4 [00:03<00:03,  1.63s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.03s/it]100%|██████████| 4/4 [00:04<00:00,  1.43it/s]100%|██████████| 4/4 [00:04<00:00,  1.11s/it]=> result
* total: 696
* correct: 576
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 80.6%

epoch [22/50] batch [2/12] time 0.544 (1.352) data 0.001 (0.664) loss 1.4141 (1.5195) lr 6.2434e-02 eta 0:07:47
epoch [22/50] batch [4/12] time 0.539 (0.946) data 0.000 (0.332) loss 1.6885 (1.5908) lr 6.2434e-02 eta 0:05:25
epoch [22/50] batch [6/12] time 0.540 (0.810) data 0.000 (0.222) loss 1.4336 (1.5614) lr 6.2434e-02 eta 0:04:37
epoch [22/50] batch [8/12] time 0.540 (0.743) data 0.000 (0.166) loss 1.3467 (1.5424) lr 6.2434e-02 eta 0:04:12
epoch [22/50] batch [10/12] time 0.544 (0.702) data 0.000 (0.133) loss 1.6533 (1.5898) lr 6.2434e-02 eta 0:03:57
epoch [22/50] batch [12/12] time 0.538 (0.675) data 0.000 (0.111) loss 1.7764 (1.6173) lr 5.9369e-02 eta 0:03:46
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.44s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 587
* accuracy: 84.3%
* error: 15.7%
* macro_f1: 82.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [23/50] batch [2/12] time 0.507 (1.259) data 0.001 (0.627) loss 1.5156 (1.5234) lr 5.9369e-02 eta 0:07:00
epoch [23/50] batch [4/12] time 0.522 (0.887) data 0.000 (0.314) loss 1.6641 (1.5530) lr 5.9369e-02 eta 0:04:54
epoch [23/50] batch [6/12] time 0.503 (0.760) data 0.000 (0.209) loss 1.8193 (1.6346) lr 5.9369e-02 eta 0:04:10
epoch [23/50] batch [8/12] time 0.505 (0.696) data 0.000 (0.157) loss 1.6074 (1.6191) lr 5.9369e-02 eta 0:03:48
epoch [23/50] batch [10/12] time 0.523 (0.660) data 0.000 (0.126) loss 1.5254 (1.6103) lr 5.9369e-02 eta 0:03:35
epoch [23/50] batch [12/12] time 0.535 (0.638) data 0.001 (0.105) loss 1.4756 (1.5878) lr 5.6267e-02 eta 0:03:26
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 600
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 83.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [24/50] batch [2/12] time 0.514 (1.292) data 0.000 (0.689) loss 1.4893 (1.5430) lr 5.6267e-02 eta 0:06:55
epoch [24/50] batch [4/12] time 0.534 (0.914) data 0.000 (0.344) loss 1.5811 (1.5469) lr 5.6267e-02 eta 0:04:52
epoch [24/50] batch [6/12] time 0.534 (0.787) data 0.000 (0.230) loss 1.2949 (1.5381) lr 5.6267e-02 eta 0:04:10
epoch [24/50] batch [8/12] time 0.532 (0.723) data 0.000 (0.172) loss 1.6934 (1.5664) lr 5.6267e-02 eta 0:03:48
epoch [24/50] batch [10/12] time 0.531 (0.685) data 0.000 (0.138) loss 1.7285 (1.5946) lr 5.6267e-02 eta 0:03:35
epoch [24/50] batch [12/12] time 0.536 (0.660) data 0.000 (0.115) loss 1.5420 (1.5834) lr 5.3140e-02 eta 0:03:25
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.48s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 600
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 84.4%

epoch [25/50] batch [2/12] time 0.536 (1.434) data 0.000 (0.885) loss 1.7041 (1.6445) lr 5.3140e-02 eta 0:07:24
epoch [25/50] batch [4/12] time 0.531 (0.982) data 0.000 (0.443) loss 1.3984 (1.6235) lr 5.3140e-02 eta 0:05:02
epoch [25/50] batch [6/12] time 0.528 (0.831) data 0.001 (0.295) loss 1.6182 (1.6141) lr 5.3140e-02 eta 0:04:14
epoch [25/50] batch [8/12] time 0.531 (0.757) data 0.000 (0.222) loss 1.6963 (1.6333) lr 5.3140e-02 eta 0:03:49
epoch [25/50] batch [10/12] time 0.528 (0.711) data 0.000 (0.177) loss 1.3486 (1.5835) lr 5.3140e-02 eta 0:03:34
epoch [25/50] batch [12/12] time 0.503 (0.678) data 0.000 (0.148) loss 1.7109 (1.5811) lr 5.0000e-02 eta 0:03:23
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 600
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 83.9%

epoch [26/50] batch [2/12] time 0.519 (1.343) data 0.000 (0.782) loss 1.5859 (1.6172) lr 5.0000e-02 eta 0:06:40
epoch [26/50] batch [4/12] time 0.510 (0.931) data 0.000 (0.391) loss 1.5186 (1.5920) lr 5.0000e-02 eta 0:04:35
epoch [26/50] batch [6/12] time 0.508 (0.791) data 0.000 (0.261) loss 1.5967 (1.5955) lr 5.0000e-02 eta 0:03:52
epoch [26/50] batch [8/12] time 0.508 (0.720) data 0.000 (0.196) loss 1.6855 (1.6185) lr 5.0000e-02 eta 0:03:30
epoch [26/50] batch [10/12] time 0.507 (0.678) data 0.000 (0.156) loss 1.5596 (1.6109) lr 5.0000e-02 eta 0:03:16
epoch [26/50] batch [12/12] time 0.504 (0.657) data 0.000 (0.130) loss 1.3604 (1.5686) lr 4.6860e-02 eta 0:03:09
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.25s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 606
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 84.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [27/50] batch [2/12] time 0.536 (1.420) data 0.001 (0.849) loss 1.5195 (1.4780) lr 4.6860e-02 eta 0:06:46
epoch [27/50] batch [4/12] time 0.535 (0.977) data 0.000 (0.424) loss 1.6309 (1.5112) lr 4.6860e-02 eta 0:04:37
epoch [27/50] batch [6/12] time 0.539 (0.831) data 0.000 (0.283) loss 1.5850 (1.5182) lr 4.6860e-02 eta 0:03:54
epoch [27/50] batch [8/12] time 0.541 (0.758) data 0.000 (0.212) loss 1.6758 (1.5270) lr 4.6860e-02 eta 0:03:32
epoch [27/50] batch [10/12] time 0.531 (0.713) data 0.000 (0.170) loss 1.5283 (1.5283) lr 4.6860e-02 eta 0:03:18
epoch [27/50] batch [12/12] time 0.530 (0.682) data 0.000 (0.142) loss 1.6299 (1.5470) lr 4.3733e-02 eta 0:03:08
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 603
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 84.9%

epoch [28/50] batch [2/12] time 0.513 (1.366) data 0.000 (0.802) loss 1.5107 (1.6089) lr 4.3733e-02 eta 0:06:14
epoch [28/50] batch [4/12] time 0.503 (0.936) data 0.000 (0.401) loss 1.5869 (1.6023) lr 4.3733e-02 eta 0:04:14
epoch [28/50] batch [6/12] time 0.505 (0.793) data 0.000 (0.267) loss 1.4268 (1.5859) lr 4.3733e-02 eta 0:03:34
epoch [28/50] batch [8/12] time 0.505 (0.721) data 0.000 (0.201) loss 1.6406 (1.5714) lr 4.3733e-02 eta 0:03:13
epoch [28/50] batch [10/12] time 0.507 (0.678) data 0.000 (0.161) loss 1.4346 (1.5555) lr 4.3733e-02 eta 0:03:00
epoch [28/50] batch [12/12] time 0.508 (0.649) data 0.000 (0.134) loss 1.4238 (1.5447) lr 4.0631e-02 eta 0:02:51
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.29s/it] 50%|█████     | 2/4 [00:03<00:03,  1.53s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.52it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 603
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 84.7%

epoch [29/50] batch [2/12] time 0.503 (1.215) data 0.001 (0.615) loss 1.7266 (1.6924) lr 4.0631e-02 eta 0:05:18
epoch [29/50] batch [4/12] time 0.503 (0.859) data 0.000 (0.307) loss 1.6270 (1.6357) lr 4.0631e-02 eta 0:03:43
epoch [29/50] batch [6/12] time 0.506 (0.741) data 0.000 (0.205) loss 1.6484 (1.6248) lr 4.0631e-02 eta 0:03:11
epoch [29/50] batch [8/12] time 0.532 (0.686) data 0.000 (0.154) loss 1.5127 (1.5988) lr 4.0631e-02 eta 0:02:55
epoch [29/50] batch [10/12] time 0.533 (0.655) data 0.000 (0.123) loss 1.4678 (1.5690) lr 4.0631e-02 eta 0:02:46
epoch [29/50] batch [12/12] time 0.535 (0.635) data 0.000 (0.103) loss 1.5283 (1.5485) lr 3.7566e-02 eta 0:02:40
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.52s/it] 50%|█████     | 2/4 [00:03<00:03,  1.63s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.11s/it]=> result
* total: 696
* correct: 609
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 85.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [30/50] batch [2/12] time 0.530 (1.425) data 0.000 (0.886) loss 1.6797 (1.5571) lr 3.7566e-02 eta 0:05:56
epoch [30/50] batch [4/12] time 0.534 (0.980) data 0.000 (0.443) loss 1.5283 (1.5642) lr 3.7566e-02 eta 0:04:02
epoch [30/50] batch [6/12] time 0.538 (0.832) data 0.000 (0.296) loss 1.6445 (1.5604) lr 3.7566e-02 eta 0:03:24
epoch [30/50] batch [8/12] time 0.537 (0.758) data 0.000 (0.222) loss 1.5908 (1.5360) lr 3.7566e-02 eta 0:03:04
epoch [30/50] batch [10/12] time 0.539 (0.714) data 0.000 (0.177) loss 1.7471 (1.5461) lr 3.7566e-02 eta 0:02:52
epoch [30/50] batch [12/12] time 0.540 (0.685) data 0.000 (0.148) loss 1.5732 (1.5422) lr 3.4549e-02 eta 0:02:44
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.37s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 610
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 85.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/12] time 0.517 (1.262) data 0.000 (0.637) loss 1.4775 (1.5122) lr 3.4549e-02 eta 0:05:00
epoch [31/50] batch [4/12] time 0.510 (0.886) data 0.000 (0.319) loss 1.5566 (1.5288) lr 3.4549e-02 eta 0:03:29
epoch [31/50] batch [6/12] time 0.528 (0.766) data 0.000 (0.213) loss 1.3877 (1.4935) lr 3.4549e-02 eta 0:02:59
epoch [31/50] batch [8/12] time 0.535 (0.710) data 0.000 (0.160) loss 1.6777 (1.5197) lr 3.4549e-02 eta 0:02:44
epoch [31/50] batch [10/12] time 0.514 (0.671) data 0.000 (0.128) loss 1.3496 (1.5053) lr 3.4549e-02 eta 0:02:34
epoch [31/50] batch [12/12] time 0.528 (0.646) data 0.000 (0.106) loss 1.5674 (1.5174) lr 3.1594e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.25s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 609
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 85.4%

epoch [32/50] batch [2/12] time 0.533 (1.429) data 0.000 (0.875) loss 1.5566 (1.6123) lr 3.1594e-02 eta 0:05:22
epoch [32/50] batch [4/12] time 0.538 (0.983) data 0.000 (0.438) loss 1.6406 (1.5898) lr 3.1594e-02 eta 0:03:40
epoch [32/50] batch [6/12] time 0.534 (0.833) data 0.000 (0.292) loss 1.8379 (1.6009) lr 3.1594e-02 eta 0:03:04
epoch [32/50] batch [8/12] time 0.536 (0.758) data 0.000 (0.219) loss 1.6016 (1.6228) lr 3.1594e-02 eta 0:02:46
epoch [32/50] batch [10/12] time 0.529 (0.713) data 0.000 (0.175) loss 1.3955 (1.5924) lr 3.1594e-02 eta 0:02:35
epoch [32/50] batch [12/12] time 0.530 (0.682) data 0.000 (0.146) loss 1.3701 (1.5546) lr 2.8711e-02 eta 0:02:27
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.44s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 621
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 87.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [33/50] batch [2/12] time 0.529 (1.425) data 0.000 (0.877) loss 1.4189 (1.3887) lr 2.8711e-02 eta 0:05:04
epoch [33/50] batch [4/12] time 0.528 (0.976) data 0.000 (0.439) loss 1.5879 (1.4976) lr 2.8711e-02 eta 0:03:26
epoch [33/50] batch [6/12] time 0.518 (0.823) data 0.000 (0.293) loss 1.5127 (1.5124) lr 2.8711e-02 eta 0:02:52
epoch [33/50] batch [8/12] time 0.505 (0.745) data 0.000 (0.219) loss 1.2998 (1.4778) lr 2.8711e-02 eta 0:02:34
epoch [33/50] batch [10/12] time 0.507 (0.697) data 0.000 (0.176) loss 1.6748 (1.5006) lr 2.8711e-02 eta 0:02:23
epoch [33/50] batch [12/12] time 0.502 (0.665) data 0.000 (0.146) loss 1.5830 (1.4998) lr 2.5912e-02 eta 0:02:15
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 622
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 87.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [34/50] batch [2/12] time 0.508 (1.382) data 0.000 (0.837) loss 1.4238 (1.4316) lr 2.5912e-02 eta 0:04:39
epoch [34/50] batch [4/12] time 0.509 (0.946) data 0.000 (0.419) loss 1.3877 (1.4607) lr 2.5912e-02 eta 0:03:09
epoch [34/50] batch [6/12] time 0.507 (0.800) data 0.000 (0.279) loss 1.5283 (1.4767) lr 2.5912e-02 eta 0:02:38
epoch [34/50] batch [8/12] time 0.507 (0.727) data 0.000 (0.210) loss 1.5195 (1.4812) lr 2.5912e-02 eta 0:02:22
epoch [34/50] batch [10/12] time 0.505 (0.682) data 0.000 (0.168) loss 1.4219 (1.4776) lr 2.5912e-02 eta 0:02:12
epoch [34/50] batch [12/12] time 0.518 (0.654) data 0.000 (0.140) loss 1.5166 (1.4830) lr 2.3209e-02 eta 0:02:05
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 617
* accuracy: 88.6%
* error: 11.4%
* macro_f1: 87.0%

epoch [35/50] batch [2/12] time 0.536 (1.350) data 0.001 (0.708) loss 1.4873 (1.4702) lr 2.3209e-02 eta 0:04:16
epoch [35/50] batch [4/12] time 0.532 (0.942) data 0.000 (0.354) loss 1.5127 (1.4612) lr 2.3209e-02 eta 0:02:57
epoch [35/50] batch [6/12] time 0.527 (0.804) data 0.000 (0.236) loss 1.4121 (1.4447) lr 2.3209e-02 eta 0:02:29
epoch [35/50] batch [8/12] time 0.525 (0.734) data 0.000 (0.177) loss 1.5039 (1.4623) lr 2.3209e-02 eta 0:02:15
epoch [35/50] batch [10/12] time 0.537 (0.694) data 0.000 (0.142) loss 1.5352 (1.4724) lr 2.3209e-02 eta 0:02:06
epoch [35/50] batch [12/12] time 0.539 (0.669) data 0.000 (0.118) loss 1.5225 (1.4641) lr 2.0611e-02 eta 0:02:00
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 623
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 87.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [36/50] batch [2/12] time 0.515 (1.345) data 0.000 (0.815) loss 1.4717 (1.4785) lr 2.0611e-02 eta 0:03:59
epoch [36/50] batch [4/12] time 0.514 (0.960) data 0.000 (0.408) loss 1.4404 (1.4534) lr 2.0611e-02 eta 0:02:48
epoch [36/50] batch [6/12] time 0.515 (0.811) data 0.000 (0.272) loss 1.5225 (1.4888) lr 2.0611e-02 eta 0:02:21
epoch [36/50] batch [8/12] time 0.515 (0.737) data 0.000 (0.204) loss 1.5537 (1.4779) lr 2.0611e-02 eta 0:02:06
epoch [36/50] batch [10/12] time 0.531 (0.694) data 0.000 (0.163) loss 1.6055 (1.5005) lr 2.0611e-02 eta 0:01:58
epoch [36/50] batch [12/12] time 0.548 (0.669) data 0.000 (0.136) loss 1.4922 (1.4915) lr 1.8129e-02 eta 0:01:52
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 615
* accuracy: 88.4%
* error: 11.6%
* macro_f1: 86.9%

epoch [37/50] batch [2/12] time 0.529 (1.325) data 0.000 (0.756) loss 1.3955 (1.4473) lr 1.8129e-02 eta 0:03:39
epoch [37/50] batch [4/12] time 0.549 (0.937) data 0.000 (0.378) loss 1.6553 (1.4910) lr 1.8129e-02 eta 0:02:33
epoch [37/50] batch [6/12] time 0.533 (0.802) data 0.000 (0.252) loss 1.4385 (1.4673) lr 1.8129e-02 eta 0:02:09
epoch [37/50] batch [8/12] time 0.533 (0.735) data 0.000 (0.189) loss 1.5166 (1.4666) lr 1.8129e-02 eta 0:01:57
epoch [37/50] batch [10/12] time 0.534 (0.694) data 0.000 (0.151) loss 1.4160 (1.4472) lr 1.8129e-02 eta 0:01:49
epoch [37/50] batch [12/12] time 0.531 (0.667) data 0.000 (0.126) loss 1.4668 (1.4564) lr 1.5773e-02 eta 0:01:44
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.45s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 622
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 87.5%

epoch [38/50] batch [2/12] time 0.530 (1.302) data 0.000 (0.667) loss 1.5371 (1.5156) lr 1.5773e-02 eta 0:03:20
epoch [38/50] batch [4/12] time 0.528 (0.915) data 0.000 (0.334) loss 1.5830 (1.5115) lr 1.5773e-02 eta 0:02:19
epoch [38/50] batch [6/12] time 0.535 (0.787) data 0.000 (0.223) loss 1.3145 (1.4666) lr 1.5773e-02 eta 0:01:58
epoch [38/50] batch [8/12] time 0.539 (0.726) data 0.000 (0.167) loss 1.4775 (1.4738) lr 1.5773e-02 eta 0:01:47
epoch [38/50] batch [10/12] time 0.532 (0.687) data 0.000 (0.134) loss 1.5459 (1.4773) lr 1.5773e-02 eta 0:01:40
epoch [38/50] batch [12/12] time 0.512 (0.659) data 0.000 (0.111) loss 1.4180 (1.4702) lr 1.3552e-02 eta 0:01:34
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.31s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 624
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 87.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [39/50] batch [2/12] time 0.545 (1.365) data 0.001 (0.799) loss 1.4854 (1.5107) lr 1.3552e-02 eta 0:03:13
epoch [39/50] batch [4/12] time 0.515 (0.941) data 0.000 (0.400) loss 1.6592 (1.5173) lr 1.3552e-02 eta 0:02:11
epoch [39/50] batch [6/12] time 0.509 (0.797) data 0.000 (0.267) loss 1.4268 (1.4967) lr 1.3552e-02 eta 0:01:49
epoch [39/50] batch [8/12] time 0.508 (0.724) data 0.000 (0.200) loss 1.5107 (1.4984) lr 1.3552e-02 eta 0:01:38
epoch [39/50] batch [10/12] time 0.515 (0.682) data 0.000 (0.160) loss 1.5029 (1.4836) lr 1.3552e-02 eta 0:01:31
epoch [39/50] batch [12/12] time 0.512 (0.654) data 0.000 (0.133) loss 1.3125 (1.4744) lr 1.1474e-02 eta 0:01:26
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.47s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 618
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 87.3%

epoch [40/50] batch [2/12] time 0.548 (1.347) data 0.001 (0.685) loss 1.6436 (1.6313) lr 1.1474e-02 eta 0:02:55
epoch [40/50] batch [4/12] time 0.544 (0.947) data 0.000 (0.343) loss 1.5684 (1.5713) lr 1.1474e-02 eta 0:02:01
epoch [40/50] batch [6/12] time 0.545 (0.813) data 0.000 (0.229) loss 1.4648 (1.5303) lr 1.1474e-02 eta 0:01:42
epoch [40/50] batch [8/12] time 0.527 (0.744) data 0.000 (0.172) loss 1.4697 (1.5287) lr 1.1474e-02 eta 0:01:32
epoch [40/50] batch [10/12] time 0.531 (0.703) data 0.000 (0.137) loss 1.4453 (1.5152) lr 1.1474e-02 eta 0:01:25
epoch [40/50] batch [12/12] time 0.535 (0.674) data 0.000 (0.114) loss 1.4609 (1.5068) lr 9.5492e-03 eta 0:01:20
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.42s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/12] time 0.504 (1.403) data 0.000 (0.876) loss 1.3516 (1.3413) lr 9.5492e-03 eta 0:02:45
epoch [41/50] batch [4/12] time 0.506 (0.954) data 0.000 (0.438) loss 1.4385 (1.3970) lr 9.5492e-03 eta 0:01:50
epoch [41/50] batch [6/12] time 0.504 (0.804) data 0.000 (0.292) loss 1.4365 (1.4115) lr 9.5492e-03 eta 0:01:31
epoch [41/50] batch [8/12] time 0.503 (0.729) data 0.000 (0.219) loss 1.4111 (1.4100) lr 9.5492e-03 eta 0:01:21
epoch [41/50] batch [10/12] time 0.505 (0.684) data 0.000 (0.176) loss 1.4570 (1.4120) lr 9.5492e-03 eta 0:01:15
epoch [41/50] batch [12/12] time 0.505 (0.654) data 0.000 (0.146) loss 1.6074 (1.4461) lr 7.7836e-03 eta 0:01:10
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.30s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 624
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 88.0%

epoch [42/50] batch [2/12] time 0.508 (1.345) data 0.000 (0.786) loss 1.3535 (1.4009) lr 7.7836e-03 eta 0:02:22
epoch [42/50] batch [4/12] time 0.511 (0.928) data 0.000 (0.393) loss 1.5098 (1.4587) lr 7.7836e-03 eta 0:01:36
epoch [42/50] batch [6/12] time 0.521 (0.790) data 0.000 (0.262) loss 1.4736 (1.4587) lr 7.7836e-03 eta 0:01:20
epoch [42/50] batch [8/12] time 0.532 (0.726) data 0.000 (0.197) loss 1.5186 (1.4738) lr 7.7836e-03 eta 0:01:12
epoch [42/50] batch [10/12] time 0.534 (0.687) data 0.000 (0.157) loss 1.4082 (1.4644) lr 7.7836e-03 eta 0:01:07
epoch [42/50] batch [12/12] time 0.534 (0.662) data 0.000 (0.131) loss 1.3320 (1.4510) lr 6.1847e-03 eta 0:01:03
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.51s/it] 50%|█████     | 2/4 [00:03<00:03,  1.63s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.03s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.11s/it]=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.7%

epoch [43/50] batch [2/12] time 0.531 (1.311) data 0.000 (0.686) loss 1.4199 (1.4453) lr 6.1847e-03 eta 0:02:03
epoch [43/50] batch [4/12] time 0.533 (0.921) data 0.000 (0.343) loss 1.5469 (1.4736) lr 6.1847e-03 eta 0:01:24
epoch [43/50] batch [6/12] time 0.536 (0.793) data 0.000 (0.229) loss 1.4756 (1.4631) lr 6.1847e-03 eta 0:01:11
epoch [43/50] batch [8/12] time 0.536 (0.728) data 0.000 (0.172) loss 1.3936 (1.4266) lr 6.1847e-03 eta 0:01:04
epoch [43/50] batch [10/12] time 0.538 (0.690) data 0.000 (0.137) loss 1.3350 (1.4192) lr 6.1847e-03 eta 0:00:59
epoch [43/50] batch [12/12] time 0.536 (0.664) data 0.000 (0.115) loss 1.3818 (1.4232) lr 4.7586e-03 eta 0:00:55
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.31s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 624
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 87.9%

epoch [44/50] batch [2/12] time 0.503 (1.353) data 0.000 (0.816) loss 1.4111 (1.3628) lr 4.7586e-03 eta 0:01:50
epoch [44/50] batch [4/12] time 0.514 (0.933) data 0.001 (0.408) loss 1.6494 (1.4812) lr 4.7586e-03 eta 0:01:14
epoch [44/50] batch [6/12] time 0.530 (0.799) data 0.000 (0.272) loss 1.3643 (1.4489) lr 4.7586e-03 eta 0:01:02
epoch [44/50] batch [8/12] time 0.509 (0.726) data 0.000 (0.204) loss 1.4707 (1.4557) lr 4.7586e-03 eta 0:00:55
epoch [44/50] batch [10/12] time 0.506 (0.682) data 0.000 (0.163) loss 1.4209 (1.4455) lr 4.7586e-03 eta 0:00:50
epoch [44/50] batch [12/12] time 0.506 (0.653) data 0.000 (0.136) loss 1.4307 (1.4473) lr 3.5112e-03 eta 0:00:46
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.52it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 624
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 88.1%

epoch [45/50] batch [2/12] time 0.538 (1.428) data 0.001 (0.855) loss 1.3711 (1.3315) lr 3.5112e-03 eta 0:01:39
epoch [45/50] batch [4/12] time 0.534 (0.981) data 0.000 (0.428) loss 1.3613 (1.3552) lr 3.5112e-03 eta 0:01:06
epoch [45/50] batch [6/12] time 0.531 (0.832) data 0.000 (0.285) loss 1.3652 (1.3687) lr 3.5112e-03 eta 0:00:54
epoch [45/50] batch [8/12] time 0.531 (0.757) data 0.000 (0.214) loss 1.5000 (1.4009) lr 3.5112e-03 eta 0:00:48
epoch [45/50] batch [10/12] time 0.531 (0.712) data 0.000 (0.171) loss 1.5371 (1.4225) lr 3.5112e-03 eta 0:00:44
epoch [45/50] batch [12/12] time 0.527 (0.681) data 0.000 (0.143) loss 1.3633 (1.4237) lr 2.4472e-03 eta 0:00:40
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 631
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 89.7%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar

epoch [46/50] batch [2/12] time 0.529 (1.394) data 0.000 (0.837) loss 1.5010 (1.4087) lr 2.4472e-03 eta 0:01:20
epoch [46/50] batch [4/12] time 0.532 (0.964) data 0.000 (0.419) loss 1.3721 (1.4297) lr 2.4472e-03 eta 0:00:53
epoch [46/50] batch [6/12] time 0.512 (0.815) data 0.000 (0.279) loss 1.5938 (1.4671) lr 2.4472e-03 eta 0:00:44
epoch [46/50] batch [8/12] time 0.513 (0.754) data 0.000 (0.210) loss 1.3926 (1.4487) lr 2.4472e-03 eta 0:00:39
epoch [46/50] batch [10/12] time 0.518 (0.706) data 0.000 (0.168) loss 1.5781 (1.4570) lr 2.4472e-03 eta 0:00:35
epoch [46/50] batch [12/12] time 0.517 (0.675) data 0.000 (0.140) loss 1.5029 (1.4619) lr 1.5708e-03 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 629
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 89.3%

epoch [47/50] batch [2/12] time 0.509 (1.318) data 0.000 (0.776) loss 1.4717 (1.4287) lr 1.5708e-03 eta 0:01:00
epoch [47/50] batch [4/12] time 0.509 (0.913) data 0.000 (0.388) loss 1.4512 (1.4678) lr 1.5708e-03 eta 0:00:40
epoch [47/50] batch [6/12] time 0.514 (0.780) data 0.000 (0.259) loss 1.3066 (1.4251) lr 1.5708e-03 eta 0:00:32
epoch [47/50] batch [8/12] time 0.513 (0.713) data 0.000 (0.194) loss 1.5293 (1.4280) lr 1.5708e-03 eta 0:00:28
epoch [47/50] batch [10/12] time 0.535 (0.675) data 0.000 (0.155) loss 1.5215 (1.4467) lr 1.5708e-03 eta 0:00:25
epoch [47/50] batch [12/12] time 0.534 (0.652) data 0.000 (0.130) loss 1.5430 (1.4606) lr 8.8564e-04 eta 0:00:23
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.51s/it] 50%|█████     | 2/4 [00:03<00:03,  1.63s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.11s/it]=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.6%

epoch [48/50] batch [2/12] time 0.549 (1.359) data 0.001 (0.704) loss 1.4854 (1.4722) lr 8.8564e-04 eta 0:00:46
epoch [48/50] batch [4/12] time 0.536 (0.946) data 0.000 (0.352) loss 1.4658 (1.4521) lr 8.8564e-04 eta 0:00:30
epoch [48/50] batch [6/12] time 0.544 (0.810) data 0.000 (0.235) loss 1.4258 (1.4494) lr 8.8564e-04 eta 0:00:24
epoch [48/50] batch [8/12] time 0.544 (0.744) data 0.000 (0.176) loss 1.2715 (1.4293) lr 8.8564e-04 eta 0:00:20
epoch [48/50] batch [10/12] time 0.538 (0.703) data 0.000 (0.141) loss 1.4238 (1.4262) lr 8.8564e-04 eta 0:00:18
epoch [48/50] batch [12/12] time 0.563 (0.678) data 0.001 (0.118) loss 1.4629 (1.4369) lr 3.9426e-04 eta 0:00:16
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.6%

epoch [49/50] batch [2/12] time 0.507 (1.311) data 0.000 (0.769) loss 1.4863 (1.5029) lr 3.9426e-04 eta 0:00:28
epoch [49/50] batch [4/12] time 0.509 (0.909) data 0.000 (0.385) loss 1.4512 (1.4734) lr 3.9426e-04 eta 0:00:18
epoch [49/50] batch [6/12] time 0.506 (0.775) data 0.000 (0.256) loss 1.6201 (1.4759) lr 3.9426e-04 eta 0:00:13
epoch [49/50] batch [8/12] time 0.509 (0.709) data 0.000 (0.192) loss 1.3574 (1.4476) lr 3.9426e-04 eta 0:00:11
epoch [49/50] batch [10/12] time 0.532 (0.675) data 0.000 (0.154) loss 1.3379 (1.4412) lr 3.9426e-04 eta 0:00:09
epoch [49/50] batch [12/12] time 0.520 (0.649) data 0.000 (0.128) loss 1.4355 (1.4329) lr 9.8664e-05 eta 0:00:07
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.6%

epoch [50/50] batch [2/12] time 0.540 (1.267) data 0.000 (0.619) loss 1.5303 (1.4111) lr 9.8664e-05 eta 0:00:12
epoch [50/50] batch [4/12] time 0.557 (0.907) data 0.000 (0.309) loss 1.4961 (1.4429) lr 9.8664e-05 eta 0:00:07
epoch [50/50] batch [6/12] time 0.546 (0.786) data 0.000 (0.206) loss 1.3584 (1.4375) lr 9.8664e-05 eta 0:00:04
epoch [50/50] batch [8/12] time 0.543 (0.726) data 0.000 (0.155) loss 1.4619 (1.4370) lr 9.8664e-05 eta 0:00:02
epoch [50/50] batch [10/12] time 0.547 (0.690) data 0.000 (0.124) loss 1.5127 (1.4432) lr 9.8664e-05 eta 0:00:01
epoch [50/50] batch [12/12] time 0.551 (0.666) data 0.000 (0.103) loss 1.5684 (1.4491) lr 0.0000e+00 eta 0:00:00
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.45s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]
=> result
* total: 696
* correct: 627
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 88.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model.pth.tar-50
Finish training
Deploy the model with the best val performance
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 45)
Evaluate on the *test* set
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:03<00:18,  3.78s/it] 33%|███▎      | 2/6 [00:04<00:06,  1.74s/it] 50%|█████     | 3/6 [00:04<00:03,  1.09s/it] 67%|██████▋   | 4/6 [00:04<00:01,  1.28it/s] 83%|████████▎ | 5/6 [00:05<00:00,  1.64it/s]100%|██████████| 6/6 [00:05<00:00,  2.23it/s]100%|██████████| 6/6 [00:05<00:00,  1.14it/s]
=> result
* total: 1,053
* correct: 975
* accuracy: 92.6%
* error: 7.4%
* macro_f1: 91.9%
Elapsed: 0:10:26
+ sh scripts/rpo_prime/base2new_test_sdl.sh oxford_flowers 2 0 main_tmp1_0.1sdl 16 new
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
Setting fixed seed: 2
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: True
head: 
load_epoch: None
model_dir: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'new']
output_dir: output/rpo_prime/base2new/test_new/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 2
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordFlowers
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: new
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/test_new/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2
RESUME: 
SEED: 2
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:OxfordFlowers
Loading dataset: OxfordFlowers
Reading split from /shared/s2/lab01/dataset/clip/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_flowers/split_fewshot_taesup/shot_16-seed_2.pkl
SUBSAMPLE NEW CLASSES!
816 937 1410
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------
Dataset    OxfordFlowers
# classes  51
# train_x  816
# val      937
# test     1,410
---------  -------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
Loading weights to prompt_learner from "output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed2/prompt_learner/model-best.pth.tar" (epoch = 45)
Evaluate on the *test* set
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:06<00:44,  6.33s/it] 25%|██▌       | 2/8 [00:06<00:16,  2.79s/it] 38%|███▊      | 3/8 [00:06<00:08,  1.66s/it] 50%|█████     | 4/8 [00:07<00:04,  1.13s/it] 62%|██████▎   | 5/8 [00:07<00:02,  1.20it/s] 75%|███████▌  | 6/8 [00:07<00:01,  1.53it/s] 88%|████████▊ | 7/8 [00:08<00:00,  1.84it/s]100%|██████████| 8/8 [00:08<00:00,  1.05s/it]
=> result
* total: 1,410
* correct: 1,053
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 69.9%
+ for seed in 1 2 3
+ sh scripts/rpo_prime/base2new_train_sdl.sh oxford_flowers 3 0 main_tmp1_0.1sdl 16
Setting fixed seed: 3
***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/RPO_prime/main_tmp1_0.1sdl.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.SUBSAMPLE_CLASSES', 'base']
output_dir: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
resume: 
root: /shared/s2/lab01/dataset/clip
seed: 3
source_domains: None
target_domains: None
trainer: RPO_prime_sdl
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 12
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 196
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: OxfordFlowers
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PROMPT: a photo of a _.
  ROOT: /shared/s2/lab01/dataset/clip
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: base
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: ViT-B/16
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.1
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: -1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: linear
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3
RESUME: 
SEED: 3
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: best_val
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 10
  COUNT_ITER: train_x
  PRINT_FREQ: 2
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: a photo of a
    N_CTX: 4
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: 
    CSC: False
    CTX_INIT: 
    N_CTX: 4
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  LP:
    PREC: fp16
    PROMPT: A photo of a {cls_name}
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: RPO_prime_sdl
  RPO:
    CTX_INIT: a photo of a
    K1: 8
    K2: 24
    PREC: fp16
    sdl_loss: 1
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.6 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
Clang version: Could not collect
CMake version: version 3.16.3
Libc version: glibc-2.10

Python version: 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21)  [GCC 9.4.0] (64-bit runtime)
Python platform: Linux-5.4.0-100-generic-x86_64-with-debian-bullseye-sid
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: GPU 0: NVIDIA TITAN RTX
Nvidia driver version: 520.61.05
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] imagenetv2-pytorch==0.1
[pip3] numpy==1.21.5
[pip3] torch==1.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               10.2.89              hfd86e86_1  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] imagenetv2-pytorch        0.1                      pypi_0    pypi
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.6                   pypi_0    pypi
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.13.1          py3.7_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_5    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchvision               0.14.1               py37_cu117    pytorch
        Pillow (9.4.0)

requested:RPO_prime_sdl
Loading trainer: RPO_prime_sdl
requested:OxfordFlowers
Loading dataset: OxfordFlowers
Reading split from /shared/s2/lab01/dataset/clip/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /shared/s2/lab01/dataset/clip/oxford_flowers/split_fewshot_taesup/shot_16-seed_3.pkl
SUBSAMPLE BASE CLASSES!
816 696 1053
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------
Dataset    OxfordFlowers
# classes  51
# train_x  816
# val      696
# test     1,053
---------  -------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Parameters to be updated: {'prompt_learner.text_prompt', 'prompt_learner.img_prompt'}
requested:Classification
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/tensorboard)
/shared/s2/lab01/myungjoo/RPO_v2/clip/clip.py:23: UserWarning: PyTorch version 1.7.1 or higher is recommended
  warnings.warn("PyTorch version 1.7.1 or higher is recommended")
epoch [1/50] batch [2/12] time 0.515 (2.363) data 0.000 (0.981) loss 3.1445 (3.1807) lr 1.0000e-01 eta 0:23:32
epoch [1/50] batch [4/12] time 0.518 (1.440) data 0.000 (0.490) loss 2.8652 (3.0576) lr 1.0000e-01 eta 0:14:18
epoch [1/50] batch [6/12] time 0.518 (1.132) data 0.000 (0.327) loss 2.4062 (2.8262) lr 1.0000e-01 eta 0:11:12
epoch [1/50] batch [8/12] time 0.517 (0.979) data 0.000 (0.245) loss 2.2305 (2.6370) lr 1.0000e-01 eta 0:09:39
epoch [1/50] batch [10/12] time 0.515 (0.886) data 0.000 (0.196) loss 2.4727 (2.5588) lr 1.0000e-01 eta 0:08:43
epoch [1/50] batch [12/12] time 0.537 (0.827) data 0.000 (0.164) loss 2.1699 (2.4971) lr 9.9901e-02 eta 0:08:06
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:11,  3.68s/it] 50%|█████     | 2/4 [00:03<00:03,  1.70s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.06s/it]100%|██████████| 4/4 [00:04<00:00,  1.39it/s]100%|██████████| 4/4 [00:04<00:00,  1.15s/it]=> result
* total: 696
* correct: 494
* accuracy: 71.0%
* error: 29.0%
* macro_f1: 63.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [2/50] batch [2/12] time 0.539 (1.310) data 0.001 (0.642) loss 2.2598 (2.2002) lr 9.9901e-02 eta 0:12:47
epoch [2/50] batch [4/12] time 0.547 (0.926) data 0.000 (0.321) loss 2.0332 (2.1084) lr 9.9901e-02 eta 0:09:01
epoch [2/50] batch [6/12] time 0.536 (0.798) data 0.000 (0.214) loss 2.3281 (2.1364) lr 9.9901e-02 eta 0:07:44
epoch [2/50] batch [8/12] time 0.532 (0.731) data 0.000 (0.161) loss 1.7617 (2.0776) lr 9.9901e-02 eta 0:07:04
epoch [2/50] batch [10/12] time 0.550 (0.694) data 0.000 (0.129) loss 2.0078 (2.0539) lr 9.9901e-02 eta 0:06:41
epoch [2/50] batch [12/12] time 0.541 (0.668) data 0.000 (0.107) loss 2.2363 (2.0535) lr 9.9606e-02 eta 0:06:24
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.34s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 500
* accuracy: 71.8%
* error: 28.2%
* macro_f1: 64.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [3/50] batch [2/12] time 0.515 (1.206) data 0.001 (0.575) loss 1.7832 (1.8936) lr 9.9606e-02 eta 0:11:32
epoch [3/50] batch [4/12] time 0.520 (0.863) data 0.000 (0.288) loss 1.9590 (1.9878) lr 9.9606e-02 eta 0:08:13
epoch [3/50] batch [6/12] time 0.517 (0.747) data 0.000 (0.192) loss 1.9463 (1.9502) lr 9.9606e-02 eta 0:07:06
epoch [3/50] batch [8/12] time 0.517 (0.690) data 0.000 (0.144) loss 2.0352 (1.9592) lr 9.9606e-02 eta 0:06:31
epoch [3/50] batch [10/12] time 0.534 (0.657) data 0.000 (0.115) loss 2.1992 (2.0064) lr 9.9606e-02 eta 0:06:11
epoch [3/50] batch [12/12] time 0.535 (0.636) data 0.000 (0.096) loss 1.8242 (1.9930) lr 9.9114e-02 eta 0:05:58
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.16s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.01s/it]=> result
* total: 696
* correct: 506
* accuracy: 72.7%
* error: 27.3%
* macro_f1: 65.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [4/50] batch [2/12] time 0.514 (1.212) data 0.000 (0.589) loss 1.9404 (1.9116) lr 9.9114e-02 eta 0:11:21
epoch [4/50] batch [4/12] time 0.538 (0.871) data 0.000 (0.294) loss 1.9385 (1.8918) lr 9.9114e-02 eta 0:08:07
epoch [4/50] batch [6/12] time 0.554 (0.762) data 0.000 (0.196) loss 1.9463 (1.9587) lr 9.9114e-02 eta 0:07:05
epoch [4/50] batch [8/12] time 0.551 (0.710) data 0.000 (0.147) loss 1.8379 (1.9729) lr 9.9114e-02 eta 0:06:34
epoch [4/50] batch [10/12] time 0.548 (0.677) data 0.000 (0.118) loss 2.1914 (2.0035) lr 9.9114e-02 eta 0:06:15
epoch [4/50] batch [12/12] time 0.546 (0.656) data 0.000 (0.098) loss 1.8906 (1.9826) lr 9.8429e-02 eta 0:06:01
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.48s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 513
* accuracy: 73.7%
* error: 26.3%
* macro_f1: 67.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [5/50] batch [2/12] time 0.531 (1.392) data 0.000 (0.835) loss 1.7285 (1.7563) lr 9.8429e-02 eta 0:12:45
epoch [5/50] batch [4/12] time 0.533 (0.961) data 0.000 (0.418) loss 1.8242 (1.8152) lr 9.8429e-02 eta 0:08:46
epoch [5/50] batch [6/12] time 0.542 (0.819) data 0.000 (0.278) loss 1.9658 (1.8164) lr 9.8429e-02 eta 0:07:27
epoch [5/50] batch [8/12] time 0.533 (0.747) data 0.000 (0.209) loss 1.8271 (1.8191) lr 9.8429e-02 eta 0:06:46
epoch [5/50] batch [10/12] time 0.521 (0.703) data 0.000 (0.167) loss 1.6416 (1.8202) lr 9.8429e-02 eta 0:06:20
epoch [5/50] batch [12/12] time 0.508 (0.671) data 0.000 (0.139) loss 1.9961 (1.8792) lr 9.7553e-02 eta 0:06:02
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.22s/it] 50%|█████     | 2/4 [00:03<00:03,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 513
* accuracy: 73.7%
* error: 26.3%
* macro_f1: 68.1%

epoch [6/50] batch [2/12] time 0.526 (1.245) data 0.000 (0.625) loss 1.9121 (1.9087) lr 9.7553e-02 eta 0:11:09
epoch [6/50] batch [4/12] time 0.507 (0.884) data 0.000 (0.313) loss 1.8379 (1.8552) lr 9.7553e-02 eta 0:07:53
epoch [6/50] batch [6/12] time 0.509 (0.759) data 0.000 (0.208) loss 1.9277 (1.8727) lr 9.7553e-02 eta 0:06:45
epoch [6/50] batch [8/12] time 0.506 (0.695) data 0.000 (0.156) loss 1.8623 (1.8556) lr 9.7553e-02 eta 0:06:09
epoch [6/50] batch [10/12] time 0.506 (0.658) data 0.000 (0.125) loss 1.6973 (1.8190) lr 9.7553e-02 eta 0:05:48
epoch [6/50] batch [12/12] time 0.508 (0.632) data 0.000 (0.104) loss 2.0039 (1.8547) lr 9.6489e-02 eta 0:05:33
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.26s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.52it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 520
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 68.8%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [7/50] batch [2/12] time 0.538 (1.402) data 0.001 (0.840) loss 1.7041 (1.7925) lr 9.6489e-02 eta 0:12:17
epoch [7/50] batch [4/12] time 0.534 (0.968) data 0.000 (0.420) loss 1.7246 (1.7886) lr 9.6489e-02 eta 0:08:27
epoch [7/50] batch [6/12] time 0.549 (0.826) data 0.000 (0.280) loss 2.0117 (1.8101) lr 9.6489e-02 eta 0:07:11
epoch [7/50] batch [8/12] time 0.530 (0.755) data 0.000 (0.210) loss 2.0410 (1.8478) lr 9.6489e-02 eta 0:06:32
epoch [7/50] batch [10/12] time 0.529 (0.710) data 0.000 (0.168) loss 1.7939 (1.8385) lr 9.6489e-02 eta 0:06:07
epoch [7/50] batch [12/12] time 0.531 (0.680) data 0.000 (0.140) loss 1.7773 (1.8438) lr 9.5241e-02 eta 0:05:50
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.38s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 520
* accuracy: 74.7%
* error: 25.3%
* macro_f1: 69.4%

epoch [8/50] batch [2/12] time 0.682 (1.470) data 0.000 (0.851) loss 2.0332 (1.9136) lr 9.5241e-02 eta 0:12:35
epoch [8/50] batch [4/12] time 0.506 (0.988) data 0.000 (0.426) loss 1.4141 (1.7715) lr 9.5241e-02 eta 0:08:25
epoch [8/50] batch [6/12] time 0.502 (0.827) data 0.000 (0.284) loss 1.9990 (1.8283) lr 9.5241e-02 eta 0:07:01
epoch [8/50] batch [8/12] time 0.504 (0.747) data 0.000 (0.213) loss 1.6152 (1.8234) lr 9.5241e-02 eta 0:06:19
epoch [8/50] batch [10/12] time 0.505 (0.698) data 0.000 (0.170) loss 1.7783 (1.8307) lr 9.5241e-02 eta 0:05:53
epoch [8/50] batch [12/12] time 0.502 (0.665) data 0.000 (0.142) loss 1.8027 (1.8467) lr 9.3815e-02 eta 0:05:35
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.31s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 523
* accuracy: 75.1%
* error: 24.9%
* macro_f1: 69.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [9/50] batch [2/12] time 0.503 (1.309) data 0.000 (0.786) loss 1.8867 (1.7617) lr 9.3815e-02 eta 0:10:57
epoch [9/50] batch [4/12] time 0.502 (0.905) data 0.000 (0.393) loss 1.7725 (1.8264) lr 9.3815e-02 eta 0:07:32
epoch [9/50] batch [6/12] time 0.527 (0.776) data 0.000 (0.262) loss 1.9062 (1.8434) lr 9.3815e-02 eta 0:06:26
epoch [9/50] batch [8/12] time 0.551 (0.717) data 0.000 (0.197) loss 1.9414 (1.8607) lr 9.3815e-02 eta 0:05:55
epoch [9/50] batch [10/12] time 0.538 (0.681) data 0.000 (0.157) loss 1.8457 (1.8612) lr 9.3815e-02 eta 0:05:36
epoch [9/50] batch [12/12] time 0.536 (0.657) data 0.000 (0.131) loss 1.6807 (1.8429) lr 9.2216e-02 eta 0:05:23
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.50s/it] 50%|█████     | 2/4 [00:03<00:03,  1.62s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 515
* accuracy: 74.0%
* error: 26.0%
* macro_f1: 69.2%

epoch [10/50] batch [2/12] time 0.538 (1.405) data 0.000 (0.831) loss 1.7305 (1.8081) lr 9.2216e-02 eta 0:11:28
epoch [10/50] batch [4/12] time 0.538 (0.971) data 0.000 (0.416) loss 1.6738 (1.7979) lr 9.2216e-02 eta 0:07:54
epoch [10/50] batch [6/12] time 0.542 (0.827) data 0.000 (0.277) loss 1.6475 (1.7712) lr 9.2216e-02 eta 0:06:42
epoch [10/50] batch [8/12] time 0.535 (0.755) data 0.000 (0.208) loss 1.7246 (1.7822) lr 9.2216e-02 eta 0:06:05
epoch [10/50] batch [10/12] time 0.535 (0.711) data 0.000 (0.166) loss 1.7363 (1.8000) lr 9.2216e-02 eta 0:05:42
epoch [10/50] batch [12/12] time 0.528 (0.682) data 0.000 (0.139) loss 1.8115 (1.7947) lr 9.0451e-02 eta 0:05:27
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.33s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 525
* accuracy: 75.4%
* error: 24.6%
* macro_f1: 70.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-10

epoch [11/50] batch [2/12] time 0.507 (1.329) data 0.000 (0.789) loss 1.7480 (1.8828) lr 9.0451e-02 eta 0:10:35
epoch [11/50] batch [4/12] time 0.509 (0.918) data 0.000 (0.395) loss 1.7109 (1.8049) lr 9.0451e-02 eta 0:07:16
epoch [11/50] batch [6/12] time 0.518 (0.783) data 0.000 (0.263) loss 1.7031 (1.8429) lr 9.0451e-02 eta 0:06:11
epoch [11/50] batch [8/12] time 0.533 (0.719) data 0.000 (0.198) loss 1.8926 (1.8168) lr 9.0451e-02 eta 0:05:39
epoch [11/50] batch [10/12] time 0.515 (0.679) data 0.000 (0.158) loss 1.8135 (1.8188) lr 9.0451e-02 eta 0:05:18
epoch [11/50] batch [12/12] time 0.511 (0.651) data 0.000 (0.132) loss 1.7686 (1.8378) lr 8.8526e-02 eta 0:05:04
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 533
* accuracy: 76.6%
* error: 23.4%
* macro_f1: 72.5%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [12/50] batch [2/12] time 0.546 (1.395) data 0.001 (0.798) loss 1.8037 (1.8345) lr 8.8526e-02 eta 0:10:50
epoch [12/50] batch [4/12] time 0.544 (0.969) data 0.000 (0.399) loss 1.7236 (1.8191) lr 8.8526e-02 eta 0:07:29
epoch [12/50] batch [6/12] time 0.546 (0.828) data 0.000 (0.266) loss 1.7803 (1.7673) lr 8.8526e-02 eta 0:06:22
epoch [12/50] batch [8/12] time 0.549 (0.761) data 0.000 (0.200) loss 1.7139 (1.7628) lr 8.8526e-02 eta 0:05:49
epoch [12/50] batch [10/12] time 0.532 (0.716) data 0.000 (0.160) loss 1.5898 (1.7386) lr 8.8526e-02 eta 0:05:28
epoch [12/50] batch [12/12] time 0.534 (0.686) data 0.000 (0.133) loss 1.9365 (1.7663) lr 8.6448e-02 eta 0:05:12
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 532
* accuracy: 76.4%
* error: 23.6%
* macro_f1: 71.7%

epoch [13/50] batch [2/12] time 0.533 (1.409) data 0.000 (0.832) loss 1.8506 (1.7905) lr 8.6448e-02 eta 0:10:39
epoch [13/50] batch [4/12] time 0.530 (0.969) data 0.000 (0.416) loss 1.8271 (1.8413) lr 8.6448e-02 eta 0:07:18
epoch [13/50] batch [6/12] time 0.519 (0.820) data 0.000 (0.278) loss 1.8369 (1.7933) lr 8.6448e-02 eta 0:06:09
epoch [13/50] batch [8/12] time 0.504 (0.742) data 0.000 (0.208) loss 1.8574 (1.8024) lr 8.6448e-02 eta 0:05:32
epoch [13/50] batch [10/12] time 0.508 (0.695) data 0.000 (0.167) loss 1.7676 (1.7933) lr 8.6448e-02 eta 0:05:09
epoch [13/50] batch [12/12] time 0.505 (0.663) data 0.000 (0.139) loss 1.6475 (1.7673) lr 8.4227e-02 eta 0:04:54
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.25s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 536
* accuracy: 77.0%
* error: 23.0%
* macro_f1: 72.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [14/50] batch [2/12] time 0.510 (1.353) data 0.000 (0.820) loss 1.6914 (1.7305) lr 8.4227e-02 eta 0:09:58
epoch [14/50] batch [4/12] time 0.505 (0.929) data 0.000 (0.410) loss 1.7832 (1.7263) lr 8.4227e-02 eta 0:06:48
epoch [14/50] batch [6/12] time 0.504 (0.788) data 0.000 (0.274) loss 1.8037 (1.7799) lr 8.4227e-02 eta 0:05:45
epoch [14/50] batch [8/12] time 0.505 (0.718) data 0.000 (0.205) loss 1.7188 (1.7382) lr 8.4227e-02 eta 0:05:12
epoch [14/50] batch [10/12] time 0.509 (0.675) data 0.000 (0.164) loss 1.6104 (1.7207) lr 8.4227e-02 eta 0:04:53
epoch [14/50] batch [12/12] time 0.521 (0.649) data 0.000 (0.137) loss 1.8818 (1.7257) lr 8.1871e-02 eta 0:04:40
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.55s/it] 50%|█████     | 2/4 [00:03<00:03,  1.65s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.04s/it]100%|██████████| 4/4 [00:04<00:00,  1.43it/s]100%|██████████| 4/4 [00:04<00:00,  1.12s/it]=> result
* total: 696
* correct: 545
* accuracy: 78.3%
* error: 21.7%
* macro_f1: 74.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [15/50] batch [2/12] time 0.535 (1.401) data 0.000 (0.837) loss 1.7979 (1.8208) lr 8.1871e-02 eta 0:10:02
epoch [15/50] batch [4/12] time 0.577 (0.980) data 0.000 (0.419) loss 1.5752 (1.7402) lr 8.1871e-02 eta 0:06:59
epoch [15/50] batch [6/12] time 0.566 (0.842) data 0.000 (0.279) loss 1.8271 (1.7536) lr 8.1871e-02 eta 0:05:58
epoch [15/50] batch [8/12] time 0.543 (0.770) data 0.000 (0.210) loss 1.6191 (1.7465) lr 8.1871e-02 eta 0:05:26
epoch [15/50] batch [10/12] time 0.542 (0.724) data 0.001 (0.168) loss 1.5713 (1.7266) lr 8.1871e-02 eta 0:05:05
epoch [15/50] batch [12/12] time 0.543 (0.694) data 0.000 (0.140) loss 1.9219 (1.7415) lr 7.9389e-02 eta 0:04:51
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.56s/it] 50%|█████     | 2/4 [00:03<00:03,  1.64s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.03s/it]100%|██████████| 4/4 [00:04<00:00,  1.43it/s]100%|██████████| 4/4 [00:04<00:00,  1.12s/it]=> result
* total: 696
* correct: 547
* accuracy: 78.6%
* error: 21.4%
* macro_f1: 75.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [16/50] batch [2/12] time 0.516 (1.323) data 0.000 (0.777) loss 1.6777 (1.6738) lr 7.9389e-02 eta 0:09:13
epoch [16/50] batch [4/12] time 0.512 (0.918) data 0.000 (0.389) loss 1.5947 (1.6577) lr 7.9389e-02 eta 0:06:21
epoch [16/50] batch [6/12] time 0.517 (0.784) data 0.000 (0.259) loss 1.7334 (1.6785) lr 7.9389e-02 eta 0:05:24
epoch [16/50] batch [8/12] time 0.516 (0.716) data 0.000 (0.194) loss 1.7275 (1.6891) lr 7.9389e-02 eta 0:04:55
epoch [16/50] batch [10/12] time 0.523 (0.677) data 0.000 (0.156) loss 1.6738 (1.7073) lr 7.9389e-02 eta 0:04:37
epoch [16/50] batch [12/12] time 0.545 (0.655) data 0.000 (0.130) loss 1.5439 (1.6946) lr 7.6791e-02 eta 0:04:27
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.21s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 555
* accuracy: 79.7%
* error: 20.3%
* macro_f1: 75.9%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [17/50] batch [2/12] time 0.528 (1.337) data 0.000 (0.769) loss 1.7549 (1.6870) lr 7.6791e-02 eta 0:09:02
epoch [17/50] batch [4/12] time 0.536 (0.937) data 0.000 (0.385) loss 1.6689 (1.6243) lr 7.6791e-02 eta 0:06:18
epoch [17/50] batch [6/12] time 0.539 (0.804) data 0.000 (0.257) loss 1.7490 (1.6720) lr 7.6791e-02 eta 0:05:23
epoch [17/50] batch [8/12] time 0.537 (0.738) data 0.000 (0.193) loss 1.6543 (1.6907) lr 7.6791e-02 eta 0:04:55
epoch [17/50] batch [10/12] time 0.548 (0.699) data 0.000 (0.154) loss 1.7852 (1.7047) lr 7.6791e-02 eta 0:04:38
epoch [17/50] batch [12/12] time 0.545 (0.685) data 0.000 (0.129) loss 1.6641 (1.7052) lr 7.4088e-02 eta 0:04:31
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.39s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 558
* accuracy: 80.2%
* error: 19.8%
* macro_f1: 76.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [18/50] batch [2/12] time 0.543 (1.401) data 0.000 (0.837) loss 1.5801 (1.5996) lr 7.4088e-02 eta 0:09:12
epoch [18/50] batch [4/12] time 0.528 (0.966) data 0.000 (0.419) loss 1.7129 (1.6416) lr 7.4088e-02 eta 0:06:18
epoch [18/50] batch [6/12] time 0.529 (0.821) data 0.001 (0.279) loss 1.7510 (1.7202) lr 7.4088e-02 eta 0:05:20
epoch [18/50] batch [8/12] time 0.533 (0.749) data 0.000 (0.210) loss 1.5371 (1.6754) lr 7.4088e-02 eta 0:04:50
epoch [18/50] batch [10/12] time 0.527 (0.705) data 0.000 (0.168) loss 1.6865 (1.6777) lr 7.4088e-02 eta 0:04:32
epoch [18/50] batch [12/12] time 0.510 (0.673) data 0.000 (0.140) loss 1.9482 (1.6963) lr 7.1289e-02 eta 0:04:18
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.16s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 551
* accuracy: 79.2%
* error: 20.8%
* macro_f1: 75.0%

epoch [19/50] batch [2/12] time 0.523 (1.331) data 0.000 (0.782) loss 1.6787 (1.6172) lr 7.1289e-02 eta 0:08:28
epoch [19/50] batch [4/12] time 0.510 (0.926) data 0.000 (0.391) loss 1.7705 (1.6636) lr 7.1289e-02 eta 0:05:51
epoch [19/50] batch [6/12] time 0.511 (0.788) data 0.000 (0.261) loss 1.6963 (1.6893) lr 7.1289e-02 eta 0:04:57
epoch [19/50] batch [8/12] time 0.513 (0.718) data 0.000 (0.196) loss 1.7207 (1.6930) lr 7.1289e-02 eta 0:04:30
epoch [19/50] batch [10/12] time 0.514 (0.677) data 0.000 (0.157) loss 1.5547 (1.6723) lr 7.1289e-02 eta 0:04:13
epoch [19/50] batch [12/12] time 0.508 (0.649) data 0.000 (0.131) loss 1.6543 (1.6690) lr 6.8406e-02 eta 0:04:01
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.27s/it] 50%|█████     | 2/4 [00:03<00:03,  1.53s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 558
* accuracy: 80.2%
* error: 19.8%
* macro_f1: 76.1%

epoch [20/50] batch [2/12] time 0.541 (1.293) data 0.001 (0.645) loss 1.6982 (1.7339) lr 6.8406e-02 eta 0:07:58
epoch [20/50] batch [4/12] time 0.549 (0.921) data 0.001 (0.323) loss 1.7764 (1.7324) lr 6.8406e-02 eta 0:05:38
epoch [20/50] batch [6/12] time 0.539 (0.795) data 0.000 (0.215) loss 1.5049 (1.6938) lr 6.8406e-02 eta 0:04:51
epoch [20/50] batch [8/12] time 0.533 (0.731) data 0.000 (0.162) loss 1.8135 (1.6897) lr 6.8406e-02 eta 0:04:26
epoch [20/50] batch [10/12] time 0.533 (0.691) data 0.000 (0.129) loss 1.7539 (1.6794) lr 6.8406e-02 eta 0:04:10
epoch [20/50] batch [12/12] time 0.526 (0.665) data 0.000 (0.108) loss 1.6523 (1.6769) lr 6.5451e-02 eta 0:03:59
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.33s/it] 50%|█████     | 2/4 [00:03<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 567
* accuracy: 81.5%
* error: 18.5%
* macro_f1: 78.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-20

epoch [21/50] batch [2/12] time 0.522 (1.372) data 0.000 (0.810) loss 1.5098 (1.5464) lr 6.5451e-02 eta 0:08:11
epoch [21/50] batch [4/12] time 0.507 (0.942) data 0.000 (0.405) loss 1.5820 (1.5874) lr 6.5451e-02 eta 0:05:35
epoch [21/50] batch [6/12] time 0.509 (0.798) data 0.000 (0.270) loss 1.7363 (1.6276) lr 6.5451e-02 eta 0:04:42
epoch [21/50] batch [8/12] time 0.516 (0.726) data 0.000 (0.203) loss 1.6348 (1.6770) lr 6.5451e-02 eta 0:04:15
epoch [21/50] batch [10/12] time 0.507 (0.683) data 0.000 (0.162) loss 1.6318 (1.6859) lr 6.5451e-02 eta 0:03:58
epoch [21/50] batch [12/12] time 0.510 (0.654) data 0.000 (0.135) loss 1.6475 (1.6691) lr 6.2434e-02 eta 0:03:47
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.30s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 581
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 80.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [22/50] batch [2/12] time 0.508 (1.301) data 0.001 (0.783) loss 1.6367 (1.6846) lr 6.2434e-02 eta 0:07:30
epoch [22/50] batch [4/12] time 0.507 (0.905) data 0.000 (0.392) loss 1.6260 (1.7007) lr 6.2434e-02 eta 0:05:11
epoch [22/50] batch [6/12] time 0.506 (0.772) data 0.000 (0.261) loss 1.7070 (1.6818) lr 6.2434e-02 eta 0:04:24
epoch [22/50] batch [8/12] time 0.517 (0.708) data 0.000 (0.196) loss 1.8994 (1.7147) lr 6.2434e-02 eta 0:04:00
epoch [22/50] batch [10/12] time 0.537 (0.673) data 0.000 (0.157) loss 1.6309 (1.7093) lr 6.2434e-02 eta 0:03:47
epoch [22/50] batch [12/12] time 0.554 (0.652) data 0.000 (0.131) loss 1.8164 (1.7158) lr 5.9369e-02 eta 0:03:39
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.45s/it] 50%|█████     | 2/4 [00:03<00:03,  1.60s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.01s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.09s/it]=> result
* total: 696
* correct: 578
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.7%

epoch [23/50] batch [2/12] time 0.528 (1.374) data 0.000 (0.831) loss 1.6768 (1.6353) lr 5.9369e-02 eta 0:07:38
epoch [23/50] batch [4/12] time 0.534 (0.953) data 0.000 (0.416) loss 1.4785 (1.5918) lr 5.9369e-02 eta 0:05:16
epoch [23/50] batch [6/12] time 0.527 (0.812) data 0.000 (0.277) loss 1.5400 (1.5747) lr 5.9369e-02 eta 0:04:28
epoch [23/50] batch [8/12] time 0.539 (0.743) data 0.000 (0.208) loss 1.7656 (1.6102) lr 5.9369e-02 eta 0:04:03
epoch [23/50] batch [10/12] time 0.535 (0.702) data 0.000 (0.166) loss 1.8447 (1.6149) lr 5.9369e-02 eta 0:03:48
epoch [23/50] batch [12/12] time 0.531 (0.673) data 0.000 (0.139) loss 1.8389 (1.6275) lr 5.6267e-02 eta 0:03:38
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.27s/it] 50%|█████     | 2/4 [00:03<00:03,  1.53s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.52it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 591
* accuracy: 84.9%
* error: 15.1%
* macro_f1: 82.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [24/50] batch [2/12] time 0.507 (1.302) data 0.000 (0.740) loss 1.5869 (1.6030) lr 5.6267e-02 eta 0:06:59
epoch [24/50] batch [4/12] time 0.521 (0.910) data 0.000 (0.370) loss 1.4893 (1.5908) lr 5.6267e-02 eta 0:04:51
epoch [24/50] batch [6/12] time 0.508 (0.776) data 0.000 (0.247) loss 1.6855 (1.6094) lr 5.6267e-02 eta 0:04:06
epoch [24/50] batch [8/12] time 0.526 (0.713) data 0.000 (0.185) loss 1.4551 (1.6010) lr 5.6267e-02 eta 0:03:45
epoch [24/50] batch [10/12] time 0.507 (0.675) data 0.000 (0.148) loss 1.6191 (1.5919) lr 5.6267e-02 eta 0:03:31
epoch [24/50] batch [12/12] time 0.507 (0.647) data 0.000 (0.124) loss 1.5088 (1.5789) lr 5.3140e-02 eta 0:03:21
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.16s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.01s/it]=> result
* total: 696
* correct: 592
* accuracy: 85.1%
* error: 14.9%
* macro_f1: 82.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [25/50] batch [2/12] time 0.539 (1.317) data 0.000 (0.735) loss 1.6611 (1.6309) lr 5.3140e-02 eta 0:06:48
epoch [25/50] batch [4/12] time 0.542 (0.927) data 0.001 (0.368) loss 1.6523 (1.6262) lr 5.3140e-02 eta 0:04:45
epoch [25/50] batch [6/12] time 0.541 (0.798) data 0.000 (0.245) loss 1.6133 (1.6034) lr 5.3140e-02 eta 0:04:04
epoch [25/50] batch [8/12] time 0.535 (0.732) data 0.000 (0.184) loss 1.5332 (1.5801) lr 5.3140e-02 eta 0:03:42
epoch [25/50] batch [10/12] time 0.541 (0.693) data 0.000 (0.147) loss 1.6904 (1.5880) lr 5.3140e-02 eta 0:03:29
epoch [25/50] batch [12/12] time 0.535 (0.666) data 0.000 (0.123) loss 1.5146 (1.5928) lr 5.0000e-02 eta 0:03:19
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 594
* accuracy: 85.3%
* error: 14.7%
* macro_f1: 82.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [26/50] batch [2/12] time 0.537 (1.311) data 0.001 (0.682) loss 1.5195 (1.6724) lr 5.0000e-02 eta 0:06:30
epoch [26/50] batch [4/12] time 0.530 (0.922) data 0.000 (0.341) loss 1.5518 (1.6118) lr 5.0000e-02 eta 0:04:32
epoch [26/50] batch [6/12] time 0.652 (0.812) data 0.000 (0.227) loss 1.7666 (1.6374) lr 5.0000e-02 eta 0:03:58
epoch [26/50] batch [8/12] time 0.532 (0.741) data 0.000 (0.171) loss 1.6738 (1.6344) lr 5.0000e-02 eta 0:03:36
epoch [26/50] batch [10/12] time 0.509 (0.695) data 0.000 (0.137) loss 1.4951 (1.6124) lr 5.0000e-02 eta 0:03:21
epoch [26/50] batch [12/12] time 0.513 (0.664) data 0.000 (0.114) loss 1.4961 (1.6101) lr 4.6860e-02 eta 0:03:11
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 598
* accuracy: 85.9%
* error: 14.1%
* macro_f1: 83.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [27/50] batch [2/12] time 0.510 (1.341) data 0.000 (0.795) loss 1.6270 (1.5908) lr 4.6860e-02 eta 0:06:23
epoch [27/50] batch [4/12] time 0.507 (0.924) data 0.000 (0.398) loss 1.7021 (1.6045) lr 4.6860e-02 eta 0:04:22
epoch [27/50] batch [6/12] time 0.515 (0.787) data 0.000 (0.265) loss 1.6885 (1.6117) lr 4.6860e-02 eta 0:03:41
epoch [27/50] batch [8/12] time 0.516 (0.719) data 0.000 (0.199) loss 1.5312 (1.6006) lr 4.6860e-02 eta 0:03:21
epoch [27/50] batch [10/12] time 0.516 (0.679) data 0.000 (0.159) loss 1.3896 (1.5936) lr 4.6860e-02 eta 0:03:08
epoch [27/50] batch [12/12] time 0.516 (0.651) data 0.000 (0.133) loss 1.5928 (1.5904) lr 4.3733e-02 eta 0:02:59
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.49s/it] 50%|█████     | 2/4 [00:03<00:03,  1.62s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 600
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 84.0%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [28/50] batch [2/12] time 0.549 (1.295) data 0.001 (0.628) loss 1.7129 (1.6504) lr 4.3733e-02 eta 0:05:54
epoch [28/50] batch [4/12] time 0.546 (0.922) data 0.000 (0.314) loss 1.4707 (1.5825) lr 4.3733e-02 eta 0:04:10
epoch [28/50] batch [6/12] time 0.548 (0.798) data 0.000 (0.210) loss 1.6885 (1.5957) lr 4.3733e-02 eta 0:03:35
epoch [28/50] batch [8/12] time 0.546 (0.733) data 0.000 (0.157) loss 1.4658 (1.5795) lr 4.3733e-02 eta 0:03:16
epoch [28/50] batch [10/12] time 0.530 (0.693) data 0.000 (0.126) loss 1.5664 (1.5759) lr 4.3733e-02 eta 0:03:04
epoch [28/50] batch [12/12] time 0.529 (0.666) data 0.000 (0.105) loss 2.0625 (1.6034) lr 4.0631e-02 eta 0:02:55
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.38s/it] 50%|█████     | 2/4 [00:03<00:03,  1.57s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.07s/it]=> result
* total: 696
* correct: 606
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 84.6%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [29/50] batch [2/12] time 0.514 (1.268) data 0.001 (0.664) loss 1.7988 (1.6436) lr 4.0631e-02 eta 0:05:32
epoch [29/50] batch [4/12] time 0.517 (0.893) data 0.000 (0.332) loss 1.6562 (1.6162) lr 4.0631e-02 eta 0:03:52
epoch [29/50] batch [6/12] time 0.514 (0.767) data 0.001 (0.221) loss 1.5762 (1.5778) lr 4.0631e-02 eta 0:03:17
epoch [29/50] batch [8/12] time 0.513 (0.703) data 0.000 (0.166) loss 1.5234 (1.5520) lr 4.0631e-02 eta 0:03:00
epoch [29/50] batch [10/12] time 0.514 (0.665) data 0.000 (0.133) loss 1.7500 (1.5715) lr 4.0631e-02 eta 0:02:48
epoch [29/50] batch [12/12] time 0.519 (0.641) data 0.000 (0.111) loss 1.5596 (1.5614) lr 3.7566e-02 eta 0:02:41
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.27s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.52it/s]100%|██████████| 4/4 [00:04<00:00,  1.04s/it]=> result
* total: 696
* correct: 604
* accuracy: 86.8%
* error: 13.2%
* macro_f1: 84.8%

epoch [30/50] batch [2/12] time 0.515 (1.219) data 0.000 (0.604) loss 1.6426 (1.6138) lr 3.7566e-02 eta 0:05:04
epoch [30/50] batch [4/12] time 0.519 (0.868) data 0.000 (0.302) loss 1.5264 (1.5596) lr 3.7566e-02 eta 0:03:35
epoch [30/50] batch [6/12] time 0.543 (0.757) data 0.000 (0.202) loss 1.5146 (1.5508) lr 3.7566e-02 eta 0:03:06
epoch [30/50] batch [8/12] time 0.559 (0.706) data 0.000 (0.151) loss 1.6807 (1.5735) lr 3.7566e-02 eta 0:02:52
epoch [30/50] batch [10/12] time 0.549 (0.674) data 0.000 (0.121) loss 1.5908 (1.5710) lr 3.7566e-02 eta 0:02:43
epoch [30/50] batch [12/12] time 0.551 (0.654) data 0.000 (0.101) loss 1.6719 (1.5697) lr 3.4549e-02 eta 0:02:36
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 606
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 85.4%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-30

epoch [31/50] batch [2/12] time 0.535 (1.408) data 0.000 (0.837) loss 1.4795 (1.5806) lr 3.4549e-02 eta 0:05:35
epoch [31/50] batch [4/12] time 0.531 (0.970) data 0.000 (0.418) loss 1.8496 (1.6541) lr 3.4549e-02 eta 0:03:48
epoch [31/50] batch [6/12] time 0.532 (0.823) data 0.000 (0.279) loss 1.5537 (1.6069) lr 3.4549e-02 eta 0:03:12
epoch [31/50] batch [8/12] time 0.534 (0.751) data 0.000 (0.209) loss 1.6123 (1.5887) lr 3.4549e-02 eta 0:02:54
epoch [31/50] batch [10/12] time 0.535 (0.707) data 0.000 (0.168) loss 1.6152 (1.5830) lr 3.4549e-02 eta 0:02:42
epoch [31/50] batch [12/12] time 0.538 (0.678) data 0.000 (0.140) loss 1.5195 (1.5654) lr 3.1594e-02 eta 0:02:34
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.17s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.56it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 603
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 84.6%

epoch [32/50] batch [2/12] time 0.517 (1.288) data 0.000 (0.722) loss 1.6475 (1.5620) lr 3.1594e-02 eta 0:04:51
epoch [32/50] batch [4/12] time 0.524 (0.906) data 0.001 (0.361) loss 1.5459 (1.5420) lr 3.1594e-02 eta 0:03:22
epoch [32/50] batch [6/12] time 0.529 (0.782) data 0.000 (0.241) loss 1.5420 (1.5384) lr 3.1594e-02 eta 0:02:53
epoch [32/50] batch [8/12] time 0.511 (0.714) data 0.000 (0.181) loss 1.6162 (1.5620) lr 3.1594e-02 eta 0:02:37
epoch [32/50] batch [10/12] time 0.510 (0.673) data 0.000 (0.145) loss 1.3818 (1.5442) lr 3.1594e-02 eta 0:02:26
epoch [32/50] batch [12/12] time 0.510 (0.646) data 0.000 (0.121) loss 1.8350 (1.5686) lr 2.8711e-02 eta 0:02:19
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.15s/it] 50%|█████     | 2/4 [00:03<00:02,  1.48s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 619
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 87.1%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [33/50] batch [2/12] time 0.535 (1.394) data 0.000 (0.828) loss 1.5205 (1.5430) lr 2.8711e-02 eta 0:04:58
epoch [33/50] batch [4/12] time 0.543 (0.966) data 0.000 (0.414) loss 1.5586 (1.5527) lr 2.8711e-02 eta 0:03:24
epoch [33/50] batch [6/12] time 0.551 (0.828) data 0.000 (0.276) loss 1.6670 (1.5854) lr 2.8711e-02 eta 0:02:53
epoch [33/50] batch [8/12] time 0.541 (0.757) data 0.000 (0.207) loss 1.6973 (1.5844) lr 2.8711e-02 eta 0:02:37
epoch [33/50] batch [10/12] time 0.537 (0.713) data 0.000 (0.166) loss 1.4395 (1.5631) lr 2.8711e-02 eta 0:02:26
epoch [33/50] batch [12/12] time 0.525 (0.683) data 0.000 (0.138) loss 1.5498 (1.5570) lr 2.5912e-02 eta 0:02:19
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.42s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.46it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 610
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 85.8%

epoch [34/50] batch [2/12] time 0.529 (1.379) data 0.000 (0.815) loss 1.3232 (1.5063) lr 2.5912e-02 eta 0:04:38
epoch [34/50] batch [4/12] time 0.527 (0.956) data 0.000 (0.408) loss 1.4814 (1.5044) lr 2.5912e-02 eta 0:03:11
epoch [34/50] batch [6/12] time 0.512 (0.809) data 0.000 (0.272) loss 1.5391 (1.5173) lr 2.5912e-02 eta 0:02:40
epoch [34/50] batch [8/12] time 0.508 (0.733) data 0.000 (0.204) loss 1.6201 (1.5339) lr 2.5912e-02 eta 0:02:23
epoch [34/50] batch [10/12] time 0.508 (0.688) data 0.000 (0.163) loss 1.3926 (1.5281) lr 2.5912e-02 eta 0:02:13
epoch [34/50] batch [12/12] time 0.509 (0.659) data 0.000 (0.136) loss 1.5479 (1.5270) lr 2.3209e-02 eta 0:02:06
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 613
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 86.1%

epoch [35/50] batch [2/12] time 0.507 (1.319) data 0.001 (0.798) loss 1.2891 (1.3882) lr 2.3209e-02 eta 0:04:10
epoch [35/50] batch [4/12] time 0.506 (0.914) data 0.000 (0.399) loss 1.4736 (1.4358) lr 2.3209e-02 eta 0:02:51
epoch [35/50] batch [6/12] time 0.508 (0.779) data 0.000 (0.266) loss 1.4854 (1.4717) lr 2.3209e-02 eta 0:02:24
epoch [35/50] batch [8/12] time 0.508 (0.711) data 0.000 (0.200) loss 1.7715 (1.5034) lr 2.3209e-02 eta 0:02:10
epoch [35/50] batch [10/12] time 0.512 (0.671) data 0.000 (0.160) loss 1.5000 (1.4972) lr 2.3209e-02 eta 0:02:02
epoch [35/50] batch [12/12] time 0.535 (0.647) data 0.000 (0.133) loss 1.3965 (1.4896) lr 2.0611e-02 eta 0:01:56
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.58s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.00s/it]100%|██████████| 4/4 [00:04<00:00,  1.47it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 609
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 85.9%

epoch [36/50] batch [2/12] time 0.541 (1.369) data 0.001 (0.720) loss 1.3711 (1.5146) lr 2.0611e-02 eta 0:04:03
epoch [36/50] batch [4/12] time 0.658 (0.982) data 0.000 (0.360) loss 1.5449 (1.5300) lr 2.0611e-02 eta 0:02:52
epoch [36/50] batch [6/12] time 0.533 (0.832) data 0.000 (0.240) loss 1.4834 (1.5254) lr 2.0611e-02 eta 0:02:24
epoch [36/50] batch [8/12] time 0.529 (0.758) data 0.000 (0.180) loss 1.4551 (1.5247) lr 2.0611e-02 eta 0:02:10
epoch [36/50] batch [10/12] time 0.529 (0.712) data 0.000 (0.144) loss 1.3223 (1.5023) lr 2.0611e-02 eta 0:02:01
epoch [36/50] batch [12/12] time 0.527 (0.695) data 0.000 (0.120) loss 1.4961 (1.5151) lr 1.8129e-02 eta 0:01:56
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.41s/it] 50%|█████     | 2/4 [00:03<00:03,  1.59s/it] 75%|███████▌  | 3/4 [00:04<00:00,  1.00it/s]100%|██████████| 4/4 [00:04<00:00,  1.48it/s]100%|██████████| 4/4 [00:04<00:00,  1.08s/it]=> result
* total: 696
* correct: 619
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 87.3%

epoch [37/50] batch [2/12] time 0.509 (1.310) data 0.000 (0.786) loss 1.5098 (1.4580) lr 1.8129e-02 eta 0:03:37
epoch [37/50] batch [4/12] time 0.511 (0.911) data 0.000 (0.393) loss 1.6133 (1.5645) lr 1.8129e-02 eta 0:02:29
epoch [37/50] batch [6/12] time 0.507 (0.776) data 0.000 (0.262) loss 1.5742 (1.5439) lr 1.8129e-02 eta 0:02:05
epoch [37/50] batch [8/12] time 0.505 (0.710) data 0.000 (0.197) loss 1.5547 (1.5483) lr 1.8129e-02 eta 0:01:53
epoch [37/50] batch [10/12] time 0.519 (0.672) data 0.000 (0.157) loss 1.6172 (1.5449) lr 1.8129e-02 eta 0:01:46
epoch [37/50] batch [12/12] time 0.512 (0.647) data 0.000 (0.131) loss 1.3701 (1.5278) lr 1.5773e-02 eta 0:01:40
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.17s/it] 50%|█████     | 2/4 [00:03<00:02,  1.49s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 621
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 87.3%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar

epoch [38/50] batch [2/12] time 0.520 (1.230) data 0.001 (0.618) loss 1.6016 (1.5542) lr 1.5773e-02 eta 0:03:09
epoch [38/50] batch [4/12] time 0.533 (0.882) data 0.000 (0.309) loss 1.5049 (1.5376) lr 1.5773e-02 eta 0:02:14
epoch [38/50] batch [6/12] time 0.535 (0.768) data 0.000 (0.206) loss 1.5654 (1.5492) lr 1.5773e-02 eta 0:01:55
epoch [38/50] batch [8/12] time 0.551 (0.713) data 0.000 (0.155) loss 1.4551 (1.5198) lr 1.5773e-02 eta 0:01:45
epoch [38/50] batch [10/12] time 0.547 (0.679) data 0.000 (0.124) loss 1.4688 (1.5149) lr 1.5773e-02 eta 0:01:39
epoch [38/50] batch [12/12] time 0.538 (0.655) data 0.000 (0.103) loss 1.4482 (1.5098) lr 1.3552e-02 eta 0:01:34
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.48s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.45it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 620
* accuracy: 89.1%
* error: 10.9%
* macro_f1: 87.5%

epoch [39/50] batch [2/12] time 0.530 (1.373) data 0.000 (0.793) loss 1.5107 (1.4478) lr 1.3552e-02 eta 0:03:14
epoch [39/50] batch [4/12] time 0.531 (0.954) data 0.001 (0.397) loss 1.4541 (1.4717) lr 1.3552e-02 eta 0:02:13
epoch [39/50] batch [6/12] time 0.530 (0.813) data 0.000 (0.265) loss 1.4805 (1.4889) lr 1.3552e-02 eta 0:01:52
epoch [39/50] batch [8/12] time 0.529 (0.742) data 0.000 (0.199) loss 1.4668 (1.4989) lr 1.3552e-02 eta 0:01:40
epoch [39/50] batch [10/12] time 0.524 (0.699) data 0.000 (0.159) loss 1.5645 (1.5159) lr 1.3552e-02 eta 0:01:33
epoch [39/50] batch [12/12] time 0.509 (0.668) data 0.000 (0.133) loss 1.5127 (1.5090) lr 1.1474e-02 eta 0:01:28
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.24s/it] 50%|█████     | 2/4 [00:03<00:03,  1.51s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.04it/s]100%|██████████| 4/4 [00:04<00:00,  1.53it/s]100%|██████████| 4/4 [00:04<00:00,  1.03s/it]=> result
* total: 696
* correct: 619
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 87.3%

epoch [40/50] batch [2/12] time 0.520 (1.232) data 0.001 (0.623) loss 1.5020 (1.4712) lr 1.1474e-02 eta 0:02:40
epoch [40/50] batch [4/12] time 0.519 (0.881) data 0.000 (0.312) loss 1.5088 (1.4600) lr 1.1474e-02 eta 0:01:52
epoch [40/50] batch [6/12] time 0.512 (0.758) data 0.000 (0.208) loss 1.5859 (1.5002) lr 1.1474e-02 eta 0:01:35
epoch [40/50] batch [8/12] time 0.509 (0.696) data 0.000 (0.156) loss 1.3838 (1.4833) lr 1.1474e-02 eta 0:01:26
epoch [40/50] batch [10/12] time 0.513 (0.659) data 0.000 (0.125) loss 1.4287 (1.4637) lr 1.1474e-02 eta 0:01:20
epoch [40/50] batch [12/12] time 0.536 (0.637) data 0.000 (0.104) loss 1.5371 (1.4785) lr 9.5492e-03 eta 0:01:16
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.28s/it] 50%|█████     | 2/4 [00:03<00:03,  1.53s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.03it/s]100%|██████████| 4/4 [00:04<00:00,  1.51it/s]100%|██████████| 4/4 [00:04<00:00,  1.05s/it]=> result
* total: 696
* correct: 625
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 88.2%
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model-best.pth.tar
Checkpoint saved to output/rpo_prime/base2new/train_base/oxford_flowers/shots_16/RPO_prime_sdl/main_tmp1_0.1sdl/seed3/prompt_learner/model.pth.tar-40

epoch [41/50] batch [2/12] time 0.541 (1.286) data 0.001 (0.653) loss 1.6582 (1.6011) lr 9.5492e-03 eta 0:02:31
epoch [41/50] batch [4/12] time 0.538 (0.911) data 0.000 (0.327) loss 1.5791 (1.5918) lr 9.5492e-03 eta 0:01:45
epoch [41/50] batch [6/12] time 0.540 (0.788) data 0.000 (0.218) loss 1.5781 (1.5807) lr 9.5492e-03 eta 0:01:29
epoch [41/50] batch [8/12] time 0.538 (0.725) data 0.000 (0.164) loss 1.4072 (1.5248) lr 9.5492e-03 eta 0:01:21
epoch [41/50] batch [10/12] time 0.535 (0.688) data 0.000 (0.131) loss 1.3984 (1.5031) lr 9.5492e-03 eta 0:01:15
epoch [41/50] batch [12/12] time 0.529 (0.662) data 0.000 (0.109) loss 1.6279 (1.5133) lr 7.7836e-03 eta 0:01:11
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.31s/it] 50%|█████     | 2/4 [00:03<00:03,  1.54s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.02it/s]100%|██████████| 4/4 [00:04<00:00,  1.50it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 625
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 88.2%

epoch [42/50] batch [2/12] time 0.524 (1.373) data 0.000 (0.807) loss 1.3809 (1.4746) lr 7.7836e-03 eta 0:02:25
epoch [42/50] batch [4/12] time 0.511 (0.943) data 0.000 (0.404) loss 1.5117 (1.4844) lr 7.7836e-03 eta 0:01:38
epoch [42/50] batch [6/12] time 0.510 (0.798) data 0.000 (0.269) loss 1.5527 (1.4940) lr 7.7836e-03 eta 0:01:21
epoch [42/50] batch [8/12] time 0.505 (0.725) data 0.000 (0.202) loss 1.4609 (1.4891) lr 7.7836e-03 eta 0:01:12
epoch [42/50] batch [10/12] time 0.508 (0.681) data 0.000 (0.162) loss 1.6162 (1.5010) lr 7.7836e-03 eta 0:01:06
epoch [42/50] batch [12/12] time 0.508 (0.652) data 0.000 (0.135) loss 1.5830 (1.5157) lr 6.1847e-03 eta 0:01:02
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.55it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 621
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 88.0%

epoch [43/50] batch [2/12] time 0.505 (1.208) data 0.001 (0.609) loss 1.4004 (1.4546) lr 6.1847e-03 eta 0:01:53
epoch [43/50] batch [4/12] time 0.504 (0.857) data 0.000 (0.305) loss 1.4961 (1.5054) lr 6.1847e-03 eta 0:01:18
epoch [43/50] batch [6/12] time 0.505 (0.740) data 0.000 (0.203) loss 1.4443 (1.5047) lr 6.1847e-03 eta 0:01:06
epoch [43/50] batch [8/12] time 0.510 (0.683) data 0.000 (0.153) loss 1.3838 (1.4956) lr 6.1847e-03 eta 0:01:00
epoch [43/50] batch [10/12] time 0.535 (0.651) data 0.000 (0.122) loss 1.4326 (1.4726) lr 6.1847e-03 eta 0:00:55
epoch [43/50] batch [12/12] time 0.545 (0.632) data 0.000 (0.102) loss 1.4365 (1.4635) lr 4.7586e-03 eta 0:00:53
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.46s/it] 50%|█████     | 2/4 [00:03<00:03,  1.61s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.02s/it]100%|██████████| 4/4 [00:04<00:00,  1.44it/s]100%|██████████| 4/4 [00:04<00:00,  1.10s/it]=> result
* total: 696
* correct: 623
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 87.9%

epoch [44/50] batch [2/12] time 0.540 (1.288) data 0.000 (0.633) loss 1.5518 (1.5337) lr 4.7586e-03 eta 0:01:45
epoch [44/50] batch [4/12] time 0.539 (0.913) data 0.000 (0.317) loss 1.4756 (1.4661) lr 4.7586e-03 eta 0:01:13
epoch [44/50] batch [6/12] time 0.537 (0.788) data 0.000 (0.211) loss 1.4258 (1.4378) lr 4.7586e-03 eta 0:01:01
epoch [44/50] batch [8/12] time 0.536 (0.725) data 0.000 (0.159) loss 1.5547 (1.4578) lr 4.7586e-03 eta 0:00:55
epoch [44/50] batch [10/12] time 0.532 (0.689) data 0.000 (0.127) loss 1.7168 (1.4857) lr 4.7586e-03 eta 0:00:50
epoch [44/50] batch [12/12] time 0.529 (0.662) data 0.000 (0.106) loss 1.4863 (1.4857) lr 3.5112e-03 eta 0:00:47
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:10,  3.36s/it] 50%|█████     | 2/4 [00:03<00:03,  1.56s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.01it/s]100%|██████████| 4/4 [00:04<00:00,  1.49it/s]100%|██████████| 4/4 [00:04<00:00,  1.06s/it]=> result
* total: 696
* correct: 623
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 88.0%

epoch [45/50] batch [2/12] time 0.507 (1.314) data 0.000 (0.788) loss 1.5146 (1.4590) lr 3.5112e-03 eta 0:01:31
epoch [45/50] batch [4/12] time 0.509 (0.911) data 0.000 (0.394) loss 1.3857 (1.4639) lr 3.5112e-03 eta 0:01:01
epoch [45/50] batch [6/12] time 0.637 (0.799) data 0.000 (0.263) loss 1.3877 (1.4482) lr 3.5112e-03 eta 0:00:52
epoch [45/50] batch [8/12] time 0.523 (0.730) data 0.000 (0.197) loss 1.5186 (1.4449) lr 3.5112e-03 eta 0:00:46
epoch [45/50] batch [10/12] time 0.515 (0.689) data 0.000 (0.158) loss 1.5801 (1.4683) lr 3.5112e-03 eta 0:00:42
epoch [45/50] batch [12/12] time 0.518 (0.660) data 0.000 (0.132) loss 1.5869 (1.4762) lr 2.4472e-03 eta 0:00:39
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.20s/it] 50%|█████     | 2/4 [00:03<00:02,  1.50s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.05it/s]100%|██████████| 4/4 [00:03<00:00,  1.54it/s]100%|██████████| 4/4 [00:04<00:00,  1.02s/it]=> result
* total: 696
* correct: 622
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 88.0%

epoch [46/50] batch [2/12] time 0.542 (1.361) data 0.000 (0.800) loss 1.4893 (1.4683) lr 2.4472e-03 eta 0:01:18
epoch [46/50] batch [4/12] time 0.542 (0.955) data 0.000 (0.400) loss 1.3633 (1.4180) lr 2.4472e-03 eta 0:00:53
epoch [46/50] batch [6/12] time 0.551 (0.820) data 0.000 (0.267) loss 1.4551 (1.4678) lr 2.4472e-03 eta 0:00:44
epoch [46/50] batch [8/12] time 0.550 (0.753) data 0.000 (0.200) loss 1.4814 (1.4744) lr 2.4472e-03 eta 0:00:39
epoch [46/50] batch [10/12] time 0.556 (0.713) data 0.000 (0.160) loss 1.3936 (1.4700) lr 2.4472e-03 eta 0:00:35
epoch [46/50] batch [12/12] time 0.551 (0.685) data 0.000 (0.134) loss 1.5625 (1.4804) lr 1.5708e-03 eta 0:00:32
Evaluate on the *val* set
  0%|          | 0/4 [00:00<?, ?it/s]slurmstepd: error: *** JOB 391564 ON a00 CANCELLED AT 2024-02-26T16:54:38 ***
